<!DOCTYPE html>
<!-- saved from url=(0301)https://disqus.com/embed/comments/?base=default&f=apaszke&t_i=lstm-explained&t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&t_e=LSTM%20implementation%20explained&t_d=LSTM%20implementation%20explained&t_t=LSTM%20implementation%20explained&s_o=default#version=b1154ecf4b95e86261f41bc70c721c86 -->
<html lang="en" dir="ltr" class="js no-touch localstorage sessionstorage contenteditable use-opacity-transitions"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Disqus Comments</title>

    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style>
        .alert--warning {
            border-radius: 3px;
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #FFE070;
            color: #A47703;
        }

        .alert--warning a,
        .alert--warning a:hover,
        .alert--warning strong {
            color: #A47703;
            font-weight: bold;
        }

        .alert--error p,
        .alert--warning p {
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        </style>
    
    <style>
        
        html {
            overflow: hidden;
        }
        

        #error {
            display: none;
        }

        .clearfix:after {
            content: "";
            display: block;
            height: 0;
            clear: both;
            visibility: hidden;
        }

        
    </style>

<script async="" src="./p13n.min.js"></script><script crossorigin="anonymous" id="bootstrap-script" data-app="lounge" src="./lounge.load.b1154ecf4b95e86261f41bc70c721c86.js"></script><meta http-equiv="Content-Security-Policy" content="script-src https:;"><link rel="stylesheet" href="./lounge.d49f53e192b9080ef8880a7c9b24f1c3.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="lounge/main" src="./lounge.bundle.c393e1d4d2a9e62948b6e48719cc1a2d.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="remote/config" src="./config.js"></script><style id="css_1544559466593"></style><!--<base target="_parent">--><base href="." target="_parent"><link rel="stylesheet" href="./discovery.539723090a04fba1b162858415868357.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="discovery/main" src="./discovery.bundle.daedd146972fc7d8dffd9be34c404865.js"></script></head>
<body>
    

    
    <div id="error" class="alert--error">
        <p>We were unable to load Disqus. If you are a moderator please see our <a href="https://docs.disqus.com/help/83/"> troubleshooting guide</a>. </p>
    </div>

    
    <script type="text/json" id="disqus-forumData">{"session":{"canModerate":false,"audienceSyncVerified":false,"mustVerify":false,"canReply":true,"mustVerifyEmail":false},"forum":{"aetBannerConfirmation":null,"founder":"172362162","twitterName":"","commentsLinkOne":"1 Comment","guidelines":null,"favicon":{"permalink":"https://disqus.com/api/forums/favicons/apaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/favicon-default.png"},"commentsLinkZero":"0 Comments","disableDisqusBranding":false,"daysAlive":0,"createdAt":"2015-08-30T17:54:14.422204","category":"Tech","aetBannerEnabled":false,"aetBannerTitle":null,"raw_guidelines":null,"colorScheme":"auto","id":"apaszke","installCompleted":true,"moderatorBadgeText":"","commentPolicyText":null,"aetEnabled":false,"channel":null,"sort":4,"description":"","newPolicy":true,"raw_description":"","language":"en","adsReviewStatus":0,"pk":"3762125","forumCategory":{"date_added":"2016-01-28T01:54:31","id":8,"name":"Tech"},"permissions":{},"commentPolicyLink":null,"aetBannerDescription":null,"name":"Adam's blog","commentsLinkMultiple":"{num} Comments","settings":{"adsDRNativeEnabled":false,"disable3rdPartyTrackers":false,"adsVideoEnabled":false,"allowAnonPost":false,"audienceSyncEnabled":false,"unapproveLinks":false,"linkAffiliationEnabled":true,"adsProductLinksThumbnailsEnabled":false,"adsProductStoriesEnabled":false,"organicDiscoveryEnabled":true,"adsProductDisplayEnabled":false,"adsProductLinksEnabled":false,"hasCustomAvatar":false,"adsEnabled":false,"threadReactionsEnabled":false,"adsPositionTopEnabled":false,"allowMedia":true,"adultContent":false,"allowAnonVotes":false,"adsProductVideoEnabled":false,"mustVerify":true,"mustVerifyEmail":true,"ssoRequired":false,"mediaembedEnabled":true,"adsPositionBottomEnabled":false,"discoveryLocked":false,"validateAllPosts":false,"adsSettingsLocked":false,"isVIP":false,"adsPositionInthreadEnabled":false},"organizationId":2724004,"typeface":"auto","url":"","daysThreadAlive":0,"avatar":{"small":{"permalink":"https://disqus.com/api/forums/avatars/apaszke.jpg?size=32","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"large":{"permalink":"https://disqus.com/api/forums/avatars/apaszke.jpg?size=92","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}},"signedUrl":""}}</script>

    <script type="text/json" id="disqus-threadData">{"cursor":{"hasPrev":false,"prev":null,"total":49,"hasNext":false,"next":"1:0:0"},"code":0,"response":{"lastModified":1544274903,"posts":[{"editableUntil":"2017-12-05T22:01:06","dislikes":0,"numReports":0,"likes":6,"message":"\u003cp>Sir i need implement the LSTM algorithm on Text\u003c/p>","id":"3637136438","createdAt":"2017-11-28T22:01:06","author":{"username":"abdelkarimtaam","about":"","name":"Abdelkarim Taam","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-11-28T22:00:58","profileUrl":"https://disqus.com/by/abdelkarimtaam/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"272532851","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/abdelkarimtaam.jpg","cache":"https://c.disquscdn.com/uploads/users/27253/2851/avatar32.jpg?1511906467"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/abdelkarimtaam.jpg","cache":"https://c.disquscdn.com/uploads/users/27253/2851/avatar92.jpg?1511906467","large":{"permalink":"https://disqus.com/api/users/avatars/abdelkarimtaam.jpg","cache":"https://c.disquscdn.com/uploads/users/27253/2851/avatar92.jpg?1511906467"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Sir i need implement the LSTM algorithm on Text","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":6,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-12-17T14:16:11","dislikes":0,"numReports":0,"likes":3,"message":"\u003cp>Hi,  can you please update this with the training code too? \u003cbr>Also, would be great if you could have another article explaining how to build LSTM networks using the 'rnn' package (with nn.Sequencer and stuff), and how it compares to using nngraph.\u003c/p>\u003cp>Thanks for the really good explanation about building the LSTM!\u003c/p>","id":"2403096907","createdAt":"2015-12-10T14:16:11","author":{"username":"aravindsrinivasl","about":"","name":"Aravind Srinivas L","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-12-10T14:14:31","profileUrl":"https://disqus.com/by/aravindsrinivasl/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"186827635","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/aravindsrinivasl.jpg","cache":"https://c.disquscdn.com/uploads/users/18682/7635/avatar32.jpg?1464748477"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/aravindsrinivasl.jpg","cache":"https://c.disquscdn.com/uploads/users/18682/7635/avatar92.jpg?1464748477","large":{"permalink":"https://disqus.com/api/users/avatars/aravindsrinivasl.jpg","cache":"https://c.disquscdn.com/uploads/users/18682/7635/avatar92.jpg?1464748477"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi,  can you please update this with the training code too? \nAlso, would be great if you could have another article explaining how to build LSTM networks using the 'rnn' package (with nn.Sequencer and stuff), and how it compares to using nngraph.\n\nThanks for the really good explanation about building the LSTM!","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":3,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-03-06T23:25:53","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi Aravind. Sorry for a late reply. I haven't used rnn package yet, because nngraph fitted nicely into my models so far. I'm planning to do some extensions to this post, which include adding a section on training LSTM networks.\u003c/p>","id":"2542268015","createdAt":"2016-02-28T23:25:53","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2403096907,"isApproved":true,"isFlagged":false,"raw_message":"Hi Aravind. Sorry for a late reply. I haven't used rnn package yet, because nngraph fitted nicely into my models so far. I'm planning to do some extensions to this post, which include adding a section on training LSTM networks.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-03-03T10:18:16","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I think there is no such thing as rnn package, you have to build RNN with nngraph.\u003c/p>","id":"2534353533","createdAt":"2016-02-25T10:18:16","author":{"username":"disqus_TsTw5z52iB","about":"","name":"Bruce Zhang","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-01-29T08:56:33","profileUrl":"https://disqus.com/by/disqus_TsTw5z52iB/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"194044248","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_TsTw5z52iB.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_TsTw5z52iB.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_TsTw5z52iB.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2403096907,"isApproved":true,"isFlagged":false,"raw_message":"I think there is no such thing as rnn package, you have to build RNN with nngraph.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-03-06T23:24:24","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>In fact there is an rnn package by Nicholas L\u00e9onard, but it's not included in torch core. See \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2FElement-Research%2Frnn%3A2cchRibNtQPiAEfpdDv4dAfhfk8&amp;cuid=3762125\" rel=\"nofollow noopener\" title=\"https://github.com/Element-Research/rnn\">this repository\u003c/a>.\u003c/p>","id":"2542264658","createdAt":"2016-02-28T23:24:24","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2534353533,"isApproved":true,"isFlagged":false,"raw_message":"In fact there is an rnn package by Nicholas L\u00e9onard, but it's not included in torch core. See \u003ca href=\"https://github.com/Element-Research/rnn\">this repository\u003c/a>.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":["links"],"isEdited":true,"sb":false},{"editableUntil":"2016-02-09T18:20:30","dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>hi great stuff.\u003cbr>i'm gonno ask this just to be sure :\u003cbr>you have 3 inputs for forward pass\u003cbr>so f i want to us it in multiple steps i have to give this layer the resuls of the last step for two of those inputs right?\u003cbr>this is making it too hard could you just take the input and somehow insert the ht-1  ?\u003c/p>","id":"2492364557","createdAt":"2016-02-02T18:20:30","author":{"username":"disqus_aISFArTPT6","about":"","name":"soshiant","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-02-02T18:10:08","profileUrl":"https://disqus.com/by/disqus_aISFArTPT6/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"194596855","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_aISFArTPT6.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_aISFArTPT6.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_aISFArTPT6.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"hi great stuff.\ni'm gonno ask this just to be sure :\nyou have 3 inputs for forward pass\nso f i want to us it in multiple steps i have to give this layer the resuls of the last step for two of those inputs right?\nthis is making it too hard could you just take the input and somehow insert the ht-1  ?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-03-06T23:28:11","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Yes, two of the outputs are inputs in the next time step. Unfortunately, I don't think it can be done in a simpler way.\u003c/p>","id":"2542272838","createdAt":"2016-02-28T23:28:11","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2492364557,"isApproved":true,"isFlagged":false,"raw_message":"Yes, two of the outputs are inputs in the next time step. Unfortunately, I don't think it can be done in a simpler way.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-02-28T12:40:06","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>So, after the LSTM model builds, what are the matrices which we get as outputs?\u003c/p>","id":"3768927212","createdAt":"2018-02-21T12:40:06","author":{"username":"disqus_m6m28sebc8","about":"","name":"Chirag Mittal","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-02-21T12:39:57","profileUrl":"https://disqus.com/by/disqus_m6m28sebc8/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"280752791","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_m6m28sebc8.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_m6m28sebc8.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_m6m28sebc8.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"So, after the LSTM model builds, what are the matrices which we get as outputs?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2017-07-24T17:30:53","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Am struggling with my own LSTM written using std:vectors I cannot seem to get it to learn I am updating the weights for each gate however I do not have weights assigned to the Hin and In and have only added them to be used by each gate. I have two layers and my main question is do I need these weights and must they therefore be used to backprop error to the gates. Thanks\u003c/p>\u003cp>\u003ca href=\"http://disq.us/url?url=http%3A%2F%2Fhobo-ai.blogspot.co.uk%2F2017%2F07%2Fcannot-get-this-to-work-yet-lstm.html%3AN4f5J9QNpZwS6ovl_qi1KIEd2l4&amp;cuid=3762125\" rel=\"nofollow noopener\" title=\"http://hobo-ai.blogspot.co.uk/2017/07/cannot-get-this-to-work-yet-lstm.html\">http://hobo-ai.blogspot.co....\u003c/a>\u003c/p>","id":"3421073377","createdAt":"2017-07-17T17:30:53","author":{"username":"housebytebestofnet","about":"","name":"Housebyte Bestofnet","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-07-17T17:29:14","profileUrl":"https://disqus.com/by/housebytebestofnet/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"259252225","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/housebytebestofnet.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/housebytebestofnet.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/housebytebestofnet.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Am struggling with my own LSTM written using std:vectors I cannot seem to get it to learn I am updating the weights for each gate however I do not have weights assigned to the Hin and In and have only added them to be used by each gate. I have two layers and my main question is do I need these weights and must they therefore be used to backprop error to the gates. Thanks\n\nhttp://hobo-ai.blogspot.co.uk/2017/07/cannot-get-this-to-work-yet-lstm.html","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":["links"],"isEdited":true,"sb":false},{"editableUntil":"2017-06-29T16:15:20","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, thank you very much for this explanation! I'm new to torch and am not quite following how these lines map to the sum part of of the gate equations. Would you mind expanding on this? Thank you!!\u003c/p>\u003cp>local i2h = nn.Linear(input_size, 4 * rnn_size)(input)  -- input to hidden\u003cbr>local h2h = nn.Linear(rnn_size, 4 * rnn_size)(prev_h)   -- hidden to hidden\u003cbr>local preactivations = nn.CAddTable()({i2h, h2h})       -- i2h + h2h\u003c/p>","id":"3379890140","createdAt":"2017-06-22T16:15:20","author":{"username":"cookiemonstrua3","about":"","name":"cookiemonstrua3","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-07-29T20:48:55","profileUrl":"https://disqus.com/by/cookiemonstrua3/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"167385783","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cookiemonstrua3.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/cookiemonstrua3.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/cookiemonstrua3.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi, thank you very much for this explanation! I'm new to torch and am not quite following how these lines map to the sum part of of the gate equations. Would you mind expanding on this? Thank you!!\n\nlocal i2h = nn.Linear(input_size, 4 * rnn_size)(input)  -- input to hidden\nlocal h2h = nn.Linear(rnn_size, 4 * rnn_size)(prev_h)   -- hidden to hidden\nlocal preactivations = nn.CAddTable()({i2h, h2h})       -- i2h + h2h","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2017-06-29T19:53:50","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>It takes in a list of modules and once given input will pass it to all submodules, and return a sum of their outputs.\u003c/p>","id":"3380432862","createdAt":"2017-06-22T19:53:50","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3379890140,"isApproved":true,"isFlagged":false,"raw_message":"It takes in a list of modules and once given input will pass it to all submodules, and return a sum of their outputs.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2017-07-03T16:01:28","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Right. So torch is implicitly creating weight matrices of input_size by 4*rnn_size and rnn_size by 4*rnn_size, multiplying them by the inputs/hidden inputs to get batch_size x 4*rnn_size output, and then adding those together?\u003c/p>\u003cp>So if you were to change the operation from Linear to something else (a convolution, for example), since you've done all the transforms in one the rnn_size isn't being used by other calculations, and as long as you had the same dimensions for i2h and h2h the remaining updates would follow?\u003c/p>","id":"3386472692","createdAt":"2017-06-26T16:01:28","author":{"username":"cookiemonstrua3","about":"","name":"cookiemonstrua3","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-07-29T20:48:55","profileUrl":"https://disqus.com/by/cookiemonstrua3/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"167385783","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cookiemonstrua3.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/cookiemonstrua3.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/cookiemonstrua3.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3380432862,"isApproved":true,"isFlagged":false,"raw_message":"Right. So torch is implicitly creating weight matrices of input_size by 4*rnn_size and rnn_size by 4*rnn_size, multiplying them by the inputs/hidden inputs to get batch_size x 4*rnn_size output, and then adding those together?\n\nSo if you were to change the operation from Linear to something else (a convolution, for example), since you've done all the transforms in one the rnn_size isn't being used by other calculations, and as long as you had the same dimensions for i2h and h2h the remaining updates would follow?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2017-03-14T13:15:16","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, i'm trying to implement own LSTM for better understanding. Unfortunately my backprop algorithm doesn't pass gradient check. Could you kindly help me?\u003c/p>","id":"3190751591","createdAt":"2017-03-07T14:15:16","author":{"username":"igorchernobaev","about":"","name":"Igor Chernobaev","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-10-12T17:47:08","profileUrl":"https://disqus.com/by/igorchernobaev/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"178294769","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/igorchernobaev.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/igorchernobaev.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/igorchernobaev.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi, i'm trying to implement own LSTM for better understanding. Unfortunately my backprop algorithm doesn't pass gradient check. Could you kindly help me?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-11-08T03:31:17","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Excellent post - very helpful.  Much appreciated Adam!\u003c/p>","id":"2978686662","createdAt":"2016-11-01T02:31:17","author":{"username":"faiyazlalani","about":"","name":"Faiyaz Lalani","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-11-01T02:28:49","profileUrl":"https://disqus.com/by/faiyazlalani/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"228451061","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/faiyazlalani.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/faiyazlalani.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/faiyazlalani.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Excellent post - very helpful.  Much appreciated Adam!","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-10-20T08:45:31","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I am interested in knowing that how lstm model is trained.\u003c/p>","id":"2948125410","createdAt":"2016-10-13T08:45:31","author":{"username":"disqus_d0sJQt6fLf","about":"","name":"fnm","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-10-13T08:02:07","profileUrl":"https://disqus.com/by/disqus_d0sJQt6fLf/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"226348288","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_d0sJQt6fLf.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_d0sJQt6fLf.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_d0sJQt6fLf.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"I am interested in knowing that how lstm model is trained.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-07-28T07:33:02","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>It would be cool to have the training procedure as well\u003c/p>","id":"2794888435","createdAt":"2016-07-21T07:33:02","author":{"username":"yitzhakspielberg","about":"","name":"Yitzhak Spielberg","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-07-21T07:22:28","profileUrl":"https://disqus.com/by/yitzhakspielberg/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"215820942","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar32.jpg?1514550992"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992","large":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"It would be cool to have the training procedure as well","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-07-28T07:24:56","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, how do I build a model with multiple lstm layers? for ordinary neural nets I used nn.sequential to build the model and model:forward(x) to calculate the output. How does it work in this case? A simple example, let's say with 2 lstm layers would be really helpful.\u003c/p>","id":"2794847588","createdAt":"2016-07-21T07:24:56","author":{"username":"yitzhakspielberg","about":"","name":"Yitzhak Spielberg","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-07-21T07:22:28","profileUrl":"https://disqus.com/by/yitzhakspielberg/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"215820942","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar32.jpg?1514550992"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992","large":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi, how do I build a model with multiple lstm layers? for ordinary neural nets I used nn.sequential to build the model and model:forward(x) to calculate the output. How does it work in this case? A simple example, let's say with 2 lstm layers would be really helpful.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-07-28T07:33:29","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>solved. just found the multilayer example above.\u003c/p>","id":"2794890520","createdAt":"2016-07-21T07:33:29","author":{"username":"yitzhakspielberg","about":"","name":"Yitzhak Spielberg","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-07-21T07:22:28","profileUrl":"https://disqus.com/by/yitzhakspielberg/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"215820942","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar32.jpg?1514550992"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992","large":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2794847588,"isApproved":true,"isFlagged":false,"raw_message":"solved. just found the multilayer example above.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-07-22T00:35:40","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, Thank you for this nice post about LSTM, I would like to explain me how we could implement the LSTM attention.\u003c/p>","id":"2783959255","createdAt":"2016-07-15T00:35:40","author":{"username":"mohammed_jabreel","about":"","name":"Mohammed Jabreel","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-07-15T00:34:45","profileUrl":"https://disqus.com/by/mohammed_jabreel/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"215127778","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/mohammed_jabreel.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/mohammed_jabreel.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/mohammed_jabreel.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi, Thank you for this nice post about LSTM, I would like to explain me how we could implement the LSTM attention.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-07-04T08:48:52","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Nice LSTM post, but I have a question,how the gate units can protect the gradient inside the cell from harmful changes during the training, if there existes some explanation in math?\u003c/p>","id":"2752671300","createdAt":"2016-06-27T08:48:52","author":{"username":"disqus_69LPgvlRKI","about":"","name":"simon","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-06-27T08:47:21","profileUrl":"https://disqus.com/by/disqus_69LPgvlRKI/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"213022569","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_69LPgvlRKI.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_69LPgvlRKI.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_69LPgvlRKI.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Nice LSTM post, but I have a question,how the gate units can protect the gradient inside the cell from harmful changes during the training, if there existes some explanation in math?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-06-18T15:50:54","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Noob question: How can I compute the RNN output with this? layer:forward() only gives the updated hidden and cell state...but how do I get the networks predictions?\u003c/p>","id":"2725100813","createdAt":"2016-06-11T15:50:54","author":{"username":"lucanaterop","about":"","name":"Luca Naterop","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2013-07-25T20:25:53","profileUrl":"https://disqus.com/by/lucanaterop/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"64200016","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/lucanaterop.jpg","cache":"https://c.disquscdn.com/uploads/users/6420/16/avatar32.jpg?1468161995"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/lucanaterop.jpg","cache":"https://c.disquscdn.com/uploads/users/6420/16/avatar92.jpg?1468161995","large":{"permalink":"https://disqus.com/api/users/avatars/lucanaterop.jpg","cache":"https://c.disquscdn.com/uploads/users/6420/16/avatar92.jpg?1468161995"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Noob question: How can I compute the RNN output with this? layer:forward() only gives the updated hidden and cell state...but how do I get the networks predictions?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-05-05T08:10:46","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, nice article. The LSTM obtained above won't have tied weights. Hence, I had 2 questions.\u003c/p>\u003cp>1) Is it more common to have tied weights between different LSTM units.\u003cbr>2) Can this simply be achieved by getting the parameters pointer of the first unit, and setting the parameters of all successive units to point to that pointer (Similar for gradient)\u003c/p>","id":"2646947651","createdAt":"2016-04-28T08:10:46","author":{"username":"disqus_FE6W9KzWs8","about":"Super Zero","name":"Gaurav Pandey","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-04-10T15:18:11","profileUrl":"https://disqus.com/by/disqus_FE6W9KzWs8/","url":"","location":"Jungles of Africa","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"102620122","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_FE6W9KzWs8.jpg","cache":"https://c.disquscdn.com/uploads/users/10262/122/avatar32.jpg?1534325357"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_FE6W9KzWs8.jpg","cache":"https://c.disquscdn.com/uploads/users/10262/122/avatar92.jpg?1534325357","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_FE6W9KzWs8.jpg","cache":"https://c.disquscdn.com/uploads/users/10262/122/avatar92.jpg?1534325357"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi, nice article. The LSTM obtained above won't have tied weights. Hence, I had 2 questions.\n\n1) Is it more common to have tied weights between different LSTM units.\n2) Can this simply be achieved by getting the parameters pointer of the first unit, and setting the parameters of all successive units to point to that pointer (Similar for gradient)","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-03-06T23:20:07","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi. Thanks for this! It would be great if you could also update the training code. This has been very helpful for me in learning about LSTM.\u003c/p>","id":"2542259263","createdAt":"2016-02-28T23:20:07","author":{"username":"disqus_JKmCckR2Jw","about":"","name":"Mahati","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-02-28T23:18:50","profileUrl":"https://disqus.com/by/disqus_JKmCckR2Jw/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"198542359","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_JKmCckR2Jw.jpg","cache":"https://c.disquscdn.com/uploads/users/19854/2359/avatar32.jpg?1456701532"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_JKmCckR2Jw.jpg","cache":"https://c.disquscdn.com/uploads/users/19854/2359/avatar92.jpg?1456701532","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_JKmCckR2Jw.jpg","cache":"https://c.disquscdn.com/uploads/users/19854/2359/avatar92.jpg?1456701532"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi. Thanks for this! It would be great if you could also update the training code. This has been very helpful for me in learning about LSTM.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-03-06T23:22:30","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi Mahati. Great to hear that it was helpful for you. I am planning to expand this post in the near future and there will be some training examples provided.\u003c/p>","id":"2542262312","createdAt":"2016-02-28T23:22:30","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2542259263,"isApproved":true,"isFlagged":false,"raw_message":"Hi Mahati. Great to hear that it was helpful for you. I am planning to expand this post in the near future and there will be some training examples provided.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-01-14T09:12:26","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Once you have your \"layer\" variable, can you use it as a traditional nn.Module and start the training?\u003c/p>","id":"2444132313","createdAt":"2016-01-07T09:12:26","author":{"username":"disqus_Pcs7K2lnNd","about":"","name":"Marco Damonte","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-01-05T13:13:30","profileUrl":"https://disqus.com/by/disqus_Pcs7K2lnNd/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"190738230","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_Pcs7K2lnNd.jpg","cache":"https://c.disquscdn.com/uploads/users/19073/8230/avatar32.jpg?1461337342"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_Pcs7K2lnNd.jpg","cache":"https://c.disquscdn.com/uploads/users/19073/8230/avatar92.jpg?1461337342","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_Pcs7K2lnNd.jpg","cache":"https://c.disquscdn.com/uploads/users/19073/8230/avatar92.jpg?1461337342"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Once you have your \"layer\" variable, can you use it as a traditional nn.Module and start the training?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2016-03-06T23:21:45","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Yes! gModule has the same API as all nn modules.\u003c/p>","id":"2542261364","createdAt":"2016-02-28T23:21:45","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2444132313,"isApproved":true,"isFlagged":false,"raw_message":"Yes! gModule has the same API as all nn modules.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-11-08T05:22:42","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>\u003ca data-dsq-mention=\"adampaszke:disqus\" href=\"https://disqus.com/by/adampaszke/\" rel=\"nofollow noopener\" title=\"https://disqus.com/by/adampaszke/\">Adam Paszke\u003c/a>, what is the dimension of preactivations? I think it is just a 1D vector of size 4 * rnn_size,  but why the first argument of nn.Narrow(2, 1, 3 * rnn_size) is 2?\u003c/p>","id":"2337287437","createdAt":"2015-11-01T04:22:42","author":{"username":"aiqunhuang","about":"","name":"Aiqun Huang","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-07-18T15:53:39","profileUrl":"https://disqus.com/by/aiqunhuang/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"114896406","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar32.jpg?1494190375"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1494190375","large":{"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1494190375"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"@adampaszke:disqus, what is the dimension of preactivations? I think it is just a 1D vector of size 4 * rnn_size,  but why the first argument of nn.Narrow(2, 1, 3 * rnn_size) is 2?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2015-11-08T16:28:09","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>\u003ca data-dsq-mention=\"adampaszke:disqus\" href=\"https://disqus.com/by/adampaszke/\" rel=\"nofollow noopener\" title=\"https://disqus.com/by/adampaszke/\">Adam Paszke\u003c/a>, I think I got it. The 1st argument of nn.Narrow should be 2, which means along the column dimension choosing 3*rnn_size columns, and in the case of preactivations, each column has only 1 element.\u003cbr>\u003c/p>","id":"2337760514","createdAt":"2015-11-01T16:28:09","author":{"username":"aiqunhuang","about":"","name":"Aiqun Huang","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-07-18T15:53:39","profileUrl":"https://disqus.com/by/aiqunhuang/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"114896406","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar32.jpg?1494190375"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1494190375","large":{"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1494190375"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2337287437,"isApproved":true,"isFlagged":false,"raw_message":"@adampaszke:disqus, I think I got it. The 1st argument of nn.Narrow should be 2, which means along the column dimension choosing 3*rnn_size columns, and in the case of preactivations, each column has only 1 element.\n","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2015-11-08T16:46:54","dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>Yeah. This module runs in batch mode only, so even if you're only doing one step at a time, you should input a 1xN matrix. The activations for respective cells are in the columns :)\u003c/p>\u003cp>In this way you can train or predict with LSTMs on several inputs in parallel (if you add more rows).\u003c/p>","id":"2337782274","createdAt":"2015-11-01T16:46:54","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2337760514,"isApproved":true,"isFlagged":false,"raw_message":"Yeah. This module runs in batch mode only, so even if you're only doing one step at a time, you should input a 1xN matrix. The activations for respective cells are in the columns :)\n\n\nIn this way you can train or predict with LSTMs on several inputs in parallel (if you add more rows).","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-11-05T18:49:56","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks \u003ca data-dsq-mention=\"adampaszke:disqus\" href=\"https://disqus.com/by/adampaszke/\" rel=\"nofollow noopener\" title=\"https://disqus.com/by/adampaszke/\">Adam Paszke\u003c/a> for such detailed step-by-step LSTM explanation. I have a question. In original paper and other sources there is nothing like rnn_size (basically, rnn_size equals to 1 there). Having rnn_size &gt; 1 just sounds like having rnn_size number of all the gates (so, instead of 4 gates it will be 4*rnn_size). The question is how did you come up with that param? Did you have a chance to see the affect of different rnn_size in prediction quality? any link is helpful, thanks!\u003c/p>","id":"2333428554","createdAt":"2015-10-29T17:49:56","author":{"username":"disqus_cBTeXGHYne","about":"","name":"Maxim  Ivanov","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-10-29T17:21:24","profileUrl":"https://disqus.com/by/disqus_cBTeXGHYne/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"180691959","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar32.jpg?1446143477"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Thanks @adampaszke:disqus for such detailed step-by-step LSTM explanation. I have a question. In original paper and other sources there is nothing like rnn_size (basically, rnn_size equals to 1 there). Having rnn_size > 1 just sounds like having rnn_size number of all the gates (so, instead of 4 gates it will be 4*rnn_size). The question is how did you come up with that param? Did you have a chance to see the affect of different rnn_size in prediction quality? any link is helpful, thanks!","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-11-05T19:31:16","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>oh, I see. LSTM.create(3,2) can be considered as layer with 2 LSTM units. Each of them is original LSTM unit with 4 gates. Makes sense?\u003c/p>","id":"2333501354","createdAt":"2015-10-29T18:31:16","author":{"username":"disqus_cBTeXGHYne","about":"","name":"Maxim  Ivanov","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-10-29T17:21:24","profileUrl":"https://disqus.com/by/disqus_cBTeXGHYne/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"180691959","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar32.jpg?1446143477"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2333428554,"isApproved":true,"isFlagged":false,"raw_message":"oh, I see. LSTM.create(3,2) can be considered as layer with 2 LSTM units. Each of them is original LSTM unit with 4 gates. Makes sense?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-11-05T23:08:04","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Exactly! This would be the layer that accepts an input vector of length 3 and uses 2 LSTM units to generate output of length 2. Second parameter (let's call it x) determines how many units will be used (so there will be 4*x gates).\u003c/p>\u003cp>Regarding Your question about the prediction quality, I'd say it depends on a problem. Bigger sizes allow the layer to be more expressive and exhibit more complex behaviour, but can also lead to overfitting (just like with the regular Linear layers). In the 'Visualizing and Understanding Recurrent Networks' paper You can find a table that lists some benchmark results for LSTM networks with varying number of layers and sizes (on top of page 4).\u003c/p>","id":"2333848755","createdAt":"2015-10-29T22:08:04","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2333501354,"isApproved":true,"isFlagged":false,"raw_message":"Exactly! This would be the layer that accepts an input vector of length 3 and uses 2 LSTM units to generate output of length 2. Second parameter (let's call it x) determines how many units will be used (so there will be 4*x gates).\n\nRegarding Your question about the prediction quality, I'd say it depends on a problem. Bigger sizes allow the layer to be more expressive and exhibit more complex behaviour, but can also lead to overfitting (just like with the regular Linear layers). In the 'Visualizing and Understanding Recurrent Networks' paper You can find a table that lists some benchmark results for LSTM networks with varying number of layers and sizes (on top of page 4).","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-10-28T21:08:30","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Really good article. I am glad that someone explain the LSTM. It is hard to understand without good examples. I want to ask you, if you have plan to expand this article about training the LSTM?\u003c/p>","id":"2319806084","createdAt":"2015-10-21T21:08:30","author":{"username":"peteruherek","about":"","name":"Peter Uherek","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-01-07T14:08:35","profileUrl":"https://disqus.com/by/peteruherek/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"89533556","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/peteruherek.jpg","cache":"https://c.disquscdn.com/uploads/users/8953/3556/avatar32.jpg?1445461711"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/peteruherek.jpg","cache":"https://c.disquscdn.com/uploads/users/8953/3556/avatar92.jpg?1445461711","large":{"permalink":"https://disqus.com/api/users/avatars/peteruherek.jpg","cache":"https://c.disquscdn.com/uploads/users/8953/3556/avatar92.jpg?1445461711"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Really good article. I am glad that someone explain the LSTM. It is hard to understand without good examples. I want to ask you, if you have plan to expand this article about training the LSTM?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-10-28T21:12:17","dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>I'll try to, if only I'll have some time :)\u003c/p>\u003cp>It's very similar to training regular NN modules. Do you know the API? You can read more in \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Fmodule.md%3A5TyRqHzYRhxbwBGgKDPRaL3d9Wg&amp;cuid=3762125\" rel=\"nofollow noopener\" title=\"https://github.com/torch/nn/blob/master/doc/module.md\">here\u003c/a> and \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Ftraining.md%23example-of-manual-training-of-a-neural-network%3AaX038om_lNKiLrjsjwVnRC2pqjk&amp;cuid=3762125\" rel=\"nofollow noopener\" title=\"https://github.com/torch/nn/blob/master/doc/training.md#example-of-manual-training-of-a-neural-network\">here (just the exmaple of manual training)\u003c/a>. I hope this helps at least a bit!\u003c/p>","id":"2319812144","createdAt":"2015-10-21T21:12:17","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2319806084,"isApproved":true,"isFlagged":false,"raw_message":"I'll try to, if only I'll have some time :)\n\nIt's very similar to training regular NN modules. Do you know the API? You can read more in \u003ca href=\"https://github.com/torch/nn/blob/master/doc/module.md\">here\u003c/a> and \u003ca href=\"https://github.com/torch/nn/blob/master/doc/training.md#example-of-manual-training-of-a-neural-network\">here (just the exmaple of manual training)\u003c/a>. I hope this helps at least a bit!","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":1,"moderationLabels":["links"],"isEdited":false,"sb":false},{"editableUntil":"2015-10-20T09:17:04","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>How to use\u003c/p>\u003cp>layer:backward()\u003c/p>","id":"2304665761","createdAt":"2015-10-13T09:17:04","author":{"username":"bibekanandakundu","about":"","name":"Bibekananda Kundu","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-10-08T08:46:52","profileUrl":"https://disqus.com/by/bibekanandakundu/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"177745908","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"How to use \n\nlayer:backward()","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-10-20T09:01:33","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Can you please provide the code for training the LSTM ?\u003c/p>","id":"2304642397","createdAt":"2015-10-13T09:01:33","author":{"username":"bibekanandakundu","about":"","name":"Bibekananda Kundu","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-10-08T08:46:52","profileUrl":"https://disqus.com/by/bibekanandakundu/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"177745908","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Can you please provide the code for training the LSTM ?","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-10-07T11:53:20","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I really liked your article, and it's encouraged me to have a go building LSTMs too. I forked your examples and have been testing it, to try and do learning with it on some data I have. But, I think I'm misunderstand how training fits into your example.\u003c/p>\u003cp>My code is on github along with test data. \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fbytesumo%2FLSTM-Experiments%2Fblob%2Fmaster%2Ftc_lstm.lua%3A2O47SxeiOJeIJtY9pK4kzH59FA8&amp;cuid=3762125\" rel=\"nofollow noopener\" title=\"https://github.com/bytesumo/LSTM-Experiments/blob/master/tc_lstm.lua\">https://github.com/bytesumo...\u003c/a>\u003c/p>\u003cp>Maybe you could glance at it, offer a pointer to fixing the training process? \u003cbr>Many thanks, Andrew.\u003c/p>","id":"2281740898","createdAt":"2015-09-30T11:53:20","author":{"username":"minkymorgan","about":"","name":"Andrew Morgan","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-09-30T11:48:37","profileUrl":"https://disqus.com/by/minkymorgan/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"176752555","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"I really liked your article, and it's encouraged me to have a go building LSTMs too. I forked your examples and have been testing it, to try and do learning with it on some data I have. But, I think I'm misunderstand how training fits into your example. \n\nMy code is on github along with test data. https://github.com/bytesumo/LSTM-Experiments/blob/master/tc_lstm.lua\n\nMaybe you could glance at it, offer a pointer to fixing the training process? \nMany thanks, Andrew.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":["links"],"isEdited":false,"sb":false},{"editableUntil":"2015-10-10T11:27:50","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>The link you posted gives me a 404 :/\u003cbr>Did you solve the issue? I can't see LSTM implementation in your code.\u003c/p>","id":"2287686610","createdAt":"2015-10-03T11:27:50","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2281740898,"isApproved":true,"isFlagged":false,"raw_message":"The link you posted gives me a 404 :/\nDid you solve the issue? I can't see LSTM implementation in your code.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-10-12T14:16:30","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>yeah ... so my initial enthusiasm ebbed as I realised my attempt was rubbish! So ditched it and settled on trying some experiments with a working library rnn. My experimental code is here. \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fbytesumo%2FLSTM-Experiments%3AummHjBixQ494XwiRvfM494oKklk&amp;cuid=3762125\" rel=\"nofollow noopener\" title=\"https://github.com/bytesumo/LSTM-Experiments\">https://github.com/bytesumo...\u003c/a>\u003cbr>Still not sure it learns anything, but most bugs ironed out now.\u003c/p>","id":"2291128732","createdAt":"2015-10-05T14:16:30","author":{"username":"minkymorgan","about":"","name":"Andrew Morgan","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-09-30T11:48:37","profileUrl":"https://disqus.com/by/minkymorgan/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"176752555","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2287686610,"isApproved":true,"isFlagged":false,"raw_message":"yeah ... so my initial enthusiasm ebbed as I realised my attempt was rubbish! So ditched it and settled on trying some experiments with a working library rnn. My experimental code is here. https://github.com/bytesumo/LSTM-Experiments\nStill not sure it learns anything, but most bugs ironed out now.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":["links"],"isEdited":false,"sb":false},{"editableUntil":"2015-10-07T06:37:34","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, this model may better have a updateOutput() &amp; backward() since it behaves different from Containers such as Sequential &amp; Concat. While it's exactly what you need to define in training, but putting things together (combine all layers in a complete Module) permits you convenience to optimize parameters as a whole. Cheers.\u003c/p>","id":"2281366551","createdAt":"2015-09-30T06:37:34","author":{"username":"vikingender","about":"","name":"Viking Ender","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2013-11-09T13:29:32","profileUrl":"https://disqus.com/by/vikingender/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"81098224","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar32.jpg?1444569281"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281","large":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi, this model may better have a updateOutput() & backward() since it behaves different from Containers such as Sequential & Concat. While it's exactly what you need to define in training, but putting things together (combine all layers in a complete Module) permits you convenience to optimize parameters as a whole. Cheers.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2015-10-10T11:32:21","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Uh, you could combine the layers in some kind of container, but I haven't tried it yet. Anyway, it's a thing worth adding here! Thanks!\u003c/p>","id":"2287690054","createdAt":"2015-10-03T11:32:21","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2281366551,"isApproved":true,"isFlagged":false,"raw_message":"Uh, you could combine the layers in some kind of container, but I haven't tried it yet. Anyway, it's a thing worth adding here! Thanks!","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-10-10T17:15:38","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I have an implementation here, the LSTM module mainly was copied from yours. So your code should work with mine as well. \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2FKHN190%2Ftorch-RNN%2Ftree%2Fmaster%2Fbone%3ArzO2MdzZlqcZoDytBcjMphRUq6w&amp;cuid=3762125\" rel=\"nofollow noopener\" title=\"https://github.com/KHN190/torch-RNN/tree/master/bone\">https://github.com/KHN190/t...\u003c/a>\u003c/p>","id":"2288078625","createdAt":"2015-10-03T17:15:38","author":{"username":"vikingender","about":"","name":"Viking Ender","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2013-11-09T13:29:32","profileUrl":"https://disqus.com/by/vikingender/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"81098224","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar32.jpg?1444569281"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281","large":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2287690054,"isApproved":true,"isFlagged":false,"raw_message":"I have an implementation here, the LSTM module mainly was copied from yours. So your code should work with mine as well. https://github.com/KHN190/torch-RNN/tree/master/bone","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":["links"],"isEdited":false,"sb":false},{"editableUntil":"2015-10-16T16:20:16","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I see. It might be convenient, but you code is too big to put it in here. And I'm not sure if it wouldn't be simpler to write another nngraph module wrapping individual layers, or your own function to construct and connect all the layers into a single network in advance.\u003c/p>","id":"2298555431","createdAt":"2015-10-09T16:20:16","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2288078625,"isApproved":true,"isFlagged":false,"raw_message":"I see. It might be convenient, but you code is too big to put it in here. And I'm not sure if it wouldn't be simpler to write another nngraph module wrapping individual layers, or your own function to construct and connect all the layers into a single network in advance.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":3,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-10-18T13:14:40","dislikes":0,"numReports":0,"likes":14,"message":"\u003cp>I don't see a way to escape from crafting the parameters updating. In my case, it's implemented in the partner functions of boneRecurrent. In your case, it must be somewhere during the training. For reusability it's better to create a Container. For one-go experiment, you need to modify training code a bit from side to side. But on one thing you are right, nn.gModule forces a lot of inconvenience in coding (e.x. I can't do resizeAs in a module, simply because the input is no more a tensor! It's nngraph.Node then). I think it's a fault of Torch.\u003c/p>","id":"2301312341","createdAt":"2015-10-11T13:14:40","author":{"username":"vikingender","about":"","name":"Viking Ender","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2013-11-09T13:29:32","profileUrl":"https://disqus.com/by/vikingender/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"81098224","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar32.jpg?1444569281"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281","large":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2298555431,"isApproved":true,"isFlagged":false,"raw_message":"I don't see a way to escape from crafting the parameters updating. In my case, it's implemented in the partner functions of boneRecurrent. In your case, it must be somewhere during the training. For reusability it's better to create a Container. For one-go experiment, you need to modify training code a bit from side to side. But on one thing you are right, nn.gModule forces a lot of inconvenience in coding (e.x. I can't do resizeAs in a module, simply because the input is no more a tensor! It's nngraph.Node then). I think it's a fault of Torch.","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":4,"points":14,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-10-02T04:23:45","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Well thanks for the sharing, I just started to learn these RNN,LSTM,Lua and Torch things... And they are really hard to understand.. Your work is very helpful and I do really appreciate it .. Yes , thank you ...\u003c/p>","id":"2273097779","createdAt":"2015-09-25T04:23:45","author":{"username":"ayanaaltaqin","about":"","name":"Ayana Altaqin","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-09-25T04:23:36","profileUrl":"https://disqus.com/by/ayanaaltaqin/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"176106852","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/ayanaaltaqin.jpg","cache":"https://c.disquscdn.com/uploads/users/17610/6852/avatar32.jpg?1443155027"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/ayanaaltaqin.jpg","cache":"https://c.disquscdn.com/uploads/users/17610/6852/avatar92.jpg?1443155027","large":{"permalink":"https://disqus.com/api/users/avatars/ayanaaltaqin.jpg","cache":"https://c.disquscdn.com/uploads/users/17610/6852/avatar92.jpg?1443155027"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Well thanks for the sharing, I just started to learn these RNN,LSTM,Lua and Torch things... And they are really hard to understand.. Your work is very helpful and I do really appreciate it .. Yes , thank you ...","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2015-09-16T14:54:04","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I think CMulTable() should be the product while the CAddTable() the sum in their descriptions.\u003c/p>\u003cp>Thanks :)\u003c/p>","id":"2244419488","createdAt":"2015-09-09T14:54:04","author":{"username":"disqus_YQTggpvnhi","about":"","name":"Ozan \u00c7a\u011flayan","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-09-09T14:53:56","profileUrl":"https://disqus.com/by/disqus_YQTggpvnhi/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"173802795","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_YQTggpvnhi.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_YQTggpvnhi.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_YQTggpvnhi.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"I think CMulTable() should be the product while the CAddTable() the sum in their descriptions.\n\nThanks :)","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-09-18T15:47:49","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>You've got me, thanks! ;)\u003c/p>","id":"2248245692","createdAt":"2015-09-11T15:47:49","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2244419488,"isApproved":true,"isFlagged":false,"raw_message":"You've got me, thanks! ;)","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-09-15T12:54:39","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>The figures is very clear and this page makes the LSTM very easy to understand, I certainly got lot of things from this article, it makes sense. What's more, I'm also curious about the bp procedure of LSTM, maybe there will be some supplyment posts later ^ ^\u003c/p>","id":"2242323613","createdAt":"2015-09-08T12:54:39","author":{"username":"disqus_3BWuyN6Mlh","about":"","name":"joe","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-09-08T12:52:08","profileUrl":"https://disqus.com/by/disqus_3BWuyN6Mlh/","url":"","location":"Chengdu","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"173655427","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_3BWuyN6Mlh.jpg","cache":"https://c.disquscdn.com/uploads/users/17365/5427/avatar32.jpg?1441717075"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_3BWuyN6Mlh.jpg","cache":"https://c.disquscdn.com/uploads/users/17365/5427/avatar92.jpg?1441717075","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_3BWuyN6Mlh.jpg","cache":"https://c.disquscdn.com/uploads/users/17365/5427/avatar92.jpg?1441717075"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"The figures is very clear and this page makes the LSTM very easy to understand, I certainly got lot of things from this article, it makes sense. What's more, I'm also curious about the bp procedure of LSTM, maybe there will be some supplyment posts later ^ ^","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2015-09-18T15:50:30","dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hey! Sorry for the late reply!\u003c/p>\u003cp>It's great to hear that you liked it! Saying 'bp procedure' do you mean the exact derivations or just the training code? It's really easy to train these models with a few calls like :backward(). There are some examples in torch docs e.g.: \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Ftraining.md%3AEIH9JOUWXiUZdlrn7UI-271vHgE&amp;cuid=3762125\" rel=\"nofollow noopener\" title=\"https://github.com/torch/nn/blob/master/doc/training.md\">https://github.com/torch/nn...\u003c/a>\u003c/p>","id":"2248250367","createdAt":"2015-09-11T15:50:30","author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-30T21:53:02","profileUrl":"https://disqus.com/by/adampaszke/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172362162","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1541535443/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":2242323613,"isApproved":true,"isFlagged":false,"raw_message":"Hey! Sorry for the late reply!\n\nIt's great to hear that you liked it! Saying 'bp procedure' do you mean the exact derivations or just the training code? It's really easy to train these models with a few calls like :backward(). There are some examples in torch docs e.g.: https://github.com/torch/nn/blob/master/doc/training.md","isHighlighted":false,"canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":["links"],"isEdited":false,"sb":false}],"thread":{"feed":"https://apaszke.disqus.com/lstm_networks_explained/latest.rss","author":"172362162","dislikes":0,"likes":12,"message":"","isSpam":false,"createdAt":"2015-08-30T22:02:32","category":"3938641","clean_title":"LSTM networks explained","id":"4081981091","signedLink":"http://disq.us/?url=http%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&key=LyNkJcWlfiA28pO5yPXRzA","isDeleted":false,"hasStreaming":false,"raw_message":"","isClosed":false,"link":"http://apaszke.github.io/lstm-explained.html","slug":"lstm_networks_explained","forum":"apaszke","identifiers":["lstm-explained"],"posts":49,"moderators":[172362162],"validateAllPosts":false,"title":"LSTM networks explained","highlightedPost":null}},"order":"popular"}</script>


    <div id="fixed-content"></div>


    
        
<script type="text/json" id="disqus-urls">{
    "root":"//disqus.com",
    "next":"https://c.disquscdn.com/next/current/embed"
}</script>

        
        <script>!function () {
            var d = document;
            var toH = d.head.appendChild.bind(d.head);

            var v = window.location.href.match(/[#&?]version=([0-9a-f]{32})/);
            var src = 'https://c.disquscdn.com/next/embed/lounge.load';
            if (v)
                src += '.' + v[1];
            src += '.js';

            var s = d.createElement('script');
            s.crossOrigin = 'anonymous';
            s.id = 'bootstrap-script';
            s.setAttribute('data-app', 'lounge');
            s.src = src;
            toH(s);

            var m = d.createElement('meta');
            m.setAttribute('http-equiv', 'Content-Security-Policy');
            m.setAttribute('content', "script-src https:;");
            toH(m);
        }();</script>
    


<script src="./common.bundle.a5e978e28df65e5c393be61ad30e685d.js"></script><div id="layout" data-tracking-area="layout"><div id="onboard" data-tracking-area="onboard"><div></div></div><div id="reactions__container"></div><div id="highlighted-post" data-tracking-area="highlighted" class="highlighted-post" style="display: none;"></div><div id="global-alert"></div><div id="tos__container"></div><header id="main-nav" data-tracking-area="main-nav"><nav class="nav nav-primary"><ul><li class="nav-tab nav-tab--primary tab-conversation active" data-role="post-count"><a class="publisher-nav-color"><span class="comment-count">49 comments</span><span class="comment-count-placeholder">Comments</span></a></li><li class="nav-tab nav-tab--primary tab-community"><a href="https://disqus.com/home/forums/apaszke/" class="publisher-nav-color" data-action="community-sidebar" data-forum="apaszke" id="community-tab" name="Adam&#39;s blog"><span class="community-name"><strong>Adam's blog</strong></span><strong class="community-name-placeholder">Community</strong></a></li><li class="nav-tab nav-tab--primary dropdown user-menu" data-role="logout"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown" role="menuitem" name="User Menu"><span class="dropdown-toggle-wrapper"><span><span class="avatar"><img data-role="user-avatar" data-user="162672657" alt="Avatar"></span><span class="username" data-role="username" data-username="jingwei_yang">Jingwei Yang</span></span> </span> <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="https://disqus.com/by/jingwei_yang/" data-action="profile" data-username="jingwei_yang" target="_blank" rel="noopener noreferrer">Your Profile</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="media-toggle-on" data-action="toggle-media">Display Media</a><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="media-toggle-off" data-action="toggle-media">Hide Media</a></li><li><a href="https://disqus.com/home/settings/account/">Edit Settings</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="logout">Logout</a></li></ul></li><li class="nav-tab nav-tab--primary notification-menu" data-role="notification-menu"><a href="https://disqus.com/home/inbox/" class="notification-container" data-action="home" data-home-path="home/inbox/"><span class="notification-icon icon-comment" aria-hidden="true"></span><span class="notification-count" data-role="notification-count"></span></a></li></ul></nav></header><section id="conversation" data-role="main" data-tracking-area="main"><div class="nav nav-secondary" data-tracking-area="secondary-nav"><ul><li id="recommend-button" class="nav-tab nav-tab--secondary recommend dropdown"><div class="thread-likes"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="recommend" title="Recommend this discussion" class="dropdown-toggle "><span class="label label-default"><span class="recommend-icon icon-heart-empty"></span> Recommend</span><span class="label label-recommended"><span class="recommend-icon icon-heart"></span> Recommended</span> <span class="label label-count">12</span></a><ul class="dropdown-menu dropdown-menu--coachmark"><li><div><h2 class="coachmark__heading">Discussion Recommended!</h2><p class="coachmark__description">Recommending means this is a discussion worth sharing. It gets shared to your followers' Disqus feeds, and gives the creator kudos!</p></div> <a href="https://disqus.com/home/?utm_source=disqus_embed&amp;utm_content=recommend_btn" class="btn btn-primary coachmark__button" target="_blank">Find More Discussions</a></li></ul></div></div></li><li id="thread-share-bar" class="nav-tab nav-tab--secondary share-bar hidden-sm"><div class="thread-share-bar-buttons"><span class="thread-share__button share-twitter" data-action="share:twitter"><span class="icon-twitter"></span><span class="share-text">Tweet</span></span><span class="thread-share__button share-facebook" data-action="share:facebook"><span class="icon-facebook"></span><span class="share-text">Share</span></span></div></li><li data-role="post-sort" class="nav-tab nav-tab--secondary dropdown sorting pull-right"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown">Sort by Best<span class="caret"></span></a><ul class="dropdown-menu pull-right"><li class="selected"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="sort" data-sort="popular">Best<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="sort" data-sort="desc">Newest<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="sort" data-sort="asc">Oldest<i aria-hidden="true" class="icon-checkmark"></i></a></li></ul></li></ul></div><div id="posts"><div id="form" class="textarea-wrapper--top-level"><form class="reply authenticated"><div class="postbox"><div role="alert"></div><div class="avatar"><a href="https://disqus.com/by/jingwei_yang/" data-action="profile" data-username="jingwei_yang" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="162672657" src="./avatar92.jpg" alt="Avatar"></a></div><div class="textarea-wrapper" data-role="textarea" dir="auto"><div><span class="placeholder">Join the discussion</span><div class="textarea" tabindex="0" role="textbox" aria-multiline="true" contenteditable="PLAINTEXT-ONLY" data-role="editable" aria-label="Join the discussion" style="overflow: auto; overflow-wrap: break-word; max-height: 350px;"><p><br></p></div><div style="display: none;"><ul class="user-mention__list"><li class="header user-mention__header"><h5>in this conversation</h5></li></ul></div></div><div data-role="drag-drop-placeholder" class="media-drag-hover" style="display: none;"><div class="drag-text"> Drag and drop your images here to upload them.</div></div><div class="media-preview empty" data-role="media-preview"><ul data-role="media-progress-list"></ul>
<ul data-role="media-rich-list"></ul>
<div class="media-expanded empty" data-role="media-preview-expanded">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-role="media-preview-expanded-image" alt="Media preview placeholder">
</div>
</div><div class="edit-alert" role="postbox-alert"></div><div class="post-actions"><ul class="wysiwyg"><li class="wysiwyg__item" data-role="media-uploader"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" tabindex="-1" data-action="attach" class="attach" title="Upload Images"><span>Attach</span></a>
<input type="file" data-role="media-upload" tabindex="-1" accept="image/*">
</li></ul><div class="logged-in"><section><div class="temp-post" style="text-align: right;"><button class="btn post-action__button">Post as <span data-username="jingwei_yang" data-role="username">Jingwei Yang</span></button></div></section></div></div></div><div data-role="login-form"><div><div></div></div></div></div></form></div><button class="alert alert--realtime" data-role="realtime-notification" style="display: none;"></button><div id="email-signup"></div><div id="no-posts" style="display: none;"></div><ul id="post-list" class="post-list"><li class="post" id="post-3637136438"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3637136438"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/abdelkarimtaam/" data-action="profile" data-username="abdelkarimtaam" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="272532851" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/27253/2851/avatar92.jpg?1511906467" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/abdelkarimtaam/" data-action="profile" data-username="abdelkarimtaam" target="_blank" rel="noopener noreferrer">Abdelkarim Taam</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3637136438" data-role="relative-time" class="time-ago" title="Tuesday, November 28, 2017 5:01 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Sir i need implement the LSTM algorithm on Text</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-6" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">6</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3637136438"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3637136438-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2403096907"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2403096907"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/aravindsrinivasl/" data-action="profile" data-username="aravindsrinivasl" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="186827635" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/18682/7635/avatar92.jpg?1464748477" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/aravindsrinivasl/" data-action="profile" data-username="aravindsrinivasl" target="_blank" rel="noopener noreferrer">Aravind Srinivas L</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2403096907" data-role="relative-time" class="time-ago" title="Thursday, December 10, 2015 9:16 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi,  can you please update this with the training code too? <br>Also, would be great if you could have another article explaining how to build LSTM networks using the 'rnn' package (with nn.Sequencer and stuff), and how it compares to using nngraph.</p><p>Thanks for the really good explanation about building the LSTM!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-3" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">3</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2403096907"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2542268015"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2542268015"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2403096907" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Aravind Srinivas L</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2542268015" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 6:25 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Aravind. Sorry for a late reply. I haven't used rnn package yet, because nngraph fitted nicely into my models so far. I'm planning to do some extensions to this post, which include adding a section on training LSTM networks.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2542268015"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2542268015-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2534353533"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2534353533"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_TsTw5z52iB/" data-action="profile" data-username="disqus_TsTw5z52iB" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="194044248" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_TsTw5z52iB/" data-action="profile" data-username="disqus_TsTw5z52iB" target="_blank" rel="noopener noreferrer">Bruce Zhang</a></span> </span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2403096907" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Aravind Srinivas L</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2534353533" data-role="relative-time" class="time-ago" title="Thursday, February 25, 2016 5:18 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I think there is no such thing as rnn package, you have to build RNN with nngraph.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2534353533"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2542264658"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2542264658"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2534353533" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Bruce Zhang</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2542264658" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 6:24 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>In fact there is an rnn package by Nicholas Lonard, but it's not included in torch core. See <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2FElement-Research%2Frnn%3A2cchRibNtQPiAEfpdDv4dAfhfk8&amp;cuid=3762125" rel="nofollow noopener" title="https://github.com/Element-Research/rnn">this repository</a>.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2542264658"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2542264658-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2534353533-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2403096907-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2492364557"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2492364557"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_aISFArTPT6/" data-action="profile" data-username="disqus_aISFArTPT6" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="194596855" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_aISFArTPT6/" data-action="profile" data-username="disqus_aISFArTPT6" target="_blank" rel="noopener noreferrer">soshiant</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2492364557" data-role="relative-time" class="time-ago" title="Tuesday, February 2, 2016 1:20 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>hi great stuff.<br>i'm gonno ask this just to be sure :<br>you have 3 inputs for forward pass<br>so f i want to us it in multiple steps i have to give this layer the resuls of the last step for two of those inputs right?<br>this is making it too hard could you just take the input and somehow insert the ht-1  ?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2492364557"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2542272838"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2542272838"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2492364557" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> soshiant</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2542272838" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 6:28 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Yes, two of the outputs are inputs in the next time step. Unfortunately, I don't think it can be done in a simpler way.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2542272838"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2542272838-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2492364557-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3768927212"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3768927212"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_m6m28sebc8/" data-action="profile" data-username="disqus_m6m28sebc8" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="280752791" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_m6m28sebc8/" data-action="profile" data-username="disqus_m6m28sebc8" target="_blank" rel="noopener noreferrer">Chirag Mittal</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3768927212" data-role="relative-time" class="time-ago" title="Wednesday, February 21, 2018 7:40 AM">10 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>So, after the LSTM model builds, what are the matrices which we get as outputs?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3768927212"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3768927212-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3421073377"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3421073377"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/housebytebestofnet/" data-action="profile" data-username="housebytebestofnet" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="259252225" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/housebytebestofnet/" data-action="profile" data-username="housebytebestofnet" target="_blank" rel="noopener noreferrer">Housebyte Bestofnet</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3421073377" data-role="relative-time" class="time-ago" title="Monday, July 17, 2017 1:30 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Am struggling with my own LSTM written using std:vectors I cannot seem to get it to learn I am updating the weights for each gate however I do not have weights assigned to the Hin and In and have only added them to be used by each gate. I have two layers and my main question is do I need these weights and must they therefore be used to backprop error to the gates. Thanks</p><p><a href="http://disq.us/url?url=http%3A%2F%2Fhobo-ai.blogspot.co.uk%2F2017%2F07%2Fcannot-get-this-to-work-yet-lstm.html%3AN4f5J9QNpZwS6ovl_qi1KIEd2l4&amp;cuid=3762125" rel="nofollow noopener" title="http://hobo-ai.blogspot.co.uk/2017/07/cannot-get-this-to-work-yet-lstm.html">http://hobo-ai.blogspot.co....</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3421073377"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3421073377-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3379890140"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3379890140"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cookiemonstrua3/" data-action="profile" data-username="cookiemonstrua3" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="167385783" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cookiemonstrua3/" data-action="profile" data-username="cookiemonstrua3" target="_blank" rel="noopener noreferrer">cookiemonstrua3</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3379890140" data-role="relative-time" class="time-ago" title="Thursday, June 22, 2017 12:15 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, thank you very much for this explanation! I'm new to torch and am not quite following how these lines map to the sum part of of the gate equations. Would you mind expanding on this? Thank you!!</p><p>local i2h = nn.Linear(input_size, 4 * rnn_size)(input)  -- input to hidden<br>local h2h = nn.Linear(rnn_size, 4 * rnn_size)(prev_h)   -- hidden to hidden<br>local preactivations = nn.CAddTable()({i2h, h2h})       -- i2h + h2h</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3379890140"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3380432862"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3380432862"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3379890140" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> cookiemonstrua3</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3380432862" data-role="relative-time" class="time-ago" title="Thursday, June 22, 2017 3:53 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It takes in a list of modules and once given input will pass it to all submodules, and return a sum of their outputs.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3380432862"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3386472692"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3386472692"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cookiemonstrua3/" data-action="profile" data-username="cookiemonstrua3" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="167385783" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cookiemonstrua3/" data-action="profile" data-username="cookiemonstrua3" target="_blank" rel="noopener noreferrer">cookiemonstrua3</a></span> </span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3380432862" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Adam Paszke</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3386472692" data-role="relative-time" class="time-ago" title="Monday, June 26, 2017 12:01 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Right. So torch is implicitly creating weight matrices of input_size by 4*rnn_size and rnn_size by 4*rnn_size, multiplying them by the inputs/hidden inputs to get batch_size x 4*rnn_size output, and then adding those together?</p><p>So if you were to change the operation from Linear to something else (a convolution, for example), since you've done all the transforms in one the rnn_size isn't being used by other calculations, and as long as you had the same dimensions for i2h and h2h the remaining updates would follow?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3386472692"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3386472692-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3380432862-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3379890140-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3190751591"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3190751591"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/igorchernobaev/" data-action="profile" data-username="igorchernobaev" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="178294769" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/igorchernobaev/" data-action="profile" data-username="igorchernobaev" target="_blank" rel="noopener noreferrer">Igor Chernobaev</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-3190751591" data-role="relative-time" class="time-ago" title="Tuesday, March 7, 2017 9:15 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, i'm trying to implement own LSTM for better understanding. Unfortunately my backprop algorithm doesn't pass gradient check. Could you kindly help me?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3190751591"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3190751591-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2978686662"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2978686662"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/faiyazlalani/" data-action="profile" data-username="faiyazlalani" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="228451061" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/faiyazlalani/" data-action="profile" data-username="faiyazlalani" target="_blank" rel="noopener noreferrer">Faiyaz Lalani</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2978686662" data-role="relative-time" class="time-ago" title="Monday, October 31, 2016 10:31 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Excellent post - very helpful.  Much appreciated Adam!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2978686662"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2978686662-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2948125410"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2948125410"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_d0sJQt6fLf/" data-action="profile" data-username="disqus_d0sJQt6fLf" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="226348288" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_d0sJQt6fLf/" data-action="profile" data-username="disqus_d0sJQt6fLf" target="_blank" rel="noopener noreferrer">fnm</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2948125410" data-role="relative-time" class="time-ago" title="Thursday, October 13, 2016 4:45 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I am interested in knowing that how lstm model is trained.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2948125410"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2948125410-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2794888435"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2794888435"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="215820942" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" target="_blank" rel="noopener noreferrer">Yitzhak Spielberg</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2794888435" data-role="relative-time" class="time-ago" title="Thursday, July 21, 2016 3:33 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It would be cool to have the training procedure as well</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2794888435"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2794888435-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2794847588"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2794847588"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="215820942" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" target="_blank" rel="noopener noreferrer">Yitzhak Spielberg</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2794847588" data-role="relative-time" class="time-ago" title="Thursday, July 21, 2016 3:24 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, how do I build a model with multiple lstm layers? for ordinary neural nets I used nn.sequential to build the model and model:forward(x) to calculate the output. How does it work in this case? A simple example, let's say with 2 lstm layers would be really helpful.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2794847588"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2794890520"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2794890520"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="215820942" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1514550992" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" target="_blank" rel="noopener noreferrer">Yitzhak Spielberg</a></span> </span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2794847588" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Yitzhak Spielberg</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2794890520" data-role="relative-time" class="time-ago" title="Thursday, July 21, 2016 3:33 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>solved. just found the multilayer example above.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2794890520"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2794890520-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2794847588-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2783959255"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2783959255"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/mohammed_jabreel/" data-action="profile" data-username="mohammed_jabreel" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="215127778" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/mohammed_jabreel/" data-action="profile" data-username="mohammed_jabreel" target="_blank" rel="noopener noreferrer">Mohammed Jabreel</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2783959255" data-role="relative-time" class="time-ago" title="Thursday, July 14, 2016 8:35 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, Thank you for this nice post about LSTM, I would like to explain me how we could implement the LSTM attention.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2783959255"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2783959255-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2752671300"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2752671300"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_69LPgvlRKI/" data-action="profile" data-username="disqus_69LPgvlRKI" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="213022569" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_69LPgvlRKI/" data-action="profile" data-username="disqus_69LPgvlRKI" target="_blank" rel="noopener noreferrer">simon</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2752671300" data-role="relative-time" class="time-ago" title="Monday, June 27, 2016 4:48 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Nice LSTM post, but I have a question,how the gate units can protect the gradient inside the cell from harmful changes during the training, if there existes some explanation in math?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2752671300"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2752671300-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2725100813"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2725100813"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/lucanaterop/" data-action="profile" data-username="lucanaterop" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="64200016" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/6420/16/avatar92.jpg?1468161995" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/lucanaterop/" data-action="profile" data-username="lucanaterop" target="_blank" rel="noopener noreferrer">Luca Naterop</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2725100813" data-role="relative-time" class="time-ago" title="Saturday, June 11, 2016 11:50 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Noob question: How can I compute the RNN output with this? layer:forward() only gives the updated hidden and cell state...but how do I get the networks predictions?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2725100813"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2725100813-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2646947651"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2646947651"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_FE6W9KzWs8/" data-action="profile" data-username="disqus_FE6W9KzWs8" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="102620122" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/10262/122/avatar92.jpg?1534325357" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_FE6W9KzWs8/" data-action="profile" data-username="disqus_FE6W9KzWs8" target="_blank" rel="noopener noreferrer">Gaurav Pandey</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2646947651" data-role="relative-time" class="time-ago" title="Thursday, April 28, 2016 4:10 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, nice article. The LSTM obtained above won't have tied weights. Hence, I had 2 questions.</p><p>1) Is it more common to have tied weights between different LSTM units.<br>2) Can this simply be achieved by getting the parameters pointer of the first unit, and setting the parameters of all successive units to point to that pointer (Similar for gradient)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2646947651"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2646947651-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2542259263"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2542259263"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_JKmCckR2Jw/" data-action="profile" data-username="disqus_JKmCckR2Jw" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="198542359" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/19854/2359/avatar92.jpg?1456701532" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_JKmCckR2Jw/" data-action="profile" data-username="disqus_JKmCckR2Jw" target="_blank" rel="noopener noreferrer">Mahati</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2542259263" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 6:20 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi. Thanks for this! It would be great if you could also update the training code. This has been very helpful for me in learning about LSTM.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2542259263"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2542262312"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2542262312"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2542259263" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Mahati</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2542262312" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 6:22 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Mahati. Great to hear that it was helpful for you. I am planning to expand this post in the near future and there will be some training examples provided.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2542262312"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2542262312-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2542259263-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2444132313"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2444132313"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_Pcs7K2lnNd/" data-action="profile" data-username="disqus_Pcs7K2lnNd" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="190738230" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/19073/8230/avatar92.jpg?1461337342" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_Pcs7K2lnNd/" data-action="profile" data-username="disqus_Pcs7K2lnNd" target="_blank" rel="noopener noreferrer">Marco Damonte</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2444132313" data-role="relative-time" class="time-ago" title="Thursday, January 7, 2016 4:12 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Once you have your "layer" variable, can you use it as a traditional nn.Module and start the training?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2444132313"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2542261364"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2542261364"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2444132313" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Marco Damonte</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2542261364" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 6:21 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Yes! gModule has the same API as all nn modules.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2542261364"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2542261364-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2444132313-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2337287437"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2337287437"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/aiqunhuang/" data-action="profile" data-username="aiqunhuang" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="114896406" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1494190375" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/aiqunhuang/" data-action="profile" data-username="aiqunhuang" target="_blank" rel="noopener noreferrer">Aiqun Huang</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2337287437" data-role="relative-time" class="time-ago" title="Sunday, November 1, 2015 12:22 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p><a data-dsq-mention="adampaszke:disqus" href="https://disqus.com/by/adampaszke/" rel="nofollow noopener" title="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" class="mention">Adam Paszke</a>, what is the dimension of preactivations? I think it is just a 1D vector of size 4 * rnn_size,  but why the first argument of nn.Narrow(2, 1, 3 * rnn_size) is 2?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2337287437"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2337760514"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2337760514"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/aiqunhuang/" data-action="profile" data-username="aiqunhuang" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="114896406" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1494190375" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/aiqunhuang/" data-action="profile" data-username="aiqunhuang" target="_blank" rel="noopener noreferrer">Aiqun Huang</a></span> </span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2337287437" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Aiqun Huang</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2337760514" data-role="relative-time" class="time-ago" title="Sunday, November 1, 2015 11:28 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p><a data-dsq-mention="adampaszke:disqus" href="https://disqus.com/by/adampaszke/" rel="nofollow noopener" title="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" class="mention">Adam Paszke</a>, I think I got it. The 1st argument of nn.Narrow should be 2, which means along the column dimension choosing 3*rnn_size columns, and in the case of preactivations, each column has only 1 element.<br></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2337760514"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2337782274"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2337782274"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2337760514" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Aiqun Huang</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2337782274" data-role="relative-time" class="time-ago" title="Sunday, November 1, 2015 11:46 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Yeah. This module runs in batch mode only, so even if you're only doing one step at a time, you should input a 1xN matrix. The activations for respective cells are in the columns :)</p><p>In this way you can train or predict with LSTMs on several inputs in parallel (if you add more rows).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2337782274"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2337782274-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2337760514-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2337287437-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2333428554"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2333428554"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_cBTeXGHYne/" data-action="profile" data-username="disqus_cBTeXGHYne" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="180691959" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_cBTeXGHYne/" data-action="profile" data-username="disqus_cBTeXGHYne" target="_blank" rel="noopener noreferrer">Maxim  Ivanov</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2333428554" data-role="relative-time" class="time-ago" title="Thursday, October 29, 2015 1:49 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks <a data-dsq-mention="adampaszke:disqus" href="https://disqus.com/by/adampaszke/" rel="nofollow noopener" title="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" class="mention">Adam Paszke</a> for such detailed step-by-step LSTM explanation. I have a question. In original paper and other sources there is nothing like rnn_size (basically, rnn_size equals to 1 there). Having rnn_size &gt; 1 just sounds like having rnn_size number of all the gates (so, instead of 4 gates it will be 4*rnn_size). The question is how did you come up with that param? Did you have a chance to see the affect of different rnn_size in prediction quality? any link is helpful, thanks!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2333428554"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2333501354"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2333501354"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_cBTeXGHYne/" data-action="profile" data-username="disqus_cBTeXGHYne" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="180691959" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_cBTeXGHYne/" data-action="profile" data-username="disqus_cBTeXGHYne" target="_blank" rel="noopener noreferrer">Maxim  Ivanov</a></span> </span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2333428554" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Maxim  Ivanov</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2333501354" data-role="relative-time" class="time-ago" title="Thursday, October 29, 2015 2:31 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>oh, I see. LSTM.create(3,2) can be considered as layer with 2 LSTM units. Each of them is original LSTM unit with 4 gates. Makes sense?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2333501354"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2333848755"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2333848755"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2333501354" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Maxim  Ivanov</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2333848755" data-role="relative-time" class="time-ago" title="Thursday, October 29, 2015 6:08 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Exactly! This would be the layer that accepts an input vector of length 3 and uses 2 LSTM units to generate output of length 2. Second parameter (let's call it x) determines how many units will be used (so there will be 4*x gates).</p><p>Regarding Your question about the prediction quality, I'd say it depends on a problem. Bigger sizes allow the layer to be more expressive and exhibit more complex behaviour, but can also lead to overfitting (just like with the regular Linear layers). In the 'Visualizing and Understanding Recurrent Networks' paper You can find a table that lists some benchmark results for LSTM networks with varying number of layers and sizes (on top of page 4).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2333848755"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2333848755-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2333501354-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2333428554-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2319806084"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2319806084"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/peteruherek/" data-action="profile" data-username="peteruherek" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="89533556" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/8953/3556/avatar92.jpg?1445461711" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/peteruherek/" data-action="profile" data-username="peteruherek" target="_blank" rel="noopener noreferrer">Peter Uherek</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2319806084" data-role="relative-time" class="time-ago" title="Wednesday, October 21, 2015 5:08 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Really good article. I am glad that someone explain the LSTM. It is hard to understand without good examples. I want to ask you, if you have plan to expand this article about training the LSTM?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2319806084"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2319812144"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2319812144"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2319806084" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Peter Uherek</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2319812144" data-role="relative-time" class="time-ago" title="Wednesday, October 21, 2015 5:12 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I'll try to, if only I'll have some time :)</p><p>It's very similar to training regular NN modules. Do you know the API? You can read more in <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Fmodule.md%3A5TyRqHzYRhxbwBGgKDPRaL3d9Wg&amp;cuid=3762125" rel="nofollow noopener" title="https://github.com/torch/nn/blob/master/doc/module.md">here</a> and <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Ftraining.md%23example-of-manual-training-of-a-neural-network%3AaX038om_lNKiLrjsjwVnRC2pqjk&amp;cuid=3762125" rel="nofollow noopener" title="https://github.com/torch/nn/blob/master/doc/training.md#example-of-manual-training-of-a-neural-network">here (just the exmaple of manual training)</a>. I hope this helps at least a bit!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2319812144"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2319812144-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2319806084-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2304665761"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2304665761"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/bibekanandakundu/" data-action="profile" data-username="bibekanandakundu" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="177745908" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/bibekanandakundu/" data-action="profile" data-username="bibekanandakundu" target="_blank" rel="noopener noreferrer">Bibekananda Kundu</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2304665761" data-role="relative-time" class="time-ago" title="Tuesday, October 13, 2015 5:17 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>How to use</p><p>layer:backward()</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2304665761"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2304665761-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2304642397"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2304642397"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/bibekanandakundu/" data-action="profile" data-username="bibekanandakundu" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="177745908" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/bibekanandakundu/" data-action="profile" data-username="bibekanandakundu" target="_blank" rel="noopener noreferrer">Bibekananda Kundu</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2304642397" data-role="relative-time" class="time-ago" title="Tuesday, October 13, 2015 5:01 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Can you please provide the code for training the LSTM ?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2304642397"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2304642397-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2281740898"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2281740898"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/minkymorgan/" data-action="profile" data-username="minkymorgan" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="176752555" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/minkymorgan/" data-action="profile" data-username="minkymorgan" target="_blank" rel="noopener noreferrer">Andrew Morgan</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2281740898" data-role="relative-time" class="time-ago" title="Wednesday, September 30, 2015 7:53 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I really liked your article, and it's encouraged me to have a go building LSTMs too. I forked your examples and have been testing it, to try and do learning with it on some data I have. But, I think I'm misunderstand how training fits into your example.</p><p>My code is on github along with test data. <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fbytesumo%2FLSTM-Experiments%2Fblob%2Fmaster%2Ftc_lstm.lua%3A2O47SxeiOJeIJtY9pK4kzH59FA8&amp;cuid=3762125" rel="nofollow noopener" title="https://github.com/bytesumo/LSTM-Experiments/blob/master/tc_lstm.lua">https://github.com/bytesumo...</a></p><p>Maybe you could glance at it, offer a pointer to fixing the training process? <br>Many thanks, Andrew.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2281740898"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2287686610"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2287686610"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2281740898" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Andrew Morgan</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2287686610" data-role="relative-time" class="time-ago" title="Saturday, October 3, 2015 7:27 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>The link you posted gives me a 404 :/<br>Did you solve the issue? I can't see LSTM implementation in your code.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2287686610"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2291128732"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2291128732"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/minkymorgan/" data-action="profile" data-username="minkymorgan" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="176752555" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/minkymorgan/" data-action="profile" data-username="minkymorgan" target="_blank" rel="noopener noreferrer">Andrew Morgan</a></span> </span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2287686610" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Adam Paszke</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2291128732" data-role="relative-time" class="time-ago" title="Monday, October 5, 2015 10:16 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>yeah ... so my initial enthusiasm ebbed as I realised my attempt was rubbish! So ditched it and settled on trying some experiments with a working library rnn. My experimental code is here. <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fbytesumo%2FLSTM-Experiments%3AummHjBixQ494XwiRvfM494oKklk&amp;cuid=3762125" rel="nofollow noopener" title="https://github.com/bytesumo/LSTM-Experiments">https://github.com/bytesumo...</a><br>Still not sure it learns anything, but most bugs ironed out now.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2291128732"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2291128732-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2287686610-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2281740898-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2281366551"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2281366551"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="81098224" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" target="_blank" rel="noopener noreferrer">Viking Ender</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2281366551" data-role="relative-time" class="time-ago" title="Wednesday, September 30, 2015 2:37 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, this model may better have a updateOutput() &amp; backward() since it behaves different from Containers such as Sequential &amp; Concat. While it's exactly what you need to define in training, but putting things together (combine all layers in a complete Module) permits you convenience to optimize parameters as a whole. Cheers.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2281366551"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2287690054"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2287690054"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2281366551" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Viking Ender</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2287690054" data-role="relative-time" class="time-ago" title="Saturday, October 3, 2015 7:32 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Uh, you could combine the layers in some kind of container, but I haven't tried it yet. Anyway, it's a thing worth adding here! Thanks!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2287690054"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2288078625"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2288078625"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="81098224" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" target="_blank" rel="noopener noreferrer">Viking Ender</a></span> </span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2287690054" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Adam Paszke</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2288078625" data-role="relative-time" class="time-ago" title="Saturday, October 3, 2015 1:15 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I have an implementation here, the LSTM module mainly was copied from yours. So your code should work with mine as well. <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2FKHN190%2Ftorch-RNN%2Ftree%2Fmaster%2Fbone%3ArzO2MdzZlqcZoDytBcjMphRUq6w&amp;cuid=3762125" rel="nofollow noopener" title="https://github.com/KHN190/torch-RNN/tree/master/bone">https://github.com/KHN190/t...</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2288078625"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2298555431"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2298555431"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2288078625" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Viking Ender</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2298555431" data-role="relative-time" class="time-ago" title="Friday, October 9, 2015 12:20 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I see. It might be convenient, but you code is too big to put it in here. And I'm not sure if it wouldn't be simpler to write another nngraph module wrapping individual layers, or your own function to construct and connect all the layers into a single network in advance.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2298555431"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2301312341"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2301312341"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="81098224" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" target="_blank" rel="noopener noreferrer">Viking Ender</a></span> </span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2298555431" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Adam Paszke</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2301312341" data-role="relative-time" class="time-ago" title="Sunday, October 11, 2015 9:14 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I don't see a way to escape from crafting the parameters updating. In my case, it's implemented in the partner functions of boneRecurrent. In your case, it must be somewhere during the training. For reusability it's better to create a Container. For one-go experiment, you need to modify training code a bit from side to side. But on one thing you are right, nn.gModule forces a lot of inconvenience in coding (e.x. I can't do resizeAs in a module, simply because the input is no more a tensor! It's nngraph.Node then). I think it's a fault of Torch.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-14" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">14</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2301312341"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2301312341-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2298555431-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2288078625-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2287690054-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2281366551-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2273097779"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2273097779"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/ayanaaltaqin/" data-action="profile" data-username="ayanaaltaqin" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="176106852" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/17610/6852/avatar92.jpg?1443155027" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/ayanaaltaqin/" data-action="profile" data-username="ayanaaltaqin" target="_blank" rel="noopener noreferrer">Ayana Altaqin</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2273097779" data-role="relative-time" class="time-ago" title="Friday, September 25, 2015 12:23 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Well thanks for the sharing, I just started to learn these RNN,LSTM,Lua and Torch things... And they are really hard to understand.. Your work is very helpful and I do really appreciate it .. Yes , thank you ...</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2273097779"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2273097779-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2244419488"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2244419488"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_YQTggpvnhi/" data-action="profile" data-username="disqus_YQTggpvnhi" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="173802795" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_YQTggpvnhi/" data-action="profile" data-username="disqus_YQTggpvnhi" target="_blank" rel="noopener noreferrer">Ozan alayan</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2244419488" data-role="relative-time" class="time-ago" title="Wednesday, September 9, 2015 10:54 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I think CMulTable() should be the product while the CAddTable() the sum in their descriptions.</p><p>Thanks :)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2244419488"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2248245692"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2248245692"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2244419488" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Ozan alayan</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2248245692" data-role="relative-time" class="time-ago" title="Friday, September 11, 2015 11:47 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>You've got me, thanks! ;)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2248245692"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2248245692-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2244419488-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-2242323613"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2242323613"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_3BWuyN6Mlh/" data-action="profile" data-username="disqus_3BWuyN6Mlh" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="173655427" src="./noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/17365/5427/avatar92.jpg?1441717075" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_3BWuyN6Mlh/" data-action="profile" data-username="disqus_3BWuyN6Mlh" target="_blank" rel="noopener noreferrer">joe</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2242323613" data-role="relative-time" class="time-ago" title="Tuesday, September 8, 2015 8:54 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>The figures is very clear and this page makes the LSTM very easy to understand, I certainly got lot of things from this article, it makes sense. What's more, I'm also curious about the bp procedure of LSTM, maybe there will be some supplyment posts later ^ ^</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2242323613"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-2248250367"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="2248250367"><li class="collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><div><a class="dropdown-toggle" data-toggle="dropdown" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#"><b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="block-user" role="menuitem">Block User</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" role="menuitem">Flag as inappropriate</a></li></ul></div></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" data-src="//a.disquscdn.com/1541535443/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" target="_blank" rel="noopener noreferrer">Adam Paszke</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2242323613" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> joe</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://apaszke.github.io/lstm-explained.html#comment-2248250367" data-role="relative-time" class="time-ago" title="Friday, September 11, 2015 11:50 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hey! Sorry for the late reply!</p><p>It's great to hear that you liked it! Saying 'bp procedure' do you mean the exact derivations or just the training code? It's really easy to train these models with a few calls like :backward(). There are some examples in torch docs e.g.: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Ftraining.md%3AEIH9JOUWXiUZdlrn7UI-271vHgE&amp;cuid=3762125" rel="nofollow noopener" title="https://github.com/torch/nn/blob/master/doc/training.md">https://github.com/torch/nn...</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:2248250367"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2248250367-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-2242323613-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="load-more" data-role="more" style="display: none;"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="more-posts" class="btn load-more__button">Load more comments</a></div></div></section><div id="placement-bottom" data-tracking-area="discovery-south"><div class="post-list" style="height: 0px; visibility: hidden;"><div style="display: block; width: 100%;"></div></div></div><div id="footer" data-tracking-area="footer" class="disqus-footer__wrapper"><ul class="disqus-footer"><li class="disqus-footer__logo"><a href="https://disqus.com/" rel="nofollow" title="Powered by Disqus" class="disqus-footer__link">Powered by Disqus</a></li><li id="thread-subscribe-button" class="email disqus-footer__item"><div class="default"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" rel="nofollow" data-action="subscribe" title="Subscribe and get email updates from this discussion" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-mail"></i><span class="clip">Subscribe</span><i aria-hidden="true" class="icon icon-checkmark"></i></a></div></li><li class="install disqus-footer__item"><a href="https://publishers.disqus.com/engage?utm_source=apaszke&amp;utm_medium=Disqus-Footer" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-disqus"></i><span class="clip hidden-md">Add Disqus to your site</span><span class="clip visible-md hidden-xs">Add Disqus</span><span class="clip visible-xs">Add</span></a></li><li class="privacy disqus-footer__item"><a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-lock"></i><span class="clip hidden-sm">Disqus' Privacy Policy</span><span class="clip visible-sm hidden-xs">Privacy Policy</span><span class="clip visible-xs">Privacy</span></a></li></ul></div></div><img src="./collect" style="display: none;"><img src="./px" style="display: none;"><img src="./saved_resource" style="display: none;"><iframe src="./sync.html" style="display: none;"></iframe><iframe src="./pixel.html" style="display: none;"></iframe><img src="./getuid(1)" style="display: none;"></body></html>