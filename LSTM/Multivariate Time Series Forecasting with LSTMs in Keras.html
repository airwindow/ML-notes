<!DOCTYPE html>
<!-- saved from url=(0084)https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/ -->
<html lang="en-US" prefix="og: http://ogp.me/ns#" style="min-height: 100%;" class=" js csstransforms3d csstransitions"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/form"></script><script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/form(1)"></script><script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/track"></script>



<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Multivariate Time Series Forecasting with LSTMs in Keras</title>
<link rel="canonical" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/">
<link rel="publisher" href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Multivariate Time Series Forecasting with LSTMs in Keras">
<meta property="og:description" content="Neural networks like Long Short-Term Memory (LSTM) recurrent neural networks are able to almost seamlessly model problems with multiple input variables. This is a great benefit in time series forecasting, where classical linear methods can be difficult to adapt to multivariate or multiple input forecasting problems. In this tutorial, you will discover how you can …">
<meta property="og:url" content="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="article:publisher" content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/">
<meta property="article:author" content="https://www.facebook.com/jason.brownlee.39">
<meta property="article:section" content="Deep Learning for Time Series">
<meta property="article:published_time" content="2017-08-13T19:00:38+00:00">
<meta property="article:modified_time" content="2018-09-19T22:03:35+00:00">
<meta property="og:updated_time" content="2018-09-19T22:03:35+00:00">
<meta property="og:image" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series.png">
<meta property="og:image:secure_url" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series.png">
<meta property="og:image:width" content="1280">
<meta property="og:image:height" content="960">
<meta property="og:image:alt" content="Line Plots of Air Pollution Time Series">
<script type="text/javascript" async="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9556588.js"></script><script async="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/analytics.js"></script><script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Multivariate Time Series Forecasting with LSTMs in Keras Comments Feed" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style type="text/css" media="all">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link rel="stylesheet" id="crayon-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="wpautoterms_css-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/wpautoterms.css" type="text/css" media="all">
<link rel="stylesheet" id="contact-form-7-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/styles.css" type="text/css" media="all">
<link rel="stylesheet" id="ssb-front-css-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/front.css" type="text/css" media="all">
<link rel="stylesheet" id="ewd-ufaq-style-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ewd-ufaq-styles.css" type="text/css" media="all">
<link rel="stylesheet" id="ewd-ufaq-rrssb-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/rrssb-min.css" type="text/css" media="all">
<link rel="stylesheet" id="woo-testimonials-css-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/testimonials.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-stylesheet-css" href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/jquery.js"></script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/crayon.min.js"></script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/front.js"></script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/third-party.min.js"></script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/modernizr.min.js"></script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/general.min.js"></script>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=4195">
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fmultivariate-time-series-forecasting-lstms-keras%2F">
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fmultivariate-time-series-forecasting-lstms-keras%2F&amp;format=xml">
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->

 <style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
    <script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Woo Shortcodes CSS -->
<link href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/shortcodes.css" rel="stylesheet" type="text/css">

<!-- Custom Stylesheet -->
<link href="./Multivariate Time Series Forecasting with LSTMs in Keras_files/custom.css" rel="stylesheet" type="text/css">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
<script src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/can-i-show.js"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(9,123,156) !important;
    background: rgba(9,123,156,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab div,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Powered By === */

  .drip-tab .drip-powered-by {
    padding: 8px;
    margin-bottom: -5px;
    font-family: Helvetica, Arial, sans-serif;
    text-align: left;
    font-weight: bold;
    font-size: 10px;
    line-height: 16px;
    color: #ffffff;
    letter-spacing: 1px;
    text-align: center;
    text-transform: uppercase;
    display: -webkit-box;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .drip-tab .drip-powered-by a {
    color: #ffffff !important;
    text-decoration: underline !important;
    letter-spacing: 1px;
    margin-left: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-tab .drip-text-field {
    margin: 0 !important;
    padding: 6px !important;
    height: auto !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* stylelint-enable */

</style></head>
<body class="post-template-default single single-post postid-4195 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/icon-100x100.png" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="text-53" class="widget widget_text">			<div class="textwidget"><p>Want help with deep learning for time series? <a href="https://machinelearningmastery.lpages.co/deep-learning-for-time-series-forecasting-mini-course/">Take the FREE Mini-Course</a></p>
</div>
		</div><div id="search-3" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
		<input type="hidden" name="post_type" value="post">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
	<li id="menu-item-6513" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6518" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
	<li id="menu-item-6514" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-4195 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-time-series">
	<header>
	<h1 class="title entry-title">Multivariate Time Series Forecasting with LSTMs in Keras</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-08-14T05:00:38+1100">August 14, 2017</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/" title="View all items in Deep Learning for Time Series">Deep Learning for Time Series</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4195 post  simplesocialbuttons-inline-no-animation simplesocialbuttons-inline-in">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Multivariate+Time+Series+Forecasting+with+LSTMs+in+Keras&amp;url=https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" width="30px" height="18px" viewBox="-10 -6 60 36" class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
						<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Neural networks like Long Short-Term Memory (LSTM) recurrent neural networks are able to almost seamlessly model problems with multiple input variables.</p>
<p>This is a great benefit in time series forecasting, where classical linear methods can be difficult to adapt to multivariate or multiple input forecasting problems.</p>
<p>In this tutorial, you will discover how you can develop an LSTM model for multivariate time series forecasting in the Keras deep learning library.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to transform a raw dataset into something we can use for time series forecasting.</li>
<li>How to prepare data and fit an LSTM for a multivariate time series forecasting problem.</li>
<li>How to make a forecast and rescale the result back into the original units.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Updated Aug/2017</strong>: Fixed a bug where yhat was compared to obs at the previous time step when calculating the final RMSE. Thanks, Songbin Xu and&nbsp;David Righart.</li>
<li><strong>Update Oct/2017</strong>: Added a new example showing how to train on multiple prior time steps due to popular demand.</li>
<li><strong>Update Sep/2018</strong>: Updated link to dataset.</li>
</ul>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 3 parts; they are:</p>
<ol>
<li>Air Pollution Forecasting</li>
<li>Basic Data Preparation</li>
<li>Multivariate LSTM Forecast Model</li>
</ol>
<h3>Python Environment</h3>
<p>This tutorial assumes you have a Python SciPy environment installed. You can use either Python 2 or 3 with this tutorial.</p>
<p>You must have Keras (2.0 or higher) installed with either the TensorFlow or Theano backend.</p>
<p>The tutorial also assumes you have scikit-learn, Pandas, NumPy and Matplotlib installed.</p>
<p>If you need help with your environment, see this post:</p>
<ul>
<li><a href="http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a></li>
</ul>
<p></p><div class="woo-sc-hr"></div><p></p>
<center>
<h3>Need help with Deep Learning for Time Series?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" target="_blank" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" data-leadbox="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" data-leadbox-id="14531ee73f72a2:164f8be4f346dc">Download Your FREE Mini-Course</a><script data-leadbox="14531ee73f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" data-config="%7B%7D" type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/leadbox-1534880695.js"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><p></p>
<h2>1. Air Pollution Forecasting</h2>
<p>In this tutorial, we are going to use the Air Quality dataset.</p>
<p>This is a dataset that reports on the weather and the level of pollution each hour for five years at the US embassy in Beijing, China.</p>
<p>The data includes the date-time, the pollution called PM2.5 concentration, and the weather information including dew point, temperature, pressure, wind direction, wind speed and the cumulative number of hours of snow and rain. The complete feature list in the raw data is as follows:</p>
<ol>
<li><strong>No</strong>: row number</li>
<li><strong>year</strong>: year of data in this row</li>
<li><strong>month</strong>: month of data in this row</li>
<li><strong>day</strong>: day of data in this row</li>
<li><strong>hour</strong>: hour of data in this row</li>
<li><strong>pm2.5</strong>: PM2.5 concentration</li>
<li><strong>DEWP</strong>: Dew Point</li>
<li><strong>TEMP</strong>: Temperature</li>
<li><strong>PRES</strong>: Pressure</li>
<li><strong>cbwd</strong>: Combined wind direction</li>
<li><strong>Iws</strong>: Cumulated wind speed</li>
<li><strong>Is</strong>: Cumulated hours of snow</li>
<li><strong>Ir</strong>: Cumulated hours of rain</li>
</ol>
<p>We can use this data and frame a forecasting problem where, given the weather conditions and pollution for prior hours, we forecast the pollution at the next hour.</p>
<p>This dataset can be used to frame other forecasting problems.<br>
Do you have good ideas? Let me know in the comments below.</p>
<p>You can download the dataset from the UCI Machine Learning Repository.</p>
<p><strong>Update</strong>, I have mirrored the dataset here because UCI has become unreliable:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/pollution.csv">Beijing PM2.5 Data Set</a></li>
</ul>
<p>Download the dataset and place it in your current working directory with the filename “<em>raw.csv</em>“.</p>
<h2>2. Basic Data Preparation</h2>
<p>The data is not ready to use. We must prepare it first.</p>
<p>Below are the first few rows of the raw dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e48e621498647" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">No,year,month,day,hour,pm2.5,DEWP,TEMP,PRES,cbwd,Iws,Is,Ir
1,2010,1,1,0,NA,-21,-11,1021,NW,1.79,0,0
2,2010,1,1,1,NA,-21,-12,1020,NW,4.92,0,0
3,2010,1,1,2,NA,-21,-11,1019,NW,6.71,0,0
4,2010,1,1,3,NA,-21,-14,1019,NW,9.84,0,0
5,2010,1,1,4,NA,-20,-12,1018,NW,12.97,0,0</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e48e621498647-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e48e621498647-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e48e621498647-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e48e621498647-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e48e621498647-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e48e621498647-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e48e621498647-1">No,year,month,day,hour,pm2.5,DEWP,TEMP,PRES,cbwd,Iws,Is,Ir</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e48e621498647-2">1,2010,1,1,0,NA,-21,-11,1021,NW,1.79,0,0</div><div class="crayon-line" id="crayon-5c0eee933e48e621498647-3">2,2010,1,1,1,NA,-21,-12,1020,NW,4.92,0,0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e48e621498647-4">3,2010,1,1,2,NA,-21,-11,1019,NW,6.71,0,0</div><div class="crayon-line" id="crayon-5c0eee933e48e621498647-5">4,2010,1,1,3,NA,-21,-14,1019,NW,9.84,0,0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e48e621498647-6">5,2010,1,1,4,NA,-20,-12,1018,NW,12.97,0,0</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The first step is to consolidate the date-time information into a single date-time so that we can use it as an index in Pandas.</p>
<p>A quick check reveals NA values for pm2.5 for the first 24 hours. We will, therefore, need to remove the first row of data. There are also a few scattered “NA” values later in the dataset; we can mark them with 0 values for now.</p>
<p>The script below loads the raw dataset and parses the date-time information as the Pandas DataFrame index. The “No” column is dropped and then clearer names are specified for each column. Finally, the NA values are replaced with “0” values and the first 24 hours are removed.</p>
<p>The “No” column is dropped and then clearer names are specified for each column. Finally, the NA values are replaced with “0” values and the first 24 hours are removed.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e496312884704" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from pandas import read_csv
from datetime import datetime
# load data
def parse(x):
	return datetime.strptime(x, '%Y %m %d %H')
dataset = read_csv('raw.csv',  parse_dates = [['year', 'month', 'day', 'hour']], index_col=0, date_parser=parse)
dataset.drop('No', axis=1, inplace=True)
# manually specify column names
dataset.columns = ['pollution', 'dew', 'temp', 'press', 'wnd_dir', 'wnd_spd', 'snow', 'rain']
dataset.index.name = 'date'
# mark all NA values with 0
dataset['pollution'].fillna(0, inplace=True)
# drop the first 24 hours
dataset = dataset[24:]
# summarize first 5 rows
print(dataset.head(5))
# save to file
dataset.to_csv('pollution.csv')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-12">12</div><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-14">14</div><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-16">16</div><div class="crayon-num" data-line="crayon-5c0eee933e496312884704-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e496312884704-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e496312884704-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-2"><span class="crayon-e">from </span><span class="crayon-e">datetime </span><span class="crayon-e">import </span><span class="crayon-v">datetime</span></div><div class="crayon-line" id="crayon-5c0eee933e496312884704-3"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-4"><span class="crayon-e">def </span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e496312884704-5"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y %m %d %H'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-6"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'raw.csv'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parse_dates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'year'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'month'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'day'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'hour'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parse</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e496312884704-7"><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-8"><span class="crayon-p"># manually specify column names</span></div><div class="crayon-line" id="crayon-5c0eee933e496312884704-9"><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'pollution'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'dew'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'temp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'press'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wnd_dir'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wnd_spd'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'snow'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rain'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-10"><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'date'</span></div><div class="crayon-line" id="crayon-5c0eee933e496312884704-11"><span class="crayon-p"># mark all NA values with 0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-12"><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-s">'pollution'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">fillna</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e496312884704-13"><span class="crayon-p"># drop the first 24 hours</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-14"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">24</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e496312884704-15"><span class="crayon-p"># summarize first 5 rows</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e496312884704-17"><span class="crayon-p"># save to file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e496312884704-18"><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">to_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'pollution.csv'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Running the example prints the first 5 rows of the transformed dataset and saves the dataset to “<em>pollution.csv</em>“.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e499260522644" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">                     pollution  dew  temp   press wnd_dir  wnd_spd  snow  rain
date
2010-01-02 00:00:00      129.0  -16  -4.0  1020.0      SE     1.79     0     0
2010-01-02 01:00:00      148.0  -15  -4.0  1020.0      SE     2.68     0     0
2010-01-02 02:00:00      159.0  -11  -5.0  1021.0      SE     3.57     0     0
2010-01-02 03:00:00      181.0   -7  -5.0  1022.0      SE     5.36     1     0
2010-01-02 04:00:00      138.0   -7  -5.0  1022.0      SE     6.25     2     0</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e499260522644-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e499260522644-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e499260522644-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e499260522644-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e499260522644-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e499260522644-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e499260522644-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e499260522644-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pollution&nbsp;&nbsp;dew&nbsp;&nbsp;temp&nbsp;&nbsp; press wnd_dir&nbsp;&nbsp;wnd_spd&nbsp;&nbsp;snow&nbsp;&nbsp;rain</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e499260522644-2">date</div><div class="crayon-line" id="crayon-5c0eee933e499260522644-3">2010-01-02 00:00:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;129.0&nbsp;&nbsp;-16&nbsp;&nbsp;-4.0&nbsp;&nbsp;1020.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SE&nbsp;&nbsp;&nbsp;&nbsp; 1.79&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e499260522644-4">2010-01-02 01:00:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;148.0&nbsp;&nbsp;-15&nbsp;&nbsp;-4.0&nbsp;&nbsp;1020.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SE&nbsp;&nbsp;&nbsp;&nbsp; 2.68&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0</div><div class="crayon-line" id="crayon-5c0eee933e499260522644-5">2010-01-02 02:00:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;159.0&nbsp;&nbsp;-11&nbsp;&nbsp;-5.0&nbsp;&nbsp;1021.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SE&nbsp;&nbsp;&nbsp;&nbsp; 3.57&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e499260522644-6">2010-01-02 03:00:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;181.0&nbsp;&nbsp; -7&nbsp;&nbsp;-5.0&nbsp;&nbsp;1022.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SE&nbsp;&nbsp;&nbsp;&nbsp; 5.36&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp; 0</div><div class="crayon-line" id="crayon-5c0eee933e499260522644-7">2010-01-02 04:00:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;138.0&nbsp;&nbsp; -7&nbsp;&nbsp;-5.0&nbsp;&nbsp;1022.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SE&nbsp;&nbsp;&nbsp;&nbsp; 6.25&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp; 0</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now that we have the data in an easy-to-use form, we can create a quick plot of each series and see what we have.</p>
<p>The code below loads the new “<em>pollution.csv</em>” file and plots each series as a separate subplot, except wind speed dir, which is categorical.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e49b247472257" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from pandas import read_csv
from matplotlib import pyplot
# load dataset
dataset = read_csv('pollution.csv', header=0, index_col=0)
values = dataset.values
# specify columns to plot
groups = [0, 1, 2, 3, 5, 6, 7]
i = 1
# plot each column
pyplot.figure()
for group in groups:
	pyplot.subplot(len(groups), 1, i)
	pyplot.plot(values[:, group])
	pyplot.title(dataset.columns[group], y=0.5, loc='right')
	i += 1
pyplot.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e49b247472257-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49b247472257-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e49b247472257-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49b247472257-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e49b247472257-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49b247472257-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e49b247472257-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49b247472257-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e49b247472257-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49b247472257-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e49b247472257-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49b247472257-12">12</div><div class="crayon-num" data-line="crayon-5c0eee933e49b247472257-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49b247472257-14">14</div><div class="crayon-num" data-line="crayon-5c0eee933e49b247472257-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49b247472257-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e49b247472257-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49b247472257-2"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-v">pyplot</span></div><div class="crayon-line" id="crayon-5c0eee933e49b247472257-3"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49b247472257-4"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'pollution.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49b247472257-5"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49b247472257-6"><span class="crayon-p"># specify columns to plot</span></div><div class="crayon-line" id="crayon-5c0eee933e49b247472257-7"><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49b247472257-8"><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0eee933e49b247472257-9"><span class="crayon-p"># plot each column</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49b247472257-10"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49b247472257-11"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49b247472257-12"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49b247472257-13"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49b247472257-14"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loc</span><span class="crayon-o">=</span><span class="crayon-s">'right'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49b247472257-15"><span class="crayon-h">	</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49b247472257-16"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Running the example creates a plot with 7 subplots showing the 5 years of data for each variable.</p>
<div id="attachment_4196" style="width: 1034px" class="wp-caption aligncenter"><img class="size-large wp-image-4196" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/Line-Plots-of-Air-Pollution-Time-Series-1024x768.png" alt="Line Plots of Air Pollution Time Series" width="1024" height="768" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-1024x768.png 1024w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p class="wp-caption-text">Line Plots of Air Pollution Time Series</p></div>
<h2>3. Multivariate LSTM Forecast Model</h2>
<p>In this section, we will fit an LSTM to the problem.</p>
<h3>LSTM Data Preparation</h3>
<p>The first step is to prepare the pollution dataset for the LSTM.</p>
<p>This involves framing the dataset as a supervised learning problem and normalizing the input variables.</p>
<p>We will frame the supervised learning problem as predicting the pollution at the current hour (t) given the pollution measurement and weather conditions at the prior time step.</p>
<p>This formulation is straightforward and just for this demonstration. Some alternate formulations you could explore include:</p>
<ul>
<li>Predict the pollution for the next hour based on the weather conditions and pollution over the last 24 hours.</li>
<li>Predict the pollution for the next hour as above and given the “expected” weather conditions for the next hour.</li>
</ul>
<p>We can transform the dataset using the <em>series_to_supervised()</em> function developed in the blog post:</p>
<ul>
<li><a href="http://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/">How to Convert a Time Series to a Supervised Learning Problem in Python</a></li>
</ul>
<p>First, the “<em>pollution.csv</em>” dataset is loaded. The wind speed feature is label encoded (integer encoded). This could further be one-hot encoded in the future if you are interested in exploring it.</p>
<p>Next, all features are normalized, then the dataset is transformed into a supervised learning problem. The weather variables for the hour to be predicted (t) are then removed.</p>
<p>The complete code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e49c300946545" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># convert series to supervised learning
def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg
 
# load dataset
dataset = read_csv('pollution.csv', header=0, index_col=0)
values = dataset.values
# integer encode direction
encoder = LabelEncoder()
values[:,4] = encoder.fit_transform(values[:,4])
# ensure all data is float
values = values.astype('float32')
# normalize features
scaler = MinMaxScaler(feature_range=(0, 1))
scaled = scaler.fit_transform(values)
# frame as supervised learning
reframed = series_to_supervised(scaled, 1, 1)
# drop columns we don't want to predict
reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)
print(reframed.head())</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-12">12</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-14">14</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-16">16</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-18">18</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-20">20</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-22">22</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-24">24</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-26">26</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-28">28</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-30">30</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-32">32</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-34">34</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-36">36</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-38">38</div><div class="crayon-num" data-line="crayon-5c0eee933e49c300946545-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e49c300946545-40">40</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e49c300946545-1"><span class="crayon-p"># convert series to supervised learning</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-2"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-3"><span class="crayon-h">	</span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-4"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-5"><span class="crayon-h">	</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-6"><span class="crayon-h">	</span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-7"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-8"><span class="crayon-h">		</span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-9"><span class="crayon-h">		</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-10"><span class="crayon-h">	</span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-11"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-12"><span class="crayon-h">		</span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-13"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-14"><span class="crayon-h">			</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-15"><span class="crayon-h">		</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-16"><span class="crayon-h">			</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-17"><span class="crayon-h">	</span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-18"><span class="crayon-h">	</span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-19"><span class="crayon-h">	</span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-20"><span class="crayon-h">	</span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-21"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-22"><span class="crayon-h">		</span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-23"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-24"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-25"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-26"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'pollution.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-27"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-28"><span class="crayon-p"># integer encode direction</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-29"><span class="crayon-v">encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-30"><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-31"><span class="crayon-p"># ensure all data is float</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-32"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-33"><span class="crayon-p"># normalize features</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-34"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-35"><span class="crayon-v">scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-36"><span class="crayon-p"># frame as supervised learning</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-37"><span class="crayon-v">reframed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-38"><span class="crayon-p"># drop columns we don't want to predict</span></div><div class="crayon-line" id="crayon-5c0eee933e49c300946545-39"><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-cn">11</span><span class="crayon-sy">,</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-cn">15</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e49c300946545-40"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>Running the example prints the first 5 rows of the transformed dataset. We can see the 8 input variables (input series) and the 1 output variable (pollution level at the current hour).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4a1421376241" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">   var1(t-1)  var2(t-1)  var3(t-1)  var4(t-1)  var5(t-1)  var6(t-1)  \
1   0.129779   0.352941   0.245902   0.527273   0.666667   0.002290
2   0.148893   0.367647   0.245902   0.527273   0.666667   0.003811
3   0.159960   0.426471   0.229508   0.545454   0.666667   0.005332
4   0.182093   0.485294   0.229508   0.563637   0.666667   0.008391
5   0.138833   0.485294   0.229508   0.563637   0.666667   0.009912
 
   var7(t-1)  var8(t-1)   var1(t)
1   0.000000        0.0  0.148893
2   0.000000        0.0  0.159960
3   0.000000        0.0  0.182093
4   0.037037        0.0  0.138833
5   0.074074        0.0  0.109658</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4a1421376241-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a1421376241-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4a1421376241-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a1421376241-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4a1421376241-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a1421376241-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4a1421376241-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a1421376241-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4a1421376241-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a1421376241-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e4a1421376241-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a1421376241-12">12</div><div class="crayon-num" data-line="crayon-5c0eee933e4a1421376241-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4a1421376241-1">&nbsp;&nbsp; var1(t-1)&nbsp;&nbsp;var2(t-1)&nbsp;&nbsp;var3(t-1)&nbsp;&nbsp;var4(t-1)&nbsp;&nbsp;var5(t-1)&nbsp;&nbsp;var6(t-1)&nbsp;&nbsp;\</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a1421376241-2">1&nbsp;&nbsp; 0.129779&nbsp;&nbsp; 0.352941&nbsp;&nbsp; 0.245902&nbsp;&nbsp; 0.527273&nbsp;&nbsp; 0.666667&nbsp;&nbsp; 0.002290</div><div class="crayon-line" id="crayon-5c0eee933e4a1421376241-3">2&nbsp;&nbsp; 0.148893&nbsp;&nbsp; 0.367647&nbsp;&nbsp; 0.245902&nbsp;&nbsp; 0.527273&nbsp;&nbsp; 0.666667&nbsp;&nbsp; 0.003811</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a1421376241-4">3&nbsp;&nbsp; 0.159960&nbsp;&nbsp; 0.426471&nbsp;&nbsp; 0.229508&nbsp;&nbsp; 0.545454&nbsp;&nbsp; 0.666667&nbsp;&nbsp; 0.005332</div><div class="crayon-line" id="crayon-5c0eee933e4a1421376241-5">4&nbsp;&nbsp; 0.182093&nbsp;&nbsp; 0.485294&nbsp;&nbsp; 0.229508&nbsp;&nbsp; 0.563637&nbsp;&nbsp; 0.666667&nbsp;&nbsp; 0.008391</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a1421376241-6">5&nbsp;&nbsp; 0.138833&nbsp;&nbsp; 0.485294&nbsp;&nbsp; 0.229508&nbsp;&nbsp; 0.563637&nbsp;&nbsp; 0.666667&nbsp;&nbsp; 0.009912</div><div class="crayon-line" id="crayon-5c0eee933e4a1421376241-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a1421376241-8">&nbsp;&nbsp; var7(t-1)&nbsp;&nbsp;var8(t-1)&nbsp;&nbsp; var1(t)</div><div class="crayon-line" id="crayon-5c0eee933e4a1421376241-9">1&nbsp;&nbsp; 0.000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.148893</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a1421376241-10">2&nbsp;&nbsp; 0.000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.159960</div><div class="crayon-line" id="crayon-5c0eee933e4a1421376241-11">3&nbsp;&nbsp; 0.000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.182093</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a1421376241-12">4&nbsp;&nbsp; 0.037037&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.138833</div><div class="crayon-line" id="crayon-5c0eee933e4a1421376241-13">5&nbsp;&nbsp; 0.074074&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.109658</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This data preparation is simple and there is more we could explore. Some ideas you could look at include:</p>
<ul>
<li>One-hot encoding wind speed.</li>
<li>Making all series stationary with differencing and seasonal adjustment.</li>
<li>Providing more than 1 hour of input time steps.</li>
</ul>
<p>This last point is perhaps the most important given the use of Backpropagation through time by LSTMs when learning sequence prediction problems.</p>
<h3>Define and Fit Model</h3>
<p>In this section, we will fit an LSTM on the multivariate input data.</p>
<p>First, we must split the prepared dataset into train and test sets. To speed up the training of the model for this demonstration, we will only fit the model on the first year of data, then evaluate it on the remaining 4 years of data. If you have time, consider exploring the inverted version of this test harness.</p>
<p>The example below splits the dataset into train and test sets, then splits the train and test sets into input and output variables. Finally, the inputs (X) are reshaped into the 3D format expected by LSTMs, namely [samples, timesteps, features].</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4a2319460603" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split into train and test sets
values = reframed.values
n_train_hours = 365 * 24
train = values[:n_train_hours, :]
test = values[n_train_hours:, :]
# split into input and outputs
train_X, train_y = train[:, :-1], train[:, -1]
test_X, test_y = test[:, :-1], test[:, -1]
# reshape input to be 3D [samples, timesteps, features]
train_X = train_X.reshape((train_X.shape[0], 1, train_X.shape[1]))
test_X = test_X.reshape((test_X.shape[0], 1, test_X.shape[1]))
print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4a2319460603-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a2319460603-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4a2319460603-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a2319460603-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4a2319460603-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a2319460603-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4a2319460603-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a2319460603-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4a2319460603-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a2319460603-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e4a2319460603-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a2319460603-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4a2319460603-1"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a2319460603-2"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0eee933e4a2319460603-3"><span class="crayon-v">n_train_hours</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">365</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">24</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a2319460603-4"><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n_train_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4a2319460603-5"><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-v">n_train_hours</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a2319460603-6"><span class="crayon-p"># split into input and outputs</span></div><div class="crayon-line" id="crayon-5c0eee933e4a2319460603-7"><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a2319460603-8"><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4a2319460603-9"><span class="crayon-p"># reshape input to be 3D [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a2319460603-10"><span class="crayon-v">train_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4a2319460603-11"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a2319460603-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Running this example prints the shape of the train and test input and output sets with about 9K hours of data for training and about 35K hours for testing.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4a5060002694" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">(8760, 1, 8) (8760,) (35039, 1, 8) (35039,)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4a5060002694-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4a5060002694-1">(8760, 1, 8) (8760,) (35039, 1, 8) (35039,)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now we can define and fit our LSTM model.</p>
<p>We will define the LSTM with 50 neurons in the first hidden layer and 1 neuron in the output layer for predicting pollution. The input shape will be 1 time step with 8 features.</p>
<p>We will use the Mean Absolute Error (MAE) loss function and the efficient Adam version of stochastic gradient descent.</p>
<p>The model will be fit for 50 training epochs with a batch size of 72. Remember that the internal state of the LSTM in Keras is reset at the end of each batch, so an internal state that is a function of a number of days may be helpful (try testing this).</p>
<p>Finally, we keep track of both the training and test loss during training by setting the <em>validation_data</em> argument in the fit() function. At the end of the run both the training and test loss are plotted.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4a7053449451" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># design network
model = Sequential()
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))
model.add(Dense(1))
model.compile(loss='mae', optimizer='adam')
# fit network
history = model.fit(train_X, train_y, epochs=50, batch_size=72, validation_data=(test_X, test_y), verbose=2, shuffle=False)
# plot history
pyplot.plot(history.history['loss'], label='train')
pyplot.plot(history.history['val_loss'], label='test')
pyplot.legend()
pyplot.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4a7053449451-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a7053449451-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4a7053449451-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a7053449451-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4a7053449451-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a7053449451-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4a7053449451-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a7053449451-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4a7053449451-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a7053449451-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e4a7053449451-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a7053449451-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4a7053449451-1"><span class="crayon-p"># design network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a7053449451-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4a7053449451-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a7053449451-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4a7053449451-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mae'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a7053449451-6"><span class="crayon-p"># fit network</span></div><div class="crayon-line" id="crayon-5c0eee933e4a7053449451-7"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">72</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a7053449451-8"><span class="crayon-p"># plot history</span></div><div class="crayon-line" id="crayon-5c0eee933e4a7053449451-9"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a7053449451-10"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4a7053449451-11"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a7053449451-12"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<h3>Evaluate Model</h3>
<p>After the model is fit, we can forecast for the entire test dataset.</p>
<p>We combine the forecast with the test dataset and invert the scaling. We also invert scaling on the test dataset with the expected pollution numbers.</p>
<p>With forecasts and actual values in their original scale, we can then calculate an error score for the model. In this case, we calculate the Root Mean Squared Error (RMSE) that gives error in the same units as the variable itself.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4a8919186706" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># make a prediction
yhat = model.predict(test_X)
test_X = test_X.reshape((test_X.shape[0], test_X.shape[2]))
# invert scaling for forecast
inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)
inv_yhat = scaler.inverse_transform(inv_yhat)
inv_yhat = inv_yhat[:,0]
# invert scaling for actual
test_y = test_y.reshape((len(test_y), 1))
inv_y = concatenate((test_y, test_X[:, 1:]), axis=1)
inv_y = scaler.inverse_transform(inv_y)
inv_y = inv_y[:,0]
# calculate RMSE
rmse = sqrt(mean_squared_error(inv_y, inv_yhat))
print('Test RMSE: %.3f' % rmse)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4a8919186706-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a8919186706-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4a8919186706-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a8919186706-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4a8919186706-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a8919186706-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4a8919186706-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a8919186706-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4a8919186706-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a8919186706-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e4a8919186706-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a8919186706-12">12</div><div class="crayon-num" data-line="crayon-5c0eee933e4a8919186706-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4a8919186706-14">14</div><div class="crayon-num" data-line="crayon-5c0eee933e4a8919186706-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4a8919186706-1"><span class="crayon-p"># make a prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a8919186706-2"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4a8919186706-3"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a8919186706-4"><span class="crayon-p"># invert scaling for forecast</span></div><div class="crayon-line" id="crayon-5c0eee933e4a8919186706-5"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a8919186706-6"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4a8919186706-7"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a8919186706-8"><span class="crayon-p"># invert scaling for actual</span></div><div class="crayon-line" id="crayon-5c0eee933e4a8919186706-9"><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a8919186706-10"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4a8919186706-11"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a8919186706-12"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_y</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4a8919186706-13"><span class="crayon-p"># calculate RMSE</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4a8919186706-14"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4a8919186706-15"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<h3>Complete Example</h3>
<p>The complete example is listed below.</p>
<p><strong>NOTE</strong>: This example assumes you have prepared the data correctly, e.g. converted the downloaded “<em>raw.csv</em>” to the prepared “<em>pollution.csv</em>“. See the first part of this tutorial.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4aa217034722" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from math import sqrt
from numpy import concatenate
from matplotlib import pyplot
from pandas import read_csv
from pandas import DataFrame
from pandas import concat
from sklearn.preprocessing import MinMaxScaler
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import mean_squared_error
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
 
# convert series to supervised learning
def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg
 
# load dataset
dataset = read_csv('pollution.csv', header=0, index_col=0)
values = dataset.values
# integer encode direction
encoder = LabelEncoder()
values[:,4] = encoder.fit_transform(values[:,4])
# ensure all data is float
values = values.astype('float32')
# normalize features
scaler = MinMaxScaler(feature_range=(0, 1))
scaled = scaler.fit_transform(values)
# frame as supervised learning
reframed = series_to_supervised(scaled, 1, 1)
# drop columns we don't want to predict
reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)
print(reframed.head())
 
# split into train and test sets
values = reframed.values
n_train_hours = 365 * 24
train = values[:n_train_hours, :]
test = values[n_train_hours:, :]
# split into input and outputs
train_X, train_y = train[:, :-1], train[:, -1]
test_X, test_y = test[:, :-1], test[:, -1]
# reshape input to be 3D [samples, timesteps, features]
train_X = train_X.reshape((train_X.shape[0], 1, train_X.shape[1]))
test_X = test_X.reshape((test_X.shape[0], 1, test_X.shape[1]))
print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)
 
# design network
model = Sequential()
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))
model.add(Dense(1))
model.compile(loss='mae', optimizer='adam')
# fit network
history = model.fit(train_X, train_y, epochs=50, batch_size=72, validation_data=(test_X, test_y), verbose=2, shuffle=False)
# plot history
pyplot.plot(history.history['loss'], label='train')
pyplot.plot(history.history['val_loss'], label='test')
pyplot.legend()
pyplot.show()
 
# make a prediction
yhat = model.predict(test_X)
test_X = test_X.reshape((test_X.shape[0], test_X.shape[2]))
# invert scaling for forecast
inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)
inv_yhat = scaler.inverse_transform(inv_yhat)
inv_yhat = inv_yhat[:,0]
# invert scaling for actual
test_y = test_y.reshape((len(test_y), 1))
inv_y = concatenate((test_y, test_X[:, 1:]), axis=1)
inv_y = scaler.inverse_transform(inv_y)
inv_y = inv_y[:,0]
# calculate RMSE
rmse = sqrt(mean_squared_error(inv_y, inv_yhat))
print('Test RMSE: %.3f' % rmse)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-12">12</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-14">14</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-16">16</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-18">18</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-20">20</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-22">22</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-24">24</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-26">26</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-28">28</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-30">30</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-32">32</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-34">34</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-36">36</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-38">38</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-40">40</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-42">42</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-44">44</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-46">46</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-48">48</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-50">50</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-52">52</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-54">54</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-56">56</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-58">58</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-60">60</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-62">62</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-64">64</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-66">66</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-68">68</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-70">70</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-72">72</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-74">74</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-76">76</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-78">78</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-80">80</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-82">82</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-84">84</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-86">86</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-88">88</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-90">90</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-92">92</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4aa217034722-94">94</div><div class="crayon-num" data-line="crayon-5c0eee933e4aa217034722-95">95</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">concatenate</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-5"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-6"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">LSTM</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-13"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-14"><span class="crayon-p"># convert series to supervised learning</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-15"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-16"><span class="crayon-h">	</span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-17"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-18"><span class="crayon-h">	</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-19"><span class="crayon-h">	</span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-20"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-21"><span class="crayon-h">		</span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-22"><span class="crayon-h">		</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-23"><span class="crayon-h">	</span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-24"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-25"><span class="crayon-h">		</span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-26"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-27"><span class="crayon-h">			</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-28"><span class="crayon-h">		</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-29"><span class="crayon-h">			</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-30"><span class="crayon-h">	</span><span class="crayon-p"># put it all together</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-31"><span class="crayon-h">	</span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-32"><span class="crayon-h">	</span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-33"><span class="crayon-h">	</span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-34"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-35"><span class="crayon-h">		</span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-36"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">agg</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-37"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-38"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-39"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'pollution.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-40"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">values</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-41"><span class="crayon-p"># integer encode direction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-42"><span class="crayon-v">encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-43"><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-44"><span class="crayon-p"># ensure all data is float</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-45"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-46"><span class="crayon-p"># normalize features</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-47"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-48"><span class="crayon-v">scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-49"><span class="crayon-p"># frame as supervised learning</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-50"><span class="crayon-v">reframed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-51"><span class="crayon-p"># drop columns we don't want to predict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-52"><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-cn">11</span><span class="crayon-sy">,</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-cn">15</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-53"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-54"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-55"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-56"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-57"><span class="crayon-v">n_train_hours</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">365</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">24</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-58"><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n_train_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-59"><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-v">n_train_hours</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-60"><span class="crayon-p"># split into input and outputs</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-61"><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-62"><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-63"><span class="crayon-p"># reshape input to be 3D [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-64"><span class="crayon-v">train_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-65"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-66"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-67"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-68"><span class="crayon-p"># design network</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-69"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-70"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-71"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-72"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mae'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-73"><span class="crayon-p"># fit network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-74"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">72</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-75"><span class="crayon-p"># plot history</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-76"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-77"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-78"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-79"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-80"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-81"><span class="crayon-p"># make a prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-82"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-83"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-84"><span class="crayon-p"># invert scaling for forecast</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-85"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-86"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-87"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-88"><span class="crayon-p"># invert scaling for actual</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-89"><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-90"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-91"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-92"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_y</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-93"><span class="crayon-p"># calculate RMSE</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4aa217034722-94"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4aa217034722-95"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0062 seconds] -->
<p>Running the example first creates a plot showing the train and test loss during training.</p>
<p>Interestingly, we can see that test loss drops below training loss. The model may be overfitting the training data. Measuring and plotting RMSE during training may shed more light on this.</p>
<div id="attachment_4197" style="width: 1034px" class="wp-caption aligncenter"><img class="size-large wp-image-4197" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/Line-Plot-of-Train-and-Test-Loss-from-the-Multivariate-LSTM-During-Training-1024x768.png" alt="Line Plot of Train and Test Loss from the Multivariate LSTM During Training" width="1024" height="768" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plot-of-Train-and-Test-Loss-from-the-Multivariate-LSTM-During-Training-1024x768.png 1024w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plot-of-Train-and-Test-Loss-from-the-Multivariate-LSTM-During-Training-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plot-of-Train-and-Test-Loss-from-the-Multivariate-LSTM-During-Training-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plot-of-Train-and-Test-Loss-from-the-Multivariate-LSTM-During-Training.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p class="wp-caption-text">Line Plot of Train and Test Loss from the Multivariate LSTM During Training</p></div>
<p>The Train and test loss are printed at the end of each training epoch. At the end of the run, the final RMSE of the model on the test dataset is printed.</p>
<p>We can see that the model achieves a respectable RMSE of 26.496, which is lower than an RMSE of 30 found with a persistence model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4ad998414208" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">...
Epoch 46/50
0s - loss: 0.0143 - val_loss: 0.0133
Epoch 47/50
0s - loss: 0.0143 - val_loss: 0.0133
Epoch 48/50
0s - loss: 0.0144 - val_loss: 0.0133
Epoch 49/50
0s - loss: 0.0143 - val_loss: 0.0133
Epoch 50/50
0s - loss: 0.0144 - val_loss: 0.0133
Test RMSE: 26.496</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4ad998414208-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4ad998414208-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4ad998414208-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4ad998414208-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4ad998414208-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4ad998414208-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4ad998414208-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4ad998414208-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4ad998414208-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4ad998414208-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e4ad998414208-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4ad998414208-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4ad998414208-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4ad998414208-2">Epoch 46/50</div><div class="crayon-line" id="crayon-5c0eee933e4ad998414208-3">0s - loss: 0.0143 - val_loss: 0.0133</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4ad998414208-4">Epoch 47/50</div><div class="crayon-line" id="crayon-5c0eee933e4ad998414208-5">0s - loss: 0.0143 - val_loss: 0.0133</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4ad998414208-6">Epoch 48/50</div><div class="crayon-line" id="crayon-5c0eee933e4ad998414208-7">0s - loss: 0.0144 - val_loss: 0.0133</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4ad998414208-8">Epoch 49/50</div><div class="crayon-line" id="crayon-5c0eee933e4ad998414208-9">0s - loss: 0.0143 - val_loss: 0.0133</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4ad998414208-10">Epoch 50/50</div><div class="crayon-line" id="crayon-5c0eee933e4ad998414208-11">0s - loss: 0.0144 - val_loss: 0.0133</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4ad998414208-12">Test RMSE: 26.496</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>This model is not tuned. Can you do better?<br>
Let me know your problem framing, model configuration, and RMSE in the comments below.</p>
<h2>Update: Train On Multiple Lag Timesteps Example</h2>
<p>There have been many requests for advice on how to adapt the above example to train the model on multiple previous time steps.</p>
<p>I had tried this and a myriad of other configurations when writing the original post and decided not to include them because they did not lift model skill.</p>
<p>Nevertheless, I have included this example below as reference template that you could adapt for your own problems.</p>
<p>The changes needed to train the model on multiple previous time steps are quite minimal, as follows:</p>
<p>First, you must frame the problem suitably when calling&nbsp;series_to_supervised(). We will use 3 hours of data as input. Also note, we no longer explictly drop the columns from all of the other fields at ob(t).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4af965895403" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># specify the number of lag hours
n_hours = 3
n_features = 8
# frame as supervised learning
reframed = series_to_supervised(scaled, n_hours, 1)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4af965895403-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4af965895403-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4af965895403-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4af965895403-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4af965895403-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4af965895403-1"><span class="crayon-p"># specify the number of lag hours</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4af965895403-2"><span class="crayon-v">n_hours</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5c0eee933e4af965895403-3"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4af965895403-4"><span class="crayon-p"># frame as supervised learning</span></div><div class="crayon-line" id="crayon-5c0eee933e4af965895403-5"><span class="crayon-v">reframed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Next, we need to be more careful in specifying the column for input and output.</p>
<p>We have 3 * 8 + 8 columns in our framed dataset. We will take 3 * 8 or 24 columns as input for the obs of all features across the previous 3 hours. We will take just the pollution variable as output at the following hour, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4b1080674703" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split into input and outputs
n_obs = n_hours * n_features
train_X, train_y = train[:, :n_obs], train[:, -n_features]
test_X, test_y = test[:, :n_obs], test[:, -n_features]
print(train_X.shape, len(train_X), train_y.shape)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4b1080674703-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b1080674703-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4b1080674703-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b1080674703-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4b1080674703-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4b1080674703-1"><span class="crayon-p"># split into input and outputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b1080674703-2"><span class="crayon-v">n_obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">n_hours *</span><span class="crayon-h"> </span><span class="crayon-e">n_features</span></div><div class="crayon-line" id="crayon-5c0eee933e4b1080674703-3"><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">n_obs</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b1080674703-4"><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">n_obs</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4b1080674703-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Next, we can reshape our input data correctly to reflect the time steps and features.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4b3315234991" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># reshape input to be 3D [samples, timesteps, features]
train_X = train_X.reshape((train_X.shape[0], n_hours, n_features))
test_X = test_X.reshape((test_X.shape[0], n_hours, n_features))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4b3315234991-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b3315234991-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4b3315234991-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4b3315234991-1"><span class="crayon-p"># reshape input to be 3D [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b3315234991-2"><span class="crayon-v">train_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b3315234991-3"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Fitting the model is the same.</p>
<p>The only other small change is in how to evaluate the model. Specifically, in how we reconstruct the rows with 8 columns suitable for reversing the scaling operation to get the y and yhat back into the original scale so that we can calculate the RMSE.</p>
<p>The gist of the change is that we concatenate the y or yhat column with the last 7 features of the test dataset in order to inverse the scaling, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4b4653026661" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># invert scaling for forecast
inv_yhat = concatenate((yhat, test_X[:, -7:]), axis=1)
inv_yhat = scaler.inverse_transform(inv_yhat)
inv_yhat = inv_yhat[:,0]
# invert scaling for actual
test_y = test_y.reshape((len(test_y), 1))
inv_y = concatenate((test_y, test_X[:, -7:]), axis=1)
inv_y = scaler.inverse_transform(inv_y)
inv_y = inv_y[:,0]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4b4653026661-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b4653026661-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4b4653026661-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b4653026661-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4b4653026661-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b4653026661-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4b4653026661-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b4653026661-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4b4653026661-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4b4653026661-1"><span class="crayon-p"># invert scaling for forecast</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b4653026661-2"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b4653026661-3"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b4653026661-4"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4b4653026661-5"><span class="crayon-p"># invert scaling for actual</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b4653026661-6"><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b4653026661-7"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b4653026661-8"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b4653026661-9"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_y</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>We can tie all of these modifications to the above example together. The complete example of multvariate time series forecasting with multiple lag inputs is listed below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4b6325785009" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from math import sqrt
from numpy import concatenate
from matplotlib import pyplot
from pandas import read_csv
from pandas import DataFrame
from pandas import concat
from sklearn.preprocessing import MinMaxScaler
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import mean_squared_error
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM

# convert series to supervised learning
def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg

# load dataset
dataset = read_csv('pollution.csv', header=0, index_col=0)
values = dataset.values
# integer encode direction
encoder = LabelEncoder()
values[:,4] = encoder.fit_transform(values[:,4])
# ensure all data is float
values = values.astype('float32')
# normalize features
scaler = MinMaxScaler(feature_range=(0, 1))
scaled = scaler.fit_transform(values)
# specify the number of lag hours
n_hours = 3
n_features = 8
# frame as supervised learning
reframed = series_to_supervised(scaled, n_hours, 1)
print(reframed.shape)

# split into train and test sets
values = reframed.values
n_train_hours = 365 * 24
train = values[:n_train_hours, :]
test = values[n_train_hours:, :]
# split into input and outputs
n_obs = n_hours * n_features
train_X, train_y = train[:, :n_obs], train[:, -n_features]
test_X, test_y = test[:, :n_obs], test[:, -n_features]
print(train_X.shape, len(train_X), train_y.shape)
# reshape input to be 3D [samples, timesteps, features]
train_X = train_X.reshape((train_X.shape[0], n_hours, n_features))
test_X = test_X.reshape((test_X.shape[0], n_hours, n_features))
print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)

# design network
model = Sequential()
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))
model.add(Dense(1))
model.compile(loss='mae', optimizer='adam')
# fit network
history = model.fit(train_X, train_y, epochs=50, batch_size=72, validation_data=(test_X, test_y), verbose=2, shuffle=False)
# plot history
pyplot.plot(history.history['loss'], label='train')
pyplot.plot(history.history['val_loss'], label='test')
pyplot.legend()
pyplot.show()

# make a prediction
yhat = model.predict(test_X)
test_X = test_X.reshape((test_X.shape[0], n_hours*n_features))
# invert scaling for forecast
inv_yhat = concatenate((yhat, test_X[:, -7:]), axis=1)
inv_yhat = scaler.inverse_transform(inv_yhat)
inv_yhat = inv_yhat[:,0]
# invert scaling for actual
test_y = test_y.reshape((len(test_y), 1))
inv_y = concatenate((test_y, test_X[:, -7:]), axis=1)
inv_y = scaler.inverse_transform(inv_y)
inv_y = inv_y[:,0]
# calculate RMSE
rmse = sqrt(mean_squared_error(inv_y, inv_yhat))
print('Test RMSE: %.3f' % rmse)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-12">12</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-14">14</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-16">16</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-18">18</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-20">20</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-22">22</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-24">24</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-26">26</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-28">28</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-30">30</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-32">32</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-34">34</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-36">36</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-38">38</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-40">40</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-42">42</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-44">44</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-46">46</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-48">48</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-50">50</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-52">52</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-54">54</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-56">56</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-58">58</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-60">60</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-62">62</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-64">64</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-66">66</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-68">68</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-70">70</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-72">72</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-74">74</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-76">76</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-78">78</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-80">80</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-82">82</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-84">84</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-86">86</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-88">88</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-90">90</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-92">92</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-94">94</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-96">96</div><div class="crayon-num" data-line="crayon-5c0eee933e4b6325785009-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b6325785009-98">98</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">concatenate</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-5"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-6"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">LSTM</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-14"><span class="crayon-p"># convert series to supervised learning</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-15"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-16"><span class="crayon-h">	</span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-17"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-18"><span class="crayon-h">	</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-19"><span class="crayon-h">	</span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-20"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-21"><span class="crayon-h">		</span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-22"><span class="crayon-h">		</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-23"><span class="crayon-h">	</span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-24"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-25"><span class="crayon-h">		</span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-26"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-27"><span class="crayon-h">			</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-28"><span class="crayon-h">		</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-29"><span class="crayon-h">			</span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-30"><span class="crayon-h">	</span><span class="crayon-p"># put it all together</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-31"><span class="crayon-h">	</span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-32"><span class="crayon-h">	</span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-33"><span class="crayon-h">	</span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-34"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-35"><span class="crayon-h">		</span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-36"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">agg</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-38"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-39"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'pollution.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-40"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">values</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-41"><span class="crayon-p"># integer encode direction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-42"><span class="crayon-v">encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-43"><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-44"><span class="crayon-p"># ensure all data is float</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-45"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-46"><span class="crayon-p"># normalize features</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-47"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-48"><span class="crayon-v">scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-49"><span class="crayon-p"># specify the number of lag hours</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-50"><span class="crayon-v">n_hours</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-51"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-52"><span class="crayon-p"># frame as supervised learning</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-53"><span class="crayon-v">reframed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-54"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-56"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-57"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-58"><span class="crayon-v">n_train_hours</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">365</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">24</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-59"><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n_train_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-60"><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-v">n_train_hours</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-61"><span class="crayon-p"># split into input and outputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-62"><span class="crayon-v">n_obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">n_hours *</span><span class="crayon-h"> </span><span class="crayon-e">n_features</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-63"><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">n_obs</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-64"><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">n_obs</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-65"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-66"><span class="crayon-p"># reshape input to be 3D [samples, timesteps, features]</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-67"><span class="crayon-v">train_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-68"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-69"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-70">&nbsp;</div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-71"><span class="crayon-p"># design network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-72"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-73"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-74"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-75"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mae'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-76"><span class="crayon-p"># fit network</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-77"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">72</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-78"><span class="crayon-p"># plot history</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-79"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-80"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-81"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-82"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-83">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-84"><span class="crayon-p"># make a prediction</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-85"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-86"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">n_hours*</span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-87"><span class="crayon-p"># invert scaling for forecast</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-88"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-89"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-90"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-91"><span class="crayon-p"># invert scaling for actual</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-92"><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-93"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-94"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-95"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_y</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-96"><span class="crayon-p"># calculate RMSE</span></div><div class="crayon-line" id="crayon-5c0eee933e4b6325785009-97"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b6325785009-98"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0060 seconds] -->
<p>The model is fit as before in a minute or two.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4b8295557215" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">...
Epoch 45/50
1s - loss: 0.0143 - val_loss: 0.0154
Epoch 46/50
1s - loss: 0.0143 - val_loss: 0.0148
Epoch 47/50
1s - loss: 0.0143 - val_loss: 0.0152
Epoch 48/50
1s - loss: 0.0143 - val_loss: 0.0151
Epoch 49/50
1s - loss: 0.0143 - val_loss: 0.0152
Epoch 50/50
1s - loss: 0.0144 - val_loss: 0.0149</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4b8295557215-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b8295557215-2">2</div><div class="crayon-num" data-line="crayon-5c0eee933e4b8295557215-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b8295557215-4">4</div><div class="crayon-num" data-line="crayon-5c0eee933e4b8295557215-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b8295557215-6">6</div><div class="crayon-num" data-line="crayon-5c0eee933e4b8295557215-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b8295557215-8">8</div><div class="crayon-num" data-line="crayon-5c0eee933e4b8295557215-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b8295557215-10">10</div><div class="crayon-num" data-line="crayon-5c0eee933e4b8295557215-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee933e4b8295557215-12">12</div><div class="crayon-num" data-line="crayon-5c0eee933e4b8295557215-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4b8295557215-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b8295557215-2">Epoch 45/50</div><div class="crayon-line" id="crayon-5c0eee933e4b8295557215-3">1s - loss: 0.0143 - val_loss: 0.0154</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b8295557215-4">Epoch 46/50</div><div class="crayon-line" id="crayon-5c0eee933e4b8295557215-5">1s - loss: 0.0143 - val_loss: 0.0148</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b8295557215-6">Epoch 47/50</div><div class="crayon-line" id="crayon-5c0eee933e4b8295557215-7">1s - loss: 0.0143 - val_loss: 0.0152</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b8295557215-8">Epoch 48/50</div><div class="crayon-line" id="crayon-5c0eee933e4b8295557215-9">1s - loss: 0.0143 - val_loss: 0.0151</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b8295557215-10">Epoch 49/50</div><div class="crayon-line" id="crayon-5c0eee933e4b8295557215-11">1s - loss: 0.0143 - val_loss: 0.0152</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee933e4b8295557215-12">Epoch 50/50</div><div class="crayon-line" id="crayon-5c0eee933e4b8295557215-13">1s - loss: 0.0144 - val_loss: 0.0149</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>A plot of train and test loss over the epochs is plotted.</p>
<div id="attachment_4594" style="width: 1290px" class="wp-caption aligncenter"><img class="size-full wp-image-4594" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/Plot-of-Loss-on-the-Train-and-Test-Datasets.png" alt="Plot of Loss on the Train and Test Datasets" width="1280" height="960" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Plot-of-Loss-on-the-Train-and-Test-Datasets.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Plot-of-Loss-on-the-Train-and-Test-Datasets-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Plot-of-Loss-on-the-Train-and-Test-Datasets-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Plot-of-Loss-on-the-Train-and-Test-Datasets-1024x768.png 1024w" sizes="(max-width: 1280px) 100vw, 1280px"><p class="wp-caption-text">Plot of Loss on the Train and Test Datasets</p></div>
<p>Finally, the Test RMSE is printed, not really showing any advantage in skill, at least on this problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee933e4bb429899126" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Test RMSE: 27.177</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee933e4bb429899126-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee933e4bb429899126-1">Test RMSE: 27.177</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>I would add that the LSTM <a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/">does not appear to be suitable for autoregression type problems</a> and that you may be better off exploring an MLP with a large window.</p>
<p>I hope this example helps you with your own time series forecasting experiments.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<ul>
<li><a href="https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data">Beijing PM2.5 Data Set on the UCI Machine Learning Repository</a></li>
<li><a href="http://machinelearningmastery.com/5-step-life-cycle-long-short-term-memory-models-keras/">The 5 Step Life-Cycle for Long Short-Term Memory Models in Keras</a></li>
<li><a href="http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/">Time Series Forecasting with the Long Short-Term Memory Network in Python</a></li>
<li><a href="http://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/">Multi-step Time Series Forecasting with Long Short-Term Memory Networks in Python</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to fit an LSTM to a multivariate time series forecasting problem.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to transform a raw dataset into something we can use for time series forecasting.</li>
<li>How to prepare data and fit an LSTM for a multivariate time series forecasting problem.</li>
<li>How to make a forecast and rescale the result back into the original units.</li>
</ul>
<p>Do you have any questions?<br>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-52">			<div class="textwidget"><p></p><center><br>
<div class="woo-sc-hr"></div><p></p>
<h2>Develop Deep Learning models for Time Series Today!</h2>
<p><a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/"><img style="border: 0;" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/Cover-220.png" alt="Deep Learning for Time Series Forecasting" align="left"></a></p>
<h4>Develop Your Own Forecasting models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br>
<a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/">Deep Learning for Time Series Forecasting</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like: <em>CNNs</em>, <em>LSTMs</em>,<br>
<em>Multivariate Forecasting</em>, <em>Multi-Step Forecasting</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Time Series Forecasting Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/">Click to learn more</a>.<br>
</p><div class="woo-sc-hr"></div><br>
</center><p></p>
</div>
		</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4195 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Multivariate+Time+Series+Forecasting+with+LSTMs+in+Keras&amp;url=https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" width="30px" height="18px" viewBox="-10 -6 60 36" class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
						<span class="simplesocialtxt">Google Plus </span></button>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/get-the-most-out-of-lstms/" rel="prev"><i class="fa fa-angle-left"></i> Get the Most out of LSTMs on Your Sequence Prediction Problem</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/long-short-term-memory-recurrent-neural-networks-mini-course/" rel="next">Mini-Course on Long Short-Term Memory Recurrent Neural Networks with Keras <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">1,228 Responses to <em>Multivariate Time Series Forecasting with LSTMs in Keras</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-409580" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-409580" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/83f49a8da1dc030d9f671f521839aecc.png" srcset="https://secure.gravatar.com/avatar/83f49a8da1dc030d9f671f521839aecc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">zorg</span>
	                <span class="date">August 14, 2017 at 7:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409580" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>except wind *dir*, which is categorical.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409580" onclick="return addComment.moveForm( &quot;comment-409580&quot;, &quot;409580&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to zorg">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409630" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-409630" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2017 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409630" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, fixed!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409630" onclick="return addComment.moveForm( &quot;comment-409630&quot;, &quot;409630&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426240" class="comment even depth-3 parent">

	      	<div id="li-comment-426240" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2121b2fe75956d9f677a3ee43b5f68cd.png" srcset="https://secure.gravatar.com/avatar/2121b2fe75956d9f677a3ee43b5f68cd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">bhupesh</span>
	                <span class="date">January 12, 2018 at 4:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426240" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how to use grid search for neurons</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426240" onclick="return addComment.moveForm( &quot;comment-426240&quot;, &quot;426240&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to bhupesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426243" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-426243" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2121b2fe75956d9f677a3ee43b5f68cd.png" srcset="https://secure.gravatar.com/avatar/2121b2fe75956d9f677a3ee43b5f68cd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">bhupesh</span>
	                <span class="date">January 12, 2018 at 4:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426243" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I want to apply grid search in this to tune neurons and add layers</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426243" onclick="return addComment.moveForm( &quot;comment-426243&quot;, &quot;426243&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to bhupesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426244" class="comment even depth-5">

	      	<div id="li-comment-426244" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2121b2fe75956d9f677a3ee43b5f68cd.png" srcset="https://secure.gravatar.com/avatar/2121b2fe75956d9f677a3ee43b5f68cd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">lstm</span>
	                <span class="date">January 12, 2018 at 4:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426244" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>and to find best parameters</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426262" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-426262" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 12, 2018 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426262" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br>
<a href="https://machinelearningmastery.com/tune-lstm-hyperparameters-keras-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/tune-lstm-hyperparameters-keras-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426262" onclick="return addComment.moveForm( &quot;comment-426262&quot;, &quot;426262&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426562" class="comment even depth-3 parent">

	      	<div id="li-comment-426562" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/23c18392020cfc14e5a519df53d3f6d6.png" srcset="https://secure.gravatar.com/avatar/23c18392020cfc14e5a519df53d3f6d6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">qing</span>
	                <span class="date">January 15, 2018 at 3:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426562" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello Jason,<br>
   I have run the code in my spyder and I know the RMSE index is good enough for this model. However, I added the accuracy index in this code, that is<br>
model.compile(loss=’mae’, optimizer=’adam’, metrics=[‘accuracy’])<br>
and the accuracy is totally the same in each epoch and is very low (0.0761). I also use my own data to run your code, and the result is the same, with good RMSE values but bad accuracy. I have troubled by this for several days and looking forward to your reply.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426562" onclick="return addComment.moveForm( &quot;comment-426562&quot;, &quot;426562&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to qing">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426586" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-426586" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 15, 2018 at 7:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426586" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You cannot measure accuracy for regression.</p>
<p>Learn more here:<br>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426586" onclick="return addComment.moveForm( &quot;comment-426586&quot;, &quot;426586&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449324" class="comment even depth-3 parent">

	      	<div id="li-comment-449324" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mike</span>
	                <span class="date">September 19, 2018 at 5:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449324" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi，Jason，I‘m a new learner. There is no real curve and predicted curve in your tutorial.<br>
I want to know how can I get it? I mean how to write it in the code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449324" onclick="return addComment.moveForm( &quot;comment-449324&quot;, &quot;449324&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mike">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449361" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-449361" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 20, 2018 at 7:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449361" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t understand your question Mike, can you elaborate?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449361" onclick="return addComment.moveForm( &quot;comment-449361&quot;, &quot;449361&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449703" class="comment even depth-5">

	      	<div id="li-comment-449703" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/36261767fbf58016d7e573a8748cd390.png" srcset="https://secure.gravatar.com/avatar/36261767fbf58016d7e573a8748cd390?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ramon</span>
	                <span class="date">September 25, 2018 at 12:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449703" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I guess he means the predicted value vs ground truth chart.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-449730" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-449730" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2018 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449730" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see.</p>
<p>You can call model.predict() to get yhat and create a line plot with y and yhat.</p>
<p>I have done this in some other tutorials, for example:<br>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/</a></p>
<p>If this is a challenge for you, I would suggest this tutorial is too advanced for you and I would encourage you to start with intro to time series here:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409643" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-409643" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/efa60fdb1f6da2ef73708fd9280261e3.png" srcset="https://secure.gravatar.com/avatar/efa60fdb1f6da2ef73708fd9280261e3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Francois AKOA</span>
	                <span class="date">August 15, 2017 at 7:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409643" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great post Jason. Thank you so much for making this material available for the community..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409643" onclick="return addComment.moveForm( &quot;comment-409643&quot;, &quot;409643&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Francois AKOA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409686" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-409686" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2017 at 4:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409686" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Francois, I’m glad it helped!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409686" onclick="return addComment.moveForm( &quot;comment-409686&quot;, &quot;409686&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409671" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-409671" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/67c08b6eb801051e99c97943dba481b4.png" srcset="https://secure.gravatar.com/avatar/67c08b6eb801051e99c97943dba481b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow" class="url">yao</a></span>
	                <span class="date">August 15, 2017 at 2:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409671" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, jason. There were some problems under my environment which were keras2.0.4and tensorflow-GPU0.12.0rc0. </p>
<p>And Bug was that “TypeError: Expected int32, got list containing Tensors of type ‘_Message’ instead.” </p>
<p>The sentence that “model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))” was located.</p>
<p>Could you please help me with that?</p>
<p>Regards,</p>
<p>yao</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409671" onclick="return addComment.moveForm( &quot;comment-409671&quot;, &quot;409671&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to yao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409687" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-409687" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2017 at 4:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409687" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend this tutorial for setting up your environment:<br>
<a href="http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow">http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409687" onclick="return addComment.moveForm( &quot;comment-409687&quot;, &quot;409687&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409836" class="comment even depth-3 parent">

	      	<div id="li-comment-409836" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/67c08b6eb801051e99c97943dba481b4.png" srcset="https://secure.gravatar.com/avatar/67c08b6eb801051e99c97943dba481b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow" class="url">yao</a></span>
	                <span class="date">August 16, 2017 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409836" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thx a lot, doctor, it works! fabulous! <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409836" onclick="return addComment.moveForm( &quot;comment-409836&quot;, &quot;409836&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to yao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409898" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-409898" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 17, 2017 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409898" onclick="return addComment.moveForm( &quot;comment-409898&quot;, &quot;409898&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410063" class="comment even depth-5">

	      	<div id="li-comment-410063" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a25919eee1afa3c64d6d94075c07154c.png" srcset="https://secure.gravatar.com/avatar/a25919eee1afa3c64d6d94075c07154c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shirley Yang</span>
	                <span class="date">August 18, 2017 at 12:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410063" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr.Jason, I update TensorFlow then it works!<br>
Sorry to bother you.<br>
Thank you very much !<br>
Best wishes !</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-410095" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-410095" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2017 at 4:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410095" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409964" class="comment even depth-4">

	      	<div id="li-comment-409964" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a25919eee1afa3c64d6d94075c07154c.png" srcset="https://secure.gravatar.com/avatar/a25919eee1afa3c64d6d94075c07154c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shirley Yang</span>
	                <span class="date">August 17, 2017 at 8:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409964" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I met the same problem .</p>
<p>Did you uninstall all the programs previously installed or just set up the environment again?</p>
<p>Thx a lot!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409964" onclick="return addComment.moveForm( &quot;comment-409964&quot;, &quot;409964&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Shirley Yang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410061" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-410061" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a25919eee1afa3c64d6d94075c07154c.png" srcset="https://secure.gravatar.com/avatar/a25919eee1afa3c64d6d94075c07154c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shirley Yang</span>
	                <span class="date">August 18, 2017 at 11:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410061" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,I set up my environment as the your tutorial.</p>
<p>scipy: 0.19.0<br>
numoy: 1.12.1<br>
matplotlib: 2.0.2<br>
pandas: 0.20.1<br>
statsmodels: 0.8.0<br>
sklearn: 0.18.1</p>
<p>theano: 0.9.0.dev-c697eeab84e5b8a74908da654b66ec9eca4f1291<br>
tensorflow: 0.12.1<br>
Using TensorFlow backend.<br>
keras: 2.0.5</p>
<p>But the bug still existed.Is the version of tensorFlow too odd?How could I do?<br>
Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410061" onclick="return addComment.moveForm( &quot;comment-410061&quot;, &quot;410061&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Shirley Yang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410093" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-410093" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2017 at 4:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410093" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It might be, I am running v1.2.1.</p>
<p>Perhaps try running Keras off Theano instead (e.g. change the backend in the ~/.keras.jason config)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410093" onclick="return addComment.moveForm( &quot;comment-410093&quot;, &quot;410093&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409715" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-409715" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/99ed31d9c853901ac7191acd878a068b.png" srcset="https://secure.gravatar.com/avatar/99ed31d9c853901ac7191acd878a068b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Songbin Xu</span>
	                <span class="date">August 15, 2017 at 10:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409715" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It seems that inv_y = scaler.inverse_transform(test_X)[:,0] is not the actual, should inv_yhat be compared with test_y but not pollution(t-1)? Because I think this inv_y here means pollution(t-1).  Is this prediction equals to only making a time shifting from the current known pollution value (which means the models just take pollution(t) as the prediction of pollution(t+1))?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409715" onclick="return addComment.moveForm( &quot;comment-409715&quot;, &quot;409715&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Songbin Xu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409755" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-409755" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2017 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409755" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I’m not sure I follow. Can you please restate your question, perhaps with an example?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409755" onclick="return addComment.moveForm( &quot;comment-409755&quot;, &quot;409755&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409837" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-409837" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/99ed31d9c853901ac7191acd878a068b.png" srcset="https://secure.gravatar.com/avatar/99ed31d9c853901ac7191acd878a068b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Songbin Xu</span>
	                <span class="date">August 16, 2017 at 7:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry for the confusing expression. In fact, the series_to_supervised()  function would create a DataFrame whose columns are: [ var1(t-1), var2(t-1), …, var1(t) ] where ‘var1’ represents ‘pollution’, therefore, the first dimension in test_X (that is, test_X[:,0]) would be ‘pollution(t-1)’. However, in the code you calculate the rmse between inv_yhat and test_X[:,0], even though the rmse is low, it could only shows that the model’s prediction for t+1 is close to what it has known at t.<br>
I am asking this question because I’ve ran through the codes and saw the models prediction pollution(t+1) looks just like pollution(t). I’ve also tried to use t-1, t-2 and so on for training, but still changed nothing.<br>
Do you think the model tends to learn to just take the pollution value at current moment as the prediction for the next moment?</p>
<p>thanks <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409837" onclick="return addComment.moveForm( &quot;comment-409837&quot;, &quot;409837&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Songbin Xu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409899" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-409899" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 17, 2017 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If we predict t for t+1 that is called persistence, and we show in the tutorial that the LSTM does a lot better than persistence.</p>
<p>Perhaps I don’t understand your question? Can you give me an example of what you are asking?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409899" onclick="return addComment.moveForm( &quot;comment-409899&quot;, &quot;409899&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409925" class="comment odd alt depth-5">

	      	<div id="li-comment-409925" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/99ed31d9c853901ac7191acd878a068b.png" srcset="https://secure.gravatar.com/avatar/99ed31d9c853901ac7191acd878a068b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Songbin Xu</span>
	                <span class="date">August 17, 2017 at 10:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409925" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hmm, it’s difficult to explain without a graph. </p>
<p>In a word, and also it’s an example, I want to ask two questions: </p>
<p>1. In the “make a prediction” part of your codes, why it computes rmse between predicted t+1 and real t, but not between predicted t+1 and real t+1? </p>
<p>2. After the “make a prediction” part of your codes run, it turns out that rmse between predicted t+1 and real t is small, is it an evidence that LSTM is making persistence?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-409950" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-409950" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 17, 2017 at 4:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409950" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>RMSE is calculated for y and yhat for the same time periods (well, that was the intent), why do you think they are not?</p>
<p>Is there a bug?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-410006" class="comment odd alt depth-5">

	      	<div id="li-comment-410006" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9cb2d2d955e04aaa55980d05b4159598.png" srcset="https://secure.gravatar.com/avatar/9cb2d2d955e04aaa55980d05b4159598?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">David Righart</span>
	                <span class="date">August 18, 2017 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410006" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think Songbin Xu is right. By executing the statement at line 90: inv_y = inv_y[:,0], you compare the inv_yhat with inv_y. inv_y is the polution(t-1) and inv_yhat is the predicted polution(t).</p>
<p>On line 50 the second parameter the function series_to_supervised can be changed to 3 or 5, so more days of history are used. If you do so, an error occurs in the scaler.inverse_transform (line 89).</p>
<p>No worries, great tutorial and I learned a lot so far!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-410028" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-410028" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2017 at 6:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410028" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see now, you guys are 100% correct. Thank you!</p>
<p>I have updated the calculation of RMSE and the final score reported in the post.</p>
<p>Note, I ran a ton of experiments on AWS with many different lag values &gt; 1 and none achieved better results than a simple lag=1 model (e.g. an LSTM model with no BPTT). I see this as a bad sign for the use of LSTMs for autoregression problems.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409728" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-409728" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a711cbfc1f33a66dd2114f9da3b9cf13.png" srcset="https://secure.gravatar.com/avatar/a711cbfc1f33a66dd2114f9da3b9cf13?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Simone</span>
	                <span class="date">August 16, 2017 at 1:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409728" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, great post!</p>
<p>Is it necessary remove seasonality (by seasonal differentiation) when we are using LSTM?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409728" onclick="return addComment.moveForm( &quot;comment-409728&quot;, &quot;409728&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Simone">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409760" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-409760" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2017 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409760" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, but results are often better.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409760" onclick="return addComment.moveForm( &quot;comment-409760&quot;, &quot;409760&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409746" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-409746" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6530754bf9385ad8a58fcb0521418317.png" srcset="https://secure.gravatar.com/avatar/6530754bf9385ad8a58fcb0521418317?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Slavenya</span>
	                <span class="date">August 16, 2017 at 5:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409746" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good article, thank. </p>
<p>Two questions:<br>
What changes will be required if your data is sporadic? Meaning sometimes it could be 5 hours without the report.</p>
<p>And how do you add more timesteps into your model? Obviously you have to reshape it properly but you also have to calculate it properly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409746" onclick="return addComment.moveForm( &quot;comment-409746&quot;, &quot;409746&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Slavenya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409763" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-409763" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2017 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409763" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could fill in the missing data by imputing or ignore the gaps using masking.</p>
<p>What do you mean by “add more timesteps”?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409763" onclick="return addComment.moveForm( &quot;comment-409763&quot;, &quot;409763&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409832" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-409832" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6530754bf9385ad8a58fcb0521418317.png" srcset="https://secure.gravatar.com/avatar/6530754bf9385ad8a58fcb0521418317?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Slavenya</span>
	                <span class="date">August 16, 2017 at 7:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409832" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>But what should I do if all data is stochastic time sequence?</p>
<p>For example predicting time till the next event – when events frequency is stochastically distributed on the timeline.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409832" onclick="return addComment.moveForm( &quot;comment-409832&quot;, &quot;409832&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Slavenya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409896" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-409896" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 17, 2017 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, this sounds like survival analysis to me, perhaps see if it applies:<br>
<a href="https://en.wikipedia.org/wiki/Survival_analysis" rel="nofollow">https://en.wikipedia.org/wiki/Survival_analysis</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409896" onclick="return addComment.moveForm( &quot;comment-409896&quot;, &quot;409896&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409748" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-409748" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bf2c5c24800dc323de5ac11cb41b354d.png" srcset="https://secure.gravatar.com/avatar/bf2c5c24800dc323de5ac11cb41b354d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack Dan</span>
	                <span class="date">August 16, 2017 at 5:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409748" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr.Jason,</p>
<p>Thank you for an awesome post.<br>
(I was practicing on load forecast using MLP and SVR (You also suggested on a comment in your other LSTM tutorials). I also tried with LSTM and it did almost perform like SVR. However, in LSTM, I did not consider time lags because I have predicted future predictor variables that I was feeding as test set. I will try this method with time lags to cross validate the models)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409748" onclick="return addComment.moveForm( &quot;comment-409748&quot;, &quot;409748&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409765" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-409765" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2017 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409765" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice Jack, let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409765" onclick="return addComment.moveForm( &quot;comment-409765&quot;, &quot;409765&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409798" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-409798" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f56af564eb8e47087e90d539d7349bee.png" srcset="https://secure.gravatar.com/avatar/f56af564eb8e47087e90d539d7349bee?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adam</span>
	                <span class="date">August 16, 2017 at 1:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409798" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can I use ‘look back'(Using t-2 , t-1 steps data to predict t step air pollution) in this case?<br>
If it’s available,that my input data shape will be [samples , look back ,  features] isn’t it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409798" onclick="return addComment.moveForm( &quot;comment-409798&quot;, &quot;409798&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Adam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409819" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-409819" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2017 at 5:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409819" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can Adam, see the series_to_supervised() function and its usage in the tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409819" onclick="return addComment.moveForm( &quot;comment-409819&quot;, &quot;409819&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410106" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-410106" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f56af564eb8e47087e90d539d7349bee.png" srcset="https://secure.gravatar.com/avatar/f56af564eb8e47087e90d539d7349bee?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adam</span>
	                <span class="date">August 18, 2017 at 6:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410106" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>If I used n_in=5 in series_to_supervised() function,in your tutorial the input shape will be [samples, 1 , features*5].Can I reshape it to [samples, 5 , features]?If I can, what is the difference between these two shape?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410106" onclick="return addComment.moveForm( &quot;comment-410106&quot;, &quot;410106&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Adam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410175" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-410175" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 19, 2017 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410175" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The second dimension is time steps (e.g. BPTT) and the third dimension are the features (e.g. observations at each time step). You can use features as time steps, but it would not really make sense and I expect performance to be poor.</p>
<p>Here’s how to build a model multiple time steps for multiple features:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee935dc5c156697714" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># specify number of hours
n_hours = 2
reframed = series_to_supervised(scaled, n_hours, 1)
...

# no longer just drop those columns
# reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)
# print(reframed.head())
...

# be more careful about choosing columns for input and output
n_features = 7
n_obs = n_hours * n_features
train_X, train_y = train[:, 0:n_obs], train[:, -n_features]
test_X, test_y = test[:, 0:n_obs], test[:, -n_features]
# reshape input to be 3D [samples, timesteps, features]
train_X = train_X.reshape((train_X.shape[0], n_hours, n_features))
test_X = test_X.reshape((test_X.shape[0], n_hours, n_features))
print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)
...</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-2">2</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-4">4</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-6">6</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-8">8</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-10">10</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-12">12</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-14">14</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-16">16</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-18">18</div><div class="crayon-num" data-line="crayon-5c0eee935dc5c156697714-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935dc5c156697714-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-1"><span class="crayon-p"># specify number of hours</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-2"><span class="crayon-v">n_hours</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-3"><span class="crayon-v">reframed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-4"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-6"><span class="crayon-p"># no longer just drop those columns</span></div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-7"><span class="crayon-p"># reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-8"><span class="crayon-p"># print(reframed.head())</span></div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-9"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-10">&nbsp;</div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-11"><span class="crayon-p"># be more careful about choosing columns for input and output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-12"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-13"><span class="crayon-v">n_obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">n_hours *</span><span class="crayon-h"> </span><span class="crayon-e">n_features</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-14"><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">n_obs</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-15"><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">n_obs</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-16"><span class="crayon-p"># reshape input to be 3D [samples, timesteps, features]</span></div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-17"><span class="crayon-v">train_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-18"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee935dc5c156697714-19"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935dc5c156697714-20"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>And that’s it. I just tested and it looks good. The RMSE calculation will blow up, but you guys can fix that up I figure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410175" onclick="return addComment.moveForm( &quot;comment-410175&quot;, &quot;410175&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410274" class="comment odd alt depth-5">

	      	<div id="li-comment-410274" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7107d96686aa8347c583343cf0bd4607.jpeg" srcset="https://secure.gravatar.com/avatar/7107d96686aa8347c583343cf0bd4607?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.linkedin.com/in/georgeakhoury" rel="external nofollow" class="url">George Khoury</a></span>
	                <span class="date">August 19, 2017 at 11:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410274" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, great post, very clear, and very useful!! I’m about 90% with you and think a few folks may be stuck on this final point if they try to implement multi-feature, multi-hour-lookback LSTM.</p>
<p>Seems like by making adjustments above, I’m able to make a prediction, but the scaling  inversion doesn’t want to cooperate. The reshape step now that we have multiple features and multiple timesteps has a mismatch in the shape, and even if I make the shape work, the concatenation and inversion still don’t work. Could you share what else you changed in this section to make it work? I’m not so concerned about the RMSE as much as that I can extract useful predictions. Thank you for any insight since you’ve been able to do it successfully.</p>
<p># make a prediction<br>
yhat = model.predict(test_X)<br>
test_X = test_X.reshape((test_X.shape[0], test_X.shape[2]))<br>
# invert scaling for forecast<br>
inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)<br>
inv_yhat = scaler.inverse_transform(inv_yhat)<br>
inv_yhat = inv_yhat[:,0]</p>
<p>…</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-412090" class="comment even depth-5">

	      	<div id="li-comment-412090" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/27e305af951a8352f9e6f51a9a571925.jpeg" srcset="https://secure.gravatar.com/avatar/27e305af951a8352f9e6f51a9a571925?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lg</span>
	                <span class="date">September 2, 2017 at 12:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412090" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great and useful article.</p>
<p>I am somewhat puzzled by the number of features you specify to forecast the pollution rate based on data from the previous 24 hours.</p>
<p>Do not we have 8 features for each time-step and not 7? </p>
<p>After generating data to supervise with the function series_to_supervised(scaled,24, 1), the resulting array has a shape of (43800, 200) which is 25 * 8. </p>
<p>To invert the scaling for forecast I made few modifications. I used scaled.shape[1] below but in my opinion it could be n_features. Moreover, I don’t know if the values concatenated to yhat and test_y really matter, as long as they have been scaled with fit_transform and the array has the right shape.</p>
<p>yhat = model.predict(test_X)<br>
test_X = test_X.reshape((test_X.shape[0], n_obs))</p>
<p># invert scaling for forecast<br>
inv_yhat = concatenate((yhat, test_X[:, 1:scaled.shape[1]]), axis=1)<br>
inv_yhat = scaler.inverse_transform(inv_yhat)<br>
inv_yhat = inv_yhat[:,0]</p>
<p># invert scaling for actual<br>
test_y = test_y.reshape((len(test_y), 1))<br>
inv_y = concatenate((test_y, test_X[:, 1:scaled.shape[1]]), axis=1)<br>
inv_y = scaler.inverse_transform(inv_y)<br>
inv_y = inv_y[:,0]</p>
<p>The model has 4 layers with dropout.<br>
After 200 epochs I have got<br>
loss: 0.0169 – val_loss: 0.0162<br>
And a rmse = 29.173 </p>
<p>Regards.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-412121" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-412121" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 2, 2017 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412121" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We have 7 features because we drop one in section “2. Basic Data Preparation”.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-412266" class="comment even depth-5">

	      	<div id="li-comment-412266" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/27e305af951a8352f9e6f51a9a571925.jpeg" srcset="https://secure.gravatar.com/avatar/27e305af951a8352f9e6f51a9a571925?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">lg</span>
	                <span class="date">September 2, 2017 at 5:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412266" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>It’s really weird to me :(, as I used your code to prepare the data (pollution.csv) and I have 9 fields in the resulting file.   </p>
<p>[date, pollution, dew,  temp, press, wnd_dir,  wnd_spd,  snow,  rain]</p>
<p><img draggable="false" class="emoji" alt="😯" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f62f.svg"></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-412343" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-412343" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2017 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Date and wind direction are dropped during data preparation, perhaps you accidentally skipped a step or are reviewing a different file from the output file?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-412414" class="comment even depth-5">

	      	<div id="li-comment-412414" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/27e305af951a8352f9e6f51a9a571925.jpeg" srcset="https://secure.gravatar.com/avatar/27e305af951a8352f9e6f51a9a571925?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lg</span>
	                <span class="date">September 3, 2017 at 6:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>So that’s fine, in my case I have 8 features.</p>
<p>When reading the file, the field ‘date’ becomes the index of the dataframe and the field ‘wnd_dir’ is later label encoded, as you do above in “The complete example” lines 42-43.</p>
<p>It is now much clearer for me. I am not puzzled anymore. <img draggable="false" class="emoji" alt="😉" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f609.svg"> </p>
<p>Thanks a lot for all the information contained in your articles and your e-books. </p>
<p>They are really very informative.</p>
<p><img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-412462" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-412462" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 4, 2017 at 4:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412462" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-414370" class="comment even depth-5">

	      	<div id="li-comment-414370" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f40067945bead7bb1fc08b4c7efbbdc4.png" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Cloud</span>
	                <span class="date">September 20, 2017 at 8:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414370" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I think the output is column var1(t), that means:<br>
train_X, train_y = train[:, 0:n_obs], train[:, -(n_features+1)]<br>
am I right?<br>
In case the “pollution” is in the last column, it is easy to get train[:, -1]<br>
am i right?<br>
I just want to verify that I understand your post.<br>
Thank you, Jason</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-416338" class="comment odd alt depth-5">

	      	<div id="li-comment-416338" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/903c36c55f2a28cbb668176cd7d40522.png" srcset="https://secure.gravatar.com/avatar/903c36c55f2a28cbb668176cd7d40522?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hesam</span>
	                <span class="date">October 11, 2017 at 9:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416338" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some confusion for this problem.</p>
<p>I want to use a bigger windows (I want to go back in time more, for example t-5 to include more data to make a prediction of the time t) and use all of this to predict one variable (such as just the pollution), like you did. I think predicting one variable will be more accurate than predicting many. Such as pollution and temperature.</p>
<p>What should I do to apply more shift?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-416381" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-416381" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 12, 2017 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416381" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I show in another comment how to update the example to use lab obs as input.</p>
<p>I will update the post and add an example to make it clearer.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-417190" class="comment odd alt depth-5">

	      	<div id="li-comment-417190" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/081542682233da03e2ec82ff7651cfa5.png" srcset="https://secure.gravatar.com/avatar/081542682233da03e2ec82ff7651cfa5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kentor</span>
	                <span class="date">October 19, 2017 at 10:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417190" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>First of all, thanks for your work and the effort you put in!</p>
<p>I tried to implement your suggestion for increasing the timesteps (BPTT). I have intergrated your code but I keep getting this error in when reshaping test_X in the prediction step:</p>
<p>test_X = test_X.reshape((test_X.shape[0], test_X.shape[2]))<br>
ValueError: cannot reshape array of size 490532 into shape (35038,7)</p>
<p>Do you have any tips on how to proceed?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-417216" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-417216" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 20, 2017 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417216" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I will update the post with a worked example. Adding to trello now…</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-420993" class="comment odd alt depth-5">

	      	<div id="li-comment-420993" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2b8c36151c79cd1440b7c1031fafd3f9.png" srcset="https://secure.gravatar.com/avatar/2b8c36151c79cd1440b7c1031fafd3f9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://-/" rel="external nofollow" class="url">Robert Dan</a></span>
	                <span class="date">November 23, 2017 at 10:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420993" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason.<br>
  In the code you wrote above, should the following code:</p>
<p>train_X = train_X.reshape((train_X.shape[0], n_hours, n_features))</p>
<p>be actually</p>
<p>train_X = train_X.reshape((train_X.shape[0]/n_hours, n_hours, n_features))</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-421040" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-421040" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2017 at 9:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why is that?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409989" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-409989" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/18cde149f64575c684ac6499ed1463ce.png" srcset="https://secure.gravatar.com/avatar/18cde149f64575c684ac6499ed1463ce?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arun</span>
	                <span class="date">August 18, 2017 at 12:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409989" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I get the following error from line # 82 of your ‘Complete Example’ code.</p>
<p>ValueError: Error when checking : expected lstm_1_input to have 3 dimensions, but got array with shape (34895, 8)</p>
<p>I think LSTM() is looking for (sequences, timesteps, dimensions).  In your code, line # 70, I believe 50 is timesteps while input_shape (1,8) represents the dimensions.  May be it’s missing ‘sequences’ ?</p>
<p>Appreciate your response.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409989" onclick="return addComment.moveForm( &quot;comment-409989&quot;, &quot;409989&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Arun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410022" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-410022" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2017 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ensure that you first prepare the data (e.g. convert “raw.csv” to “pollution.csv”).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410022" onclick="return addComment.moveForm( &quot;comment-410022&quot;, &quot;410022&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-428063" class="comment odd alt depth-2">

	      	<div id="li-comment-428063" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2d0d8b7dab042f768a39ba9b49e681d6.png" srcset="https://secure.gravatar.com/avatar/2d0d8b7dab042f768a39ba9b49e681d6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sameer</span>
	                <span class="date">January 31, 2018 at 11:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428063" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have the same error too. Cannot figure out what’s wrong</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428063" onclick="return addComment.moveForm( &quot;comment-428063&quot;, &quot;428063&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sameer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-452739" class="comment even depth-2 parent">

	      	<div id="li-comment-452739" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/994db2d606d77cf605f00eb2dc1f4a5b.png" srcset="https://secure.gravatar.com/avatar/994db2d606d77cf605f00eb2dc1f4a5b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Edward</span>
	                <span class="date">October 26, 2018 at 2:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452739" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Greetings Sir..</p>
<p>I’ve run into the same problem as well. And I’m confident that I’m using “pollution.csv” data.. How can I rectify this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452739" onclick="return addComment.moveForm( &quot;comment-452739&quot;, &quot;452739&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Edward">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452763" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-452763" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 26, 2018 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452763" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452763" onclick="return addComment.moveForm( &quot;comment-452763&quot;, &quot;452763&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409995" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-409995" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/584ad99335f9602fc42d4330df7032ba.png" srcset="https://secure.gravatar.com/avatar/584ad99335f9602fc42d4330df7032ba?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neal Valiant</span>
	                <span class="date">August 18, 2017 at 2:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409995" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I am wondering what the issue that  I’m getting is caused by, maybe a different type of dataset then the example one. basically when I run the history into the model, When i check the History.history.keys() I only get back ‘loss’ as my only key.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-409995" onclick="return addComment.moveForm( &quot;comment-409995&quot;, &quot;409995&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Neal Valiant">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410024" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410024" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2017 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must specify the metrics to collect when you compile the model.</p>
<p>For example, in classification:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee935deca577609464" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee935deca577609464-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee935deca577609464-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410024" onclick="return addComment.moveForm( &quot;comment-410024&quot;, &quot;410024&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410088" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410088" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e106f1c922d7e4def5829d66b1d5ed85.png" srcset="https://secure.gravatar.com/avatar/e106f1c922d7e4def5829d66b1d5ed85?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aman Garg</span>
	                <span class="date">August 18, 2017 at 4:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410088" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, </p>
<p>Thank you for such a nice tutorial. </p>
<p>Since you have published a similar topic and few other related topics in one of your paid books (LSTM networks), should the reader also expect some different topics covered in it?</p>
<p>I’m an ardent fan of your blogs since it covers most of the learning material and therefore, it makes me wonder that will be different in your book?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410088" onclick="return addComment.moveForm( &quot;comment-410088&quot;, &quot;410088&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Aman Garg">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410097" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410097" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2017 at 4:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Arman.</p>
<p>The book does not cover time series, instead it focuses on teaching you how to implement a suite of different LSTM architectures, as well as prepare data for your problems.</p>
<p>Some ideas were tested on the blog first, most are only in the book.</p>
<p>You can see the full table of contents here:<br>
<a href="http://machinelearningmastery.com/lstms-with-python/" rel="nofollow">http://machinelearningmastery.com/lstms-with-python/</a></p>
<p>The book provides all the content in one place, code as well, more access to me, updates as I fix bugs and adapt to new APIs, and it is a great way to support my site so I can keep doing this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410097" onclick="return addComment.moveForm( &quot;comment-410097&quot;, &quot;410097&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410109" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410109" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/99ed31d9c853901ac7191acd878a068b.png" srcset="https://secure.gravatar.com/avatar/99ed31d9c853901ac7191acd878a068b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Songbin Xu</span>
	                <span class="date">August 18, 2017 at 6:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410109" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for accepting my opinions, such a pleasure!</p>
<p>Running the codes u modified, still something puzzles me here,</p>
<p>1. Have u drawn the waveforms of inv_y and inv_yhat in the same plot? I think they looks quite like persistence.</p>
<p>2. Curiously, I computed the rmse between pollution(t) and pollution(t-1) in test_X, it’s 4.629, much lower than your final score 26.496, does it mean LSTM performs even worse than persistence?</p>
<p>3. I’ve tried to remove var1 at t-1, t-2, … , and I’ve also tried to use lag values&gt;1, and also assign different weights to the inputs at different timesteps, but none of them improved, they performed even worse. </p>
<p>Do you have any other ideas to avoid the whole model to learn persistence?</p>
<p>Looking forward to your advices <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410109" onclick="return addComment.moveForm( &quot;comment-410109&quot;, &quot;410109&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Songbin Xu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410176" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410176" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 19, 2017 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for pointing out the fault!</p>
<p>The final line plot shows loss on the transformed train and test sets.</p>
<p>Yes, LSTMs are no good at autoregression, yet I keep getting asked to develop examples (tens of emails per day)… See here:<br>
<a href="http://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>
<p>Consider developing a baseline with an MLP, you’ll find it tough to beat it with an LSTM!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410176" onclick="return addComment.moveForm( &quot;comment-410176&quot;, &quot;410176&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410231" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410231" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b486a4b040df23a57e3137a46c45dcc4.jpeg" srcset="https://secure.gravatar.com/avatar/b486a4b040df23a57e3137a46c45dcc4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://blog.varunajayasiri.com/" rel="external nofollow" class="url">Varuna Jayasiri</a></span>
	                <span class="date">August 19, 2017 at 2:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410231" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why are you only training with a single timestep (or sequence length)? Shouldn’t you use more timesteps for better training/prediction? For instance in <a href="https://github.com/fchollet/keras/blob/master/examples/lstm_text_generation.py" rel="nofollow">https://github.com/fchollet/keras/blob/master/examples/lstm_text_generation.py</a> they use 40 (maxlen)  timesteps</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410231" onclick="return addComment.moveForm( &quot;comment-410231&quot;, &quot;410231&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Varuna Jayasiri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410300" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-410300" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 20, 2017 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410300" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it is just an example to help you get started. I do recommend using multiple time steps in order to get the full BPTT.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410300" onclick="return addComment.moveForm( &quot;comment-410300&quot;, &quot;410300&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410682" class="comment even depth-3 parent">

	      	<div id="li-comment-410682" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e5cddf7b4f2eea21c26f50c6ce4e71c7.png" srcset="https://secure.gravatar.com/avatar/e5cddf7b4f2eea21c26f50c6ce4e71c7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Long.Ye</span>
	                <span class="date">August 23, 2017 at 11:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410682" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason and Varuna,</p>
<p>When the timesteps = 1 as you mentioned, does it mean the value of t-1 time was used to predict the value of t time?  Is moving window a method to use multiple time steps? Is there any other way? Has Keras any functions of moving window?</p>
<p>Thank you very much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410682" onclick="return addComment.moveForm( &quot;comment-410682&quot;, &quot;410682&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Long.Ye">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410713" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-410713" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2017 at 4:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410713" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Keras treats the “time steps” of a sequence as the window, kind of. It is the closest match I can think of.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410713" onclick="return addComment.moveForm( &quot;comment-410713&quot;, &quot;410713&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410341" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410341" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a85fee3239fb760a5a9e7423bd4a5322.png" srcset="https://secure.gravatar.com/avatar/a85fee3239fb760a5a9e7423bd4a5322?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">lymlin</span>
	                <span class="date">August 20, 2017 at 4:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410341" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I met some problem when learning your codes.</p>
<p> dataset = read_csv(‘D:\Geany\scriptslym\raw.csv’, parse_dates = [[‘year’, ‘month’, ‘day’, ‘hour’]],index_col=0, data_parser=parse)<br>
Traceback (most recent call last):<br>
  File “”, line 1, in<br>
    dataset = read_csv(‘D:\Geany\scriptslym\raw.csv’, parse_dates = [[‘year’, ‘month’, ‘day’, ‘hour’]],index_col=0, data_parser=parse)<br>
NameError: name ‘parse’ is not defined<br>
&gt;&gt;&gt;</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410341" onclick="return addComment.moveForm( &quot;comment-410341&quot;, &quot;410341&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to lymlin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410385" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410385" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 21, 2017 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410385" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It looks like you have specified a function “parse” but not defined it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410385" onclick="return addComment.moveForm( &quot;comment-410385&quot;, &quot;410385&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410409" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410409" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/284046cbf75de47d08f02433aa872a65.png" srcset="https://secure.gravatar.com/avatar/284046cbf75de47d08f02433aa872a65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">guntama</span>
	                <span class="date">August 21, 2017 at 11:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410409" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Can I use “keras.layers.normalization.BatchNormalization” as a substitute for “sklearn.preprocessing.MinMaxScaler”?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410409" onclick="return addComment.moveForm( &quot;comment-410409&quot;, &quot;410409&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to guntama">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410425" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410425" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 21, 2017 at 4:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410425" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, they do very different things.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410425" onclick="return addComment.moveForm( &quot;comment-410425&quot;, &quot;410425&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410459" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410459" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb456edc1b5669c6a810c1620dd7583b.png" srcset="https://secure.gravatar.com/avatar/eb456edc1b5669c6a810c1620dd7583b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Naveen Koneti</span>
	                <span class="date">August 21, 2017 at 10:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410459" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Its a very Informative article. Thanks. I have a question regarding forecasting in time series. You have used the training data with all the columns while learning after variable transformations and the same has been done for the test data too. The test data along with all the variables were used during prediction.  For instance, If I want to predict the pollution for a future date, Should I know the other inputs like dew, pressure, wind dir etc on a future date which I’m not aware off?  Another question is, Suppose we have same data about multiple regions(let us consider that the pollution among these regions is not negligible), How can we model so that the input argument while prediction is the region name along with time to forecast just for that one region.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410459" onclick="return addComment.moveForm( &quot;comment-410459&quot;, &quot;410459&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Naveen Koneti">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410505" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-410505" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 22, 2017 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410505" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on how you define your model.</p>
<p>The model defined above uses the variables from the prior time step as inputs to predict the next pollution value.</p>
<p>In your case, maybe you want to build a separate model per region, perhaps a model that improves performance by combining models across regions. You must experiment to see what works best for your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410505" onclick="return addComment.moveForm( &quot;comment-410505&quot;, &quot;410505&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410878" class="comment even depth-3">

	      	<div id="li-comment-410878" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb456edc1b5669c6a810c1620dd7583b.png" srcset="https://secure.gravatar.com/avatar/eb456edc1b5669c6a810c1620dd7583b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Naveen Koneti</span>
	                <span class="date">August 24, 2017 at 4:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410878" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks! I missed the trick of converting the time-series to supervised learning problem. That alone is sufficient even for multiple regions I guess. We just have to submit the input parameters of the previous time stamp for the specific region during prediction. We may also try one-hot encoding on the region variable too during data preprocessing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410878" onclick="return addComment.moveForm( &quot;comment-410878&quot;, &quot;410878&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Naveen Koneti">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-413016" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-413016" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ba915b98ee9c9353aa28720ca0d64356.png" srcset="https://secure.gravatar.com/avatar/ba915b98ee9c9353aa28720ca0d64356?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">LY</span>
	                <span class="date">September 7, 2017 at 8:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413016" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your excellent blog, Jason. I’ve really learnt a lot from your nice work recently. After this post, I’ve already known how to transform data into data that formates LSTM and how to construct a LSTM model.</p>
<p>Like the question aksed by Naveen Koneti, I have the same puzzle.<br>
Recently I’ve worked on some clinical data. The data is not like the one we used in this demo. It is consist of hunderds of patients, each patient has several vital sign records. If it is about one individual’s records through many years, I can process the data as what you told us. I wonder how I can conquer this kind of data. Could you give me some advice, or tell me where I can find any solutions about it?<br>
If I didn’t state my question clearly and you’re interested it, pls let me know.<br>
Thanks in advance.</p>
<p>PS. the data set in my situation is like this<br>
[ID           date  feature1 feature2  feautre3 ]<br>
[patient1 date1 value11  value12  value13  ]<br>
[patient1 date2 value21  value22  value23  ]<br>
[patient2 date1 value31  value32  value33  ]<br>
[patient2 date2……………………………………..]<br>
[patient3 ……………………………………………..]</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413016" onclick="return addComment.moveForm( &quot;comment-413016&quot;, &quot;413016&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to LY">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413203" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-413203" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2017 at 11:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413203" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could model one patient at a time, or groups or all of them. Try different approaches and see what works best.</p>
<p>I cannot tell you what would work best – I have no idea – you must discover it.</p>
<p>See this post:<br>
<a href="http://machinelearningmastery.com/a-data-driven-approach-to-machine-learning/" rel="nofollow">http://machinelearningmastery.com/a-data-driven-approach-to-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413203" onclick="return addComment.moveForm( &quot;comment-413203&quot;, &quot;413203&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433474" class="comment odd alt depth-2">

	      	<div id="li-comment-433474" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/198869336aa6b35f6f7fb50befdf2d3d.png" srcset="https://secure.gravatar.com/avatar/198869336aa6b35f6f7fb50befdf2d3d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fabio Ferrari</span>
	                <span class="date">March 28, 2018 at 7:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433474" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Naveen, I have the same your question: the model is defined such that if you know the input features at time t, then you can predict the target value at time t+1. If you want to predict the target variable at time t+2, though, you would need to know the input features at time t+1. If a feature does not change over time, it is no problem; but if a feature changes over time, then its value at time t+1 is not known and may be different from its value at time t.<br>
I am thinking that to solve this, you would need to define such features as output of the model as well as the target variable. In this way, at time t, you can predict the target variable for time t+1, but also the feature for time t+1, so that this predicted value can be used as input to predict the target variable for time t+2.</p>
<p>What do you think about that? Did you think of a different solution?<br>
Many thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433474" onclick="return addComment.moveForm( &quot;comment-433474&quot;, &quot;433474&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fabio Ferrari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410461" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410461" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b7c1cb32c97bd28ec2f534fe4b204145.png" srcset="https://secure.gravatar.com/avatar/b7c1cb32c97bd28ec2f534fe4b204145?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">August 21, 2017 at 11:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410461" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
again a nice post for the use of lstm’s!</p>
<p>I had the following idea when reading.</p>
<p>I would like to build a network, in which each feature has its own LSTM neuron/layer, so that the input is not fully connected.<br>
My idea is adding a lstm layer for each feature and merge it with the merge layer and feed these results to the output neurons.</p>
<p>Is there a better way to do this? Or would you recommend to avoid this because the features are poorly abstracted? On the other hand, this might also be interesting. </p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410461" onclick="return addComment.moveForm( &quot;comment-410461&quot;, &quot;410461&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410506" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410506" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 22, 2017 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410506" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try it and see if it can out-perform a model that learns all features together. </p>
<p>Also, contrast to an MLP with a window – that often does better than LSTMs on autoregression problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410506" onclick="return addComment.moveForm( &quot;comment-410506&quot;, &quot;410506&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410494" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410494" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ffa63d210ca9bae2becd03e173fc3f83.png" srcset="https://secure.gravatar.com/avatar/ffa63d210ca9bae2becd03e173fc3f83?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tryfon</span>
	                <span class="date">August 22, 2017 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410494" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I have two questions:</p>
<p>1) I have a question/ notice regarding the scaling of the Y variable (pollution). The way you implement the rescaling between [0-1] you consider the entire length of the array (all of the 43799 observations -after the dropna-). </p>
<p>Is it rightto rescale it that way? By doing so we are incorporating information of the furture (test set) to the past (train set) because the scaler is “exposed” to both of them and therefore we introduce bias. </p>
<p>If you agree with my point what could be a fix?</p>
<p>2) Also the activation function of the output (Y variable) is sigmoid, that’s why we rescale it within the [0,1] range. Am I correct?</p>
<p>Thanks for sharing the article!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410494" onclick="return addComment.moveForm( &quot;comment-410494&quot;, &quot;410494&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tryfon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410517" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-410517" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 22, 2017 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, ideally you would develop a scaling procedure on the training data and use it on test and when making predictions on new data.</p>
<p>I tried to keep the tutorial simple by scaling all data together.</p>
<p>The activation on the output layer is ‘linear’, the default. This must be the case because we are predicting a real-value.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410517" onclick="return addComment.moveForm( &quot;comment-410517&quot;, &quot;410517&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431491" class="comment even depth-3 parent">

	      	<div id="li-comment-431491" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7a1b58146e9c174d39b9f27b88a1298b.png" srcset="https://secure.gravatar.com/avatar/7a1b58146e9c174d39b9f27b88a1298b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fati</span>
	                <span class="date">March 7, 2018 at 9:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431491" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>First I wanna thanks for your helpful and practical blog.</p>
<p>I tried to separate train and test set to do normalization on training but I have gotten error related to test set shape something like that “ValueError: cannot reshape array of size 136 into shape (34,2,4)”, which I don’t know how to fix it!<br>
Do you have an example on LSTM which run normalization on train and used in test, or do you explain that in your book? </p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431491" onclick="return addComment.moveForm( &quot;comment-431491&quot;, &quot;431491&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fati">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431543" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-431543" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 8, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431543" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help you learn how to reshape your input data:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431543" onclick="return addComment.moveForm( &quot;comment-431543&quot;, &quot;431543&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431495" class="comment even depth-3 parent">

	      	<div id="li-comment-431495" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7a1b58146e9c174d39b9f27b88a1298b.png" srcset="https://secure.gravatar.com/avatar/7a1b58146e9c174d39b9f27b88a1298b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fati</span>
	                <span class="date">March 7, 2018 at 10:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431495" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>I did some changes and just use transform method on test set, is that correct?<br>
firstly I divided my data-set to two different sets ,(train and test)<br>
secondly I ran fit_transform on train set and transform on test set</p>
<p>But I get rmse=0 ? which seems weird. am I correct?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431495" onclick="return addComment.moveForm( &quot;comment-431495&quot;, &quot;431495&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fati">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431546" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-431546" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 8, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431546" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds correct.</p>
<p>An RMSE of zero suggests a bug or a very simple modeling problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431546" onclick="return addComment.moveForm( &quot;comment-431546&quot;, &quot;431546&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410570" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410570" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e81d6edb489cc4a4a539cba56dba1172.png" srcset="https://secure.gravatar.com/avatar/e81d6edb489cc4a4a539cba56dba1172?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">WCH</span>
	                <span class="date">August 22, 2017 at 5:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410570" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much for your tutorial.</p>
<p>I have one question, </p>
<p>but I  failed to read the NW in pollution. csv.(cbwd column) </p>
<p>values = values.astype(‘float32’)<br>
ValueError: could not convert string to float: NW</p>
<p>How do you fix it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410570" onclick="return addComment.moveForm( &quot;comment-410570&quot;, &quot;410570&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to WCH">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410572" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-410572" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e81d6edb489cc4a4a539cba56dba1172.png" srcset="https://secure.gravatar.com/avatar/e81d6edb489cc4a4a539cba56dba1172?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">WCH</span>
	                <span class="date">August 22, 2017 at 5:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410572" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry, I saw the text above and solved it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410572" onclick="return addComment.moveForm( &quot;comment-410572&quot;, &quot;410572&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to WCH">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410648" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-410648" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2017 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410648" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410648" onclick="return addComment.moveForm( &quot;comment-410648&quot;, &quot;410648&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442311" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-442311" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5ee598a65d389b6a39cc9636f044bd02.png" srcset="https://secure.gravatar.com/avatar/5ee598a65d389b6a39cc9636f044bd02?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juno Huang</span>
	                <span class="date">June 29, 2018 at 7:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442311" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, I would like to know how did you fix it? I still have that problem, tried to find the solution above but didn’t find one. Thank you !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442311" onclick="return addComment.moveForm( &quot;comment-442311&quot;, &quot;442311&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Juno Huang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446340" class="comment even depth-3 parent">

	      	<div id="li-comment-446340" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/82cecb8c2b2e2039d2df59bca6fc8bb7.png" srcset="https://secure.gravatar.com/avatar/82cecb8c2b2e2039d2df59bca6fc8bb7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Can Altas</span>
	                <span class="date">August 17, 2018 at 3:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446340" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You have to prepare the Data befor you convert (see “Basic Data Preparation”). In Jason’s complete Example of the LSTM this preparation step is missing (more likely left out).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446340" onclick="return addComment.moveForm( &quot;comment-446340&quot;, &quot;446340&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Can Altas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446378" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-446378" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2018 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446378" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes the note above the complete example says clearly:</p>
<blockquote><p>
NOTE: This example assumes you have prepared the data correctly, e.g. converted the downloaded “raw.csv” to the prepared “pollution.csv“. See the first part of this tutorial.
</p></blockquote>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446378" onclick="return addComment.moveForm( &quot;comment-446378&quot;, &quot;446378&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410574" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410574" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/76d656b353162989e5226ffabfb411de.png" srcset="https://secure.gravatar.com/avatar/76d656b353162989e5226ffabfb411de?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dmitry</span>
	                <span class="date">August 22, 2017 at 5:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410574" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!<br>
I assume there is little mistake when you calculate RMSE on test data.<br>
You must write this code before calculate RMSE: </p>
<p>inv_y = inv_y[:-1]<br>
inv_yhat = inv_yhat[1:]</p>
<p>Thus, RMSE equals 10.6 (on the same data, in my case), that is much less than 26.5 in your case.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410574" onclick="return addComment.moveForm( &quot;comment-410574&quot;, &quot;410574&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dmitry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410649" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-410649" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2017 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t understand your comment and snippet of code, can you spell out the bug you see?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410649" onclick="return addComment.moveForm( &quot;comment-410649&quot;, &quot;410649&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419815" class="comment even depth-3">

	      	<div id="li-comment-419815" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d713d62e11b0bb299172446029774587.png" srcset="https://secure.gravatar.com/avatar/d713d62e11b0bb299172446029774587?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tommy</span>
	                <span class="date">November 12, 2017 at 2:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419815" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This beats further exploration</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419815" onclick="return addComment.moveForm( &quot;comment-419815&quot;, &quot;419815&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tommy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-424454" class="comment odd alt depth-3">

	      	<div id="li-comment-424454" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/12988f65ba5769d937b28a01613f0b57.png" srcset="https://secure.gravatar.com/avatar/12988f65ba5769d937b28a01613f0b57?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Azhar Khan</span>
	                <span class="date">December 22, 2017 at 11:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424454" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I agree with @Dmitry here. The prediction “inv_yhat” is one index ahead of real output “inv_y”.</p>
<p>It can be seen by plotting predicted output v/s real output:<br>
pyplot.plot(inv_y[:-1,], color=’green’, marker=’o’, label = ‘Real Screening Count’)<br>
pyplot.plot(inv_yhat[1:,], color=’red’, marker=’o’, label = ‘Predicted Screening Count’)<br>
pyplot.legend()<br>
pyplot.show()</p>
<p>Compute RMSE by skipping first element of inv_yhat, and better RSME score is presented:<br>
rmse = sqrt(mean_squared_error(inv_y[:-1,], inv_yhat[1:,]))<br>
print(‘Test RMSE: %.3f’ % rmse)</p>
<p>rmse = sqrt(mean_squared_error(inv_y, inv_yhat))<br>
print(‘Test RMSE: %.3f’ % rmse)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424454" onclick="return addComment.moveForm( &quot;comment-424454&quot;, &quot;424454&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Azhar Khan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410603" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410603" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/544d1a205925f88d63d380ce45ebabbd.png" srcset="https://secure.gravatar.com/avatar/544d1a205925f88d63d380ce45ebabbd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jan</span>
	                <span class="date">August 22, 2017 at 11:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410603" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>great post! I was waiting for meteo problems to infiltrate the machinelearningmastery world.</p>
<p>Could you write something about the changed scenareo where, given the weather conditions and pollution for some time, we can predict the pollution for another time or place with given weather conditions?</p>
<p>For example: We have the weather conditions and pollution given for Beijing in 2016, and we have the weather conditions given for Chengde (city close to Bejing) also in 2016. Now we want to know how was the pollution in Chengde in 2016.</p>
<p>Would be great to learn about that!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410603" onclick="return addComment.moveForm( &quot;comment-410603&quot;, &quot;410603&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to jan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410659" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410659" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2017 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410659" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great suggestion, I like it. An approach would be to train the model to generalize across geographical domains based only on weather conditions.</p>
<p>I have tried not to use too many weather examples – I came from 6 years of work in severe weather, it’s too close to home <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410659" onclick="return addComment.moveForm( &quot;comment-410659&quot;, &quot;410659&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410673" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410673" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a711cbfc1f33a66dd2114f9da3b9cf13.png" srcset="https://secure.gravatar.com/avatar/a711cbfc1f33a66dd2114f9da3b9cf13?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Simone</span>
	                <span class="date">August 23, 2017 at 9:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410673" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I have read many of your posts about LSTM. I have not completely clear the difference between the parameters batch_size and time_steps. Batch_size means when the memory is reset (right?), but this shouldn’t have the same value of time_steps that, if I have understood correctly, means how often the system makes a prediction?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410673" onclick="return addComment.moveForm( &quot;comment-410673&quot;, &quot;410673&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Simone">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410711" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-410711" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2017 at 4:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410711" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question!</p>
<p>Batch size is the number of samples (e.g. sequences) to that are used to estimate the gradient before the weights are updated. The internal state is reset at the end of each batch after the weights are updated.</p>
<p>One sample is comprised of 1 or more time steps that are stepped over during backpropagation through time. Each time step may have one or more features (e.g. observations recorded at that time).</p>
<p>Time steps and batch size and generally not related.</p>
<p>You can split up a sequence to have one-time step per sequence. In that case you will not get the benefit of learning across time (e.g. bptt), but you can reset state at the end of the time steps for one sequence. This an odd config though and really only good to showing off the LSTMs memory capability.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410711" onclick="return addComment.moveForm( &quot;comment-410711&quot;, &quot;410711&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410802" class="comment even depth-3">

	      	<div id="li-comment-410802" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a711cbfc1f33a66dd2114f9da3b9cf13.png" srcset="https://secure.gravatar.com/avatar/a711cbfc1f33a66dd2114f9da3b9cf13?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Simone</span>
	                <span class="date">August 24, 2017 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410802" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, now it’s more clear!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410802" onclick="return addComment.moveForm( &quot;comment-410802&quot;, &quot;410802&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Simone">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410747" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-410747" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/87dbe816af4e7fcf75d3c6221840c846.png" srcset="https://secure.gravatar.com/avatar/87dbe816af4e7fcf75d3c6221840c846?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pedro</span>
	                <span class="date">August 23, 2017 at 8:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410747" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,I ger this error at this step, could you help me please?</p>
<p>model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))</p>
<p>—————————————————————————<br>
TypeError                                 Traceback (most recent call last)<br>
 in ()<br>
—-&gt; 1 model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))</p>
<p>C:\Anaconda3\lib\site-packages\keras\models.py in add(self, layer)<br>
    431                 # and create the node connecting the current layer<br>
    432                 # to the input layer we just created.<br>
–&gt; 433                 layer(x)<br>
    434<br>
    435             if len(layer.inbound_nodes) != 1:</p>
<p>C:\Anaconda3\lib\site-packages\keras\layers\recurrent.py in __call__(self, inputs, initial_state, **kwargs)<br>
    241         # modify the input spec to include the state.<br>
    242         if initial_state is None:<br>
–&gt; 243             return super(Recurrent, self).__call__(inputs, **kwargs)<br>
    244<br>
    245         if not isinstance(initial_state, (list, tuple)):</p>
<p>C:\Anaconda3\lib\site-packages\keras\engine\topology.py in __call__(self, inputs, **kwargs)<br>
    556                                          ‘<code>layer.build(batch_input_shape)</code>‘)<br>
    557                 if len(input_shapes) == 1:<br>
–&gt; 558                     self.build(input_shapes[0])<br>
    559                 else:<br>
    560                     self.build(input_shapes)</p>
<p>C:\Anaconda3\lib\site-packages\keras\layers\recurrent.py in build(self, input_shape)<br>
   1010                                         initializer=bias_initializer,<br>
   1011                                         regularizer=self.bias_regularizer,<br>
-&gt; 1012                                         constraint=self.bias_constraint)<br>
   1013         else:<br>
   1014             self.bias = None</p>
<p>C:\Anaconda3\lib\site-packages\keras\legacy\interfaces.py in wrapper(*args, **kwargs)<br>
     86                 warnings.warn(‘Update your <code>' + object_name +<br>
     87                               '</code> call to the Keras 2 API: ‘ + signature, stacklevel=2)<br>
—&gt; 88             return func(*args, **kwargs)<br>
     89         wrapper._legacy_support_signature = inspect.getargspec(func)<br>
     90         return wrapper</p>
<p>C:\Anaconda3\lib\site-packages\keras\engine\topology.py in add_weight(self, name, shape, dtype, initializer, regularizer, trainable, constraint)<br>
    389         if dtype is None:<br>
    390             dtype = K.floatx()<br>
–&gt; 391         weight = K.variable(initializer(shape), dtype=dtype, name=name)<br>
    392         if regularizer is not None:<br>
    393             self.add_loss(regularizer(weight))</p>
<p>C:\Anaconda3\lib\site-packages\keras\layers\recurrent.py in bias_initializer(shape, *args, **kwargs)<br>
   1002                         self.bias_initializer((self.units,), *args, **kwargs),<br>
   1003                         initializers.Ones()((self.units,), *args, **kwargs),<br>
-&gt; 1004                         self.bias_initializer((self.units * 2,), *args, **kwargs),<br>
   1005                     ])<br>
   1006             else:</p>
<p>C:\Anaconda3\lib\site-packages\keras\backend\tensorflow_backend.py in concatenate(tensors, axis)<br>
   1679         return tf.sparse_concat(axis, tensors)<br>
   1680     else:<br>
-&gt; 1681         return tf.concat([to_dense(x) for x in tensors], axis)<br>
   1682<br>
   1683 </p>
<p>C:\Anaconda3\lib\site-packages\tensorflow\python\ops\array_ops.py in concat(concat_dim, values, name)<br>
    998       ops.convert_to_tensor(concat_dim,<br>
    999                             name=”concat_dim”,<br>
-&gt; 1000                             dtype=dtypes.int32).get_shape(<br>
   1001                             ).assert_is_compatible_with(tensor_shape.scalar())<br>
   1002       return identity(values[0], name=scope)</p>
<p>C:\Anaconda3\lib\site-packages\tensorflow\python\framework\ops.py in convert_to_tensor(value, dtype, name, as_ref, preferred_dtype)<br>
    667<br>
    668         if ret is None:<br>
–&gt; 669           ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)<br>
    670<br>
    671         if ret is NotImplemented:</p>
<p>C:\Anaconda3\lib\site-packages\tensorflow\python\framework\constant_op.py in _constant_tensor_conversion_function(v, dtype, name, as_ref)<br>
    174                                          as_ref=False):<br>
    175   _ = as_ref<br>
–&gt; 176   return constant(v, dtype=dtype, name=name)<br>
    177<br>
    178 </p>
<p>C:\Anaconda3\lib\site-packages\tensorflow\python\framework\constant_op.py in constant(value, dtype, shape, name, verify_shape)<br>
    163   tensor_value = attr_value_pb2.AttrValue()<br>
    164   tensor_value.tensor.CopyFrom(<br>
–&gt; 165       tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))<br>
    166   dtype_value = attr_value_pb2.AttrValue(type=tensor_value.tensor.dtype)<br>
    167   const_tensor = g.create_op(</p>
<p>C:\Anaconda3\lib\site-packages\tensorflow\python\framework\tensor_util.py in make_tensor_proto(values, dtype, shape, verify_shape)<br>
    365       nparray = np.empty(shape, dtype=np_dt)<br>
    366     else:<br>
–&gt; 367       _AssertCompatible(values, dtype)<br>
    368       nparray = np.array(values, dtype=np_dt)<br>
    369       # check to them.</p>
<p>C:\Anaconda3\lib\site-packages\tensorflow\python\framework\tensor_util.py in _AssertCompatible(values, dtype)<br>
    300     else:<br>
    301       raise TypeError(“Expected %s, got %s of type ‘%s’ instead.” %<br>
–&gt; 302                       (dtype.name, repr(mismatch), type(mismatch).__name__))<br>
    303<br>
    304 </p>
<p>TypeError: Expected int32, got list containing Tensors of type ‘_Message’ instead.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410747" onclick="return addComment.moveForm( &quot;comment-410747&quot;, &quot;410747&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Pedro">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410811" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-410811" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2017 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410811" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps check that your environment is setup correctly:<br>
<a href="http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow">http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>
<p>Also, ensure that you have copied all of the code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410811" onclick="return addComment.moveForm( &quot;comment-410811&quot;, &quot;410811&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410773" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410773" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/584ad99335f9602fc42d4330df7032ba.png" srcset="https://secure.gravatar.com/avatar/584ad99335f9602fc42d4330df7032ba?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neal Valiant</span>
	                <span class="date">August 24, 2017 at 2:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410773" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I was curious if you can point me in the right direction for converting data back to the actual values instead of scaled.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410773" onclick="return addComment.moveForm( &quot;comment-410773&quot;, &quot;410773&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Neal Valiant">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410818" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-410818" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2017 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410818" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can invert the scaling.</p>
<p>This tutorial demonstrates how to do that Neal.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410818" onclick="return addComment.moveForm( &quot;comment-410818&quot;, &quot;410818&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411005" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-411005" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/584ad99335f9602fc42d4330df7032ba.png" srcset="https://secure.gravatar.com/avatar/584ad99335f9602fc42d4330df7032ba?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neal Valiant</span>
	                <span class="date">August 25, 2017 at 7:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411005" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I did have an issue converting back to actual values, but was able to get past it using the drop columns on the reframed data which got me past it.</p>
<p>When looking at my predicted values vs actual values, I’m noticing that my first column has a prediction and a true value, but for every other variable, I only see what I can assume is a prediction? does this make a prediction on every column, or just one particular one.</p>
<p>Im sorry for asking a question such as this, I just think I’m confusing myself looking at my results.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411005" onclick="return addComment.moveForm( &quot;comment-411005&quot;, &quot;411005&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Neal Valiant">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411063" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-411063" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 25, 2017 at 3:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411063" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code in the tutorial only predicts pollution.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411063" onclick="return addComment.moveForm( &quot;comment-411063&quot;, &quot;411063&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410778" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-410778" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bf2c5c24800dc323de5ac11cb41b354d.png" srcset="https://secure.gravatar.com/avatar/bf2c5c24800dc323de5ac11cb41b354d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack Dan</span>
	                <span class="date">August 24, 2017 at 3:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr. Jason,<br>
I have been trying with my own dataset and I am getting an error “ValueError: operands could not be broadcast together with shapes (168,39) (41,) (168,39)” when I try to do <code>inv_yhat = scaler.inverse_transform(inv_yhat)</code> as you have in line 86 in your script. I still can not figure out where my issue is. I have <code>yhat.shape</code> as (168,1) and test_X.shape<code> as (168,38). When I do this,  </code>inv_yhat = np.concatenate((yhat, test_X[:, 1:]), axis=1)<code>, my </code>inv_yhat.shape<code> is (168,39)</code>. I still can not figure why <code>inverse_transform</code> gives that error.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410778" onclick="return addComment.moveForm( &quot;comment-410778&quot;, &quot;410778&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410819" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-410819" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2017 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410819" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The shape of the data must be the same when inverting the scale as when it was originally scaled.</p>
<p>This means, if you scaled with the entire test dataset (all columns), then you need to tack the yhat onto the test dataset for the inverse. We jump through these exact hoops at the end of the example when calculating RMSE.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410819" onclick="return addComment.moveForm( &quot;comment-410819&quot;, &quot;410819&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410827" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-410827" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/745b6d75c628c22c2ccb4d64f905e90b.png" srcset="https://secure.gravatar.com/avatar/745b6d75c628c22c2ccb4d64f905e90b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jay Regalia</span>
	                <span class="date">August 24, 2017 at 7:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410827" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This seems to be the same issue I am having at the moment also. i concatenate my inv_yhat with my test_X like you said, but the shape of inv_yhat after is still not taking into account the 2nd numbers(in posts case (41,).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410827" onclick="return addComment.moveForm( &quot;comment-410827&quot;, &quot;410827&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jay Regalia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411156" class="comment even depth-4">

	      	<div id="li-comment-411156" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bf2c5c24800dc323de5ac11cb41b354d.png" srcset="https://secure.gravatar.com/avatar/bf2c5c24800dc323de5ac11cb41b354d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack Dan</span>
	                <span class="date">August 26, 2017 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411156" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ask a question in stackoverflow and post the link, I should be able to help. I spent lots of time on this and have a decent idea now.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411156" onclick="return addComment.moveForm( &quot;comment-411156&quot;, &quot;411156&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410829" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-410829" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bf2c5c24800dc323de5ac11cb41b354d.png" srcset="https://secure.gravatar.com/avatar/bf2c5c24800dc323de5ac11cb41b354d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack Dan</span>
	                <span class="date">August 24, 2017 at 7:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410829" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you’re right! I did that and it worked, nice! Thank you for your comment!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410829" onclick="return addComment.moveForm( &quot;comment-410829&quot;, &quot;410829&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410882" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-410882" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2017 at 4:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410882" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear that Jack.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410882" onclick="return addComment.moveForm( &quot;comment-410882&quot;, &quot;410882&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-427452" class="comment odd alt depth-4">

	      	<div id="li-comment-427452" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8b85c1a3bb8ca1e8f4a39fe96af63ce0.jpeg" srcset="https://secure.gravatar.com/avatar/8b85c1a3bb8ca1e8f4a39fe96af63ce0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jehung</span>
	                <span class="date">January 24, 2018 at 2:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427452" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How did you solve the problem??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427452" onclick="return addComment.moveForm( &quot;comment-427452&quot;, &quot;427452&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to jehung">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-440216" class="comment even depth-4 parent">

	      	<div id="li-comment-440216" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8c316822dbbf26b4106f5e0ce6db5768.png" srcset="https://secure.gravatar.com/avatar/8c316822dbbf26b4106f5e0ce6db5768?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tom</span>
	                <span class="date">June 8, 2018 at 7:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440216" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>here’s link to solution on stackoverflow:<br>
<a href="https://datascience.stackexchange.com/questions/22488/value-error-operands-could-not-be-broadcast-together-with-shapes-lstm" rel="nofollow">https://datascience.stackexchange.com/questions/22488/value-error-operands-could-not-be-broadcast-together-with-shapes-lstm</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440216" onclick="return addComment.moveForm( &quot;comment-440216&quot;, &quot;440216&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tom">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440269" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-440269" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 9, 2018 at 6:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440269" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410835" class="comment even depth-3 parent">

	      	<div id="li-comment-410835" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/745b6d75c628c22c2ccb4d64f905e90b.png" srcset="https://secure.gravatar.com/avatar/745b6d75c628c22c2ccb4d64f905e90b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John Regilina</span>
	                <span class="date">August 24, 2017 at 8:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410835" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am having the same problem, but cannot solve the issue. everytime i try to concatenante them together, there is not change to my inv_yhat variable. i still am unable to understand this issue if you can expand a bit more that would be amazing</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410835" onclick="return addComment.moveForm( &quot;comment-410835&quot;, &quot;410835&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to John Regilina">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411159" class="comment odd alt depth-4">

	      	<div id="li-comment-411159" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bf2c5c24800dc323de5ac11cb41b354d.png" srcset="https://secure.gravatar.com/avatar/bf2c5c24800dc323de5ac11cb41b354d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack Dan</span>
	                <span class="date">August 26, 2017 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411159" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>@John Regilina,<br>
Check the shape of data after you scale the data and then check the scale again after you do the concatenation. Remember, when your <code>yhat</code> shape will be (rowlength,1) and after concatenation <code>inv_yhat</code> should be the same shape after you scaled the data. Look at Dr.Jason’s answer to my comment/question. Hope that will help. (Thanks to Dr.Jason saved a lot of my time)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411159" onclick="return addComment.moveForm( &quot;comment-411159&quot;, &quot;411159&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437892" class="comment even depth-3">

	      	<div id="li-comment-437892" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/623149b193be8e9f700e6a0b022e4ce8.png" srcset="https://secure.gravatar.com/avatar/623149b193be8e9f700e6a0b022e4ce8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sabyasachi Purkayastha</span>
	                <span class="date">May 18, 2018 at 10:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Sir, thank you for the awesome tutorial. But I still couldn’t understand what exactly needs to be done. I am getting the error:<br>
 &gt; operands could not be broadcast together with shapes (12852,27) (14,) (12852,27) ”<br>
This the line which generates the error:<br>
inv_yhat = scaler.inverse_transform(inv_yhat).fit()<br>
Could you please give me a small example to understand what went wrong. Thanks in advance Sir.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437892" onclick="return addComment.moveForm( &quot;comment-437892&quot;, &quot;437892&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sabyasachi Purkayastha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414268" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-414268" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb4ff520de26ec298c8962811ea5d5e4.png" srcset="https://secure.gravatar.com/avatar/eb4ff520de26ec298c8962811ea5d5e4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shan</span>
	                <span class="date">September 19, 2017 at 1:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414268" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am also stuck with same thing. How did you fix it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414268" onclick="return addComment.moveForm( &quot;comment-414268&quot;, &quot;414268&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Shan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433296" class="comment even depth-3">

	      	<div id="li-comment-433296" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a83facc6bd885320f2f16b5da6f611fd.png" srcset="https://secure.gravatar.com/avatar/a83facc6bd885320f2f16b5da6f611fd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">anna</span>
	                <span class="date">March 26, 2018 at 11:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433296" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Same question here, how did everyone fix this? From your answers I cannot deduce what exactly went wrong in your case, and what you did to solve it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433296" onclick="return addComment.moveForm( &quot;comment-433296&quot;, &quot;433296&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to anna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410786" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410786" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/979e63fca56622202562027e7dbb954b.png" srcset="https://secure.gravatar.com/avatar/979e63fca56622202562027e7dbb954b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lizzie</span>
	                <span class="date">August 24, 2017 at 4:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410786" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, In  dataset.drop(‘No’, axis =1, inplace = True), what is the purpose of ‘axis’ and ‘inplace’?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410786" onclick="return addComment.moveForm( &quot;comment-410786&quot;, &quot;410786&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Lizzie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410820" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-410820" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2017 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>We specify to remove the column with axis=1 and to do it on the array in memory with inplace rather than return a copy of the array with the column removed.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410820" onclick="return addComment.moveForm( &quot;comment-410820&quot;, &quot;410820&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410790" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-410790" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/979e63fca56622202562027e7dbb954b.png" srcset="https://secure.gravatar.com/avatar/979e63fca56622202562027e7dbb954b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lizzie</span>
	                <span class="date">August 24, 2017 at 4:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410790" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Fabulous tutorials Jason!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410790" onclick="return addComment.moveForm( &quot;comment-410790&quot;, &quot;410790&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Lizzie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410821" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-410821" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2017 at 6:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410821" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Lizzie.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410821" onclick="return addComment.moveForm( &quot;comment-410821&quot;, &quot;410821&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410796" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410796" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cfee7ce9962f3518519a13d91db9c1ec.png" srcset="https://secure.gravatar.com/avatar/cfee7ce9962f3518519a13d91db9c1ec?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jaskaran</span>
	                <span class="date">August 24, 2017 at 5:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you show how the multi variate forecast looks like?<br>
Looks like you missed it in the article.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410796" onclick="return addComment.moveForm( &quot;comment-410796&quot;, &quot;410796&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jaskaran">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410824" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-410824" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2017 at 6:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410824" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure,</p>
<p>You can plot all predictions as follows:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee935d3db311168553" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">pyplot.plot(inv_yhat)
pyplot.plot(inv_y)
pyplot.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee935d3db311168553-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935d3db311168553-2">2</div><div class="crayon-num" data-line="crayon-5c0eee935d3db311168553-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee935d3db311168553-1"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935d3db311168553-2"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee935d3db311168553-3"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>You get:</p>
<p><img src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/all.png" alt=""></p>
<p>It’s a mess, you can plot the last 100 time steps as follows:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee935d3ea233116839" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">pyplot.plot(inv_yhat[-100:])
pyplot.plot(inv_y[-100:])
pyplot.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee935d3ea233116839-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee935d3ea233116839-2">2</div><div class="crayon-num" data-line="crayon-5c0eee935d3ea233116839-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee935d3ea233116839-1"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">100</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee935d3ea233116839-2"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">100</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee935d3ea233116839-3"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>You get:<br>
<img src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/100.png" alt=""></p>
<p>The predictions look like persistence.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410824" onclick="return addComment.moveForm( &quot;comment-410824&quot;, &quot;410824&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411580" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-411580" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/48d470509eb41a1ab9a034e535d0cdbf.png" srcset="https://secure.gravatar.com/avatar/48d470509eb41a1ab9a034e535d0cdbf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">BEN BECKER</span>
	                <span class="date">August 29, 2017 at 1:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411580" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, what am I missing, looking at your plot of the most recent 100 time steps, it looks like the predicted value is always 1 time period after the actual?  If on step 90 the actual is 17, but the predicted value shows 17 for step 91, we are one time period off, that is if we shifted the predicted values back a day, it would overlap with the actual which doesn’t really buy us much since the next hour prediction seems to really align with the prior actual.  Am I missing something looking at this chart?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411580" onclick="return addComment.moveForm( &quot;comment-411580&quot;, &quot;411580&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to BEN BECKER">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411621" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-411621" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2017 at 5:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411621" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is what a persistence forecast looks like, that value(t) = value(t-1).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411621" onclick="return addComment.moveForm( &quot;comment-411621&quot;, &quot;411621&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411647" class="comment odd alt depth-5">

	      	<div id="li-comment-411647" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/48d470509eb41a1ab9a034e535d0cdbf.png" srcset="https://secure.gravatar.com/avatar/48d470509eb41a1ab9a034e535d0cdbf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">BECKER</span>
	                <span class="date">August 29, 2017 at 9:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411647" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So how would you get the true predicted value(t)?  I am thinking of the last record in the time series where we are trying to predict the value for the next hour.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-411697" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-411697" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 30, 2017 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411697" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow. Perhaps you can restate your question?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-415340" class="comment odd alt depth-5">

	      	<div id="li-comment-415340" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/92e3597973d61ab1514845b684ceed6b.png" srcset="https://secure.gravatar.com/avatar/92e3597973d61ab1514845b684ceed6b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anna</span>
	                <span class="date">October 2, 2017 at 4:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415340" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason Brownlee</p>
<p>Thank you for your great posts. I run the model above for my data and it works perfectly, how ever when I draw the real data (blue one –  inv_y) and the prediction (the orange one – inv_yhat), the result shows the prediction is delay after 1 step. it should be predicted one step before as your graph. your model is the same with the matlab tool:<br>
<a href="https://nl.mathworks.com/videos/maglev-modeling-with-neural-time-series-tool-68797.html" rel="nofollow">https://nl.mathworks.com/videos/maglev-modeling-with-neural-time-series-tool-68797.html</a></p>
<p>And after running the model, I  applyed realtime this model for my problem to compute the inv_yhat in every step. I got the result is really bad, since I have never had the real inv_y. I took the prediction to feed the input ( instead of real data inv_y)</p>
<p>My problem is: I received some signals as  inputs, then I labeled offline to have  output (real data inv_y or the first column in train_X)</p>
<p>Do you have the model that trains without the real data in the first column?????? thank you</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-415370" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-415370" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 3, 2017 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415370" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Your model may have low skill and be simply predicting the input as the output (e.g. persistence).</p>
<p>You may need to continue to develop your model, I list some ideas for lifting model skill here:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432716" class="comment odd alt depth-4">

	      	<div id="li-comment-432716" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/dab3a2c7629ecbaeb7a906d355042abc.png" srcset="https://secure.gravatar.com/avatar/dab3a2c7629ecbaeb7a906d355042abc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Li Yue</span>
	                <span class="date">March 20, 2018 at 6:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432716" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, i have the same confusion as you. i think the prediction problem should be value_predict(t-1) = value_real(t). the label “train_y”  indicates value_real(t+1). we input the train_x(t) into the model to get the prediction and the prediction should match “train_y” , not one step after “train_y”.  did you solve this problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432716" onclick="return addComment.moveForm( &quot;comment-432716&quot;, &quot;432716&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Li Yue">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417939" class="comment even depth-3 parent">

	      	<div id="li-comment-417939" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8ac0a5ef4dc2d6ea3a0f5037b59c666c.png" srcset="https://secure.gravatar.com/avatar/8ac0a5ef4dc2d6ea3a0f5037b59c666c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tyler Byers</span>
	                <span class="date">October 26, 2017 at 3:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417939" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It’s definitely similar to a persistence model since we trained the model using the <code>var1(t-1)</code> feature (i.e. the lagged pollution feature). The model certainly found that to be the strongest predictor. This would be ok if we were doing predictions later on an hour-by-hour basis.  But, if, say we want to predict the pollution 20 hours from now, we aren’t yet going to know what the hour-19 pollution is. So it seems like cheating to include this variable in the training and prediction sets.</p>
<p>I removed this variable to train the model, leaving other parameters about the same, and was then only able to get a minimum validation loss of 0.55 and test RMSE of 87.02</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417939" onclick="return addComment.moveForm( &quot;comment-417939&quot;, &quot;417939&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tyler Byers">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417971" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-417971" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 26, 2017 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417971" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work.</p>
<p>It’s not cheating, it comes down to different framings of the problem based on the requirements of the problem.</p>
<p>This post can help if you want to explore direct multi-step forecasting:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417971" onclick="return addComment.moveForm( &quot;comment-417971&quot;, &quot;417971&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424753" class="comment even depth-3 parent">

	      	<div id="li-comment-424753" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/36682ea74789ca76efee0fc0a6b5e829.png" srcset="https://secure.gravatar.com/avatar/36682ea74789ca76efee0fc0a6b5e829?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">xeo</span>
	                <span class="date">December 26, 2017 at 4:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It looks the prediction is pretty good. Can we say the lstm model is good?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424753" onclick="return addComment.moveForm( &quot;comment-424753&quot;, &quot;424753&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to xeo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424768" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-424768" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 26, 2017 at 5:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424768" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think LSTMs are poor at autoregression.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424768" onclick="return addComment.moveForm( &quot;comment-424768&quot;, &quot;424768&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410931" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410931" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c18ad8c603d4bbd29cba87d74f50eac6.png" srcset="https://secure.gravatar.com/avatar/c18ad8c603d4bbd29cba87d74f50eac6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">gammarayburst</span>
	                <span class="date">August 24, 2017 at 11:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Wind dir is label encoded not wind speed!!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410931" onclick="return addComment.moveForm( &quot;comment-410931&quot;, &quot;410931&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to gammarayburst">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410989" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410989" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 25, 2017 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410989" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-410989" onclick="return addComment.moveForm( &quot;comment-410989&quot;, &quot;410989&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-411278" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-411278" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b39a469060133808c7214722798e5159.png" srcset="https://secure.gravatar.com/avatar/b39a469060133808c7214722798e5159?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Filipe</span>
	                <span class="date">August 27, 2017 at 4:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411278" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>First of all, thanks. All of this material on the blog is super interesting, and helpful and making me learn a lot. </p>
<p>Of course… I have a question. </p>
<p>I’m surprised by the use of LSTMs here. The property of them being “stateful” I guess is being used. But is there “sequence” information flowing? </p>
<p>So when I used LSTMs in Keras for text classification tasks (sentence, outcome), each “sentence” is a sequence. Each observation is a sequence. It’s an ordered array of the words in the sentence (and it’s outcome).<br>
In this example, I could not see a sense in which var1(t-1) is linked to var1(t-2). Aren’t they being treated as independent Xs in a regression problem? (predicting var8(t))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411278" onclick="return addComment.moveForm( &quot;comment-411278&quot;, &quot;411278&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Filipe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411296" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-411296" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 27, 2017 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411296" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct, we are not providing a sequence of observations and therefore not getting good BPTT.</p>
<p>Based on my tests, I have found LSTMs to be poor at autoregression, and in this case, as I added more history to the model (longer sequences), performance degraded.</p>
<p>I would strongly encourage you to use an MLP baseline that any MLP would have to out-perform.</p>
<p>See this post for more on the limitations of LSTM for time series:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411296" onclick="return addComment.moveForm( &quot;comment-411296&quot;, &quot;411296&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-411284" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-411284" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/747937e1262044972f0f987667efc8e2.png" srcset="https://secure.gravatar.com/avatar/747937e1262044972f0f987667efc8e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.linkedin.com/in/stylianos-iordanis-34787a19/" rel="external nofollow" class="url">STYLIANOS IORDANIS</a></span>
	                <span class="date">August 27, 2017 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411284" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome article, as always.<br>
Btw, what is your view on using an autoencoder/ restricted Boltzmann layer compressing features/ features before feeding an LSTM network ? For example, if one has a financial timeseries to forecast, e.g. a classifier trying to predict increase or decrease in a look ahead time window, via numerous technical indicators and/or other candidate exogenous leading indicators…..<br>
Could you write an article based on that idea?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411284" onclick="return addComment.moveForm( &quot;comment-411284&quot;, &quot;411284&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to STYLIANOS IORDANIS">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411297" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-411297" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 27, 2017 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411297" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have seen better results from large MLPs, nevertheless, try it and see how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411297" onclick="return addComment.moveForm( &quot;comment-411297&quot;, &quot;411297&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411309" class="comment even depth-3 parent">

	      	<div id="li-comment-411309" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/747937e1262044972f0f987667efc8e2.png" srcset="https://secure.gravatar.com/avatar/747937e1262044972f0f987667efc8e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">STYLIANOS IORDANIS</span>
	                <span class="date">August 27, 2017 at 7:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411309" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>autoencoder/ restricted Boltzmann layers also deal with multicollinearity issues… do MLPs also deal with multicollinearity if you have multicollinearity in the features, right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411309" onclick="return addComment.moveForm( &quot;comment-411309&quot;, &quot;411309&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to STYLIANOS IORDANIS">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411424" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-411424" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 28, 2017 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>MLPs are more robust to multicollinearity than linear models.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411424" onclick="return addComment.moveForm( &quot;comment-411424&quot;, &quot;411424&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-411514" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-411514" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d34f88ace6fa5777154aa3e43c0456c7.png" srcset="https://secure.gravatar.com/avatar/d34f88ace6fa5777154aa3e43c0456c7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hee Un</span>
	                <span class="date">August 29, 2017 at 12:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411514" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, I am always amazed at your article. Thank you.<br>
I have a question.<br>
Is this LSTM code now weighted for each features?<br>
Nowdays, I’m predicting precipitation, that is the trend is correct, but the amount is not right.<br>
What’s wrong with that?:(</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411514" onclick="return addComment.moveForm( &quot;comment-411514&quot;, &quot;411514&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hee Un">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411612" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-411612" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2017 at 5:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411612" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>Sorry, I’m not sure I understand the question, perhaps you could rephrase it?</p>
<p>I can say that I would expect better skill if the data was further prepared – e.g. made stationary.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411612" onclick="return addComment.moveForm( &quot;comment-411612&quot;, &quot;411612&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-411783" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-411783" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9feaca69d922a7e54eea179ea5a2f861.png" srcset="https://secure.gravatar.com/avatar/9feaca69d922a7e54eea179ea5a2f861?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vipul</span>
	                <span class="date">August 30, 2017 at 7:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411783" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for wonderful explanation!<br>
Could you please help me to understand dimensionality reduction concept. Should PCA or statistical approach be used before feeding the data to LSTM OR LSTM will learn correlation with the inputs provided on its own? how to approach regression problem in LSTM when we have large set of features?</p>
<p>Your reply is greatly appreciated!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411783" onclick="return addComment.moveForm( &quot;comment-411783&quot;, &quot;411783&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vipul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411845" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-411845" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 31, 2017 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411845" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, if you make the problem simpler using data preparation, the LSTM or any model will perform better.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411845" onclick="return addComment.moveForm( &quot;comment-411845&quot;, &quot;411845&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-411821" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-411821" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d902111389ae6ed31320da7a481d2835.png" srcset="https://secure.gravatar.com/avatar/d902111389ae6ed31320da7a481d2835?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nader</span>
	                <span class="date">August 31, 2017 at 2:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411821" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How can I predict a single input ?<br>
for example :</p>
<p>[0.036, 0.338, 0.197, 0.836, 0.333, 0.128, 0.00000001, 0.0000001]</p>
<p>how do i reshape and do a  model.predict () ?</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411821" onclick="return addComment.moveForm( &quot;comment-411821&quot;, &quot;411821&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nader">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411853" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-411853" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 31, 2017 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this post will make it clearer:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411853" onclick="return addComment.moveForm( &quot;comment-411853&quot;, &quot;411853&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411879" class="comment even depth-3 parent">

	      	<div id="li-comment-411879" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d902111389ae6ed31320da7a481d2835.png" srcset="https://secure.gravatar.com/avatar/d902111389ae6ed31320da7a481d2835?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nader</span>
	                <span class="date">August 31, 2017 at 12:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411879" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you, Jason.<br>
I applied: </p>
<p>my_x = np.array([0.036, 0.338, 0.197, 0.836, 0.333, 0.128, 0.00000001, 0.0000001])<br>
print(my_x.shape) # (8,)<br>
my_x = my_x.reshape((1, 1, 8))<br>
my_pred = model.predict(my_x)<br>
print(my_pred)</p>
<p>The answer is the “scaled” answer which is 0.03436</p>
<p>I tried applying the scaler.inverse_transform(my_pred)  to GET the actual number</p>
<p>But I get the following error: </p>
<p>on-broadcastable output operand with shape (1,1) doesn’t match the broadcast shape (1,8)</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411879" onclick="return addComment.moveForm( &quot;comment-411879&quot;, &quot;411879&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nader">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411986" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-411986" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 1, 2017 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411986" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the transform requires data in the same form as when you “fit” it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411986" onclick="return addComment.moveForm( &quot;comment-411986&quot;, &quot;411986&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414636" class="comment even depth-5">

	      	<div id="li-comment-414636" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6708431315d594fd2bfecfaf67d04e7f.png" srcset="https://secure.gravatar.com/avatar/6708431315d594fd2bfecfaf67d04e7f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">David</span>
	                <span class="date">September 23, 2017 at 3:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414636" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Then what if I use multi-time step prediction? (use several lags for prediction)<br>
The y_hat and X_test can not have the same dimension.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-414682" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-414682" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 24, 2017 at 5:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414682" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If the size of X or y must vary, you can use padding.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-411828" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-411828" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e09b295734f8fcc9e6b5a38b00cc474f.png" srcset="https://secure.gravatar.com/avatar/e09b295734f8fcc9e6b5a38b00cc474f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fejwin</span>
	                <span class="date">August 31, 2017 at 3:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411828" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for the tutorial!<br>
Maybe I missed something, but it seems that you provided the model with all of remaining data as ‘testdata’ and then tried predicting it? Isn’t that kind of pointless, since we should be interested in predicting unknown data in the future, instead of data that the model has already seen? Wouldn’t it make more sense to try the model to predict a first timestep into the future that neither the training nor the test data knew anything about? (Perhaps only give the model training data, but no test data, and afterwards ask it to predict first time step after training data?) How would I have to change the code to achieve that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411828" onclick="return addComment.moveForm( &quot;comment-411828&quot;, &quot;411828&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fejwin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411856" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-411856" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 31, 2017 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The model is fit on the training data, then makes a prediction for each step in the test data. The model did not “know” the answer to the test data prior to making each prediction.</p>
<p>Normally we would use walk-forward validation:<br>
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<p>I did use walk forward validation on other LSTM examples (use the blog search) but it confuses readers more than helps it seems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-411856" onclick="return addComment.moveForm( &quot;comment-411856&quot;, &quot;411856&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419420" class="comment even depth-3 parent">

	      	<div id="li-comment-419420" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04d2bb3133980fb172ae2abf47dad041.png" srcset="https://secure.gravatar.com/avatar/04d2bb3133980fb172ae2abf47dad041?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Guillermo</span>
	                <span class="date">November 8, 2017 at 9:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason.</p>
<p>I am digging into your example and maybe missing something because I agree with Fejwin.</p>
<p>I mean, as long as real Pollution in t-1 is introduced in the test_X set, instead of predicted Pollution in t-1, when you run model.predict(test_X) each output is not considered for future prediction.</p>
<p>This is with all the features, including real Pollution(t-1) the model predicts an output: predicted Pollution(t).  But on the next step, when the model predicts Pollution(t+1) it doesn´t take predicted Pollution(t), it takes real Pollution(t) instead.</p>
<p>Can you clarify this point please?</p>
<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419420" onclick="return addComment.moveForm( &quot;comment-419420&quot;, &quot;419420&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Guillermo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419488" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-419488" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 9, 2017 at 9:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419488" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the assumption in the setup of the problem is that each prior hours pollution is available when predicting t+1.</p>
<p>You could change the framing of the problem if you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419488" onclick="return addComment.moveForm( &quot;comment-419488&quot;, &quot;419488&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414709" class="comment even depth-2 parent">

	      	<div id="li-comment-414709" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6708431315d594fd2bfecfaf67d04e7f.png" srcset="https://secure.gravatar.com/avatar/6708431315d594fd2bfecfaf67d04e7f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">David</span>
	                <span class="date">September 24, 2017 at 1:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414709" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can I use part of trainX to predict testY ? (lags needed to predict testY is in trainX) Not sure if it is a logical way to do it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414709" onclick="return addComment.moveForm( &quot;comment-414709&quot;, &quot;414709&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to David">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414748" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-414748" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2017 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414748" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414748" onclick="return addComment.moveForm( &quot;comment-414748&quot;, &quot;414748&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-412028" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-412028" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/127cf1579a8d974dbeb196ac391018c4.png" srcset="https://secure.gravatar.com/avatar/127cf1579a8d974dbeb196ac391018c4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">hadi</span>
	                <span class="date">September 1, 2017 at 12:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412028" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason Brownlee,</p>
<p>I have a little different question, Actually I have a sequence of characters as input and I want to project it into a multidimensional space.<br>
I mean I want to project each sequence of chars (let say word) to an vector of 100 real numbers along my corpus, so my input is a sequence of chars (any char-emedding is welcome) and my output is a vector for each sequence (which is a word ) and Im really confused how to define the model,<br>
I would appreciate if you give any clue help or sample code to define my model.</p>
<p>Thanks a lot in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412028" onclick="return addComment.moveForm( &quot;comment-412028&quot;, &quot;412028&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to hadi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412045" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-412045" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 1, 2017 at 3:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Keras provides an Embedding layer that you can use directly:<br>
<a href="https://keras.io/layers/embeddings/" rel="nofollow">https://keras.io/layers/embeddings/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412045" onclick="return addComment.moveForm( &quot;comment-412045&quot;, &quot;412045&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-412087" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-412087" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bcd96901407c33887c0f2bb82bc4a96e.png" srcset="https://secure.gravatar.com/avatar/bcd96901407c33887c0f2bb82bc4a96e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sai k</span>
	                <span class="date">September 2, 2017 at 12:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412087" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for the wonderful tutorial!<br>
Could you please explain how to deal the problem when situation is “Predict the pollution for the complete month (assume month has 30 days. t+1…t+30) and given the “expected” weather features for that month…assuming we have been provided historic data of pollution and weather data on daily basis”</p>
<p>How should the data be prepared and how it should be feed into LSTM?</p>
<p>As I new to LSTM model, I have problem understanding the data preparation and feeding to LSTM.</p>
<p>Thanks in advance for your response</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412087" onclick="return addComment.moveForm( &quot;comment-412087&quot;, &quot;412087&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sai k">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412120" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-412120" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 2, 2017 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412120" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Predicting for a month is called multi-step forecasting.</p>
<p>Here is a post on the general approach:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<p>Here is an example of doing multi-step forecasting with an LSTM:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412120" onclick="return addComment.moveForm( &quot;comment-412120&quot;, &quot;412120&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-412619" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-412619" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3795e33ff2464384809c70d4ea93c61c.png" srcset="https://secure.gravatar.com/avatar/3795e33ff2464384809c70d4ea93c61c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian</span>
	                <span class="date">September 5, 2017 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412619" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for sharing. I added accuracy info to model while training using ‘ metrics=[‘accuracy’] ‘.</p>
<p>So model.compile(loss=’mae’, optimizer=’adam’) becomes : </p>
<p>model.compile(loss=’mae’, optimizer=’adam’, metrics=[‘accuracy’])</p>
<p>This adds acc &amp; val_acc to output. After 100 epochs the acc value appears quite low : (0.0761) :<br>
Epoch 100/100<br>
1s – loss: 0.0143 – acc: 0.0761 – val_loss: 0.0132 – val_acc: 0.0393</p>
<p>The accuracy of the model appears very low ? Is this expected ?</p>
<p>Further info on acc &amp; val_acc values : <a href="https://github.com/tflearn/tflearn/issues/357" rel="nofollow">https://github.com/tflearn/tflearn/issues/357</a> “acc is the accuracy of a batch of training data and val_acc is the accuracy of a batch of testing data.”</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412619" onclick="return addComment.moveForm( &quot;comment-412619&quot;, &quot;412619&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Adrian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412943" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-412943" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 7, 2017 at 12:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412943" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a regression problem. Accuracy does not make sense.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412943" onclick="return addComment.moveForm( &quot;comment-412943&quot;, &quot;412943&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-412632" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-412632" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b5b675dd30589029154fd70d2695559f.png" srcset="https://secure.gravatar.com/avatar/b5b675dd30589029154fd70d2695559f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.hiller.pro/" rel="external nofollow" class="url">Eric H</a></span>
	                <span class="date">September 5, 2017 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412632" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I’ve recently discovered your site and have been so pleased with your information – thank you. I’ve been trying to model data which is much like the air quality data described here, but every few time steps there will be a change in the number of features present.<br>
Example: in my data a time step = 1 day and a sequence can be 800 – 1200 days long. Normally the data consists of features<br>
– pm2.5: PM2.5 concentration<br>
– DEWP: Dew Point<br>
– TEMP: Temperature<br>
– PRES: Pressure<br>
– cbwd: Combined wind direction<br>
– Iws: Cumulated wind speed<br>
– Is: Cumulated hours of snow<br>
– Ir: Cumulated hours of rain</p>
<p>But then every (random-ish amount of time) there will be an additional number of features for a day and then back to the baseline number of features. </p>
<p>I’ve no idea on how to handle variable feature length. I’ve seen and played with plenty of variable sequence length examples, but I have both variable sequenceS and features. I’d love your input!<br>
Thanks!<br>
-Eric</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412632" onclick="return addComment.moveForm( &quot;comment-412632&quot;, &quot;412632&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Eric H">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412945" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-412945" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 7, 2017 at 12:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412945" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You will need to normalize the number of features to be consistent for all time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-412945" onclick="return addComment.moveForm( &quot;comment-412945&quot;, &quot;412945&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413305" class="comment even depth-3 parent">

	      	<div id="li-comment-413305" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0560d6c56f22b7fdb70baa59155c6206.png" srcset="https://secure.gravatar.com/avatar/0560d6c56f22b7fdb70baa59155c6206?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.hiller.pro/" rel="external nofollow" class="url">Eric Hiller</a></span>
	                <span class="date">September 10, 2017 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413305" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it possible to use (what in TensorFlow – land is called) SparseFeatures or SparseTensors to represent sparse datasets, or is there a fundamental issue with handling sparse datasets within RNNs?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413305" onclick="return addComment.moveForm( &quot;comment-413305&quot;, &quot;413305&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Eric Hiller">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413426" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-413426" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 11, 2017 at 12:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413426" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, I’m not sure off the cuff. Keras may support sparse numpy arrays – try it and see?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413426" onclick="return addComment.moveForm( &quot;comment-413426&quot;, &quot;413426&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413037" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413037" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ffd32cab7c13fd706aef8e486c6cd864.png" srcset="https://secure.gravatar.com/avatar/ffd32cab7c13fd706aef8e486c6cd864?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali Haidar</span>
	                <span class="date">September 8, 2017 at 1:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413037" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for the amazing articles. They are really helpful. </p>
<p>Lets say I want to forecast with lead 2. I mean by that forecasting values at time t using t-2 values, without using t-1 elements. I have to remove columns from reframed  after running function series_to_supervised right ? To remove all columns with values t-1?<br>
reframed.drop(reframed.columns[…])</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413037" onclick="return addComment.moveForm( &quot;comment-413037&quot;, &quot;413037&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ali Haidar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413208" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413208" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2017 at 11:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413208" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yep, looks good.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413208" onclick="return addComment.moveForm( &quot;comment-413208&quot;, &quot;413208&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413472" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-413472" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/940af00480e39fd02024ee712636cf05.png" srcset="https://secure.gravatar.com/avatar/940af00480e39fd02024ee712636cf05?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Inna</span>
	                <span class="date">September 11, 2017 at 7:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413472" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello!<br>
Thanks for articles.</p>
<p>I have a question related with time series. Is it possible to forecast all variables? For example, I have ‘pollution’, ‘dew’, ‘temp’, ‘press’, ‘wnd_dir’, ‘wnd_spd’, ‘snow’, ‘rain’ and want to predict all of them for the next hour. We know about trends and common rules (because of data amount: few years), so we can do forecasting. Where can I find more info about it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413472" onclick="return addComment.moveForm( &quot;comment-413472&quot;, &quot;413472&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Inna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413632" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413632" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 13, 2017 at 12:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413632" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this example can be modified to predict each variable.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413632" onclick="return addComment.moveForm( &quot;comment-413632&quot;, &quot;413632&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413539" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413539" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/75f29114f59792781c134003b0e15cf5.png" srcset="https://secure.gravatar.com/avatar/75f29114f59792781c134003b0e15cf5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">appreciator</span>
	                <span class="date">September 12, 2017 at 10:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413539" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason for the great tutorial! I’m adapting it for different data, and i’m trying to use &gt;1 time step. However I noticed something strange in the series-to-supervised: Since the first loops ends at 0 and the last loops starts at 0, won’t there be two columns that are the same?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413539" onclick="return addComment.moveForm( &quot;comment-413539&quot;, &quot;413539&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to appreciator">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413641" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413641" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 13, 2017 at 12:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413641" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, try it with the data and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413641" onclick="return addComment.moveForm( &quot;comment-413641&quot;, &quot;413641&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413541" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-413541" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2652cc5d8b7c695c33eec56a8206774b.png" srcset="https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">September 12, 2017 at 11:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413541" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the tutorial. I had just one question though.<br>
I’ve seen tutorial using multivariate time series to train a lot of dataset (all have correlation between each other) at the same time and were able to predict for each dataset used.</p>
<p>For sake of argument let’s say than one of the dataset is broke, the sensor that get the information to feed it is out of service (let’s say at some point one of the column of data only have 0 instead of whatever value). Do you think that we could use the other spot to continue to predict the broken one? (there is correlation between them and there would be a lot of non broken data from before the bug)</p>
<p>Best regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413541" onclick="return addComment.moveForm( &quot;comment-413541&quot;, &quot;413541&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Eric">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413642" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-413642" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 13, 2017 at 12:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you could try it and see. Or impute the missing data and see if that is better.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413642" onclick="return addComment.moveForm( &quot;comment-413642&quot;, &quot;413642&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413778" class="comment even depth-3 parent">

	      	<div id="li-comment-413778" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2652cc5d8b7c695c33eec56a8206774b.png" srcset="https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">September 14, 2017 at 2:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason,</p>
<p>I shall try that as soon as possible.I guess that the overall accuracy will lower for every set prediction (since my goal is to use multivariate, feed it every spot data set and predict each of them (with possibility to predict a broken one)) so one spot being fed “wrong” data should lower each spot accuracy no?</p>
<p>Best regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413778" onclick="return addComment.moveForm( &quot;comment-413778&quot;, &quot;413778&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Eric">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413892" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-413892" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 15, 2017 at 12:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It will.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413892" onclick="return addComment.moveForm( &quot;comment-413892&quot;, &quot;413892&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413612" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413612" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb4ff520de26ec298c8962811ea5d5e4.png" srcset="https://secure.gravatar.com/avatar/eb4ff520de26ec298c8962811ea5d5e4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://pk.linkedin.com/in/shanzehra66" rel="external nofollow" class="url">Shan</a></span>
	                <span class="date">September 13, 2017 at 3:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413612" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there any time parser like date parser? I am working with data which is in milliseconds.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413612" onclick="return addComment.moveForm( &quot;comment-413612&quot;, &quot;413612&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Shan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413653" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413653" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 13, 2017 at 12:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413653" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It can handle parsing dates and times I believe.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413653" onclick="return addComment.moveForm( &quot;comment-413653&quot;, &quot;413653&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413697" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-413697" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7b1550e35b177010ba173392794a1c30.png" srcset="https://secure.gravatar.com/avatar/7b1550e35b177010ba173392794a1c30?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kumar</span>
	                <span class="date">September 13, 2017 at 10:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413697" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i got this error when i tried to run the program</p>
<p>pyplot.plot(history.history[‘val_loss’], label=’test’)<br>
KeyError: ‘val_loss’</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413697" onclick="return addComment.moveForm( &quot;comment-413697&quot;, &quot;413697&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413880" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413880" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 15, 2017 at 12:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413880" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ensure you copy all of the code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413880" onclick="return addComment.moveForm( &quot;comment-413880&quot;, &quot;413880&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413943" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413943" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7f27b9e48ab4d5da5ea8c5e078aa164f.png" srcset="https://secure.gravatar.com/avatar/7f27b9e48ab4d5da5ea8c5e078aa164f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Simon</span>
	                <span class="date">September 15, 2017 at 9:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413943" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Wouldn’t it be better to scale the data after you run the series_to_supervised function? As it stands now, the inverse scaling doesn’t work if n_in &gt; 1 since the dimensions don’t line up anymore.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413943" onclick="return addComment.moveForm( &quot;comment-413943&quot;, &quot;413943&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Simon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413993" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-413993" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 16, 2017 at 8:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413993" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It would, but the scaling would be column-wise and incorrect.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413993" onclick="return addComment.moveForm( &quot;comment-413993&quot;, &quot;413993&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414096" class="comment even depth-3 parent">

	      	<div id="li-comment-414096" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7f27b9e48ab4d5da5ea8c5e078aa164f.png" srcset="https://secure.gravatar.com/avatar/7f27b9e48ab4d5da5ea8c5e078aa164f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Simon</span>
	                <span class="date">September 17, 2017 at 11:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you expand more on this and how the code might be modified to incorporate multi-step? I’m also playing around with turning this into a classification problem, would it still work if the feature we are trying to predict is a classifier?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414096" onclick="return addComment.moveForm( &quot;comment-414096&quot;, &quot;414096&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Simon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414149" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-414149" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 18, 2017 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414149" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I give the code to do this in another comment.</p>
<p>For classification, you will need to change the number of neurons in the output layer, the activation function in the output layer and the loss function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414149" onclick="return addComment.moveForm( &quot;comment-414149&quot;, &quot;414149&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413972" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-413972" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e6a151e8cc4b7a273ab54f2c365bb1f2.png" srcset="https://secure.gravatar.com/avatar/e6a151e8cc4b7a273ab54f2c365bb1f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Agrippa Sulla</span>
	                <span class="date">September 16, 2017 at 5:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a little question. I’ve successfully built my own LSTM multivariate NN using your code as a basis (thanks!). It forecasts export growth for the UK using past export growth and GDP. It perform decently but the financial crisis kinda messes things up. </p>
<p>Now I want to add data to this model, but I can’t go further back than 1980 for the time-series (not for now at least). So what I want to do is add the GDP growth rate of all the UK’s major trading partners. Should I be worried about adding another 20 input neurons (e.g. countries)? Do you have a post talking about the risks of using data that is low in rows (e.g. years) but high in columns (e.g. inputs).</p>
<p>I hope my question makes sense.</p>
<p>Cheers</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413972" onclick="return addComment.moveForm( &quot;comment-413972&quot;, &quot;413972&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Agrippa Sulla">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414001" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-414001" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 16, 2017 at 8:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414001" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t have posts on the topic of more columns than rows. It does require careful handling.</p>
<p>As a start, I would recommend developing a strong test harness, then try adding data and see how it impacts the model skill. Experiment.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414001" onclick="return addComment.moveForm( &quot;comment-414001&quot;, &quot;414001&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413974" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413974" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/875163e086ed54c30ce973cde9e5fbfe.png" srcset="https://secure.gravatar.com/avatar/875163e086ed54c30ce973cde9e5fbfe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ed</span>
	                <span class="date">September 16, 2017 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason<br>
Thanks a lot for your tutorial!<br>
Is there a feature importance plot for cases like this?<br>
sometimes is very important to know it</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-413974" onclick="return addComment.moveForm( &quot;comment-413974&quot;, &quot;413974&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414002" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-414002" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 16, 2017 at 8:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414002" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question. I’m not sure about feature importance plots for LSTMs. I would expect that if feature importance can be calculated for MLPs, then it could be calculated for LSTMs, but this is not something I have looked into sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414002" onclick="return addComment.moveForm( &quot;comment-414002&quot;, &quot;414002&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414057" class="comment even depth-3 parent">

	      	<div id="li-comment-414057" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/875163e086ed54c30ce973cde9e5fbfe.png" srcset="https://secure.gravatar.com/avatar/875163e086ed54c30ce973cde9e5fbfe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ed</span>
	                <span class="date">September 17, 2017 at 2:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414057" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot, Jason!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414057" onclick="return addComment.moveForm( &quot;comment-414057&quot;, &quot;414057&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414074" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-414074" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 17, 2017 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414074" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414074" onclick="return addComment.moveForm( &quot;comment-414074&quot;, &quot;414074&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414298" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-414298" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1293f7a013a2b84eca196f7030d734e4.png" srcset="https://secure.gravatar.com/avatar/1293f7a013a2b84eca196f7030d734e4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kuldeep</span>
	                <span class="date">September 20, 2017 at 12:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414298" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great post as always!</p>
<p>I have a question regarding scaling. My problem is quite different as I have to apply series to supervised function first on the data coming from different source and then combine the data… my question is, can I apply scaling at the end? Should scaling be applied column wise or on complete matrix/array?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414298" onclick="return addComment.moveForm( &quot;comment-414298&quot;, &quot;414298&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kuldeep">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414327" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-414327" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 20, 2017 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414327" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The key is being able to scale the data consistently. The place in the pipeline is less important.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414327" onclick="return addComment.moveForm( &quot;comment-414327&quot;, &quot;414327&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414387" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-414387" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/59604064be8b82a41693c4249bbe84f6.png" srcset="https://secure.gravatar.com/avatar/59604064be8b82a41693c4249bbe84f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nejra</span>
	                <span class="date">September 21, 2017 at 1:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414387" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason thank you very much for your tutorials!<br>
I’m trying to develop an LSTM for time prediction having as input 3 features (2 measurements and a third one is a sort of control of the system) and the output (value to predict) is not a single value but a vector of 6 values. So, at every time step my network should be able to predict this entire vector. Two questions:<br>
1. Since my inputs are not correlated between them, their order in the input array will not influence my predictions?<br>
2. How can I shape my output in order to estimate all the 6 values of the vector for each time step?<br>
Thanks for any kind of help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414387" onclick="return addComment.moveForm( &quot;comment-414387&quot;, &quot;414387&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nejra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414414" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-414414" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 21, 2017 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help you understand how to prepare data for multi-step forecasting:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414414" onclick="return addComment.moveForm( &quot;comment-414414&quot;, &quot;414414&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414484" class="comment even thread-even depth-1">

	      	<div id="li-comment-414484" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9925e36e69c54e780388dcb6920538f5.png" srcset="https://secure.gravatar.com/avatar/9925e36e69c54e780388dcb6920538f5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mitchel Myers</span>
	                <span class="date">September 22, 2017 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I replicated the example described on this page, and saved my test_y and yhat vectors to csv so that I could manually check how my prediction compared with the true values. However, when I did this, I discovered that every yhat value in my array is the exact same value (~34). I was expecting a unique yhat value for each input vector. Do you have any suggestions to help fix this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414484" onclick="return addComment.moveForm( &quot;comment-414484&quot;, &quot;414484&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mitchel Myers">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-414584" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-414584" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9925e36e69c54e780388dcb6920538f5.png" srcset="https://secure.gravatar.com/avatar/9925e36e69c54e780388dcb6920538f5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mitchel Myers</span>
	                <span class="date">September 23, 2017 at 3:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414584" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Follow up on this — when this error arose, I was using my own data set that I want to perform time series forecasting on. When I duplicated the guide exactly as described above, the issue goes away. Do you have any idea why this issue comes up (where every predicted yhat value is the exact same) when I use a different data set?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414584" onclick="return addComment.moveForm( &quot;comment-414584&quot;, &quot;414584&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mitchel Myers">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414609" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-414609" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 23, 2017 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414609" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the model needs to be tuned to your specific dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414609" onclick="return addComment.moveForm( &quot;comment-414609&quot;, &quot;414609&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414777" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-414777" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f20603c6433d511e2596e9077c08acee.png" srcset="https://secure.gravatar.com/avatar/f20603c6433d511e2596e9077c08acee?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">zwj</span>
	                <span class="date">September 25, 2017 at 1:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414777" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason thank you very much for your tutorials!  I try to delete the columns [‘dew’, ‘temp’, ‘press’, ‘wnd_dir’, ‘wnd_spd’, ‘snow’, ‘rain’] from the train_X data, and I also get the almost same test RMSE. It is 26.461. It seems to show that the 8 weather conditions have no affect on the prediction result. The code is below.</p>
<p># fit an LSTM network to training data<br>
def fit_lstm(train, test, batch_size, neurons):<br>
	# split into input and outputs<br>
	train_X, train_y = train[:, 0:1], train[:, -1]<br>
	test_X, test_y   = test [:, 0:1], test [:, -1]</p>
<p>	train_X = train_X.reshape((train_X.shape[0], 1, train_X.shape[1]))<br>
	test_X  = test_X.reshape((test_X.shape[0],   1, test_X.shape[1]))<br>
	print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)</p>
<p>	# design network<br>
	model = Sequential()<br>
	model.add(LSTM(neurons, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
	model.add(Dense(1))<br>
	model.compile(loss=’mae’, optimizer=’adam’)</p>
<p>	# fit network<br>
	history = model.fit(train_X, train_y, epochs=50, batch_size=batch_size, validation_data=(test_X, test_y), verbose=2, shuffle=False)<br>
	#history = model.fit(train_X, train_y, epochs=50, batch_size=72,  verbose=2, shuffle=False)</p>
<p>	return model</p>
<p># make a prediction<br>
def make_forecasts(model, test_X):<br>
	test_X = test_X[:, 0:1]<br>
	test_X = test_X.reshape((test_X.shape[0], 1, test_X.shape[1]))<br>
	forecasts   = model.predict(test_X)</p>
<p>	return forecasts</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414777" onclick="return addComment.moveForm( &quot;comment-414777&quot;, &quot;414777&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to zwj">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414781" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-414781" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2017 at 3:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414781" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice one!</p>
<p>The real motivation for me writing this post was to help the 100s of people asking how to develop a multivariate LSTM. </p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414781" onclick="return addComment.moveForm( &quot;comment-414781&quot;, &quot;414781&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419849" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-419849" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d713d62e11b0bb299172446029774587.png" srcset="https://secure.gravatar.com/avatar/d713d62e11b0bb299172446029774587?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tommy</span>
	                <span class="date">November 13, 2017 at 4:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is more substantial than I think is being acknowledged. What is the point of creating a multivariate lstm if all of the other variables don’t have an impact on the outcome? Has this been attempted with other data sets?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419849" onclick="return addComment.moveForm( &quot;comment-419849&quot;, &quot;419849&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tommy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419879" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-419879" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 13, 2017 at 10:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419879" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is an example for those who want to explore the approach.</p>
<p>I don’t have more examples because it turns out the method is outperformed by MLPs for autoregression problems. At least in my experience.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419879" onclick="return addComment.moveForm( &quot;comment-419879&quot;, &quot;419879&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414875" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-414875" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9925e36e69c54e780388dcb6920538f5.png" srcset="https://secure.gravatar.com/avatar/9925e36e69c54e780388dcb6920538f5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mitchel</span>
	                <span class="date">September 27, 2017 at 1:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you explain why the train_X and test_X data sets are reshaped to this? </p>
<p>train_X = train_X.reshape((train_X.shape[0], 1, train_X.shape[1]))<br>
test_X = test_X.reshape((test_X.shape[0], 1, test_X.shape[1]))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414875" onclick="return addComment.moveForm( &quot;comment-414875&quot;, &quot;414875&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mitchel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414899" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-414899" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 27, 2017 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The shape is: samples, time steps, features.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414899" onclick="return addComment.moveForm( &quot;comment-414899&quot;, &quot;414899&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414989" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-414989" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e29b1c2bd454a5e2df26fe21de087201.png" srcset="https://secure.gravatar.com/avatar/e29b1c2bd454a5e2df26fe21de087201?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lino</span>
	                <span class="date">September 28, 2017 at 12:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414989" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Great post.<br>
Suppose i want to predict the next 24h using previous one year dataset. How can we do it?<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-414989" onclick="return addComment.moveForm( &quot;comment-414989&quot;, &quot;414989&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Lino">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415003" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415003" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 28, 2017 at 4:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415003" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I give an example in another comment.</p>
<p>Also, generally, see this post on multi-step forecasting with LSTMs:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415003" onclick="return addComment.moveForm( &quot;comment-415003&quot;, &quot;415003&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415052" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-415052" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c2bd8400b88bcf8af2c920474375a392.png" srcset="https://secure.gravatar.com/avatar/c2bd8400b88bcf8af2c920474375a392?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nels</span>
	                <span class="date">September 29, 2017 at 5:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415052" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think I’m missing something fundamental in my understanding of LSTM/s and BPTT.  I’ve read through many of your posts and have come to understand RNN’s and LSTM in particular much better because of them, so thank you for that!</p>
<p>My question that I hope you can shed some light on is what is the difference between passing the past information, i.e. var(t-n)…var(t-1) in the input vector for a single sample, and passing multiple sequences, of length n as a single sample?</p>
<p>To help clarify,  using temsteps of length N, I have a configuration that looks like this:</p>
<p>Input to LSTM is [samples, timesteps, features].<br>
Each sample/observation consists of a vector of timestamps (of size N+1) where each of these vector’s values corresponds to the input feature’s values I.e.</p>
<p>            Observations for each time t, with features f and r<br>
            [<br>
                time t<br>
                [<br>
                    [  f(t-N)            r(t-N)          ]<br>
                    [  f(t-N+1)          r(t-N+1)        ]<br>
                    [  f(t-N+2)          r(t-N+2)        ]<br>
                        .                   .<br>
                        .                   .<br>
                        .                   .<br>
                    [  f(t)              r(t)            ]<br>
                ]<br>
            ]<br>
And for each observation/sequence the target is Y(t).</p>
<p>Or, as many of your examples do, you can include the the past information in the form of a windowed input, with a single time step, so something like:</p>
<p>Input is [samples, 1, features].  So for every observation, we include previous time values as features</p>
<p> Observations for each time t, with features f and r<br>
            [<br>
                time t<br>
                [<br>
                    [  f(t-N), r(t-N), f(t-N+1), r(t-N+1), f(t-N+2), r(t-N+2), f(t), r(t) ]<br>
                ]<br>
            ]<br>
And again, for each observation, the target is Y(t).</p>
<p>I understand that having sequences longer than 1 allows BPTT to work over the length of those sequences, but I don’t think I really understand the difference in these two methods.</p>
<p>I have tried the described two options, and I find the the latter is performing better based on preliminary tests.  I can use a window size of 3 and a sequence length of 1 and get good results, but if I use the first approach and a window size of 12, the model actually fails to learn within the same amount of time.  </p>
<p>Hence, I wonder if I don’t have a fundamental misconception.  If you have some time, I would like to hear your explanation on this difference and how the LSTM responds in terms of “memory” based on these two different types of input setup. (I have read a lot of articles, blogs, git hub issues, and stack overflow posts trying to wrap my head around this, but I haven’t found anything that address this directly.)</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415052" onclick="return addComment.moveForm( &quot;comment-415052&quot;, &quot;415052&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nels">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415147" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415147" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2017 at 7:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, the multiple steps for one sequence are required for BPTT:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>
<p>Without the history, the training will not have sufficient context to estimate the error gradient and your model will learn a function mapping rather than a sequence prediction problem.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415147" onclick="return addComment.moveForm( &quot;comment-415147&quot;, &quot;415147&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415074" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-415074" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f30fc38f9fa6638a5a12865fa22b9d85.png" srcset="https://secure.gravatar.com/avatar/f30fc38f9fa6638a5a12865fa22b9d85?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Paul</span>
	                <span class="date">September 29, 2017 at 12:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415074" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>With this line…</p>
<p># drop columns we don’t want to predict<br>
reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)</p>
<p>I don’t understand the numbers used here, doesn’t the data not even have that many columns? There are 8 feature columns and 1 index column.</p>
<p>I’m adapting this code for my own use and have very different features but I’m not sure I’m getting that line adapted right.</p>
<p>Thanks for the great post!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415074" onclick="return addComment.moveForm( &quot;comment-415074&quot;, &quot;415074&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Paul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415077" class="comment even depth-2 parent">

	      	<div id="li-comment-415077" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f30fc38f9fa6638a5a12865fa22b9d85.png" srcset="https://secure.gravatar.com/avatar/f30fc38f9fa6638a5a12865fa22b9d85?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Paul</span>
	                <span class="date">September 29, 2017 at 1:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415077" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nevermind! I figured it out.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415077" onclick="return addComment.moveForm( &quot;comment-415077&quot;, &quot;415077&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Paul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415153" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-415153" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2017 at 7:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415153" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it Paul.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415153" onclick="return addComment.moveForm( &quot;comment-415153&quot;, &quot;415153&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415151" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415151" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2017 at 7:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415151" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It does have that many columns after we reshape it to be a supervised learning problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415151" onclick="return addComment.moveForm( &quot;comment-415151&quot;, &quot;415151&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415194" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-415194" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/60621ea4285d8f8b2de21f0c44dfe602.png" srcset="https://secure.gravatar.com/avatar/60621ea4285d8f8b2de21f0c44dfe602?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wenhan Wang</span>
	                <span class="date">September 30, 2017 at 2:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415194" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is awesome!<br>
Helping me a lot in my real work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415194" onclick="return addComment.moveForm( &quot;comment-415194&quot;, &quot;415194&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Wenhan Wang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415251" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415251" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 1, 2017 at 9:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415251" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I’m glad to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415251" onclick="return addComment.moveForm( &quot;comment-415251&quot;, &quot;415251&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415585" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-415585" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c17646630cda46b35e860e874fe1663f.png" srcset="https://secure.gravatar.com/avatar/c17646630cda46b35e860e874fe1663f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vilmara Sanchez</span>
	                <span class="date">October 4, 2017 at 3:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Jason, I am working on a project for sleep stage classification where the number of timesteps (observations) in the input series (ECG signal) is different than the number of timesteps in the output series (sleep stage scores).</p>
<p>The issue here is that the input and output time series are not equal in terms of timesteps as the examples you have shown in your problems.</p>
<p>I have tried to frame the problem in different ways without getting results that make sense. Could you please provide guidance on how to approach this problem?. </p>
<p>Thanks,</p>
<p>Vilmara</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415585" onclick="return addComment.moveForm( &quot;comment-415585&quot;, &quot;415585&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vilmara Sanchez">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415650" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415650" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 5, 2017 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415650" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, I would recommend an encoder-decoder model:<br>
<a href="https://machinelearningmastery.com/encoder-decoder-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/encoder-decoder-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415650" onclick="return addComment.moveForm( &quot;comment-415650&quot;, &quot;415650&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415844" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-415844" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d4219d9a8164c0ed0477d3a23672fb16.png" srcset="https://secure.gravatar.com/avatar/d4219d9a8164c0ed0477d3a23672fb16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Devakar Verma</span>
	                <span class="date">October 6, 2017 at 6:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
If we want to predict multiple features as output and having multiple feature as input. How can we solve this problem. For example input variables are temperature and humidity and want to predict both temperature and humidity, can we solve this with single LSTM model.</p>
<p>Thanks for your anticipated response.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415844" onclick="return addComment.moveForm( &quot;comment-415844&quot;, &quot;415844&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Devakar Verma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415886" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415886" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 7, 2017 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415886" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes you can. Change the multivariate input model to output more than one value in the output layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415886" onclick="return addComment.moveForm( &quot;comment-415886&quot;, &quot;415886&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415894" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-415894" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bcd3b622e0760a0bf9412b973bc05955.png" srcset="https://secure.gravatar.com/avatar/bcd3b622e0760a0bf9412b973bc05955?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brent</span>
	                <span class="date">October 7, 2017 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thank you for taking the time to write such an excellent post and follow up with questions. The mechanics of the data conversion &amp; training work great.</p>
<p>However, my first reaction is that the LSTM doesn’t seem to have learned anything more than to copy the previous value. As BECKER states:</p>
<p>&gt;  it looks like the predicted value is always 1 time period after the actual?</p>
<p>These are the same results as in your Shampoo example: the predicted value appears to be equal to the previous value (possibly with some constant offset).</p>
<p>Have you found a different network architecture that performs better than a DNN without LSTM layers?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415894" onclick="return addComment.moveForm( &quot;comment-415894&quot;, &quot;415894&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Brent">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415898" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415898" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 7, 2017 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Agreed, LSTMs do not seem to be very good for autoregression. I would generally recommend using an MLP with a window for time series forecasting instead.</p>
<p>See this post:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-415898" onclick="return addComment.moveForm( &quot;comment-415898&quot;, &quot;415898&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416082" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-416082" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9a86dbf59fb76e77c25bf2c5f727bf1b.png" srcset="https://secure.gravatar.com/avatar/9a86dbf59fb76e77c25bf2c5f727bf1b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sathvik</span>
	                <span class="date">October 9, 2017 at 1:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416082" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much Jason for the wonderful article, learnt a lot… I wanted to have a comparison shown on multivariate statistical methods and neural networks and I was looking for some post/article on multivariate time series model using ARIMA. I would be glad to know if anything you know of the same. </p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416082" onclick="return addComment.moveForm( &quot;comment-416082&quot;, &quot;416082&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to sathvik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416097" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-416097" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2017 at 4:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You will need to look into using SARIMAX, sorry I do not have an example at this stage.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416097" onclick="return addComment.moveForm( &quot;comment-416097&quot;, &quot;416097&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416374" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-416374" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb4ff520de26ec298c8962811ea5d5e4.png" srcset="https://secure.gravatar.com/avatar/eb4ff520de26ec298c8962811ea5d5e4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shan</span>
	                <span class="date">October 12, 2017 at 4:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416374" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, is there any library available to perform feature extraction/  dimensionlity reduction for sequential LSTM model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416374" onclick="return addComment.moveForm( &quot;comment-416374&quot;, &quot;416374&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Shan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416391" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-416391" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 12, 2017 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416391" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Often an embedding layer is used to project observations at each time step prior to feeding them into the LSTM.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416391" onclick="return addComment.moveForm( &quot;comment-416391&quot;, &quot;416391&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416424" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-416424" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3df940b021e9a3a144157d4f535a2e71.png" srcset="https://secure.gravatar.com/avatar/3df940b021e9a3a144157d4f535a2e71?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Terry</span>
	                <span class="date">October 12, 2017 at 6:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How does multivariate LSTM compare to Multivariate ARIMAX? Are there use cases where one model outperforms the other?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416424" onclick="return addComment.moveForm( &quot;comment-416424&quot;, &quot;416424&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Terry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416482" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-416482" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 13, 2017 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend using a linear model first and only moving to a neural net if it delivers better results on your specific problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416482" onclick="return addComment.moveForm( &quot;comment-416482&quot;, &quot;416482&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416471" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-416471" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/903c36c55f2a28cbb668176cd7d40522.png" srcset="https://secure.gravatar.com/avatar/903c36c55f2a28cbb668176cd7d40522?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hesam</span>
	                <span class="date">October 13, 2017 at 4:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416471" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>There are some problem of scaling back when we use more than one shift in time, I mean something like this: </p>
<p>reframed = series_to_supervised(scaled, 6, 1)</p>
<p>I can train and test the model, but some errors appears in the scaling back section which I couldn’t fix.</p>
<p>Please have a look. I really appreciate it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416471" onclick="return addComment.moveForm( &quot;comment-416471&quot;, &quot;416471&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hesam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-416511" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-416511" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/26fe5f76e4e425fd61f5e57fe20ac99f.png" srcset="https://secure.gravatar.com/avatar/26fe5f76e4e425fd61f5e57fe20ac99f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anil Maddala</span>
	                <span class="date">October 13, 2017 at 9:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416511" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for the great series of articles. How should I modify the code from changing the LSTM code from preiction to classification?</p>
<p>One sample input data is 60 time steps over 2 features and I want to classify the 60 step input sequence into 3 classes.  To start with is LSTM the right approach?</p>
<p>Hoping that you wold take any requests, I would definetly love to see an article on Multivariate classification in Keras using LSTM/GRU and it would be really helpful for analyzing sensor data. You could look at the Human Activity Recognition dataset</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416511" onclick="return addComment.moveForm( &quot;comment-416511&quot;, &quot;416511&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Anil Maddala">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416530" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-416530" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 13, 2017 at 2:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416530" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Change the loss function and the activation function of the output layer to categorical_crossentropy and softmax respectively.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416530" onclick="return addComment.moveForm( &quot;comment-416530&quot;, &quot;416530&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416560" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-416560" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d34f88ace6fa5777154aa3e43c0456c7.png" srcset="https://secure.gravatar.com/avatar/d34f88ace6fa5777154aa3e43c0456c7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">heeun</span>
	                <span class="date">October 13, 2017 at 6:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416560" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks yor nice article.</p>
<p>I have a question!</p>
<p>That algorithm is many to one right?</p>
<p>How can I slove many to many?? for example, i want predict pollution and rain</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416560" onclick="return addComment.moveForm( &quot;comment-416560&quot;, &quot;416560&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to heeun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416619" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-416619" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2017 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416619" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is many-to-one in terms of features.</p>
<p>You can change it to be many-to-many by outputting multiple features.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416619" onclick="return addComment.moveForm( &quot;comment-416619&quot;, &quot;416619&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416646" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-416646" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/63263f95035f8c4fb1ec667a96d08822.png" srcset="https://secure.gravatar.com/avatar/63263f95035f8c4fb1ec667a96d08822?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pau</span>
	                <span class="date">October 14, 2017 at 1:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416646" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>3 Things:<br>
1) Thanks so much for this. I’ve used this as a basis for some code I’m writing and it gave me a great head start.<br>
2) One thing that would be great to help with understanding the meanings of variables you’re using is to first put them into variables rather than using the integers. For example, </p>
<p>x_size = 1<br>
train_X, train_y = train[:, :-x_size], train[:, -x_size:]<br>
test_X, test_y = test[:, :-x_size], test[:, -x_size:]</p>
<p>This way, as people are reading the code they understand why it’s “-1” in case their adapted usage has different dimensions, they can change one variable and have it used everywhere it’s needed. </p>
<p>3) For instance, I’m trying to make this code output multiple predictions and am having a bit of trouble figuring out all the variables I need to change.</p>
<p>I have 368 columns of data, the first 168 are what will be predicted based on the other 200 points.</p>
<p>    x_size = 200<br>
    # split into input and outputs<br>
    train_X, train_y = train[:, :-x_size], train[:, -x_size:]<br>
    test_X, test_y = test[:, :-x_size], test[:, -x_size:]</p>
<p>    # reshape input to be 3D [samples, timesteps, features]<br>
    train_X = train_X.reshape((train_X.shape[0], 1, train_X.shape[1]))<br>
    test_X = test_X.reshape((test_X.shape[0], 1, test_X.shape[1]))<br>
    print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)</p>
<p>    # design network<br>
    model = Sequential()<br>
    model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
    model.add(Dense(1))</p>
<p>I get the error:<br>
ValueError: Error when checking target: expected dense_1 to have shape (None, 1) but got array with shape (659, 200)</p>
<p>Should the Dense(1) be Dense(x_size) where for me that is 200? (this is why it would be great to use variables so I know what that 1 means). When I try it as 168 (which is what it seems like it should be), I get an error.</p>
<p>When I switch to x_size, it actually runs without errors, but I’m not sure if that means I’m correct or not.</p>
<p>I’m so confused.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416646" onclick="return addComment.moveForm( &quot;comment-416646&quot;, &quot;416646&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Pau">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416719" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-416719" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 15, 2017 at 5:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416719" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have an example of multiple timestep outputs here that you could use as a starting point:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416719" onclick="return addComment.moveForm( &quot;comment-416719&quot;, &quot;416719&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416889" class="comment even depth-3 parent">

	      	<div id="li-comment-416889" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/63263f95035f8c4fb1ec667a96d08822.png" srcset="https://secure.gravatar.com/avatar/63263f95035f8c4fb1ec667a96d08822?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Paul</span>
	                <span class="date">October 16, 2017 at 4:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416889" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Rather than trying to predict many timestep outputs, I’m looking to output multiple predicted values per timestep. </p>
<p>One thing I don’t understand is this section:</p>
<p># invert scaling for forecast<br>
inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)<br>
inv_yhat = scaler.inverse_transform(inv_yhat)<br>
inv_yhat = inv_yhat[:,0]</p>
<p>Why is it inserting the yhat values as the *first* column? The scaler has a different scale per column so positioning is important, and the Y data had been the last column in the row, hadn’t it? So won’t it get scaled incorrectly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416889" onclick="return addComment.moveForm( &quot;comment-416889&quot;, &quot;416889&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Paul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416972" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-416972" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 17, 2017 at 5:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The first column is the pollution value, we remove it from the test data, concat our prediction so we have enough columns for the transform’s expectations, then invert the transform and get the predicted pollution values in the correct scale.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416972" onclick="return addComment.moveForm( &quot;comment-416972&quot;, &quot;416972&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416664" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-416664" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c83a273c95f67cffbe26a5780a84f1fb.png" srcset="https://secure.gravatar.com/avatar/c83a273c95f67cffbe26a5780a84f1fb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rui</span>
	                <span class="date">October 14, 2017 at 9:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416664" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>First of all ,thanks a lot for the great tutorial Jason.</p>
<p>I just have one question regarding the achieved predictions using the LSTM network.</p>
<p>I just don’t understand why are you making  “trainPredict = model.predict(trainX)” .</p>
<p>I get the predict method using the testset testX, but using this method for trainX is not like if you were in some way cheating? I say this because we train the network using the trainX and trainY and trainY corresponds to the labels you are trying to predict in the predict method using trainX.</p>
<p>Is it performed for validation purposes only?</p>
<p>I’m still learning to work with the Keras API so I might be confused with the syntax of it</p>
<p>Many thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416664" onclick="return addComment.moveForm( &quot;comment-416664&quot;, &quot;416664&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rui">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416725" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-416725" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 15, 2017 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416725" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Where am I doing that exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-416725" onclick="return addComment.moveForm( &quot;comment-416725&quot;, &quot;416725&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417006" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-417006" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/449699ac632be559ad84f66e0f516deb.png" srcset="https://secure.gravatar.com/avatar/449699ac632be559ad84f66e0f516deb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kai Li</span>
	                <span class="date">October 17, 2017 at 1:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417006" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason<br>
Thanks a lot for your tutorial!<br>
I still have some question,looking forward to your answer.<br>
If I want use the feature(t) 、 feature(t-1)  and pollution(t-1) to predict pollution (t), how can I do to reshape my input?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417006" onclick="return addComment.moveForm( &quot;comment-417006&quot;, &quot;417006&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kai Li">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-417033" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-417033" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/aef9a7f4dd03e08964bb8bdd283f692d.png" srcset="https://secure.gravatar.com/avatar/aef9a7f4dd03e08964bb8bdd283f692d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DC</span>
	                <span class="date">October 17, 2017 at 8:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417033" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Thank you very much for the wonderful post. I have a few questions. </p>
<p>1. You did not de-trend by using diff for above example. Diff from multi step only works for series. Can you please share how can we de-trend of multivariate time series?</p>
<p>2. I’d like to use past 3 days of above data to predict 3 time steps for multivariate data as above. Can you please let me know how I can do that with the example above?</p>
<p>Thanks for your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417033" onclick="return addComment.moveForm( &quot;comment-417033&quot;, &quot;417033&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to DC">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417058" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417058" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 18, 2017 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could de-trend each input series separately. Here is an example of using diff to detrend:<br>
<a href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="nofollow">https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/</a></p>
<p>I give an example in another comment of how to use multiple lag obs as input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417058" onclick="return addComment.moveForm( &quot;comment-417058&quot;, &quot;417058&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417124" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-417124" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4b84a0746f7666aaab1d27906b9a7b7d.png" srcset="https://secure.gravatar.com/avatar/4b84a0746f7666aaab1d27906b9a7b7d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Xie</span>
	                <span class="date">October 19, 2017 at 12:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417124" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason. First of all, any thanks for your post. And I have some problems.</p>
<p>1. I don’t really get the meaning of hidden_units? Can you please explain a little bit.<br>
2. I am building a lstm network as you do. I just follow your ways and build the network but got an error, as described  here <a href="https://stackoverflow.com/questions/46811085/dimension-error-building-lstm-with-keras.Could" rel="nofollow">https://stackoverflow.com/questions/46811085/dimension-error-building-lstm-with-keras.Could</a> you please help me?</p>
<p>Thanks!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417124" onclick="return addComment.moveForm( &quot;comment-417124&quot;, &quot;417124&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Xie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417142" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417142" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 19, 2017 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417142" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A hidden unit is a neuron or cell in a hidden layer.</p>
<p>A hidden layer is a layer that is not the output or the input layer.</p>
<p>Change your code to set “return_sequences” to be “False”.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417142" onclick="return addComment.moveForm( &quot;comment-417142&quot;, &quot;417142&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417130" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-417130" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/be304c559bff531e29c7ebaea1aec57e.jpeg" srcset="https://secure.gravatar.com/avatar/be304c559bff531e29c7ebaea1aec57e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Argie</span>
	                <span class="date">October 19, 2017 at 3:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417130" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So in your example you are using the data this way:</p>
<p>No,year, month,day,hour,pm2.5,DEWP,TEMP,PRES,cbwd,Iws,Is,Ir<br>
1,   2010,1,1,0,NA,-21,-11,1021,NW,1.79,0,0</p>
<p>Is possible to use the data in a way that lets say we could have multiple input numbers in one of the columns like for example, having<br>
No, year, month, day, hour, pm2.5, newVariable<br>
and in the new variable position instead of having just one integer like 20<br>
to have a sequence of integers like (5,10,3,50,23)  </p>
<p>Would that be possible using it on the same context, or is there any scenario that we could<br>
use the data the way I mentioned  ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417130" onclick="return addComment.moveForm( &quot;comment-417130&quot;, &quot;417130&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Argie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417144" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-417144" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 19, 2017 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417144" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you mean, can you predict a sequence output, then yes. Here is an example:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417144" onclick="return addComment.moveForm( &quot;comment-417144&quot;, &quot;417144&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417148" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-417148" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/be304c559bff531e29c7ebaea1aec57e.jpeg" srcset="https://secure.gravatar.com/avatar/be304c559bff531e29c7ebaea1aec57e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Argie</span>
	                <span class="date">October 19, 2017 at 7:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417148" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I might have not been clear enough, and sorry for that.</p>
<p>What I mean is that as an input I will have 4 different categories of data lets call them A, B, C, and D, that each one of them will have more than one integer, to be exact they will have 10 integers<br>
so for example:</p>
<p>A = {3,4,6,8,34,65,43,1,54} and so on with the other three categories.</p>
<p>The sequence of numbers within the four categories belong on different time stamps, for example 3 -&gt; t0 , 4-&gt; t1 and so on.</p>
<p>So what I need is to classify them for different data samples.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417148" onclick="return addComment.moveForm( &quot;comment-417148&quot;, &quot;417148&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Argie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417169" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-417169" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 19, 2017 at 3:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417169" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>These would be parallel series (columns) that could be all fed to one LSTM model like the example in the above tutorial.</p>
<p>The model will process the parallel series one at a time step at a time.</p>
<p>If the series extends beyond 200-400 time steps, then they could be split into multiple samples (e.g. multiple sub-parallel series).</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417169" onclick="return addComment.moveForm( &quot;comment-417169&quot;, &quot;417169&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417242" class="comment odd alt depth-5">

	      	<div id="li-comment-417242" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/be304c559bff531e29c7ebaea1aec57e.jpeg" srcset="https://secure.gravatar.com/avatar/be304c559bff531e29c7ebaea1aec57e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Argie</span>
	                <span class="date">October 20, 2017 at 11:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417242" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So so helpful, I tried it and worked like a charm.</p>
<p>Great job, and so helpful all the material you provide, and the way you do it !! </p>
<p>Thanks a lot Jason !!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-417315" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-417315" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2017 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417315" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that, well done!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417133" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-417133" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a87941f97e7e7c336bf9b15d7c38e799.png" srcset="https://secure.gravatar.com/avatar/a87941f97e7e7c336bf9b15d7c38e799?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tim</span>
	                <span class="date">October 19, 2017 at 4:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417133" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Really appreciate all the work you have done!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417133" onclick="return addComment.moveForm( &quot;comment-417133&quot;, &quot;417133&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417145" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417145" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 19, 2017 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417145" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Tim.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417145" onclick="return addComment.moveForm( &quot;comment-417145&quot;, &quot;417145&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417146" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-417146" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3aeaeef34959611a5eccfc84ed120bdf.png" srcset="https://secure.gravatar.com/avatar/3aeaeef34959611a5eccfc84ed120bdf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhinav</span>
	                <span class="date">October 19, 2017 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr Brownlee. Thank you for this tutorial.</p>
<p>inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)</p>
<p>inv_yhat = scaler.inverse_transform(inv_yhat)</p>
<p>what does these steps do?</p>
<p>Because I am getting a ValueError: operands could not be broadcast together with shapes (1822,11) (6,) (1822,11) on this step.<br>
I am applying on my own dataset</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417146" onclick="return addComment.moveForm( &quot;comment-417146&quot;, &quot;417146&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abhinav">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417168" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417168" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 19, 2017 at 3:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417168" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>These steps add the prediction to the test input data so that we can inverse the transform and get the prediction back into the scale we care about.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417168" onclick="return addComment.moveForm( &quot;comment-417168&quot;, &quot;417168&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417184" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-417184" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/fa649d478eebd3861238bebb5a4282d1.png" srcset="https://secure.gravatar.com/avatar/fa649d478eebd3861238bebb5a4282d1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TvT</span>
	                <span class="date">October 19, 2017 at 8:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for sharing your awesome work, I’ve been learning a lot from you!</p>
<p>I have been struggling with increasing the second dimension to fully benefit from the BPTT though. I keep getting lost in the shapes. Would you mind sharing your code for multiple time steps aswell?<br>
That would be awesome!</p>
<p>Keep up the good work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417184" onclick="return addComment.moveForm( &quot;comment-417184&quot;, &quot;417184&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to TvT">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417214" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417214" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 20, 2017 at 5:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post might help clear things up:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417214" onclick="return addComment.moveForm( &quot;comment-417214&quot;, &quot;417214&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417271" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-417271" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/65623ab13f9e1c4272e01a44af33e3cf.png" srcset="https://secure.gravatar.com/avatar/65623ab13f9e1c4272e01a44af33e3cf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dirk</span>
	                <span class="date">October 20, 2017 at 7:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome work, thanks for sharing it!</p>
<p>Could it be possible that you switched up the chronological order of your predictions?<br>
It looks to me that you predict the pollution of the previous hour, instead of predicting the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417271" onclick="return addComment.moveForm( &quot;comment-417271&quot;, &quot;417271&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dirk">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417328" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417328" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2017 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417328" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is what a persistence model looks like exactly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417328" onclick="return addComment.moveForm( &quot;comment-417328&quot;, &quot;417328&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417301" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-417301" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/315e3eb084cd0eb0c9eeb3a66e9d0aca.png" srcset="https://secure.gravatar.com/avatar/315e3eb084cd0eb0c9eeb3a66e9d0aca?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Craig</span>
	                <span class="date">October 21, 2017 at 3:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417301" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I’m new to Deep Learning, so sorry if this is a fundamental question. I am trying to use an LSTM NN to create a super fast surrogate for a coastal circulation model (something sort of similar to this, but with time dependency: <a href="https://arxiv.org/pdf/1709.08725.pdf" rel="nofollow">https://arxiv.org/pdf/1709.08725.pdf</a>)</p>
<p>My training set looks something like this:</p>
<p>-samples: 2000 – (I modeled a year with hourly output)<br>
-timesteps: 7 – (t-6, t-5, …, t)<br>
-features: 4 – (offshore boundary tide, 1st derivative of offshore boundary tide, boundary river discharge for river-1, and boundary river discharge for river-2)</p>
<p>Currently, my target is velocity magnitude for one node in my model domain ([2000,1]</p>
<p>My question is: When you do this tutorial, you assign the time steps as additional features (i.e. for my problem, our train_X = [2000,1,28]). I did this and it works fine, but eventually I’d like to scale this, and I thought I’d try to reshape my data to it’s intended shape for the model (i.e. [2000,7,4]). However, when I do this, my training time goes way down (it’s probably 3-4x slower.</p>
<p>Does the model treat these two shapes differently? If not, why does it take so much longer to train with the latter shape?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417301" onclick="return addComment.moveForm( &quot;comment-417301&quot;, &quot;417301&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Craig">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417344" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417344" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2017 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417344" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>More time steps is slower.</p>
<p>Perhaps this post will clear things up re input shapes:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417344" onclick="return addComment.moveForm( &quot;comment-417344&quot;, &quot;417344&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417516" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-417516" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3ca08a5d9abf023fc3250994b9aa8f08.jpeg" srcset="https://secure.gravatar.com/avatar/3ca08a5d9abf023fc3250994b9aa8f08?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amir Aaron</span>
	                <span class="date">October 22, 2017 at 5:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Great article.<br>
I have a small question:<br>
In previous article you pointed out that we need to make the data stationary,<br>
Do we need to do it for multi-variant as well?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417516" onclick="return addComment.moveForm( &quot;comment-417516&quot;, &quot;417516&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Amir Aaron">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417567" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417567" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2017 at 5:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417567" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ideally, yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417567" onclick="return addComment.moveForm( &quot;comment-417567&quot;, &quot;417567&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417715" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-417715" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3bca0e4264325db31433ce65b6a480a2.png" srcset="https://secure.gravatar.com/avatar/3bca0e4264325db31433ce65b6a480a2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andriy</span>
	                <span class="date">October 24, 2017 at 12:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417715" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice article! I think one question remains unanswered. Why use RNNs if we only use one previous step to predict the next step? Why not SVM for example?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417715" onclick="return addComment.moveForm( &quot;comment-417715&quot;, &quot;417715&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Andriy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417738" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417738" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 24, 2017 at 4:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417738" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No reason at all, we cannot what will work best for a given problem.</p>
<p>Try it and compare the results!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417738" onclick="return addComment.moveForm( &quot;comment-417738&quot;, &quot;417738&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417899" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-417899" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/91036ecfe305c5b43ae7a03808a0d204.png" srcset="https://secure.gravatar.com/avatar/91036ecfe305c5b43ae7a03808a0d204?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali Abdul</span>
	                <span class="date">October 25, 2017 at 7:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this very informative post! Before applying to my financial dataset, I would like to consult you about my case. The type of my data is almost the same. I have financial risk factors like equity values, interest rates, foreign exchanges etc. values on daily basis and  their corresponding dependent variable which is profit or loss of a portfolio. My goal is to detect the patterns and features (if any) responsible for the highest profits or lowest losses. So my question is can I convert your code above to a classification problem if I label my classes as 0 for the lowest losses and 1 for the highest profits?</p>
<p>Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417899" onclick="return addComment.moveForm( &quot;comment-417899&quot;, &quot;417899&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ali Abdul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417959" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-417959" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 26, 2017 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417959" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-417959" onclick="return addComment.moveForm( &quot;comment-417959&quot;, &quot;417959&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418041" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-418041" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/91036ecfe305c5b43ae7a03808a0d204.png" srcset="https://secure.gravatar.com/avatar/91036ecfe305c5b43ae7a03808a0d204?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali Abdul</span>
	                <span class="date">October 27, 2017 at 1:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418041" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great! One more small thing. When dealing with tails (let’s say 0 for lower, 1 for other than tail, 2 for upper tail), the classes and the features of course will be highly imbalanced. What would your approach be?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418041" onclick="return addComment.moveForm( &quot;comment-418041&quot;, &quot;418041&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ali Abdul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418056" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-418056" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 27, 2017 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418056" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You might need to adjust the distribution via rescaling to make the least represented classes better represented.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418056" onclick="return addComment.moveForm( &quot;comment-418056&quot;, &quot;418056&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418022" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-418022" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/91036ecfe305c5b43ae7a03808a0d204.png" srcset="https://secure.gravatar.com/avatar/91036ecfe305c5b43ae7a03808a0d204?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mehmet Abd</span>
	                <span class="date">October 26, 2017 at 8:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this very informative post! Before applying to my financial dataset, I would like to consult you about my case. The type of my data is almost the same. I have financial risk factors like equity values, interest rates, foreign exchanges etc. values on daily basis and  their corresponding dependent variable which is profit or loss of a portfolio. My goal is to detect the patterns and features (if any) responsible for the highest profits or lowest losses. So my question is can I convert your code above to a classification problem if I label my classes as 0 for the lowest losses and 1 for the highest profits?</p>
<p>Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418022" onclick="return addComment.moveForm( &quot;comment-418022&quot;, &quot;418022&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mehmet Abd">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418052" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-418052" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 27, 2017 at 5:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418052" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418052" onclick="return addComment.moveForm( &quot;comment-418052&quot;, &quot;418052&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418347" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-418347" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/903c36c55f2a28cbb668176cd7d40522.png" srcset="https://secure.gravatar.com/avatar/903c36c55f2a28cbb668176cd7d40522?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hesam</span>
	                <span class="date">October 29, 2017 at 8:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418347" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello</p>
<p>What we should do if the time itself would be a value that we must predict, such as predicting time and date for the next rainfall?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418347" onclick="return addComment.moveForm( &quot;comment-418347&quot;, &quot;418347&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hesam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418401" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-418401" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 30, 2017 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418401" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could predict the likelihood of rainfall for each hour and then use code (an if statement) to interpret those predictions and only output the predictions with a probability above a given threshold.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418401" onclick="return addComment.moveForm( &quot;comment-418401&quot;, &quot;418401&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418386" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-418386" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5789ddd0a76af869ed4079213d68c9b4.png" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thabet</span>
	                <span class="date">October 30, 2017 at 3:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418386" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Could you perhaps show me exactly where to change as to predict the temperature instead of pollution?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418386" onclick="return addComment.moveForm( &quot;comment-418386&quot;, &quot;418386&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Thabet">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418407" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-418407" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 30, 2017 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418407" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can change the column used as the output variable when fitting the model.</p>
<p>Around line 52 in the full example where we drop columns we don’t care about. Change it to drop the pollution as well and not drop temperature.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418407" onclick="return addComment.moveForm( &quot;comment-418407&quot;, &quot;418407&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418560" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-418560" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5789ddd0a76af869ed4079213d68c9b4.png" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thabet</span>
	                <span class="date">October 31, 2017 at 10:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418560" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you please help me further as i can’t manage to find where to change to predict for the temperature instead of pollution</p>
<p>“” Next, we need to be more careful in specifying the column for input and output.<br>
We have 3 * 8 + 8 columns in our framed dataset. We will take 3 * 8 or 24 columns as input for the obs of all features across the previous 3 hours. We will take just the pollution variable as output at the following hour, as follows:</p>
<p># split into input and outputs<br>
n_obs = n_hours * n_features<br>
train_X, train_y = train[:, :n_obs], train[:, -n_features]<br>
test_X, test_y = test[:, :n_obs], test[:, -n_features]<br>
print(train_X.shape, len(train_X), train_y.shape)</p>
<p>Where and how should i change to chose the temperature column?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418560" onclick="return addComment.moveForm( &quot;comment-418560&quot;, &quot;418560&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Thabet">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418577" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-418577" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 31, 2017 at 2:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418577" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot prepare an example for you.</p>
<p>You might want to explore getting more familiar with NumPy arrays first:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418577" onclick="return addComment.moveForm( &quot;comment-418577&quot;, &quot;418577&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418642" class="comment odd alt depth-5">

	      	<div id="li-comment-418642" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5789ddd0a76af869ed4079213d68c9b4.png" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thabet</span>
	                <span class="date">November 1, 2017 at 7:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason<br>
can you at least point to me where in these lines the clue is?</p>
<p>train_X, train_y = train[:, :n_obs], train[:, -n_features]<br>
test_X, test_y = test[:, :n_obs], test[:, -n_features]</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418692" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-418692" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d6878cb70cfcc9b3c2627d2665ccb05e.png" srcset="https://secure.gravatar.com/avatar/d6878cb70cfcc9b3c2627d2665ccb05e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Allen</span>
	                <span class="date">November 1, 2017 at 7:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418692" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for sharing your awesome work, I’ve been learning a lot from you!</p>
<p>I have a small question:</p>
<p>In previous article you pointed out that “Predict the pollution for the next hour as above and<br>
given the “expected” weather conditions for the next hour.” ,  eg “pollution,dew,temp”.</p>
<p>What would your approach be?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418692" onclick="return addComment.moveForm( &quot;comment-418692&quot;, &quot;418692&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Allen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418733" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418733" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 2, 2017 at 5:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418733" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For the case: “Predict the pollution for the next hour as above and given the “expected” weather conditions for the next hour.”</p>
<p>You would not need to transform the dataset, you would simply pretend that the actual weather conditions for the next hour are a forecast and predict the pollution value at that time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418733" onclick="return addComment.moveForm( &quot;comment-418733&quot;, &quot;418733&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418719" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-418719" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/387a22b6ed5ccb743145c2c460fd9038.png" srcset="https://secure.gravatar.com/avatar/387a22b6ed5ccb743145c2c460fd9038?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali</span>
	                <span class="date">November 2, 2017 at 3:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418719" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>first thanks for the post I learned a lot. I have a fundamental question about LSTM. lets say, I have 3 variables X, Y, and Z. I want to predict on Z.</p>
<p>if I make the input(train_X in example above) time lagged. So I pass it x(t), x(t-1), x(t-2), x(t-3) etc…. then will the time component of LSTM matter or not? For example we have:</p>
<p>t,  x,  y,  x-1, x-2, y-1, y-2, z-1, z-2,    z<br>
1, 1, 2,    0,    0,     0,   0 ,   0,    0,     3<br>
2, 2, 4,    1,    0,     2.   0,    3     0,     3<br>
3, 3, 6,    2,    1,     4,   2,    3,    3,     6<br>
4, 4,  8,   3,    2      6,   4     6,    3,     6<br>
5, 5, 10,   4,   3,    8,    6     6,    6,     9</p>
<p>traditionally we would train on variables (x, y, x-1, x-2, y, y-1, y-2, z-2, z-2) on the first 4 time-steps then evaluate on the 5th.</p>
<p>my question is if I train it on time step,(1, 2, 4, 5) and evaluate on step 5, will I have the same result? mainly if I add the time-lag as an input can I reshuffle the data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418719" onclick="return addComment.moveForm( &quot;comment-418719&quot;, &quot;418719&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418736" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418736" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 2, 2017 at 5:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418736" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you reshuffle the data and the result is better/same then the LSTM is probably not the right method to use. I would recommend using an MLP. See this post:<br>
<a href="https://machinelearningmastery.com/get-the-most-out-of-lstms/" rel="nofollow">https://machinelearningmastery.com/get-the-most-out-of-lstms/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418736" onclick="return addComment.moveForm( &quot;comment-418736&quot;, &quot;418736&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418722" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-418722" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/387a22b6ed5ccb743145c2c460fd9038.png" srcset="https://secure.gravatar.com/avatar/387a22b6ed5ccb743145c2c460fd9038?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali</span>
	                <span class="date">November 2, 2017 at 4:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418722" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>if we pass in previous time lag can we shuffle the data around in the model? in other words make the input timeless?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418722" onclick="return addComment.moveForm( &quot;comment-418722&quot;, &quot;418722&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418723" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-418723" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/387a22b6ed5ccb743145c2c460fd9038.png" srcset="https://secure.gravatar.com/avatar/387a22b6ed5ccb743145c2c460fd9038?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali</span>
	                <span class="date">November 2, 2017 at 4:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418723" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry when I refreshed my question didn’t appear, I thought it did not go through….did not mean to impatiently spam. apologies.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418723" onclick="return addComment.moveForm( &quot;comment-418723&quot;, &quot;418723&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418737" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-418737" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 2, 2017 at 5:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418737" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem, I moderate comments so there is some delay before they appear.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418737" onclick="return addComment.moveForm( &quot;comment-418737&quot;, &quot;418737&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418823" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-418823" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cb94c5c402ca1a44ccbd74f48c43d8aa.png" srcset="https://secure.gravatar.com/avatar/cb94c5c402ca1a44ccbd74f48c43d8aa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gus C</span>
	                <span class="date">November 3, 2017 at 3:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418823" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this great post.<br>
So how do you assess graphically your forecast with the actual?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418823" onclick="return addComment.moveForm( &quot;comment-418823&quot;, &quot;418823&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Gus C">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418845" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-418845" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 3, 2017 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418845" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could plot both with matplotlib.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418845" onclick="return addComment.moveForm( &quot;comment-418845&quot;, &quot;418845&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418827" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-418827" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/283be31748ea90f66417527abcf657cc.png" srcset="https://secure.gravatar.com/avatar/283be31748ea90f66417527abcf657cc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Num</span>
	                <span class="date">November 3, 2017 at 4:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418827" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I have a problem that’s highly related to this guide. </p>
<p>I have a time series where the predicted variable is (allegedly) in part dependant on some features from that time step, and these features are known before it (they are “planned prices” and “expected value” for different feature). I would like to include them as input into the LSTM.<br>
For one output, this turned out to be easy (just keep them in), but if I try to predict several outputs, I am having troubles formating the input correctly.</p>
<p>For better understanding, the desired input would be features x1 through x8 for t-1,t-2…etc and then x1 through x7 for t,t+1,t+2…etc. </p>
<p>Is this even possible with the example given here?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418827" onclick="return addComment.moveForm( &quot;comment-418827&quot;, &quot;418827&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Num">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418847" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-418847" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 3, 2017 at 5:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418847" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe you could adapt the example for your problem.</p>
<p>Spend some time with this post:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418847" onclick="return addComment.moveForm( &quot;comment-418847&quot;, &quot;418847&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418830" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-418830" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d91160e7cda2d674adc1e0032dd681c5.png" srcset="https://secure.gravatar.com/avatar/d91160e7cda2d674adc1e0032dd681c5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Geoffrey Anderson</span>
	                <span class="date">November 3, 2017 at 4:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418830" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>PM2.5 is just one time series to predict, clearly.  Predicting say 3 (or even 100,000) time series would be nice to look at too.  An real life example where it’s useful is inventory management in retailing businesses.  How many units will be sold in the next day of eggs, mascara, paper plates, frozen corn, 2% milk, skim milk, etc etc.  Many of these TS will be correlated. Might need multi-tasking neural network outputs.  LSTM would offer more automatic feature engineering than, say, using a boosted tree traditional machine learning algorithm which is natively unaware of time series.  The latter needs manual feature creation of time-windowed aggregates by the data scientist.  The LSTM just inputs the raw time series values directly by contrast, finding its own features.  A bonus when using the LSTM is there may be some time-window or other features the human didn’t know about in advance. Another bonus is multiple-output (multitasking) that neural networks can naturally provide, unlike boosted trees for example.  I’d suggest to start with only 2 or 3 TS at first, because a whole grocery store’s worth of items for even just a one day example is way too cumbersome to look at and manipulate easily on one small monitor screen.  Just a warning: This may be frontier research, believe it or not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418830" onclick="return addComment.moveForm( &quot;comment-418830&quot;, &quot;418830&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Geoffrey Anderson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418848" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-418848" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 3, 2017 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418848" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion Geoffrey. I hope to spend more time on this soon.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-418848" onclick="return addComment.moveForm( &quot;comment-418848&quot;, &quot;418848&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419142" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-419142" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eabfa1b8d430dcbbd174679ad693f727.png" srcset="https://secure.gravatar.com/avatar/eabfa1b8d430dcbbd174679ad693f727?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lu</span>
	                <span class="date">November 6, 2017 at 8:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419142" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I plot inv_yhat and inv_y in a same figure, and I found an interesting fact, that the training result is shifted to right for an hour compared with the ground truth. That’s to say the predicted result is almost the one hour ago data, or  X_t = X_{t-1} approximately.<br>
Actually, the best estimation for RNN is to output the latest result, without doing any prediction. How do you think about this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419142" onclick="return addComment.moveForm( &quot;comment-419142&quot;, &quot;419142&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Lu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419194" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-419194" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 7, 2017 at 9:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419194" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When a prediction looks like a shifted input it means the model has no skill because it is predicting the input as output, e.g. a persistence model:<br>
<a href="https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/" rel="nofollow">https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419194" onclick="return addComment.moveForm( &quot;comment-419194&quot;, &quot;419194&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419177" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-419177" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/68398f95ae9f8098af0ffdadfbccdd09.jpeg" srcset="https://secure.gravatar.com/avatar/68398f95ae9f8098af0ffdadfbccdd09?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rafael</span>
	                <span class="date">November 7, 2017 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m using my own dataset and I’m not using the series_to_supervised method because I already have the dataset prepared in 2 files, train and test files. I still have the error:</p>
<p>Traceback (most recent call last):<br>
  File “teste.py”, line 64, in<br>
    inv_yhat = scaler.inverse_transform(inv_yhat)<br>
  File “C:\Users\rafae\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\preprocessing\data.py”, line 385, in inverse_transform<br>
    X -= self.min_<br>
ValueError: operands could not be broadcast together with shapes (52,12585) (12586,) (52,12585)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419177" onclick="return addComment.moveForm( &quot;comment-419177&quot;, &quot;419177&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rafael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419178" class="comment even depth-2">

	      	<div id="li-comment-419178" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/68398f95ae9f8098af0ffdadfbccdd09.jpeg" srcset="https://secure.gravatar.com/avatar/68398f95ae9f8098af0ffdadfbccdd09?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rafael</span>
	                <span class="date">November 7, 2017 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>To load the datasets </p>
<p>#Train dataset<br>
dataset = read_csv(‘trainning_small.csv’, header=None, index_col=None)<br>
dataset.drop(dataset.columns[[0]], axis=1, inplace=True)<br>
train = dataset.values</p>
<p>encoder = LabelEncoder()<br>
train[:,-1] = encoder.fit_transform(train[:,-1])<br>
train = train.astype(‘float32’)</p>
<p>scaler = MinMaxScaler(feature_range=(0, 1))<br>
train = scaler.fit_transform(train)</p>
<p>#Test dataset<br>
dataset_test = read_csv(‘test_passare.csv’, header=None, index_col=None)<br>
dataset_test.drop(dataset_test.columns[[0]], axis=1, inplace=True)<br>
test = dataset_test.values</p>
<p>encoder = LabelEncoder()<br>
test[:,-1] = encoder.fit_transform(test[:,-1])<br>
test = test.astype(‘float32’)</p>
<p>test = scaler.fit_transform(test)</p>
<p>train_x, train_y = train[:, :-1], train[:, -1]<br>
test_x, test_y = test[:, :-1], test[:, -1]</p>
<p>train_x = train_x.reshape((train_x.shape[0], 1, train_x.shape[1]))<br>
test_x = test_x.reshape((test_x.shape[0], 1, test_x.shape[1]))<br>
print(train_x.shape, train_y.shape, test_x.shape, test_y.shape)</p>
<p>THE RESULT FOR THE PRINT:<br>
(838, 1, 12585) (838,) (52, 1, 12585) (52,)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419178" onclick="return addComment.moveForm( &quot;comment-419178&quot;, &quot;419178&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rafael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419223" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-419223" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/33ba11b92e6b155bebc022b8413a53c7.png" srcset="https://secure.gravatar.com/avatar/33ba11b92e6b155bebc022b8413a53c7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fred</span>
	                <span class="date">November 7, 2017 at 4:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419223" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr. Brownlee,</p>
<p>First of all, thanks for this wonderful post.  I have applied your code with the following parameters:<br>
lags=8, features=8, epochs=50, batch=104, neurons=150</p>
<p>And got almost perfect match between train and test.  The test RMSE is 26.526.</p>
<p>My question is that what does this result stand for?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419223" onclick="return addComment.moveForm( &quot;comment-419223&quot;, &quot;419223&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fred">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419328" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-419328" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 8, 2017 at 9:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419328" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done. The result is a summary of the error between predicted and expected values.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419328" onclick="return addComment.moveForm( &quot;comment-419328&quot;, &quot;419328&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419777" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-419777" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7c8d912927c0f7d305e8b25970b92c88.png" srcset="https://secure.gravatar.com/avatar/7c8d912927c0f7d305e8b25970b92c88?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vlad</span>
	                <span class="date">November 12, 2017 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419777" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I launched this example on my notebook (AMD FX-8800P Radeon R7, 8GB RAM), it runs already 4 hours and I even can’t see what is going on with the model training and how long will it run. Is it possible to include in the example some monitoring and visualization of the training process, ex. using callbacks.RemoteMonitor ?</p>
<p>P.S. previously I worked with Matlab, it was so nice to see number of epochs, accuracy, error, and many other parameters during the training process. It helped a lot to understand should I continue training, or should I change the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419777" onclick="return addComment.moveForm( &quot;comment-419777&quot;, &quot;419777&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vlad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419797" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-419797" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 12, 2017 at 9:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You should see the progress for each epoch and across epochs as output on the command line.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419797" onclick="return addComment.moveForm( &quot;comment-419797&quot;, &quot;419797&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419782" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-419782" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7c8d912927c0f7d305e8b25970b92c88.png" srcset="https://secure.gravatar.com/avatar/7c8d912927c0f7d305e8b25970b92c88?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vlad</span>
	                <span class="date">November 12, 2017 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419782" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hm, relaunched the example step-by-step and found out it’s stuck not at training, but at model compilation. Working for hours at 100% CPU load on block:<br>
# design network<br>
model = Sequential()<br>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
model.add(Dense(1))<br>
model.compile(loss=’mae’, optimizer=’adam’)<br>
What’s wrong?<br>
Ubuntu 16.4, Keras 2.0.6, Theano 0.9.0, Python 3.6.2, Anaconda custom</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419782" onclick="return addComment.moveForm( &quot;comment-419782&quot;, &quot;419782&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vlad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419798" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-419798" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 12, 2017 at 9:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419798" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you running on the command line? If you run in a notebook, you may hide error or verbose messages.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419798" onclick="return addComment.moveForm( &quot;comment-419798&quot;, &quot;419798&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419804" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-419804" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7c8d912927c0f7d305e8b25970b92c88.png" srcset="https://secure.gravatar.com/avatar/7c8d912927c0f7d305e8b25970b92c88?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vlad</span>
	                <span class="date">November 12, 2017 at 9:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419804" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I updated all libraries and anaconda and python and now it works! Sorry for disturbance <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"> BTW, monitoring tool can be used for  callbacks.RemoteMonitor is hualos-master</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419804" onclick="return addComment.moveForm( &quot;comment-419804&quot;, &quot;419804&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vlad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419866" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-419866" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 13, 2017 at 10:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419866" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that, well done!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419866" onclick="return addComment.moveForm( &quot;comment-419866&quot;, &quot;419866&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419854" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-419854" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6f8866d0b0ac3c9d6e1090bae9948df0.png" srcset="https://secure.gravatar.com/avatar/6f8866d0b0ac3c9d6e1090bae9948df0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tommy</span>
	                <span class="date">November 13, 2017 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419854" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the very well written article.  I really appreciate the detailed walkthrough.</p>
<p>I have been looking for a way to apply multivariate input to a machine learning prediction model of any sort. I’m doing this in order to predict the growth of compute systems in excess of hundreds of thousands of nodes bases on 6 years of daily samples.  Simply looking at the Y growth over time and feeding that into something like Facebook prophet has proved somewhat insufficient because it only looks at the problem as a function of past behavior.</p>
<p>In reality there are more variables at play that control or effect that line of growth.  As such, simple univariate approaches fall short and the predictions can be very good or very bad.</p>
<p>When I found this article I thought to myself, Eureka! I will be able to use this approach in order to feed in multivariate data along with the growth of my systems in order to get better predictions.  However I was somewhat crestfallen at the revelation of 2 key problems discussed over the last several months here in the comments…</p>
<p>One problem you acknowledged as a potential/known issue and linked to another article explaining why autoregression time series problems may not be best solved with lstm neural networks. The article posits that better results might be obtained by stacking or using more layers. Have you tried this? If so, what did it look like and what results did you get?</p>
<p>The second and more concerning problem was when one commenter performed the same exercise as laid out in this article, but removed all of the multivariate data and still obtained the same rmse rate as you did.  It was as if none of the other variables had any bearing on the prediction.  This is deeply concerning, because as I see it, either this event was anomalous and driven by the input data, or the overall approach itself may be flawed, or the implementation thereof is broken.  I’m not sufficiently versed in the technology to make a value statement on any of those points.</p>
<p>I’m hoping that you would be willing to share your thoughts on possible answers to these questions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419854" onclick="return addComment.moveForm( &quot;comment-419854&quot;, &quot;419854&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tommy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419881" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-419881" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 13, 2017 at 10:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419881" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The tutorial is a demonstration of a method, not the best way of solving or even framing the presented problem.</p>
<p>I should have made that clearer, but that is the philosophy behind every single blog post on my site. I show how to use the methods, not how to get the best results (for a specific problem). The former problem is tractable the latter is not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419881" onclick="return addComment.moveForm( &quot;comment-419881&quot;, &quot;419881&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419888" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-419888" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4efecf7ef0cbbf83dbc60c76d848d5eb.png" srcset="https://secure.gravatar.com/avatar/4efecf7ef0cbbf83dbc60c76d848d5eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tommy</span>
	                <span class="date">November 13, 2017 at 12:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419888" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the clarity and candor!  As a long-time comp-sci person, I find it very strange to run these tensorflow sessions and get different results for the same inputs (I’ve been putting your code through the paces) … I found I needed to add this, or every subsequent run would result in predictions that seemed to augment each previous run:</p>
<p><code></code><code><br>
try:<br>
    keras.backend.clear_session()<br>
except:<br>
    pass<br>
</code><code></code></p>
<p>For what it’s worth, I zeroed out all the other variables (instead of eliminating them) and it /did/ have bearing on the output.  I don’t think this methodology can be dismissed as ineffective.  It seems to be approximating a workable solution.  More exploration is necessary.</p>
<p>Thank you for setting me on the path!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419888" onclick="return addComment.moveForm( &quot;comment-419888&quot;, &quot;419888&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tommy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419939" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-419939" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 14, 2017 at 10:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419939" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Damn.</p>
<p>Well, these are stochastic algorithms in general, but a single trained model should be deterministic and when it’s not, we’re in trouble.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419939" onclick="return addComment.moveForm( &quot;comment-419939&quot;, &quot;419939&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419960" class="comment odd alt depth-5">

	      	<div id="li-comment-419960" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4efecf7ef0cbbf83dbc60c76d848d5eb.png" srcset="https://secure.gravatar.com/avatar/4efecf7ef0cbbf83dbc60c76d848d5eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tommy</span>
	                <span class="date">November 14, 2017 at 11:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-419960" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Have you tried running multiple iterations and examining yhat_inv?</p>
<p>I keep getting different output, and I didn’t expect that.  Am I looking in the wrong place?</p>
<p>I can send a catalog of my results if that helps…</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-420035" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-420035" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2017 at 9:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420035" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have not.</p>
<p>In general, we do expect different results across different runs given the stochastic nature of neural networks (forgive me if I am missing the point):<br>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420108" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-420108" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e53f2aeb60ef4d4b1ebfe571ac708454.png" srcset="https://secure.gravatar.com/avatar/e53f2aeb60ef4d4b1ebfe571ac708454?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sam</span>
	                <span class="date">November 15, 2017 at 10:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420108" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>multivariate time series forecasting possible for multi-step??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420108" onclick="return addComment.moveForm( &quot;comment-420108&quot;, &quot;420108&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420180" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-420180" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2017 at 10:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420180" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420180" onclick="return addComment.moveForm( &quot;comment-420180&quot;, &quot;420180&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420214" class="comment odd alt depth-3">

	      	<div id="li-comment-420214" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e53f2aeb60ef4d4b1ebfe571ac708454.png" srcset="https://secure.gravatar.com/avatar/e53f2aeb60ef4d4b1ebfe571ac708454?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sam</span>
	                <span class="date">November 16, 2017 at 6:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, </p>
<p>Jason Can you please explain..How to prepare dataset for train models.. let’s suppose i have 5 feature and i want to predict t + 5 value..</p>
<p>For example.. </p>
<p>x1 = (2,3,4,3,1,6,8,9,4,1)<br>
x2 = (5,2,5,7,9,9,6,3,1,3)<br>
x3 = (2,3,4,8,1,6,8,9,1,1)<br>
x4 = (5,1,5,7,9,9,6,3,1,7)<br>
x5 = (2,3,4,6,8,3,1,3,5,7)<br>
y =   (8,7,6,5,4,3,2,8,9,7)</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420214" onclick="return addComment.moveForm( &quot;comment-420214&quot;, &quot;420214&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420448" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-420448" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4efecf7ef0cbbf83dbc60c76d848d5eb.png" srcset="https://secure.gravatar.com/avatar/4efecf7ef0cbbf83dbc60c76d848d5eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tommy</span>
	                <span class="date">November 18, 2017 at 3:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420448" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you think about putting a dropout layer between the LSTM and Dense layers to address the overfitting phenomenon?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420448" onclick="return addComment.moveForm( &quot;comment-420448&quot;, &quot;420448&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tommy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420537" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-420537" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 19, 2017 at 11:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420537" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try it and see, I’d love to hear how it goes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420537" onclick="return addComment.moveForm( &quot;comment-420537&quot;, &quot;420537&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420591" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-420591" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/325ca6e186f097b950fca927bad13eb8.png" srcset="https://secure.gravatar.com/avatar/325ca6e186f097b950fca927bad13eb8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdulrauf Garba</span>
	                <span class="date">November 19, 2017 at 10:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason, we need a similar tutorial of Multivariate time series using the Recurrent neural network in R.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420591" onclick="return addComment.moveForm( &quot;comment-420591&quot;, &quot;420591&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdulrauf Garba">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420641" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-420641" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 20, 2017 at 10:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420641" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420641" onclick="return addComment.moveForm( &quot;comment-420641&quot;, &quot;420641&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420768" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-420768" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/dcb18e49ae1765b5e2d4f7ee5a13ba63.png" srcset="https://secure.gravatar.com/avatar/dcb18e49ae1765b5e2d4f7ee5a13ba63?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Louis</span>
	                <span class="date">November 22, 2017 at 1:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420768" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason!</p>
<p>You say in your post: </p>
<p>“We can use this data and frame a forecasting problem where, given the weather conditions and pollution for prior hours, we forecast the pollution at the next hour.”</p>
<p>Is it possible to do the same without prior knowledge of the pollution levels?</p>
<p>I am working on a very similar time series forecasting problem. However, in my case, I don’t have access to intermediate level of pollution.</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420768" onclick="return addComment.moveForm( &quot;comment-420768&quot;, &quot;420768&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Louis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420820" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-420820" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2017 at 11:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but it is important to spend time exploring different framings of the problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420820" onclick="return addComment.moveForm( &quot;comment-420820&quot;, &quot;420820&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420780" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-420780" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/746201ba61ea26d2667d659c7d016ed3.png" srcset="https://secure.gravatar.com/avatar/746201ba61ea26d2667d659c7d016ed3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shantanu</span>
	                <span class="date">November 22, 2017 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420780" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>I have a question about splitting the data.<br>
I have the data month wise for around 20 years.<br>
How should I split it?<br>
Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420780" onclick="return addComment.moveForm( &quot;comment-420780&quot;, &quot;420780&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Shantanu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420822" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-420822" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2017 at 11:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420822" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br>
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420822" onclick="return addComment.moveForm( &quot;comment-420822&quot;, &quot;420822&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420789" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-420789" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6ecb389bf41ce322695c7e992e8196f2.png" srcset="https://secure.gravatar.com/avatar/6ecb389bf41ce322695c7e992e8196f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">michael</span>
	                <span class="date">November 22, 2017 at 9:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for this excellent tutorial!</p>
<p>This may or may not be a slight variation of your “Train On Multiple Lag Timesteps Example”, but I was wondering how I should modify your example to do a multivariate one to multiple time step prediction i.e. look at one time step of 8 dimensional data and predict 10 time steps of 8 dimensional data. Or a multivariate seq2seq prediction i.e. show 10 time steps of 8 dimensional data and predict 10 time steps of 8 dimensional data.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420789" onclick="return addComment.moveForm( &quot;comment-420789&quot;, &quot;420789&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420829" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-420829" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2017 at 11:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420829" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hmmm, I have to think about that. It might be best to do a multiple output model:<br>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420829" onclick="return addComment.moveForm( &quot;comment-420829&quot;, &quot;420829&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420965" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-420965" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/878978f067558c3daae07bf708861c7b.png" srcset="https://secure.gravatar.com/avatar/878978f067558c3daae07bf708861c7b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sammy</span>
	                <span class="date">November 23, 2017 at 1:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420965" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
   First of all, thank you very much for this excellent post. I would be grateful if you can show how to do multivariate time series forecasting per group. In other words, lets say we have data for many cities and we would like to add the forecasting per city ? How we can feed the data to LSTM for a given city and get inv_y, inv_yhat to compare to see how model does ?<br>
Thanks again,<br>
Sammy</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420965" onclick="return addComment.moveForm( &quot;comment-420965&quot;, &quot;420965&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sammy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421029" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-421029" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2017 at 9:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421029" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could model each city separately or combine all cities into a single dataset, or do both and ensemble the result.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421029" onclick="return addComment.moveForm( &quot;comment-421029&quot;, &quot;421029&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420983" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-420983" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04b84804174505d7b12d88c405741eec.png" srcset="https://secure.gravatar.com/avatar/04b84804174505d7b12d88c405741eec?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow" class="url">Nagabhushan S Baddi</a></span>
	                <span class="date">November 23, 2017 at 7:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420983" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason.<br>
I have a dataset of 169307 rows and 41 features. I want to use timestep of 5. So, when I am using X=np.reshape(X, (169307, 5, 41)), I am getting an error that “cannot reshape array of size 6941587 into shape (169307,5,41)”. Does this mean that n_samples*n_features in the orginal dataset should be divisible by n_timesteps? If this is true, then how can I be able to use timestep of my choice?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-420983" onclick="return addComment.moveForm( &quot;comment-420983&quot;, &quot;420983&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nagabhushan S Baddi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421037" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-421037" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2017 at 9:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421037" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this post will help:<br>
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421037" onclick="return addComment.moveForm( &quot;comment-421037&quot;, &quot;421037&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421088" class="comment even depth-3 parent">

	      	<div id="li-comment-421088" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04b84804174505d7b12d88c405741eec.png" srcset="https://secure.gravatar.com/avatar/04b84804174505d7b12d88c405741eec?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://no%20e/" rel="external nofollow" class="url">Nagabhushan</a></span>
	                <span class="date">November 24, 2017 at 7:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421088" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason.</p>
<p>I referred to this post. But it explains data preprocessing in which only 1 feature is present. But my dataset has multiple features..I am confused on how to reformulate the data and then reshape it…for example, let us say, the following is my dataset:<br>
 Slno f1 f2 f2 target<br>
  1.     2. 3.  1.  0<br>
  2.     1.  7. 9.  1<br>
  3 .     3.  3. 1. .1<br>
  ……</p>
<p>Here it has three features f1 f2 f3..and a target label with two classes.here the classification cannot be done only on the current feature vector, since the output has a dependence on previous feature vectors..can u plz explain me the data formulation for this case to the format n_sample, time steps, n_features…where n_sample is the same as number of sample in the original dataset X and n_features is the same as number of feature I.e 3.  Let’s say the time step is 5. Plz help in this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421088" onclick="return addComment.moveForm( &quot;comment-421088&quot;, &quot;421088&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nagabhushan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421134" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-421134" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 25, 2017 at 10:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421134" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help you frame your data as a supervised learning problem:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421134" onclick="return addComment.moveForm( &quot;comment-421134&quot;, &quot;421134&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421179" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-421179" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b7c1cb32c97bd28ec2f534fe4b204145.png" srcset="https://secure.gravatar.com/avatar/b7c1cb32c97bd28ec2f534fe4b204145?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">November 25, 2017 at 11:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I’m a little confused about the range of scaling.</p>
<p>In many other posts you mentioned the following:<br>
“Transform the observations to have a specific scale. Specifically, to rescale the data to values between -1 and 1 to meet the default hyperbolic tangent activation function of the LSTM model.”</p>
<p>Is there a reason for the use of 0 to 1 ?<br>
Isn’t  -1 to 1 better for scaling, since the activation function is tanh?</p>
<p>Thank you,<br>
Chris</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421179" onclick="return addComment.moveForm( &quot;comment-421179&quot;, &quot;421179&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421200" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-421200" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 26, 2017 at 7:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421200" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, a scale of 0-1 results in better skill in my experience.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421200" onclick="return addComment.moveForm( &quot;comment-421200&quot;, &quot;421200&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421390" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-421390" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8ddc036a0c0cd9f63bc03115ec4b850c.png" srcset="https://secure.gravatar.com/avatar/8ddc036a0c0cd9f63bc03115ec4b850c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Somayeh</span>
	                <span class="date">November 28, 2017 at 1:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421390" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you so much for the wonderful tutorial! That was so helpful for me.<br>
When i read your post, my questions was solved about how to predict multi-output multi-input system in multi-step time series because of your great illustration. </p>
<p>But  I have a question, in my problem, we have many observations for some cases in each time (about 500), so we have multiple series inputs and outputs in each time.</p>
<p>Could you please help me how can solve this issue.</p>
<p>Any help will be useful for me. i will be very appreciated for your help.</p>
<p>Thank you,</p>
<p>Somayeh</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421390" onclick="return addComment.moveForm( &quot;comment-421390&quot;, &quot;421390&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Somayeh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421429" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-421429" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 28, 2017 at 8:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421429" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend exploring many different framings of the problem to see what works best and consider a baseline MLP model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421429" onclick="return addComment.moveForm( &quot;comment-421429&quot;, &quot;421429&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-443924" class="comment even depth-2">

	      	<div id="li-comment-443924" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bf27cba0faa131a8f124b1024f094eba.png" srcset="https://secure.gravatar.com/avatar/bf27cba0faa131a8f124b1024f094eba?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Max</span>
	                <span class="date">July 20, 2018 at 12:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443924" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>May I ask how you solved your problem of multiple outputs? I am having trouble implementing it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443924" onclick="return addComment.moveForm( &quot;comment-443924&quot;, &quot;443924&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Max">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421526" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-421526" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cfb457d5b7806e749695027db0b90778.png" srcset="https://secure.gravatar.com/avatar/cfb457d5b7806e749695027db0b90778?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">November 29, 2017 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421526" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see this question has been raised before, I’m sorry for beating a dead horse. I’ve been struggling with the inverse_transform step.<br>
I tried to implement this algorithm using my own dataset and had trouble with it. Then I tried to run the example with the example dataset as in the tutorial and also had an error on the inverse_transform step.</p>
<p>inv_yhat = scaler.inverse_transform(inv_yhat)</p>
<p>(on my data)<br>
ValueError: operands could not be broadcast together with shapes (15357,287) (8,) (15357,287) </p>
<p>on the tutorial data set:<br>
ValueError: operands could not be broadcast together with shapes (35037,24) (8,) (35037,24) </p>
<p>PS. your blog is great. Keep up the the good work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421526" onclick="return addComment.moveForm( &quot;comment-421526&quot;, &quot;421526&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421552" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-421552" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2017 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421552" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, you must make sure that the data has the same shape and that columns have the same index when transforming and inverse transforming.</p>
<p>Confirm this before performing each operation.</p>
<p>Does that help? Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421552" onclick="return addComment.moveForm( &quot;comment-421552&quot;, &quot;421552&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421543" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-421543" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">November 29, 2017 at 8:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421543" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI jason,</p>
<p>Thanks for great tutorial. I have a question how to choose the no. of timesteps as you always choose 1 timestep ? From where can I see the predicted value as graph just showing training of model and how can I predict the value for different time intervals (e.g. if I want to predict the value for next 1, 2, 4 or hours)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421543" onclick="return addComment.moveForm( &quot;comment-421543&quot;, &quot;421543&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421554" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-421554" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2017 at 8:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend experimenting with different numbers of time steps on your problem to see what works best.</p>
<p>You can collect predicted values and plot your own graph using matplotlib. I provide examples on other posts, for example:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421554" onclick="return addComment.moveForm( &quot;comment-421554&quot;, &quot;421554&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421592" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-421592" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/81d980169dd303a3baa120ad73dad744.png" srcset="https://secure.gravatar.com/avatar/81d980169dd303a3baa120ad73dad744?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Ali Mbarak</span>
	                <span class="date">November 29, 2017 at 4:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421592" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Mr Jason Brownlee, Your tutorial is awesome, it helped me in my project. I have been really interested in machine learning and this place has given me a lot.</p>
<p>My next move was to find a way to input data to my code and predict the future value. Like for example, for predicting air pollution.  A user will keep todays data like N02 and windspeed and the code will spit out tomorrow’s air pollution. In other words how to apply the code to practice?.</p>
<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421592" onclick="return addComment.moveForm( &quot;comment-421592&quot;, &quot;421592&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ahmed Ali Mbarak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421628" class="comment even depth-2 parent">

	      	<div id="li-comment-421628" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">November 30, 2017 at 12:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421628" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think “yhat” is the predicted value regarding “test_X” actual value because we are providing test_X as input to predict.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421628" onclick="return addComment.moveForm( &quot;comment-421628&quot;, &quot;421628&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421666" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-421666" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 30, 2017 at 8:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421666" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds correct.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421666" onclick="return addComment.moveForm( &quot;comment-421666&quot;, &quot;421666&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421656" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-421656" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 30, 2017 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421656" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421656" onclick="return addComment.moveForm( &quot;comment-421656&quot;, &quot;421656&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421610" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-421610" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">November 29, 2017 at 8:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421610" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>In series_to_supervised() function, when we change the value of variable “n_in” (e.g. if we say 2 in this example ,does it mean we are now predicting for the next two hour because now the dataframe will have 16 columns instead of 8)? How the value of “n_out” effects please explain that also .</p>
<p>Best Regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421610" onclick="return addComment.moveForm( &quot;comment-421610&quot;, &quot;421610&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421663" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-421663" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 30, 2017 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421663" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn more about that function here:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421663" onclick="return addComment.moveForm( &quot;comment-421663&quot;, &quot;421663&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421627" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-421627" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">November 30, 2017 at 12:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421627" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>i took the “yhat” array as my predicted values and “test_X” array as actual values because we predicted on test_X array and draw a plot using matplotlib , did I do the right ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421627" onclick="return addComment.moveForm( &quot;comment-421627&quot;, &quot;421627&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-421652" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-421652" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/878978f067558c3daae07bf708861c7b.png" srcset="https://secure.gravatar.com/avatar/878978f067558c3daae07bf708861c7b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sammy</span>
	                <span class="date">November 30, 2017 at 7:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421652" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
   I wanted to have n_in: Number of lag observations as input (X) set to 3 (using my own data) as can be seen below<br>
49 # frame as supervised learning<br>
50 reframed = series_to_supervised(scaled, 3, 1)</p>
<p>I make the data samples<br>
86 inv_yhat = scaler.inverse_transform(inv_yhat)<br>
and I get the following error:<br>
 File “/usr/local/Cellar/python3/3.6.2/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sklearn/preprocessing/data.py”, line 385, in inverse_transform<br>
    X -= self.min_<br>
ValueError: operands could not be broadcast together with shapes (67112,57) (19,) (67112,57)<br>
I have initially 19 variables and I have number of observations set to 3 the text_X has following shape<br>
  &gt;&gt;&gt; test_X.shape<br>
(67112, 1, 57)<br>
yhat = model.predict(test_X)  and<br>
&gt;&gt;&gt; yhat.shape<br>
(67112, 1)</p>
<p>I don’t understand the error above. I would be grateful if you can help me see what I am doing wrong.<br>
Again, thanks a lot. You are awesome !<br>
Sammy</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421652" onclick="return addComment.moveForm( &quot;comment-421652&quot;, &quot;421652&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sammy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421677" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-421677" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 30, 2017 at 8:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421677" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Sammy, did you try the section “Update: Train On Multiple Lag Timesteps Example”?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421677" onclick="return addComment.moveForm( &quot;comment-421677&quot;, &quot;421677&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421678" class="comment even depth-3 parent">

	      	<div id="li-comment-421678" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/878978f067558c3daae07bf708861c7b.png" srcset="https://secure.gravatar.com/avatar/878978f067558c3daae07bf708861c7b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sammy</span>
	                <span class="date">November 30, 2017 at 9:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421678" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No as I didn’t see the update before. I will try it now. Thanks a lot</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421678" onclick="return addComment.moveForm( &quot;comment-421678&quot;, &quot;421678&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sammy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421681" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-421681" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 30, 2017 at 10:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421681" onclick="return addComment.moveForm( &quot;comment-421681&quot;, &quot;421681&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421766" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-421766" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/08a1edc869df238b4c28c34546743166.jpeg" srcset="https://secure.gravatar.com/avatar/08a1edc869df238b4c28c34546743166?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Miha</span>
	                <span class="date">December 1, 2017 at 2:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421766" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>First of all, many thanks for this great tutorial!</p>
<p>I’m trying to apply this to my own problem. However, I’m facing some problems.<br>
Let’s say we have the time series of multivariate data structured like this:</p>
<p>x1,x2,x3,…x30, y1<br>
x1,x2,x3,…x30, y2<br>
….</p>
<p>where x1 – x30 are numeric (continues) values and y1 – yn are labels which I want to predict.<br>
Y can only be 1 (on) or 0 (off). Some of these parameters are raw sensor data, which increase or decrease over n samples, so I know that this problem is ideal for RNN.</p>
<p>But I am not sure if my approach is ok.</p>
<p>Is it ok to re-factor the data in a way, that I take the first 10 samples (without y values of course), create the 2D array of them and try to predict the output of sample n10 and then move for 1 place and take next 10 samples and predict sample n11 and so on… So not to combine them into one vector like you did.</p>
<p>For example, if I have 10,000 samples, each for 100ms and I want to look at the last 10 samples (1 second) I train the data with samples of shape (99990, 10, 30 ) where 99990 represent the number of samples, each containing 10 readings (1 second) with the dimension of 30.</p>
<p>My current model looks like this, but it is not as successful as I want it to be (I think it can be a lot better):</p>
<p>model = Sequential()<br>
model.add(LSTM(100, input_shape=(nsamples, nbatch, ndimension))<br>
model.add(Dropout(0.2))<br>
model.add(LSTM(100))<br>
model.add(Dropout(0.2))<br>
model.add(Dense(1, activation=’sigmoid’))<br>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’)</p>
<p>Can you please point me in the right direction?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421766" onclick="return addComment.moveForm( &quot;comment-421766&quot;, &quot;421766&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Miha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421929" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-421929" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">December 2, 2017 at 9:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421929" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Maha,</p>
<p>Can you tell me why you are just applying “Activation Function” to just output layer I mean why there is no “Activation Function” for hidden layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421929" onclick="return addComment.moveForm( &quot;comment-421929&quot;, &quot;421929&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421987" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-421987" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 3, 2017 at 5:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are using the default activation functions for the LSTM hidden layers.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421987" onclick="return addComment.moveForm( &quot;comment-421987&quot;, &quot;421987&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421979" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-421979" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/dac67684b219ac8d73ed9b09759a0e42.png" srcset="https://secure.gravatar.com/avatar/dac67684b219ac8d73ed9b09759a0e42?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Silvia</span>
	                <span class="date">December 3, 2017 at 4:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421979" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>train_X = train_X.reshape((train_X.shape[0], 1, train_X.shape[1]))<br>
test_X = test_X.reshape((test_X.shape[0], 1, test_X.shape[1]))</p>
<p>I’m having a lot of troubles with these two lines.</p>
<p>I don’t understand why it isn’t like so</p>
<p>train_X = train_X.reshape((1, train_X.shape[0], train_X.shape[1]))<br>
test_X = test_X.reshape((1, test_X.shape[0],  test_X.shape[1]))</p>
<p>I thought (and obviously I’m wrong, but I want to know why) that we had 1 sample because we have one city, but have multiple timesteps one for each set of measurements.</p>
<p>If we had 3 cities would we then have 3 instead of 1?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421979" onclick="return addComment.moveForm( &quot;comment-421979&quot;, &quot;421979&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Silvia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421996" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-421996" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 3, 2017 at 5:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421996" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In this example, we are only using a single time step per sample.</p>
<p>It is unrelated to the number of cities.</p>
<p>See this post for more on how to reshape data for LSTMs:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-421996" onclick="return addComment.moveForm( &quot;comment-421996&quot;, &quot;421996&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422024" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-422024" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e7fcdd7bca4e8c822dc99a05e293f236.png" srcset="https://secure.gravatar.com/avatar/e7fcdd7bca4e8c822dc99a05e293f236?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mahesh</span>
	                <span class="date">December 3, 2017 at 12:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>If I have data for every city then how can I build one LSTM model. Here data is for only one city and have to forecast pollution. Lets suppose if I append data for other cities so can we predict pollution using single LSTM<br>
Yes,we can build model for each city separately but can we build a single model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422024" onclick="return addComment.moveForm( &quot;comment-422024&quot;, &quot;422024&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mahesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422094" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422094" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 4, 2017 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422094" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There is no one best way. I would encourage you to explore different ways to frame this problem, perhaps one model per city, perhaps one model for regions or all cities, perhaps ensembles of models. See what works best for your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422094" onclick="return addComment.moveForm( &quot;comment-422094&quot;, &quot;422094&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422062" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-422062" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/50d86d87f6986dffaaad63ba2b957b0c.png" srcset="https://secure.gravatar.com/avatar/50d86d87f6986dffaaad63ba2b957b0c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">lucy80</span>
	                <span class="date">December 3, 2017 at 10:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422062" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>If instead of single time series we have multiple time series, how should we normalize data?<br>
i.e. if we have pollution data for 100 cities, normalization should be done citiwise or across all cities ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422062" onclick="return addComment.moveForm( &quot;comment-422062&quot;, &quot;422062&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to lucy80">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422099" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422099" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 4, 2017 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It really depends on the model that you are constructing.</p>
<p>Your goal is to ensure input data to the model is consistent.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422099" onclick="return addComment.moveForm( &quot;comment-422099&quot;, &quot;422099&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422555" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-422555" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7f3498c05249bc66410ccc314b3f59ca.png" srcset="https://secure.gravatar.com/avatar/7f3498c05249bc66410ccc314b3f59ca?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mangesh Divate</span>
	                <span class="date">December 9, 2017 at 7:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422555" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,  one question is why didn’t you used scikit-learn train_test_split function instead of</p>
<p># split into train and test sets<br>
values = reframed.values<br>
n_train_hours = 365 * 24<br>
train = values[:n_train_hours, :]<br>
test = values[n_train_hours:,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422555" onclick="return addComment.moveForm( &quot;comment-422555&quot;, &quot;422555&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mangesh Divate">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422577" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422577" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 9, 2017 at 9:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422577" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>By all means, try it. Note that you cannot shuffle the series.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422577" onclick="return addComment.moveForm( &quot;comment-422577&quot;, &quot;422577&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422691" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-422691" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3c6d6d407d2cf8dde005be5495e88903.png" srcset="https://secure.gravatar.com/avatar/3c6d6d407d2cf8dde005be5495e88903?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">james</span>
	                <span class="date">December 11, 2017 at 1:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422691" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>oh,jason,<br>
    in  my computer, every epochs  used  191s!   emmmmmm………..  this time is  too long .<br>
i want to  ask ,you used GPU  to speed up ? or  other  problems?<br>
                                                                                                               thank you!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422691" onclick="return addComment.moveForm( &quot;comment-422691&quot;, &quot;422691&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to james">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422715" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422715" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2017 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422715" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>GPU can speed up LSTMs somewhat, but not as much as MLPs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422715" onclick="return addComment.moveForm( &quot;comment-422715&quot;, &quot;422715&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422736" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-422736" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0a0c268709b77e9605a78a55f9c02cd3.png" srcset="https://secure.gravatar.com/avatar/0a0c268709b77e9605a78a55f9c02cd3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark</span>
	                <span class="date">December 11, 2017 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422736" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you so much for your brilliant website helping us all get good at machine learning!</p>
<p>Please could you clarify the line of code that outputs the next hour’s pollution reading? I’ve run the model and it return the RMSE but I’m interested to see the t+1 prediction.</p>
<p>What code would I add at the end so that when the model has finished running it prints the next hour’s predicted pollution reading?</p>
<p>Many thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422736" onclick="return addComment.moveForm( &quot;comment-422736&quot;, &quot;422736&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422766" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422766" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2017 at 4:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422766" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Mark!</p>
<p>See this post on how to make predictions with a finalized LSTM model:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422766" onclick="return addComment.moveForm( &quot;comment-422766&quot;, &quot;422766&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422925" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-422925" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0a0c268709b77e9605a78a55f9c02cd3.png" srcset="https://secure.gravatar.com/avatar/0a0c268709b77e9605a78a55f9c02cd3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark</span>
	                <span class="date">December 13, 2017 at 12:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422925" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you, Jason.</p>
<p>I’m almost ready to apply what you’ve taught me here to my use case. The only other thing that isn’t 100% clear to me is the dropping columns number references 9,10,11,12,13,14,15 (below):</p>
<p># drop columns we don’t want to predict<br>
reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)</p>
<p>I get that you’re dropping the columns after ‘pollution’ because you only want to predict the pollution readings but why are they referenced 9-15?</p>
<p>Thank you in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422925" onclick="return addComment.moveForm( &quot;comment-422925&quot;, &quot;422925&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422952" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-422952" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 13, 2017 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422952" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are dropping variables that we do not want to predict at the next time step. We only want to predict pollution.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422952" onclick="return addComment.moveForm( &quot;comment-422952&quot;, &quot;422952&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422966" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-422966" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0a0c268709b77e9605a78a55f9c02cd3.png" srcset="https://secure.gravatar.com/avatar/0a0c268709b77e9605a78a55f9c02cd3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark</span>
	                <span class="date">December 13, 2017 at 7:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422966" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I understand that. My question was around the numbering. If we’re dropping columns ‘dew’ through to ‘rain’ i.e. columns number 3 to 9 in the prepared “pollution.csv” dataset above then why isn’t the code written:</p>
<p>reframed.drop(reframed.columns[[3,4,5,6,7,8,9]], axis=1, inplace=True)</p>
<p>It’s the 9 – 15 that I just need an explanation for please.</p>
<p>Many thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422966" onclick="return addComment.moveForm( &quot;comment-422966&quot;, &quot;422966&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422997" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-422997" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 13, 2017 at 4:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422997" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are dropping them from the new dataset that has lag variables.</p>
<p>Try printing the version of the dataset that we are modifying to get an idea of its shape.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-422997" onclick="return addComment.moveForm( &quot;comment-422997&quot;, &quot;422997&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423026" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423026" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b7c1cb32c97bd28ec2f534fe4b204145.png" srcset="https://secure.gravatar.com/avatar/b7c1cb32c97bd28ec2f534fe4b204145?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">December 13, 2017 at 11:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello json,<br>
again a very successful contribution. </p>
<p>What I would like to do is something like a early warning system that predicts as early as possible, as safely as possible for example in the case of natural disasters, financial forecast or driving data from the prediction output of a Multivariate Time Series LSTM Forecast.</p>
<p>Suppose I get the prediction, e.g. x, y and z and each area labeled  with x or z must be K-units long, each time they occur. X and z  make up 10 percent of the data.</p>
<p>The ground truth and Prediction would then look like e.g.<br>
GT:y y y y y  y y y x x x x x x y y y y y y z z z z z z y y y y y y y y y y y y y y y y<br>
PR:y y y x x y y y x x x x x x y y y x y y y z z z y y y y y y y y y z z y y y x x y y </p>
<p>Now I would like to determine an overall probability for an event, based on the PR sequence.<br>
Op:y – – – – – – – – X – – – – – – Y – – – – – – Z- – – – – -Y – – – – – – – – – – – – – – – – – </p>
<p>I had the idea of a window with a threshold or a sequence classification task.</p>
<p>Since I am fairly new to machine learning and co, but I’m thinking that this problem has probably been discussed and solved very often, I would be very happy about your advice.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423026" onclick="return addComment.moveForm( &quot;comment-423026&quot;, &quot;423026&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423061" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423061" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 14, 2017 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423061" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There is not one best way to solve a problem like, this, but many. I’d encourage you to brainstorm different ways of framing this as a prediction problem and see what works best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423061" onclick="return addComment.moveForm( &quot;comment-423061&quot;, &quot;423061&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423049" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423049" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">December 14, 2017 at 4:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>These days LSTM is also popular for sentimental analysis. Have you written any tutorial on Sentimental Analysis using LSTM or something like that ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423049" onclick="return addComment.moveForm( &quot;comment-423049&quot;, &quot;423049&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423065" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423065" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 14, 2017 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423065" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see here:<br>
<a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow">https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423065" onclick="return addComment.moveForm( &quot;comment-423065&quot;, &quot;423065&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423091" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423091" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d7fcb7c1e3cc9a509c9fd5e9e9a4b2a5.png" srcset="https://secure.gravatar.com/avatar/d7fcb7c1e3cc9a509c9fd5e9e9a4b2a5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mike</span>
	                <span class="date">December 14, 2017 at 5:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423091" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,jason<br>
     can i save my model ? i don’t  want to train it everytime….<br>
oh,and do  you have any article to talk  how to  predict next n step  in Multivariate Time Series Forecasting with LSTMs in Keras??<br>
                                          thank you!!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423091" onclick="return addComment.moveForm( &quot;comment-423091&quot;, &quot;423091&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mike">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423147" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423147" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 15, 2017 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes you can save your model, here’s how:<br>
<a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>
<p>Here’s how to make predictions:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423147" onclick="return addComment.moveForm( &quot;comment-423147&quot;, &quot;423147&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423262" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423262" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3c6d6d407d2cf8dde005be5495e88903.png" srcset="https://secure.gravatar.com/avatar/3c6d6d407d2cf8dde005be5495e88903?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tony</span>
	                <span class="date">December 15, 2017 at 11:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423262" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, jason<br>
   I read your article and run the code.But  i have some  questions .Can you give me some suggestions?<br>
1.   In this article, you prepare the pollution dataset for the LSTM.  All features are normalized, your dataset  is transformed a supervised learning problem . I  want to ask ,why the code is   ‘MinMaxScaler(feature_range=(0, 1)) ‘,  rather than  ‘MinMaxScaler(feature_range=(-1, 1))’ ?I remember  the default activation function for LSTMs is the hyperbolic tangent (tanh), which outputs values between -1 and 1.   Why we set (0,1) in there?<br>
2.  In  this code,we don’t transform Time Series to Stationary. Why?  I think  we must  transform Time Series to Stationary.  It’s  necessary，right?<br>
3. the important arguments are batch_size, n_neuron  and epochs. How shoud i adjust  them?<br>
4. Can i use CNN network to  predict  Multivariate Time Series ? Too many  people all think LSTM is the best  way, Really?<br>
                                                                                            Thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423262" onclick="return addComment.moveForm( &quot;comment-423262&quot;, &quot;423262&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tony">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423335" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-423335" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 16, 2017 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423335" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Results are better if you normalize the data.</p>
<p>Making the data stationary may improve the skill of the model. I was trying to keep the example simple.</p>
<p>Use experiments to see what values give the best results. Be systematic.</p>
<p>I think MLP is better at time series, here’s why:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423335" onclick="return addComment.moveForm( &quot;comment-423335&quot;, &quot;423335&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423474" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-423474" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3c6d6d407d2cf8dde005be5495e88903.png" srcset="https://secure.gravatar.com/avatar/3c6d6d407d2cf8dde005be5495e88903?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tony</span>
	                <span class="date">December 16, 2017 at 7:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423474" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thank you jason,<br>
       your reply  it’s very usefu.  But i still  don’t  understand  why the code is MinMaxScaler(feature_range=(0, 1))?   in your other article ,you use feature_range=(0, 1),<br>
so i’m very wondering . what is the reason? The activation function for LSTMs is changeable?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423474" onclick="return addComment.moveForm( &quot;comment-423474&quot;, &quot;423474&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tony">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423566" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-423566" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 17, 2017 at 8:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423566" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423566" onclick="return addComment.moveForm( &quot;comment-423566&quot;, &quot;423566&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423598" class="comment odd alt depth-5">

	      	<div id="li-comment-423598" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3c6d6d407d2cf8dde005be5495e88903.png" srcset="https://secure.gravatar.com/avatar/3c6d6d407d2cf8dde005be5495e88903?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tony</span>
	                <span class="date">December 17, 2017 at 1:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423598" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i am foolish,I write it wrongly ,i am sorry,<br>
         my question is:<br>
          But i still don’t understand why the code is MinMaxScaler(feature_range=(0, 1))? in your other article ,you use feature_range=(-1, 1),The activation function for LSTMs is tanh?  i think  thnh is in (-1,1)  , why in there ,we use (0,1)?<br>
          thank you so much….</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-423669" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-423669" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423669" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>LSTMs generally perform better with normalized data (in the range 0-1).</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-426821" class="comment odd alt depth-5">

	      	<div id="li-comment-426821" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8ae915f0c4bd95c44f67e1e006379773.png" srcset="https://secure.gravatar.com/avatar/8ae915f0c4bd95c44f67e1e006379773?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">slouchpie</span>
	                <span class="date">January 18, 2018 at 12:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426821" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, great article.<br>
Can you please explain why it is OK to use feature_range [0. 1] as opposed to [-1, 1].<br>
In another article (<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/</a>) you said that the feature_range should be [-1, 1] in order to be the same range as the hyperbolic tan (tanh) function, which default LSTM uses. In fact, you said “This is the preferred range for the time series data.”.<br>
I am not sure why it is OK to now use [0, 1]. Are you taking absolute value of tanh somewhere in your LSTM layer?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-426870" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-426870" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 19, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426870" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The range [0,1] results in better skill.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423270" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423270" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1e28eaec0b8479322b2355a6eb05fe83.png" srcset="https://secure.gravatar.com/avatar/1e28eaec0b8479322b2355a6eb05fe83?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">soloyuyang</span>
	                <span class="date">December 16, 2017 at 12:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,Jason,<br>
The work you have done is wonderful. i’m interested in time series forecasting with lstm.<br>
i have two questions.<br>
1.In some cases in time series forecasting, especially the single series, the features are the data of previous time(t-1,t-2…). For example,only the series of pm2.5, i want to predict the value on t+1,depending on the data of t-k……t-1,t. how should i set the “time-steps” and “features”,  [samples, k+1, 1]or [samples, 1, k+1](treat the previous data as features).<br>
2.you have mentioned “LSTM does not appear to be suitable for autoregression type problems”. did you mean that LSTM didn’t perform well in the cases like the example i mentioned in the first question(single series ,and predict t+1 with data before t).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423270" onclick="return addComment.moveForm( &quot;comment-423270&quot;, &quot;423270&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to soloyuyang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423337" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423337" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 16, 2017 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423337" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post may help you with preparing the data:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<p>And this post has an example:<br>
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>
<p>Correct.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423337" onclick="return addComment.moveForm( &quot;comment-423337&quot;, &quot;423337&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423593" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423593" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/81d980169dd303a3baa120ad73dad744.png" srcset="https://secure.gravatar.com/avatar/81d980169dd303a3baa120ad73dad744?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Mbarak</span>
	                <span class="date">December 17, 2017 at 1:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423593" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I hope you are doing fine. </p>
<p>I am getting this error and i don’t know why. I used my own data set for Ammarilo Texas.</p>
<p>raceback (most recent call last):<br>
  File “/Users/Ahmed/Desktop/Coding/P.prediction.py”, line 118, in<br>
    inv_yhat = scaler.inverse_transform(inv_yhat)<br>
  File “/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/sklearn/preprocessing/data.py”, line 385, in inverse_transform<br>
    X -= self.min_<br>
ValueError: operands could not be broadcast together with shapes (3567,13) (10,) (3567,13)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423593" onclick="return addComment.moveForm( &quot;comment-423593&quot;, &quot;423593&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ahmed Mbarak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423668" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423668" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423668" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The size of your data may not match the expectations of your model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423668" onclick="return addComment.moveForm( &quot;comment-423668&quot;, &quot;423668&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423642" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423642" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">December 17, 2017 at 11:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Currently I am working on a project and I am following your tutorials , they are great but I have some questions regarding LSTM. First is can you briefly tell what timestep is exactly and how that affects the performance of model? </p>
<p>In the above example, we used model.add(LSTM(50)), if we increase the no. LSTM cells, how that will affect the performance of model ?</p>
<p>In the above example, why did you assign shuffle = False, If we keep it true , dont you think that will increase the performance ?</p>
<p>How can I check the underfitting and overfitting of my model and result accuracy of the model ? </p>
<p>Best Regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423642" onclick="return addComment.moveForm( &quot;comment-423642&quot;, &quot;423642&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423674" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423674" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423674" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn more about LSTM inputs here:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<p>I recommend testing different numbers of cells on your problem to see what works best.</p>
<p>We do not want to shuffle inputs because all samples are sequential, learn more here:<br>
<a href="https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/" rel="nofollow">https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/</a></p>
<p>More about model diagnostics here:<br>
<a href="https://machinelearningmastery.com/diagnose-overfitting-underfitting-lstm-models/" rel="nofollow">https://machinelearningmastery.com/diagnose-overfitting-underfitting-lstm-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423674" onclick="return addComment.moveForm( &quot;comment-423674&quot;, &quot;423674&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423677" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423677" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d3ca990d016251679e2fe27de19d6af2.png" srcset="https://secure.gravatar.com/avatar/d3ca990d016251679e2fe27de19d6af2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TAMER A. FARRAG</span>
	                <span class="date">December 18, 2017 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423677" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason, I want to ask why you do normalization (scale) for data before “series to supervised operation”. for another example, this may cause denormalization errors when using n_in=2, n_out=1 .<br>
So , It is better to do normalization after “series to supervised” operation?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423677" onclick="return addComment.moveForm( &quot;comment-423677&quot;, &quot;423677&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to TAMER A. FARRAG">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423710" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423710" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 3:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend normalizing before splitting the series into multiple features.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423710" onclick="return addComment.moveForm( &quot;comment-423710&quot;, &quot;423710&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423686" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423686" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">December 18, 2017 at 8:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423686" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Again appreciation for your blogs and thanks for the quick response but still have some queries. </p>
<p>I am working on a dataset whose size is approximately 2.5 Million and more than 10 features and this is a time series data and interval is 5 min so in my case should I use Truncated Backpropagation Through Time or just I should increase the no. of timesteps to 250-500 as mentioned in one of your blog ?</p>
<p>I have followed many of your tutorials but I did not see “dropout” anywhere but I have read at some places it dcreases the learning time ? </p>
<p>No. of timesteps tells that how many times we are going to backpropagate ? Please correct me if I am wrong.</p>
<p>One big confusion is when to use LSTM and when to Bidirectional LSTM .e.g. as I mentioned my dataset above what will be useful in my case ?</p>
<p>Best Regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423686" onclick="return addComment.moveForm( &quot;comment-423686&quot;, &quot;423686&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423715" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423715" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 3:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423715" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here are some ideas on strategies for dealing with long sequences:<br>
<a href="https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/" rel="nofollow">https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/</a></p>
<p>Here is an example of dropout with LSTMs:<br>
<a href="https://machinelearningmastery.com/use-dropout-lstm-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/use-dropout-lstm-networks-time-series-forecasting/</a></p>
<p>Yes, time steps define BPTT, here’s more on BPTT:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>
<p>Try bidirectional and see if it lifts model skill, here is an example:<br>
<a href="https://machinelearningmastery.com/develop-bidirectional-lstm-sequence-classification-python-keras/" rel="nofollow">https://machinelearningmastery.com/develop-bidirectional-lstm-sequence-classification-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423715" onclick="return addComment.moveForm( &quot;comment-423715&quot;, &quot;423715&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423708" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423708" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f41d9f9cb92c9e5027c0fd70ec35115.png" srcset="https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rui</span>
	                <span class="date">December 18, 2017 at 2:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423708" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello, nice example.</p>
<p>If you want to “compress” time, before entering the LSTM, using convNet1D how would you do ?</p>
<p> thanks in advance,<br>
Rui</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423708" onclick="return addComment.moveForm( &quot;comment-423708&quot;, &quot;423708&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rui">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423727" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423727" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 3:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423727" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Depends on the problem. </p>
<p>Perhaps you can compress all obs from an hour, day or week into a CNN output vector to feed into an LSTM.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423727" onclick="return addComment.moveForm( &quot;comment-423727&quot;, &quot;423727&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423771" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423771" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d308520be749c71072454bbdb3a8d151.jpeg" srcset="https://secure.gravatar.com/avatar/d308520be749c71072454bbdb3a8d151?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stefano</span>
	                <span class="date">December 19, 2017 at 4:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I do not understand why you swap “samples” and “timesteps” meaning. From the Keras’ FAQ, a sample is an element of the dataset. In the case of timeseries prediction, an element of the dataset is a timeseries. In this case, you have just one timeseries. Instead you have N timeseries with just 1 timestep. A timeseries with 1 timestep is not really a timeseries. Anyway, you are not even setting the stateful property and the internal state is going to be reset at each step (sample in your case). So, how does the network remember? </p>
<p>Best regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423771" onclick="return addComment.moveForm( &quot;comment-423771&quot;, &quot;423771&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Stefano">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423793" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423793" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 19, 2017 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423793" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When we frame our time series problem as a supervised learning problem, we can choose what constitutes a sample or a time step.</p>
<p>Indeed, we need multiple timesteps in order to achieve true BPTT:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>
<p>LSTMs can remember across samples if internal state is not reset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423793" onclick="return addComment.moveForm( &quot;comment-423793&quot;, &quot;423793&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423888" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423888" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">December 19, 2017 at 9:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423888" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Really great blogs. I have never seen such nice blogs. But again I am disturbing you.</p>
<p>If I have a time series dataset at 5min interval which contain 250000 rows and 10 features and I want to predict one feature and If I apply Backpropagation Through Time (BPTT) using 200 timesteps:</p>
<p>1-&gt; I have to reshape into [samples, timesteps, features] = [ 250000, 200, 10] ?</p>
<p>or</p>
<p>2-&gt; I will have to split the 250000 time steps into 1250 sub-sequences of 200 time steps each and I have to reshape into [samples, timesteps, features] = [ 1250, 200, 10]  ?</p>
<p>Which approach is the right for BPTT, both of them have mentioned in your blogs and now I am totally confused between these two ?</p>
<p>And kindly mention the reshape [samples, timesteps, features] for the above example in case of Truncated Backpropagation Through Time (TBPTT).</p>
<p>Regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423888" onclick="return addComment.moveForm( &quot;comment-423888&quot;, &quot;423888&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423926" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423926" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 19, 2017 at 3:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423926" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, here are some ideas that may help:<br>
<a href="https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/" rel="nofollow">https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423926" onclick="return addComment.moveForm( &quot;comment-423926&quot;, &quot;423926&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423943" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423943" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f6d4d46df902c0fea1c6a3b1f03ab22d.png" srcset="https://secure.gravatar.com/avatar/f6d4d46df902c0fea1c6a3b1f03ab22d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.hcltech.com/" rel="external nofollow" class="url">Mahesh</a></span>
	                <span class="date">December 19, 2017 at 5:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423943" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,<br>
I am trying to Solve a problem using RNN and wish to explain that problem using this example and want to know how to apply RNN<br>
If the test data had every other data other than PM2.5 ( Pollution) for  few days  , how  to predict pollution using the Training data and test data with RNN<br>
thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423943" onclick="return addComment.moveForm( &quot;comment-423943&quot;, &quot;423943&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mahesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424040" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-424040" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 20, 2017 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I’m not sure I follow. Can you perhaps rephrase your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424040" onclick="return addComment.moveForm( &quot;comment-424040&quot;, &quot;424040&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424344" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-424344" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f6d4d46df902c0fea1c6a3b1f03ab22d.png" srcset="https://secure.gravatar.com/avatar/f6d4d46df902c0fea1c6a3b1f03ab22d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.hcltech.com/" rel="external nofollow" class="url">Mahesh</a></span>
	                <span class="date">December 21, 2017 at 11:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424344" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,<br>
Let me Rephrase my question<br>
We have a  problem to solve  similar to example you have explained above.<br>
Instead of explaining my problem, I would like to pose a question on this problem hoping that would provide some clues to solve my problem<br>
You had Stated </p>
<p>    Predict the pollution for the next hour based on the weather conditions and pollution over the last 24 hours.<br>
    Predict the pollution for the next hour as above and given the “expected” weather conditions for the next hour.</p>
<p>The first one is clear. But the second line is not clear to me<br>
Are you predicting the pollution for next hour based on Model created using past data AND using weather conditions  like temperature, pressure for next hour ?<br>
if yes, then i would go ahead and read more on the solution you have posted<br>
if no, i am wondering how RNN can be used to solve a problem like<br>
Predict the pollution , not just for next hour but , say, for next 15 hours  based on past data and with weather conditions also provided for those 15 hours</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424344" onclick="return addComment.moveForm( &quot;comment-424344&quot;, &quot;424344&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mahesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424378" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-424378" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 22, 2017 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424378" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I use the weather conditions for the next hour with the conceit that we pretend they are forecast weather condition rather than obs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424378" onclick="return addComment.moveForm( &quot;comment-424378&quot;, &quot;424378&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423999" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423999" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d7fcb7c1e3cc9a509c9fd5e9e9a4b2a5.png" srcset="https://secure.gravatar.com/avatar/d7fcb7c1e3cc9a509c9fd5e9e9a4b2a5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jack</span>
	                <span class="date">December 19, 2017 at 11:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423999" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi，jason<br>
     if   i want  to  make Multivariate Time Series classification  Forecasting with LSTMs in Keras.<br>
what should i do ? my dataset is  Y: classified variable(0/1)  , X1：numericalvariable，X2：numerical variable，X3：numerical variable，and all of these variables are timeseries.    i want  to  predict Y’s class.<br>
                                                                          thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-423999" onclick="return addComment.moveForm( &quot;comment-423999&quot;, &quot;423999&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424054" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-424054" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 20, 2017 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424054" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can use the above tutorial as a guide?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424054" onclick="return addComment.moveForm( &quot;comment-424054&quot;, &quot;424054&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424022" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-424022" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eedf4f02c80308b2cf11d79da1f0db8.png" srcset="https://secure.gravatar.com/avatar/5eedf4f02c80308b2cf11d79da1f0db8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">December 20, 2017 at 3:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI Jason,</p>
<p>You are not using in this blog “stateful = True”, how your network will remember the previous history ? </p>
<p>When we use property “returnSequences = True” ?</p>
<p>Please give a brief description.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424022" onclick="return addComment.moveForm( &quot;comment-424022&quot;, &quot;424022&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424042" class="comment even depth-2">

	      	<div id="li-comment-424042" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/579961fdcdf73b2a961bdcfc13cdb454.png" srcset="https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anton</span>
	                <span class="date">December 20, 2017 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424042" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This model is not rolling-forecast, so we don’t need to manually reset the cells memory as of reset_states() method, and therefore the model is not required to be “stateful = True”</p>
<p>“returnSequences = True” is necessary for LSTM multi-layer stacking (probably not only), when each previous layer should return the same vectors as it received from the previous layer. In this post model Jason used only 1 LSTM layer, so it should transmit only one flat value to Dense(1) layer.</p>
<p>Am i right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424042" onclick="return addComment.moveForm( &quot;comment-424042&quot;, &quot;424042&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Anton">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-424058" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-424058" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 20, 2017 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The LSTM is still stateful, although state is reset at the end of each batch.</p>
<p>Return sequences is appropriate when stacking LSTMs or when outputting a sequence.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424058" onclick="return addComment.moveForm( &quot;comment-424058&quot;, &quot;424058&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424037" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-424037" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/579961fdcdf73b2a961bdcfc13cdb454.png" srcset="https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anton</span>
	                <span class="date">December 20, 2017 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424037" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason! </p>
<p>Is it important (or even necessary) to include the pollution of the previous timestep as the feature of observation to predict next?</p>
<p>   var1(t-1)  var2(t-1)  var3(t-1)  var4(t-1)  var5(t-1)  var6(t-1)  \<br>
1   0.129779   0.352941   0.245902   0.527273   0.666667   0.002290</p>
<p>   var7(t-1)  var8(t-1)   var1(t)<br>
1   0.000000        0.0  0.148893</p>
<p>I’m asking about var1(t-1)</p>
<p>Bacause if the pollution value is a result of all the other variables in the past, so why should we feed it to the LSTM? </p>
<p>Thanks for your great work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424037" onclick="return addComment.moveForm( &quot;comment-424037&quot;, &quot;424037&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Anton">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424069" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-424069" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 20, 2017 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424069" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Test and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424069" onclick="return addComment.moveForm( &quot;comment-424069&quot;, &quot;424069&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424226" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-424226" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/449b21082ed936027fd3464cf3087a04.png" srcset="https://secure.gravatar.com/avatar/449b21082ed936027fd3464cf3087a04?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Franzi</span>
	                <span class="date">December 21, 2017 at 1:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424226" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>thank you very much for your turorial. I am wondering if it is possible to adapt your code to the a multi-step forecasting problem.<br>
Can I predict multiple time steps of the pollution value under consideration of the other variables?</p>
<p>Thank you for your great work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424226" onclick="return addComment.moveForm( &quot;comment-424226&quot;, &quot;424226&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Franzi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424254" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-424254" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2017 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, use this post as a template:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424254" onclick="return addComment.moveForm( &quot;comment-424254&quot;, &quot;424254&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424263" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-424263" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4f7ab6648ccee4bb2d652f85386bd57d.jpeg" srcset="https://secure.gravatar.com/avatar/4f7ab6648ccee4bb2d652f85386bd57d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ismael</span>
	                <span class="date">December 21, 2017 at 6:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424263" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!</p>
<p>Thanks for your tutorial, and the time you have dedicated to make it and answer all of us. And also sorry for my bad english!</p>
<p>I’m making a prediction model for water consumption, and I have for inputs, the real aggregated consume of a pool of people of the previous day, the previous-day forecast of consume for the day, if the day is labor/no labor, day of the week, and the average anual consume and standard dev for 10 subtypes of persons.</p>
<p>For last inputs, I have 20 columns, 10 for average consume, and 10 for standard dev.</p>
<p>With this, my question is, may I link in any way average consumue and std-dev, as something similar than a tuple, as input? I’m afraid that the model misunderstand relations between them.</p>
<p>Thank you in advance!! Best regards.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424263" onclick="return addComment.moveForm( &quot;comment-424263&quot;, &quot;424263&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ismael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424292" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-424292" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2017 at 3:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424292" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend brainstorming many different ways of framing the problem and test each to see what works best for your data, even ensemble a few of them together.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424292" onclick="return addComment.moveForm( &quot;comment-424292&quot;, &quot;424292&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424573" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-424573" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c6f73d1feef8931c307473daea5e4edb.png" srcset="https://secure.gravatar.com/avatar/c6f73d1feef8931c307473daea5e4edb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ankit Mishra</span>
	                <span class="date">December 23, 2017 at 7:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424573" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this blog on using RNN and using LSTM  for forecasting.<br>
 and its very enlightning</p>
<p>i have been working on an energy dataset with dimensions(87647,7).(approx five years of data).The data is collected at every half an hour </p>
<p>.I have trained my model using a single LSTM and Dense Layer with test batchsize of 4 years and predicted and validated over a 1 year of data .</p>
<p>The test rmse is about 0.458 and train rmse is 0.058 .does this means my model badly overfits the data. i have scaled the data using minmax scaler just like your post </p>
<p>i have read your other blog of diagnosis of underfitting and overfitting and played with batchsize and epochs but it doesnt helps much . </p>
<p>can you give me insights upon how to improve my model performance ?<br>
does LSTM regressor work well ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424573" onclick="return addComment.moveForm( &quot;comment-424573&quot;, &quot;424573&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ankit Mishra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424618" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-424618" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 24, 2017 at 4:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424618" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great work! I have some ideas for lifting model skill here that might help as a first step:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424618" onclick="return addComment.moveForm( &quot;comment-424618&quot;, &quot;424618&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424651" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-424651" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b84e9852c9d41162bc1b2ef38e1c2ac4.png" srcset="https://secure.gravatar.com/avatar/b84e9852c9d41162bc1b2ef38e1c2ac4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adam</span>
	                <span class="date">December 24, 2017 at 12:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424651" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason<br>
thank you for such a great tutorial, I implement the code and it works fine with no problem.<br>
but I was wondering about the future I mean how we may predict the next 10 hours or  5 days after the dataset ends based on this proven model</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424651" onclick="return addComment.moveForm( &quot;comment-424651&quot;, &quot;424651&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Adam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424700" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-424700" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 25, 2017 at 5:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424700" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can call model.predict()</p>
<p>Learn more here:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424700" onclick="return addComment.moveForm( &quot;comment-424700&quot;, &quot;424700&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424742" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-424742" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ab4c68bac57227d96bb7df438b3d21ec.png" srcset="https://secure.gravatar.com/avatar/ab4c68bac57227d96bb7df438b3d21ec?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sara</span>
	                <span class="date">December 25, 2017 at 7:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424742" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Why have you trained both examples till the 50 epochs? because the lowest validation error on each example might happen somewhere before the 50th epoch. for example, 10th at the first one and 15th at the second one.</p>
<p>the 50th epoch might not be the best point.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424742" onclick="return addComment.moveForm( &quot;comment-424742&quot;, &quot;424742&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424763" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-424763" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 26, 2017 at 5:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424763" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is just a demonstration. You can tune the model with early stopping or any way you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424763" onclick="return addComment.moveForm( &quot;comment-424763&quot;, &quot;424763&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424989" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-424989" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b84e9852c9d41162bc1b2ef38e1c2ac4.png" srcset="https://secure.gravatar.com/avatar/b84e9852c9d41162bc1b2ef38e1c2ac4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">tom</span>
	                <span class="date">December 28, 2017 at 1:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424989" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
Thanks for this awesome web site where I learned a lot about deep learning, but I have a question:<br>
How to feed a multiple data sources (several csv files) special if these files are time series to neural network?<br>
we may have a multiple data frames, different date format with different time steps, and may be different data format…etc.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424989" onclick="return addComment.moveForm( &quot;comment-424989&quot;, &quot;424989&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to tom">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425010" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425010" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 28, 2017 at 5:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can use a multi-headed model, see an example on this post:<br>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425010" onclick="return addComment.moveForm( &quot;comment-425010&quot;, &quot;425010&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424995" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-424995" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ba53e1499e0096048888a5d1176e2199.png" srcset="https://secure.gravatar.com/avatar/ba53e1499e0096048888a5d1176e2199?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">karim</span>
	                <span class="date">December 28, 2017 at 1:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424995" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason<br>
thanks for the tutorial, I did the example you did with no problems at all, thanks for the detailed description you did, but I have a question about what’s next.<br>
I mean how to publish this model into a complete application that can make prediction with different data based on the model without repeating the whole training process all over again and again.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-424995" onclick="return addComment.moveForm( &quot;comment-424995&quot;, &quot;424995&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to karim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425013" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425013" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 28, 2017 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425013" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have notes on finalizing the model here:<br>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<p>I have some ideas on moving a model to production here:<br>
<a href="http://machinelearningmastery.com/deploy-machine-learning-model-to-production/" rel="nofollow">http://machinelearningmastery.com/deploy-machine-learning-model-to-production/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425013" onclick="return addComment.moveForm( &quot;comment-425013&quot;, &quot;425013&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425113" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-425113" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f41d9f9cb92c9e5027c0fd70ec35115.png" srcset="https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://github.com/rjpg" rel="external nofollow" class="url">Rui</a></span>
	                <span class="date">December 29, 2017 at 12:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425113" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello </p>
<p>when using K.set_image_dim_ordering(“th”)</p>
<p>on LSTM the input_shape(timeSteps,variables) becomes input_shape(variables, timeSteps) ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425113" onclick="return addComment.moveForm( &quot;comment-425113&quot;, &quot;425113&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rui">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425127" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-425127" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 29, 2017 at 2:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425127" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t know, try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425127" onclick="return addComment.moveForm( &quot;comment-425127&quot;, &quot;425127&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425172" class="comment even depth-3 parent">

	      	<div id="li-comment-425172" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f41d9f9cb92c9e5027c0fd70ec35115.png" srcset="https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rui</span>
	                <span class="date">December 30, 2017 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425172" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I tried , In my problem I am using K.set_image_dim_ordering(“th”) the acc drop when I use input_shape(variables, timeSteps) … Looking on the internet (on completely different approaches) it looks like it does not change the dim ordering on LSTM like on ConvNets.</p>
<p>With all that I assume the dim_order is always the same in LSTM :  input_shape(timeSteps,variables)</p>
<p>for K.set_image_dim_ordering(‘th’) or K.set_image_dim_ordering(‘tf’)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425172" onclick="return addComment.moveForm( &quot;comment-425172&quot;, &quot;425172&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rui">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425234" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-425234" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 31, 2017 at 5:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425234" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe dimensional order is always the same for LSTMS and that changing dim ordering is only for images (e.g. impacting CNNs) as the name suggests.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425234" onclick="return addComment.moveForm( &quot;comment-425234&quot;, &quot;425234&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425139" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-425139" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0b7df686ab181a8100f4e44a15681a27.jpeg" srcset="https://secure.gravatar.com/avatar/0b7df686ab181a8100f4e44a15681a27?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter Cserna</span>
	                <span class="date">December 29, 2017 at 10:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425139" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I am wondering if I would one hot encode the wind feature, what modifications should be done on the shape of input?<br>
Br,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425139" onclick="return addComment.moveForm( &quot;comment-425139&quot;, &quot;425139&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Peter Cserna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425160" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425160" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 30, 2017 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425160" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The length of the binary vector would be added to the number of input features.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425160" onclick="return addComment.moveForm( &quot;comment-425160&quot;, &quot;425160&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425283" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-425283" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/84be200054559e38984655b5c4df9957.png" srcset="https://secure.gravatar.com/avatar/84be200054559e38984655b5c4df9957?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter K.</span>
	                <span class="date">December 31, 2017 at 10:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425283" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, </p>
<p>Great tutorial, and outstanding book btw. I have two related conceptual questions and would appreciate your expertise:</p>
<p>1. Given that LSTM is stateful and has memory, what would be a valid reason to use multi-lag input? Is it just to force a quasi-working memory onto the LSTM or are there some other reasons?</p>
<p>2. You mention that LSTM is not ideal for autoregression. I don’t get this. Doesn’t the inbuilt memory make LSTM ideal for autoregressive time series?</p>
<p>And one more question: what’s your view on combining convolutional NN with LSTM for time series predictions, for instance to capture multi-scale patterns?</p>
<p>Happy New Year!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425283" onclick="return addComment.moveForm( &quot;comment-425283&quot;, &quot;425283&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Peter K.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425320" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425320" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 1, 2018 at 5:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425320" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Time steps are required for BPTT:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>
<p>The memory in LSTMs is simple and cannot act like a stack making it poor for autoregression. Please read this post:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>
<p>I have not tried combining CNN and LSTM for time series, but I have for video classification:<br>
<a href="https://machinelearningmastery.com/cnn-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/cnn-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425320" onclick="return addComment.moveForm( &quot;comment-425320&quot;, &quot;425320&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425536" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-425536" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ac4c69e103afed2ecdc657254e3dc2a7.png" srcset="https://secure.gravatar.com/avatar/ac4c69e103afed2ecdc657254e3dc2a7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Choi.HD</span>
	                <span class="date">January 3, 2018 at 11:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425536" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello. Thank you so much. Dr.Jason </p>
<p>I have a question. How can we see a graph of a prediction, not loss graph? like 1 year after</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425536" onclick="return addComment.moveForm( &quot;comment-425536&quot;, &quot;425536&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Choi.HD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425578" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425578" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 4, 2018 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425578" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can collect predictions and plot them using matplotlib.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425578" onclick="return addComment.moveForm( &quot;comment-425578&quot;, &quot;425578&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425565" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-425565" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0d4109194474dcbd0249c7cfe0d94477.png" srcset="https://secure.gravatar.com/avatar/0d4109194474dcbd0249c7cfe0d94477?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vlad Gorlov</span>
	                <span class="date">January 4, 2018 at 7:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425565" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As far as I can understand so far (and I am a beginner in deep learning space), LSTM cannot handle trends or seasonality (you recommend making all series stationary with differencing and seasonal adjustment first). In practical business problems trends and seasonality are the most important aspects of forecasting so separating them out leaves us very little to work with. Any thoughts on how trends and seasonality could be handled by NN’s? In principle, NN’s are good at finding patterns and these are exactly that</p>
<p>Many thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425565" onclick="return addComment.moveForm( &quot;comment-425565&quot;, &quot;425565&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vlad Gorlov">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425588" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-425588" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 4, 2018 at 8:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425588" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Exactly as you say, model the structure and remove it, then model what you have left.</p>
<p>I would encourage you to explore MLPs and only move to LSTMs if they lift model skill.</p>
<p>Also, get creative about inputs to the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425588" onclick="return addComment.moveForm( &quot;comment-425588&quot;, &quot;425588&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425644" class="comment even depth-3 parent">

	      	<div id="li-comment-425644" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0d4109194474dcbd0249c7cfe0d94477.png" srcset="https://secure.gravatar.com/avatar/0d4109194474dcbd0249c7cfe0d94477?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vlad Gorlov</span>
	                <span class="date">January 5, 2018 at 2:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425644" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I keep hoping that given deep learning success across such a variety of applications it can also be used eventually to pick up these patterns just like today it can handle video. I doubt that there is something structurally intractable about trends, seasonality, lifecycles, etc. If people can do it, ML should be able to even if not just yet.</p>
<p>Was looking at your CNN LSTM tutorial. Seems like a step in that direction. Of course, there we are dealing with a sequence of patterns each of which can be interpreted by CNN and then submitted to LSTM. Time series are not quite like that, they are sequences WITH patterns. But hopefully there is an architecture to handle that too</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425644" onclick="return addComment.moveForm( &quot;comment-425644&quot;, &quot;425644&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vlad Gorlov">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425669" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-425669" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 5, 2018 at 5:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425669" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It might come down to how the series is presented to the network.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425669" onclick="return addComment.moveForm( &quot;comment-425669&quot;, &quot;425669&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425627" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-425627" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e85b4c9ff4ce92bdc07a327ccd4b3e34.png" srcset="https://secure.gravatar.com/avatar/e85b4c9ff4ce92bdc07a327ccd4b3e34?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Antonio</span>
	                <span class="date">January 4, 2018 at 11:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425627" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I have question, I am new to ML so please don’t get annoyed. I am actually trying to understand why the shape of a prediction does not have the same shape of test_X, I have fed the model with my data which is originally a time series with 3 values of a parameter max,min and avg, I have converted it to a supervised problem, I would like to predict these 3 values, so I’d expect the prediction to have more than one column, but I always get one column as output and I don’t understand which of the parameter values either min, max or avg is predicting.</p>
<p>Thanks a lot,<br>
Antonio</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425627" onclick="return addComment.moveForm( &quot;comment-425627&quot;, &quot;425627&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Antonio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425665" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-425665" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 5, 2018 at 5:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post for a good explanation of input shape:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425665" onclick="return addComment.moveForm( &quot;comment-425665&quot;, &quot;425665&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425906" class="comment even depth-3">

	      	<div id="li-comment-425906" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e85b4c9ff4ce92bdc07a327ccd4b3e34.png" srcset="https://secure.gravatar.com/avatar/e85b4c9ff4ce92bdc07a327ccd4b3e34?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Antonio</span>
	                <span class="date">January 9, 2018 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425906" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425906" onclick="return addComment.moveForm( &quot;comment-425906&quot;, &quot;425906&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Antonio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425742" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-425742" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/449b21082ed936027fd3464cf3087a04.png" srcset="https://secure.gravatar.com/avatar/449b21082ed936027fd3464cf3087a04?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Franziska</span>
	                <span class="date">January 6, 2018 at 4:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425742" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hay, I would like to predict the pollution data for the next 10 timesteps so t+1 till t+10, just knowing the ‘dew’, ‘temp’, ‘press’, ‘wnd_dir’, ‘wnd_spd’, ‘snow’, ‘rain’ data of timestep t.</p>
<p>Is this possible? What do I have to change in the definition of series_to Supervised function?</p>
<p>Thank a lot in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425742" onclick="return addComment.moveForm( &quot;comment-425742&quot;, &quot;425742&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Franziska">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425757" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-425757" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 6, 2018 at 5:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425757" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post has an example of multi-step forecasting:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425757" onclick="return addComment.moveForm( &quot;comment-425757&quot;, &quot;425757&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425813" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-425813" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/476c7c1d10d8a0411ef6713aab71c4d4.png" srcset="https://secure.gravatar.com/avatar/476c7c1d10d8a0411ef6713aab71c4d4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vlad</span>
	                <span class="date">January 7, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425813" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello and a happy new year! <img draggable="false" class="emoji" alt="😀" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f600.svg"></p>
<p>I’m back with more pertinent quesions. Managed to create the ml environment, finally, and ran this example with my own data (the values are all integers so i have not used the labelencoding() feature – used here for the wind dir)</p>
<p>i’ve transformed the data so it resembles the pollution data input, trained it but when executing </p>
<p>inv_yhat = scaler.inverse_transform(inv_yhat)</p>
<p>it returns the following error:</p>
<p>Traceback (most recent call last):<br>
  File “/Users/vlad/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py”, line 2862, in run_code<br>
    exec(code_obj, self.user_global_ns, self.user_ns)<br>
  File “”, line 1, in<br>
    inv_yhat = scaler.inverse_transform(inv_yhat)<br>
  File “/Users/vlad/anaconda3/lib/python3.6/site-packages/sklearn/preprocessing/data.py”, line 385, in inverse_transform<br>
    X -= self.min_<br>
ValueError: operands could not be broadcast together with shapes (13,13) (7,) (13,13) </p>
<p>the data structure is 303 rows x 7 columns (excluding the date)<br>
training data size is 289.</p>
<p>Any idea what i’m doing wrong?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425813" onclick="return addComment.moveForm( &quot;comment-425813&quot;, &quot;425813&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to vlad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425844" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-425844" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 8, 2018 at 5:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Does the example in the post work as-is?</p>
<p>Perhaps this post will help you reshape your data:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425844" onclick="return addComment.moveForm( &quot;comment-425844&quot;, &quot;425844&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425898" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-425898" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cc63d6185199d1aaab7e8ca973f0a59f.png" srcset="https://secure.gravatar.com/avatar/cc63d6185199d1aaab7e8ca973f0a59f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nathan D.</span>
	                <span class="date">January 9, 2018 at 1:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for the great post. I have a short question that hope you may address:</p>
<p>Is this fair to normalize both training and test datasets at the same time? I think in your post, the test dataset is truly the validation one so it should be ok. However, how do we normalize and re-scale the unseen test data in the future, in which they may contain values (at some features) larger/smaller than the max/min that we have seen in our training data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425898" onclick="return addComment.moveForm( &quot;comment-425898&quot;, &quot;425898&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nathan D.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425922" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-425922" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 9, 2018 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425922" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, normalize the training dataset and use the min/max from training to normalize the test set.</p>
<p>sklearn makes this really easy with their data transform objects.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425922" onclick="return addComment.moveForm( &quot;comment-425922&quot;, &quot;425922&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425947" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-425947" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/664383c749762301a661097bca38a9b6.png" srcset="https://secure.gravatar.com/avatar/664383c749762301a661097bca38a9b6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leo</span>
	                <span class="date">January 9, 2018 at 2:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425947" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, great work, thank you very much for your blog, it gives me many help.</p>
<p>However, I  have a question. Your code removed the other 7 features from the test data, therefore, we need to restore them in last section to do the invert scaling. But, the code :</p>
<p>concatenate((yhat, test_X[:, -7:]), axis=1), </p>
<p>whether the test_X should be replaced by test_y in this line?  is it right? Or it does not matter</p>
<p>Thanks again and happy new year!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425947" onclick="return addComment.moveForm( &quot;comment-425947&quot;, &quot;425947&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Leo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425948" class="comment even depth-2 parent">

	      	<div id="li-comment-425948" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/664383c749762301a661097bca38a9b6.png" srcset="https://secure.gravatar.com/avatar/664383c749762301a661097bca38a9b6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leo</span>
	                <span class="date">January 9, 2018 at 2:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425948" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In fact, I mean the test_X[:, -7:]) should be replaced by test[:, -n_features:]?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425948" onclick="return addComment.moveForm( &quot;comment-425948&quot;, &quot;425948&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Leo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425962" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-425962" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 9, 2018 at 3:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Did you try it, does it work?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425962" onclick="return addComment.moveForm( &quot;comment-425962&quot;, &quot;425962&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-437705" class="comment even depth-3">

	      	<div id="li-comment-437705" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09adc2fd6b283be0378293835a7bf117.png" srcset="https://secure.gravatar.com/avatar/09adc2fd6b283be0378293835a7bf117?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">chiu0602</span>
	                <span class="date">May 17, 2018 at 1:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437705" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think it should be test_X[:, -(n_features-1):])</p>
<p>By the way, thanks Dr Jason a lot for the useful articles and help through comments!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437705" onclick="return addComment.moveForm( &quot;comment-437705&quot;, &quot;437705&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to chiu0602">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425961" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425961" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 9, 2018 at 3:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425961" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It does not matter.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425961" onclick="return addComment.moveForm( &quot;comment-425961&quot;, &quot;425961&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425966" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-425966" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5f09c68b7652ff38f87f323b97630488.png" srcset="https://secure.gravatar.com/avatar/5f09c68b7652ff38f87f323b97630488?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dan Baez</span>
	                <span class="date">January 9, 2018 at 3:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425966" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for the great post and I recently purchased your book. Equally helpful for learning (I’m completely new to ML techniques!). I have question which is probably straight forward but has me puzzled. </p>
<p>In the China Pollution multivariate prediction code, what exactly is required to predict and print the next time hour prediction once I have updated all other variables with new data in the pollution.csv file? I have read other posts but it is still not clear to me. So essentially, I have run all the code as provided above not problems. I now have updated pollution.csv with my own variable data but can’t copy and paste any of the code provided to obtain new predictions….what is the exact code to use so I get a pollution value to be predicted and printed? Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-425966" onclick="return addComment.moveForm( &quot;comment-425966&quot;, &quot;425966&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dan Baez">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426049" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-426049" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 10, 2018 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, I spell out how to make a prediction here:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426049" onclick="return addComment.moveForm( &quot;comment-426049&quot;, &quot;426049&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426010" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-426010" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ac4c69e103afed2ecdc657254e3dc2a7.png" srcset="https://secure.gravatar.com/avatar/ac4c69e103afed2ecdc657254e3dc2a7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sergio</span>
	                <span class="date">January 10, 2018 at 12:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr. Jason. Thank you so much always.</p>
<p>I have a question. </p>
<p>The value of result on your air pollution example was got 0.xxx. In other words, it is new value.</p>
<p>But in my case, the results exist. For example, area, weather, person are multivariate depends on time. And the sold number of icecream is the value of result through area, weather, person etc. And then i want to predict the sold number of ice cream in real time seeing datas. How can i make this codes? I think it can be regression or mixed regression and time series. </p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426010" onclick="return addComment.moveForm( &quot;comment-426010&quot;, &quot;426010&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sergio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426066" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-426066" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 10, 2018 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426066" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow. Perhaps use the above code as a template for your problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426066" onclick="return addComment.moveForm( &quot;comment-426066&quot;, &quot;426066&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426018" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-426018" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e85b4c9ff4ce92bdc07a327ccd4b3e34.png" srcset="https://secure.gravatar.com/avatar/e85b4c9ff4ce92bdc07a327ccd4b3e34?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Antonio</span>
	                <span class="date">January 10, 2018 at 1:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426018" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI Jason,</p>
<p>I have a question I hope you can answer, the prediction you make with your model, are a step-by-step prediction, that is you use the current pollution value to predict the next one, so their variations are not very big and I assume the predictions are very accurate because of that. My question is: how would I predict all the values of the next hour based on past data, in other words how would you predict the shape of the pollution function for the next x seconds based on past data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426018" onclick="return addComment.moveForm( &quot;comment-426018&quot;, &quot;426018&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Antonio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426069" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-426069" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 10, 2018 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426069" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is called multi-step forecasting, see this tutorial:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426069" onclick="return addComment.moveForm( &quot;comment-426069&quot;, &quot;426069&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426184" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-426184" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b61d4bb318ba7b15b72fb153989b0602.png" srcset="https://secure.gravatar.com/avatar/b61d4bb318ba7b15b72fb153989b0602?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">JB</span>
	                <span class="date">January 11, 2018 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason-<br>
This example is fantastic, but I have some questions.  If I alter the model to where n_in = 12 and n_out =3, am I correct in understanding that I am essentially using the last 12 time points to forecast the next three in time?  If that is so, wouldn’t there theoretically be multiple forecasts for each point in time?  If so, how do we come up with the values that are output?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426184" onclick="return addComment.moveForm( &quot;comment-426184&quot;, &quot;426184&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to JB">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426247" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-426247" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 12, 2018 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426247" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are multiple ways to predict 3 time steps ahead:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<p>I would recommend this approach:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426247" onclick="return addComment.moveForm( &quot;comment-426247&quot;, &quot;426247&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426327" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-426327" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8d6842367f185049718f93092acb5cac.png" srcset="https://secure.gravatar.com/avatar/8d6842367f185049718f93092acb5cac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maria</span>
	                <span class="date">January 12, 2018 at 10:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426327" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, Brownlee.</p>
<p>First of all, thanks!</p>
<p>If your problem were classification, what “loss” function would you indicate?<br>
What changes would you do in “design network” section?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426327" onclick="return addComment.moveForm( &quot;comment-426327&quot;, &quot;426327&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Maria">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426329" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-426329" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8d6842367f185049718f93092acb5cac.png" srcset="https://secure.gravatar.com/avatar/8d6842367f185049718f93092acb5cac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maria</span>
	                <span class="date">January 12, 2018 at 11:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426329" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I intend to use “categorical_crossentropy” loss function.<br>
My problem has 3 possible output classes (0,1 or 2)</p>
<p>So the last layer I put 3 neurons. Right?</p>
<p>Before all of this, i need to use LabelEncoder class and np_utils.to_categorical() method. Right?</p>
<p>My doubts is about what activation function is better to my problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426329" onclick="return addComment.moveForm( &quot;comment-426329&quot;, &quot;426329&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Maria">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426369" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-426369" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 13, 2018 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426369" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nope, you need to use categorical_crossentropy for &gt; 2 classes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426369" onclick="return addComment.moveForm( &quot;comment-426369&quot;, &quot;426369&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426368" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-426368" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 13, 2018 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426368" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>binary_crossentropy for 2 classes otherwise categorical_crossentropy.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426368" onclick="return addComment.moveForm( &quot;comment-426368&quot;, &quot;426368&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426404" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-426404" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/79da4762ef6c7f371788441c78fbf754.png" srcset="https://secure.gravatar.com/avatar/79da4762ef6c7f371788441c78fbf754?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">steven</span>
	                <span class="date">January 13, 2018 at 9:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426404" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Nice example, very detail and great responses to questions. I just found this post when tried to see if LSTM outperforms normal statistical learning methods. From your answers, you alluded two important points:</p>
<p>1. LSTM is not great for autoregression, compared to MLP<br>
2. SARIMA is better fit to this particular dataset </p>
<p>Can you elaborate the first point? Do you mean there is an AR model in the dataset, esp., pollution? I did acf and pacf on pollution (in R, not Python):</p>
<p>acf(pollution,plot=T)</p>
<p>Autocorrelations of series ‘pollution’, by lag</p>
<p>    0     1     2     3     4     5     6     7     8     9    10    11    12<br>
1.000 0.659 0.507 0.405 0.328 0.273 0.228 0.193 0.164 0.143 0.127 0.111 0.102  …</p>
<p>pacf(pollution,plot=T)</p>
<p>Partial autocorrelations of series ‘pollution’, by lag</p>
<p>     1      2      3      4      5      6      7      8      9     10     11<br>
 0.659  0.128  0.053  0.024  0.023  0.012  0.012  0.006  0.011  0.011  0.004 </p>
<p>From your experience, how would compare performance between MLP and linear regression (SARIMA or whatever)? I understand you don’t have an example on linear regression yet. So just keep the discussion in general.</p>
<p>Thanks,<br>
Steven</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426404" onclick="return addComment.moveForm( &quot;comment-426404&quot;, &quot;426404&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to steven">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426472" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-426472" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 14, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426472" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but we are modeling it as an AR: t = f(t-1, t-2, …).</p>
<p>See more here:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>
<p>Compare the methods based on skill directly. Perhaps I don’t understand your question.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426472" onclick="return addComment.moveForm( &quot;comment-426472&quot;, &quot;426472&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426538" class="comment even depth-3">

	      	<div id="li-comment-426538" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/79da4762ef6c7f371788441c78fbf754.png" srcset="https://secure.gravatar.com/avatar/79da4762ef6c7f371788441c78fbf754?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Steven</span>
	                <span class="date">January 14, 2018 at 5:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ah, now I realized what you refer “AR” to is different than I referred to after reading your link. Your AR is defined as the learning method: model prediction is based on previous knowledge at t-1, t-2, etc. What I referred to was time parametric behavior in the data itself. In other words, the dataset itself can or can’t be fit into AR, ARIMA… etc models and thus if LSTM would be advantageous to these parametric modeling methods.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426538" onclick="return addComment.moveForm( &quot;comment-426538&quot;, &quot;426538&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Steven">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426639" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-426639" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e18a661cce6b71e948ea30b80fabac5a.png" srcset="https://secure.gravatar.com/avatar/e18a661cce6b71e948ea30b80fabac5a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sara</span>
	                <span class="date">January 16, 2018 at 4:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thank you for this perfect post.<br>
For prediction, in multivariate model, after saving this model, How I should call it back?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426639" onclick="return addComment.moveForm( &quot;comment-426639&quot;, &quot;426639&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426660" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-426660" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 16, 2018 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426660" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help you understand how to make predictions:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426660" onclick="return addComment.moveForm( &quot;comment-426660&quot;, &quot;426660&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426710" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-426710" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/90172a87012b38947acedf37dc344ab1.png" srcset="https://secure.gravatar.com/avatar/90172a87012b38947acedf37dc344ab1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zack Stinnett</span>
	                <span class="date">January 17, 2018 at 9:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have been working on this and I added the accuracy metric to compile and the results were really low. Is the accuracy supposed to be low?</p>
<p>model.compile(loss=’mae’, optimizer=’adam’,metrics=[‘accuracy’])</p>
<p>Epoch 50/50<br>
1s – loss: 0.0143 – acc: 0.0761 – val_loss: 0.0141 – val_acc: 0.0393</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426710" onclick="return addComment.moveForm( &quot;comment-426710&quot;, &quot;426710&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Zack Stinnett">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426732" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-426732" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 17, 2018 at 10:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426732" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You cannot measure accuracy for regression.</p>
<p>Learn more here:<br>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426732" onclick="return addComment.moveForm( &quot;comment-426732&quot;, &quot;426732&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426761" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-426761" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/10a31f375480c14f661b7be19a806da2.png" srcset="https://secure.gravatar.com/avatar/10a31f375480c14f661b7be19a806da2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">January 18, 2018 at 12:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426761" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thank you for your article. I have a question about the encoding part right after the normalization. Why are you doing that since we don’t have classes as data are time series ?<br>
Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426761" onclick="return addComment.moveForm( &quot;comment-426761&quot;, &quot;426761&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426802" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-426802" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 18, 2018 at 10:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426802" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow John, what do you mean encoding?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426802" onclick="return addComment.moveForm( &quot;comment-426802&quot;, &quot;426802&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426904" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-426904" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb05e181ca9874c93fa5812b5f270959.png" srcset="https://secure.gravatar.com/avatar/eb05e181ca9874c93fa5812b5f270959?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sacha Jacob</span>
	                <span class="date">January 19, 2018 at 9:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426904" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,<br>
Thank you very much for this tutorial, it helped me a lot<br>
I have one question: how should we model our LSTM to produce predictions for the next N days instead of just the current hour?<br>
It makes more sense to produce a larger prediction windows for other applications such as sales forecast or weather forecast </p>
<p>Regards.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426904" onclick="return addComment.moveForm( &quot;comment-426904&quot;, &quot;426904&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sacha Jacob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426974" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-426974" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 20, 2018 at 8:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-426974" onclick="return addComment.moveForm( &quot;comment-426974&quot;, &quot;426974&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427030" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-427030" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/664f97f134906e1ea96eab4400dbeda2.png" srcset="https://secure.gravatar.com/avatar/664f97f134906e1ea96eab4400dbeda2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arpita</span>
	                <span class="date">January 21, 2018 at 2:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427030" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Your explanation is awesome and most helpful. My problem has multiple variables (5 input variables) of previous 24 time steps as an input,where n_in=24*5=120 and  the output (forecast) only one variable with next 24 time step, where n_out=24*1=24. How can I solve this problem. Please help me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427030" onclick="return addComment.moveForm( &quot;comment-427030&quot;, &quot;427030&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Arpita">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-427061" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-427061" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/10a31f375480c14f661b7be19a806da2.png" srcset="https://secure.gravatar.com/avatar/10a31f375480c14f661b7be19a806da2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">January 21, 2018 at 10:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427061" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason. I am working on a project where i try to predict the evolution of a stock index. I used your function series_to_supervised to have one feature (which is obtained by offseting the stock index by one step). I trained my model on the data i have until. Then i tried to predict tomorrow index by using the model. Then i trained the model on the previous data plus the new information predicted for tomorrow in order to have a model that will be used to predict the stock index of day 2. But the problem is, besides it takes a lot of time, the result isn’t good. Do you have any idea how i can improve my algorithm ? Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427061" onclick="return addComment.moveForm( &quot;comment-427061&quot;, &quot;427061&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427084" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-427084" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 22, 2018 at 4:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427084" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try an MLP instead? LSTMs are generally poor at autoregression type problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427084" onclick="return addComment.moveForm( &quot;comment-427084&quot;, &quot;427084&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427151" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-427151" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5f09c68b7652ff38f87f323b97630488.png" srcset="https://secure.gravatar.com/avatar/5f09c68b7652ff38f87f323b97630488?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dan</span>
	                <span class="date">January 22, 2018 at 7:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427151" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, when you refer to LSTMs being generally poor at autoregression type problems, would you be able to elaborate a little? The reason is I am confused by some literature which mentions that LSTM’s as being superior to ARIMA models for certain time series applications, and I thought ARIMA was an autoregressive type model. Perhaps I am misunderstanding something. Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427151" onclick="return addComment.moveForm( &quot;comment-427151&quot;, &quot;427151&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427240" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-427240" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 23, 2018 at 7:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427240" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What literature have you seen Dan? I’d love to see. Any links?</p>
<p>I see MLPs or ARIMA outperform LSTM on pretty much every time series problem I try.</p>
<p>Also see this post with some refs on why LSTMs are poor at autoregression:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427240" onclick="return addComment.moveForm( &quot;comment-427240&quot;, &quot;427240&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427176" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-427176" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4e4e50b521dad92e0c231a7a12746c47.png" srcset="https://secure.gravatar.com/avatar/4e4e50b521dad92e0c231a7a12746c47?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bartek</span>
	                <span class="date">January 22, 2018 at 11:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>How to add in your code the forecast for “date”. Let’s suppose that now we have test RMSE for ***next value*** – how to print something like that: The dust for 1/22/2018 will be around 9.16, and add forecast for longer times period like one month, one year.</p>
<p>Bartek</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427176" onclick="return addComment.moveForm( &quot;comment-427176&quot;, &quot;427176&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bartek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427243" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-427243" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 23, 2018 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427243" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post explains how to make predictions in more detail:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427243" onclick="return addComment.moveForm( &quot;comment-427243&quot;, &quot;427243&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427302" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-427302" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ac4c69e103afed2ecdc657254e3dc2a7.png" srcset="https://secure.gravatar.com/avatar/ac4c69e103afed2ecdc657254e3dc2a7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sergio</span>
	                <span class="date">January 23, 2018 at 1:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427302" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much.<br>
I have a question about this concept.<br>
And then this LSTM get one formula and put the test_X on that formula<br>
and compare between prediction by test_X and test_y?</p>
<p>If that operate like that, where can we see that formula?</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427302" onclick="return addComment.moveForm( &quot;comment-427302&quot;, &quot;427302&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sergio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427419" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-427419" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 24, 2018 at 9:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427419" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There is no over arching formula. There is an opaque model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427419" onclick="return addComment.moveForm( &quot;comment-427419&quot;, &quot;427419&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427548" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-427548" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/10a31f375480c14f661b7be19a806da2.png" srcset="https://secure.gravatar.com/avatar/10a31f375480c14f661b7be19a806da2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michel</span>
	                <span class="date">January 25, 2018 at 7:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427548" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!<br>
Thank you for your post!<br>
How would you do to predict future values ? As you don’t have future values of your features, how will you manage to have futures y_hat ? Does it mean that you will do yours predictions step by step and use y_hat of day to be the feature that will be used for day 2….etc ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427548" onclick="return addComment.moveForm( &quot;comment-427548&quot;, &quot;427548&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Michel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427559" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-427559" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 25, 2018 at 9:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427559" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>model.predict(…)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427559" onclick="return addComment.moveForm( &quot;comment-427559&quot;, &quot;427559&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427563" class="comment even depth-3 parent">

	      	<div id="li-comment-427563" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/10a31f375480c14f661b7be19a806da2.png" srcset="https://secure.gravatar.com/avatar/10a31f375480c14f661b7be19a806da2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michel</span>
	                <span class="date">January 25, 2018 at 10:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427563" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do i need to train again the model with including the future value predicted in order to predict the ones after ? Or do we keep the same model ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427563" onclick="return addComment.moveForm( &quot;comment-427563&quot;, &quot;427563&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Michel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427605" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-427605" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 26, 2018 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427605" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can try both approaches and see which results in the most accurate predictions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427605" onclick="return addComment.moveForm( &quot;comment-427605&quot;, &quot;427605&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427630" class="comment even depth-5">

	      	<div id="li-comment-427630" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/10a31f375480c14f661b7be19a806da2.png" srcset="https://secure.gravatar.com/avatar/10a31f375480c14f661b7be19a806da2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michel</span>
	                <span class="date">January 26, 2018 at 9:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427630" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I tried both of them. Both of them gave very bad results. Do you have an idea to improve it ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-427686" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-427686" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 27, 2018 at 5:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427686" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I have a few ideas:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427817" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-427817" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5f596b8dfda358e48e21ee00ea8156c9.png" srcset="https://secure.gravatar.com/avatar/5f596b8dfda358e48e21ee00ea8156c9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://zvexx.com/" rel="external nofollow" class="url">Hugues Laliberte</a></span>
	                <span class="date">January 29, 2018 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427817" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>thanks for sharing all this knowledge, much appreciated.</p>
<p>I managed to run my model and i have a few observations/questions. My data is composed of 20’000 minutes of 10 inputs and 1 feature. My test data is the next 8’000 minutes. My objective is to forecast the next minute feature. So far i have used only the last minute data to train.</p>
<p>– On the first run, i let the model used the feature as an input and i got excellent results. But in reality i do not have that feature available, at least not in the last hour or two.</p>
<p>– So i removed the feature from the input (by removing it using the reframed.drop command) and then the results got pretty poor. I could not calculate the RMSE though as i got the error (operands could not be broadcast together with shapes (8098,9) (10,) (8098,9)), on instruction inv_yhat = scaler.inverse_transform(inv_yhat). Any idea how i can go around that ?</p>
<p>– So to improve on this i will use the code in the second part of your tutorial above to use more than 1 minute step as inputs, ideally 15, 30 or 60 minutes if possible/not too slow to train.</p>
<p>– In the discussions above, you often mention that MLP should give better results than LSTM for time series, at least they should be tried first. You gave the link where this is discussed, but have you made a tutorial on how to set-up a model with MLP ? Or is it part of your book ? I would like to try.</p>
<p>thanks for all your help,</p>
<p>Hugues</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427817" onclick="return addComment.moveForm( &quot;comment-427817&quot;, &quot;427817&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hugues Laliberte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427818" class="comment odd alt depth-2">

	      	<div id="li-comment-427818" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5f596b8dfda358e48e21ee00ea8156c9.png" srcset="https://secure.gravatar.com/avatar/5f596b8dfda358e48e21ee00ea8156c9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hugues Laliberte</span>
	                <span class="date">January 29, 2018 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427818" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry, above i wrongly used “feature” , i wanted to say output or target.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427818" onclick="return addComment.moveForm( &quot;comment-427818&quot;, &quot;427818&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hugues Laliberte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-427832" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-427832" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 29, 2018 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427832" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help you prepare the data so you can try an MLP:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<p>I hope to write a book on this topic soon to address all of these questions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427832" onclick="return addComment.moveForm( &quot;comment-427832&quot;, &quot;427832&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427857" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-427857" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5f596b8dfda358e48e21ee00ea8156c9.png" srcset="https://secure.gravatar.com/avatar/5f596b8dfda358e48e21ee00ea8156c9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://zvexx.com/" rel="external nofollow" class="url">Hugues Laliberte</a></span>
	                <span class="date">January 29, 2018 at 5:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427857" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks Jason,<br>
after googling MLP for time series, i bumped into this article of yours: <a href="https://machinelearningmastery.com/exploratory-configuration-multilayer-perceptron-network-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/exploratory-configuration-multilayer-perceptron-network-time-series-forecasting/</a><br>
Can i follow this to build an MLP network for my time series ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427857" onclick="return addComment.moveForm( &quot;comment-427857&quot;, &quot;427857&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hugues Laliberte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427909" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-427909" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2018 at 9:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427909" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could use it as a starting point.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427909" onclick="return addComment.moveForm( &quot;comment-427909&quot;, &quot;427909&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427885" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-427885" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5856d719c4edcaa6e887849304f7ebd3.png" srcset="https://secure.gravatar.com/avatar/5856d719c4edcaa6e887849304f7ebd3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sayan</span>
	                <span class="date">January 30, 2018 at 7:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427885" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
I’m running the code: </p>
<p>however there is an error in model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))</p>
<p>the error is Expected int32, got  of type ‘Variable’ instead.</p>
<p>How I can resolve it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427885" onclick="return addComment.moveForm( &quot;comment-427885&quot;, &quot;427885&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to sayan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427928" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-427928" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2018 at 9:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427928" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, I have not seen this error.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427928" onclick="return addComment.moveForm( &quot;comment-427928&quot;, &quot;427928&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427951" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-427951" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b2ccf588b29b2411465b6bd6bfc36d6a.png" srcset="https://secure.gravatar.com/avatar/b2ccf588b29b2411465b6bd6bfc36d6a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Matt C</span>
	                <span class="date">January 30, 2018 at 4:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427951" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Jason,    </p>
<p>    Hello, I was wondering why you ignore the first column of X_test here in this line: </p>
<p>inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)</p>
<p>where you look at “test_X[:, 1:]”. Aren’t you losing one of the weather condition features? If not, then what is that column? </p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-427951" onclick="return addComment.moveForm( &quot;comment-427951&quot;, &quot;427951&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Matt C">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428008" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-428008" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 31, 2018 at 9:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428008" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why do you think that? Perhaps inspect the test_X to confirm what is going on.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428008" onclick="return addComment.moveForm( &quot;comment-428008&quot;, &quot;428008&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428042" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-428042" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2a4d9115892e9fcfc064ddc8b88b363b.png" srcset="https://secure.gravatar.com/avatar/2a4d9115892e9fcfc064ddc8b88b363b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sushrut</span>
	                <span class="date">January 31, 2018 at 6:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428042" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I have specific business problems and want to implement LSTM for the same. </p>
<p>1.Sales forecast with effect of promotion: Actual sales has trend and seasonality AND which is effected by promotions. I want to capture both the time series pattern AND promotion effectiveness on sales to get a final sales forecast.</p>
<p>2.Order forecast : My partner places orders on the company, which has its own pattern ALSO it is effected by the Inventory levels and the sales of a particular week.</p>
<p>Kindly advise on how to use LSTM for both the cases, since both have their own time series pattern (auto correlated) AND effected by other variables.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428042" onclick="return addComment.moveForm( &quot;comment-428042&quot;, &quot;428042&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to sushrut">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428083" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-428083" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2018 at 7:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428083" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend getting a handle on time series forecasting first:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428083" onclick="return addComment.moveForm( &quot;comment-428083&quot;, &quot;428083&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428137" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-428137" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2a4d9115892e9fcfc064ddc8b88b363b.png" srcset="https://secure.gravatar.com/avatar/2a4d9115892e9fcfc064ddc8b88b363b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sushrut</span>
	                <span class="date">February 1, 2018 at 10:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428137" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>thanks for the reply. Dont you think only time series models wont help in my case, since i need to not only get the pattern of order forecast but also how inventory is effecting the order pattern.</p>
<p>Kindly advise.<br>
Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428137" onclick="return addComment.moveForm( &quot;comment-428137&quot;, &quot;428137&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to sushrut">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428182" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-428182" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 2, 2018 at 8:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428182" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try a few methods and see what works best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428182" onclick="return addComment.moveForm( &quot;comment-428182&quot;, &quot;428182&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428066" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-428066" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6f7ddac857705d203806f215fe97d88a.png" srcset="https://secure.gravatar.com/avatar/6f7ddac857705d203806f215fe97d88a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neumaier C</span>
	                <span class="date">February 1, 2018 at 2:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428066" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Jason,</p>
<p>your post here helped me a lot to get my LSTM model working.</p>
<p>I tried to create a second model, also using a multivariate time series, but this time i did not want to predict a single value from the data, I wanted to predict the data for the next timestep.</p>
<p>Assuming we have the data: [1.0, 0.2, 0.3], [0.9, 0.3, 0.1], [0.7, 0.1, 0.5]<br>
I want to predict the whole term, not a single value. So for example  [0.9, 0.3, 0.1] instead of [0.9].</p>
<p>I am kind of stuck on how to modify the model settings and i can not find any good references on this.</p>
<p>Do you have any suggestions?</p>
<p>Thanks a lot</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428066" onclick="return addComment.moveForm( &quot;comment-428066&quot;, &quot;428066&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Neumaier C">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428095" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-428095" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2018 at 7:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428095" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help you prepare your data:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428095" onclick="return addComment.moveForm( &quot;comment-428095&quot;, &quot;428095&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428127" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-428127" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5edea7f605b9358b1cf28d3b05d3e8f5.png" srcset="https://secure.gravatar.com/avatar/5edea7f605b9358b1cf28d3b05d3e8f5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neumaier C</span>
	                <span class="date">February 1, 2018 at 7:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428127" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot for the answer. </p>
<p>But does changing the input_shape have any effect on the output? </p>
<p>That’s the point I am struggling with. I am trying to understand or go find a way to tell the network how many values it should predict. Shouldn‘t I change the shape of the train_Y data?</p>
<p>I already prepared the data according to my plans: 8 features, 10 rumratend. For both train_X and train_Y. But when I try to fit the model, I am getting an input_dim error (expected shape (None, 10), so 10 single values rather than 10 series of data-vectors. </p>
<p>Thanks and best regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428127" onclick="return addComment.moveForm( &quot;comment-428127&quot;, &quot;428127&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Neumaier C">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428176" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-428176" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 2, 2018 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you want to predict multiple output variables, you will need to shape your y variable accordingly.</p>
<p>Maybe this post will help:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428176" onclick="return addComment.moveForm( &quot;comment-428176&quot;, &quot;428176&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428075" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-428075" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5f596b8dfda358e48e21ee00ea8156c9.png" srcset="https://secure.gravatar.com/avatar/5f596b8dfda358e48e21ee00ea8156c9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hugues Laliberte</span>
	                <span class="date">February 1, 2018 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428075" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello again Jason,</p>
<p>i’m making good progress,</p>
<p>i’m trying your multiple lags timesteps code above,</p>
<p>the results are pretty good, but again, my output is fed as an input, which is not realistic for me. In the single step code, i managed to change your code to remove my output from my input (by playing on the reframed.drop line.</p>
<p>But in the multiple lags timesteps, you do not show this reframed.drop line. I tried to add it, but for some reason it does not change my inputs, so my output is still in. Any idea how I can remove my output from my inputs in this scenario ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428075" onclick="return addComment.moveForm( &quot;comment-428075&quot;, &quot;428075&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hugues Laliberte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428076" class="comment even depth-2">

	      	<div id="li-comment-428076" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5f596b8dfda358e48e21ee00ea8156c9.png" srcset="https://secure.gravatar.com/avatar/5f596b8dfda358e48e21ee00ea8156c9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hugues Laliberte</span>
	                <span class="date">February 1, 2018 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428076" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>forgot to mention above, i reduce the n_features parameter but it did not change my input data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428076" onclick="return addComment.moveForm( &quot;comment-428076&quot;, &quot;428076&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hugues Laliberte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428120" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-428120" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb7b7df095cf03dfc370c8382c24f909.png" srcset="https://secure.gravatar.com/avatar/eb7b7df095cf03dfc370c8382c24f909?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">simon</span>
	                <span class="date">February 1, 2018 at 5:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428120" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for good examples!!!</p>
<p>I wonder the concept of this code is only to predict ‘pollution’ when we have other parameters (dew	temp, press, wnd_spd, snow,	rain) at the same time of prediction. </p>
<p>But can we predict all columns beyond 2014-12-31 23:00:00 (the last entry of the data)?</p>
<p>Let’s say we want to predict pollution level in 2015-01-01 01:00:00 and our current time is 2014-12-31 23:00:00. Since we don’t have any data about dewtemp, press, wnd_spd, snow, rain for the time 2015-01-01 01:00:00, how can we predict pollution level in 2015-01-01 01:00:00?</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428120" onclick="return addComment.moveForm( &quot;comment-428120&quot;, &quot;428120&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to simon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428171" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-428171" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 2, 2018 at 8:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428171" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can frame the prediction model to predict tomorrow from today.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428171" onclick="return addComment.moveForm( &quot;comment-428171&quot;, &quot;428171&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428122" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-428122" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb7b7df095cf03dfc370c8382c24f909.png" srcset="https://secure.gravatar.com/avatar/eb7b7df095cf03dfc370c8382c24f909?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">simon</span>
	                <span class="date">February 1, 2018 at 6:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428122" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>And can we predict all column data at once?<br>
Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428122" onclick="return addComment.moveForm( &quot;comment-428122&quot;, &quot;428122&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to simon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428173" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-428173" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 2, 2018 at 8:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428173" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428173" onclick="return addComment.moveForm( &quot;comment-428173&quot;, &quot;428173&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428466" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-428466" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b41381764c60a3e25f1f2da88e67016f.png" srcset="https://secure.gravatar.com/avatar/b41381764c60a3e25f1f2da88e67016f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shivam</span>
	                <span class="date">February 5, 2018 at 8:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428466" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, I know this is completely off-topic but would it be possible to code this in R?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428466" onclick="return addComment.moveForm( &quot;comment-428466&quot;, &quot;428466&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Shivam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428548" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-428548" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 6, 2018 at 9:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428548" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428548" onclick="return addComment.moveForm( &quot;comment-428548&quot;, &quot;428548&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428698" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-428698" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/699a109d1ea95e8e741c257b304984ed.png" srcset="https://secure.gravatar.com/avatar/699a109d1ea95e8e741c257b304984ed?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Patrik</span>
	                <span class="date">February 7, 2018 at 10:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428698" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello and thank you for all the information on the site.<br>
I may be confused here, but it seems to me that all the examples given throughout various posts deal with predicting the future based on historical data (e.g. predicting pollution for tomorrow based on observations from today, yesterday, etc.). Am I correct in assuming that this is what you refer to as “auto-regression problem”?<br>
The scenario I would like to solve is a bit different: I want to predict the future based on predicted observations for the future (e.g. predicting pollution for tomorrow based on predicted temperature, dew, etc. for tomorrow (perhaps in addition to real, measured data from today, yesterday, etc.)). Is this a completely different problem category, or is it just a variation on the examples you have provided? Are LSTMs the right tool for this kind of problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428698" onclick="return addComment.moveForm( &quot;comment-428698&quot;, &quot;428698&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Patrik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428745" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-428745" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 8, 2018 at 8:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428745" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Autoregression means that output is a function of observations at prior time steps.</p>
<p>Making predictions from predictions can become very unstable. It is called a recursive model in this post:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428745" onclick="return addComment.moveForm( &quot;comment-428745&quot;, &quot;428745&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428795" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-428795" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/699a109d1ea95e8e741c257b304984ed.png" srcset="https://secure.gravatar.com/avatar/699a109d1ea95e8e741c257b304984ed?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Patrik</span>
	                <span class="date">February 8, 2018 at 6:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428795" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you, but this is not quite what I had in mind. Recursive model predicts the future and then uses those predictions to predict even further, and like you say, this can become unstable.<br>
The situation I am talking about is this:<br>
– we have historical observations for certain variables, including the target variable<br>
– we have future predictions about the same variables (except the target variable)<br>
– we want to predict the target variable based on the available predictions of other variables (let’s say we get predictions of temperature, dew, etc. from a meteorogical service)<br>
In the pollution scenario, this would mean that we want to find the correlation between the temperature, pressure, etc. and pollution (and this correlation can exist between lagged inputs and current pollution, but also between current-time inputs and current pollution).<br>
When the net learns this correlation, we will feed it information about temperature, pressure, etc. “from the future” and expect the pollution at said future date.<br>
But in the given example, it seems to me that the net only searches for the correlation between current pollution (at time t) and historical observations of certain variables (temp, dew, ..) Or am I missing something? Because the “present-day” observations are dropped from the training array, so the net can’t learn this correlation at time t.<br>
So I guess what I’m really asking is, whether LSTMs are only suitable for predicting the future based on historical (and only historical) observations, or can they also use input at time t to predict for time t?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428795" onclick="return addComment.moveForm( &quot;comment-428795&quot;, &quot;428795&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Patrik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428838" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-428838" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 9, 2018 at 9:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428838" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are no rules. Suitability is to hard to comment on. To check if the method is appropriate for your data, try it.</p>
<p>What is the best framing for your specific data? No one can say. I’d recommend brainstorming 5-10 framings, test each and see what works best for your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428838" onclick="return addComment.moveForm( &quot;comment-428838&quot;, &quot;428838&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428824" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-428824" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/eb734e9bdc234e33c3644d65a53230f5.png" srcset="https://secure.gravatar.com/avatar/eb734e9bdc234e33c3644d65a53230f5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luca</span>
	                <span class="date">February 9, 2018 at 4:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428824" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>thanks for your post, it was really interesting and helpful!<br>
I was wondering, why does scaling the values into the range (0,1) affect the accuracy of the prediction? Is it a common practice in time series forecasting?<br>
In fact, I tried to repeat the experiment without scaling, and I got an RMSE of 100.35. Also, the loss functions were much less steep. Could you please help me understand why this happens?</p>
<p>Thank you in advance,<br>
Luca</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428824" onclick="return addComment.moveForm( &quot;comment-428824&quot;, &quot;428824&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Luca">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428853" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-428853" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 9, 2018 at 9:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a good practice for neural networks, although is not always required.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428853" onclick="return addComment.moveForm( &quot;comment-428853&quot;, &quot;428853&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428825" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-428825" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/71c8deefc071cd6f4dc9950a9c5dc82b.png" srcset="https://secure.gravatar.com/avatar/71c8deefc071cd6f4dc9950a9c5dc82b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adam</span>
	                <span class="date">February 9, 2018 at 4:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428825" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Quick one from me — I’m finding that my model doesn’t converge, and is pretty spiky.   See loss graph here: </p>
<p><a href="https://drive.google.com/file/d/1fLmgtP_YgBH67GWI9Is_nb8tihQd_vMj/view" rel="nofollow">https://drive.google.com/file/d/1fLmgtP_YgBH67GWI9Is_nb8tihQd_vMj/view</a></p>
<p>Gonna play around with learning rate, drop-off and regularization — but had a feeling folks might have seen a graph that looks exactly like this before.</p>
<p>Welcome any thoughts!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428825" onclick="return addComment.moveForm( &quot;comment-428825&quot;, &quot;428825&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Adam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428854" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-428854" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 9, 2018 at 9:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428854" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Might also try a larger network.</p>
<p>This post might help:<br>
<a href="https://machinelearningmastery.com/diagnose-overfitting-underfitting-lstm-models/" rel="nofollow">https://machinelearningmastery.com/diagnose-overfitting-underfitting-lstm-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428854" onclick="return addComment.moveForm( &quot;comment-428854&quot;, &quot;428854&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428856" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-428856" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/71c8deefc071cd6f4dc9950a9c5dc82b.png" srcset="https://secure.gravatar.com/avatar/71c8deefc071cd6f4dc9950a9c5dc82b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adam</span>
	                <span class="date">February 9, 2018 at 10:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks — I’ll give it a go.  Both neurons and layers?</p>
<p>The interesting thing I’m finding is that because of the spikes in test performance I can just get one run that’s pretty good, and the next one is terrible (with the same input).  I realize I can fix seed, but I’m more worried about the results in “production”.</p>
<p>Is it normal to do something like fitting for a few cycles, and forecasting each time and averaging the results?  Or should I be trying to solve the “spiky-ness” problem directly?</p>
<p>FYI: so far a dropout, and and a decaying learning rate have helped a bit … regularizaton might, but it’s just then taking too damn long to get to an answer <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>
<p>Thanks for an awesome resource.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428856" onclick="return addComment.moveForm( &quot;comment-428856&quot;, &quot;428856&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Adam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428953" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-428953" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 10, 2018 at 8:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428953" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yeah, this is common.</p>
<p>You could search for a config that is more stable. You could also try and iron out the forecast skill by creating n models and making predictions with an ensemble of all of them.</p>
<p>I have notes here on how to control for the stochastic natural of the method:<br>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<p>And more general notes here:<br>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428953" onclick="return addComment.moveForm( &quot;comment-428953&quot;, &quot;428953&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428984" class="comment odd alt depth-5">

	      	<div id="li-comment-428984" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/71c8deefc071cd6f4dc9950a9c5dc82b.png" srcset="https://secure.gravatar.com/avatar/71c8deefc071cd6f4dc9950a9c5dc82b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adam</span>
	                <span class="date">February 10, 2018 at 11:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-428984" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perfect — giving that a whirl and seems to be doing ok! many thanks.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-429044" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-429044" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 11, 2018 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429044" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429092" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-429092" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ba587052add6f256834112f7eee27159.png" srcset="https://secure.gravatar.com/avatar/ba587052add6f256834112f7eee27159?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tanya</span>
	                <span class="date">February 11, 2018 at 10:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429092" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,<br>
thanks for the great post.<br>
I am a pretty new in machine learning, but I have to see how to predict the pollution for the next hour as above and given the “expected” weather conditions for the next hour. Can you help me with the code or how to change the current one in order to get such a prediction?</p>
<p>Thank you very much in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429092" onclick="return addComment.moveForm( &quot;comment-429092&quot;, &quot;429092&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tanya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429134" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-429134" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 12, 2018 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429134" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe you have everything you need to make this change.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429134" onclick="return addComment.moveForm( &quot;comment-429134&quot;, &quot;429134&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429732" class="comment odd alt depth-3">

	      	<div id="li-comment-429732" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ba587052add6f256834112f7eee27159.png" srcset="https://secure.gravatar.com/avatar/ba587052add6f256834112f7eee27159?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tanya</span>
	                <span class="date">February 17, 2018 at 2:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429732" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, thanks to answering. Unfortunately I have tried already and I did not get it working. That is why I’ve text you. Some hint or code will help me really very much. As I said, I am a pretty new in python and machine learning…..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429732" onclick="return addComment.moveForm( &quot;comment-429732&quot;, &quot;429732&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tanya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429100" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-429100" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f0788916a9fa130b449673180dc9fa6.png" srcset="https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shamsul</span>
	                <span class="date">February 12, 2018 at 3:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429100" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p># design network<br>
model = Sequential()<br>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
model.add(Dense(1))<br>
model.compile(loss=’mae’, optimizer=’adam’)</p>
<p>SIR,</p>
<p>WHAT IS DENSE? HOW WILL IT BE VARIED?  IS IT RELATED TO THE NUMBER OF DATA POINTS WE WOULD LIKE TO PREDICT IN SINGLE FORECAST?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429100" onclick="return addComment.moveForm( &quot;comment-429100&quot;, &quot;429100&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to shamsul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429136" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-429136" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 12, 2018 at 8:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429136" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dense just means a fully connected layer, the parameter is the number of neurons in that layer.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429136" onclick="return addComment.moveForm( &quot;comment-429136&quot;, &quot;429136&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429316" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-429316" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9112b854b76e04315e1bc30eac635bf7.png" srcset="https://secure.gravatar.com/avatar/9112b854b76e04315e1bc30eac635bf7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">rbk</span>
	                <span class="date">February 13, 2018 at 5:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429316" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you have a recommendation for situations where we soon by have the target data available when using the NN? In this example, you may have a dataset that has monitored pollution but you cannot measure that on an ongoing basis and let:s suppose, for the sake of argument, that it cannot be easily calculated using ng an equation either.. Therefore, perhaps the LSTM needs to have its own calculated pollution fed back, in addition to easier measurements like wind and rain, in order to make a prediction about pollution at the next step. Suggestions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429316" onclick="return addComment.moveForm( &quot;comment-429316&quot;, &quot;429316&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to rbk">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429380" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-429380" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 14, 2018 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429380" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend exploring multiple different framings of your problem, evaluate them and see what works best for your specific data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429380" onclick="return addComment.moveForm( &quot;comment-429380&quot;, &quot;429380&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429400" class="comment even depth-3 parent">

	      	<div id="li-comment-429400" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9112b854b76e04315e1bc30eac635bf7.png" srcset="https://secure.gravatar.com/avatar/9112b854b76e04315e1bc30eac635bf7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">rbk</span>
	                <span class="date">February 14, 2018 at 10:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429400" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Fair enough. It seems like you are suggesting that other NN formulations are more appropriate for such a problem. I think i agree.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429400" onclick="return addComment.moveForm( &quot;comment-429400&quot;, &quot;429400&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to rbk">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429433" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-429433" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 14, 2018 at 2:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429433" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In my experience MLPs perform better for autoregression type forecasting.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429433" onclick="return addComment.moveForm( &quot;comment-429433&quot;, &quot;429433&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429342" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-429342" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/fd3cdefe9759181f2d83140893928bac.png" srcset="https://secure.gravatar.com/avatar/fd3cdefe9759181f2d83140893928bac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Erik</span>
	                <span class="date">February 13, 2018 at 9:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429342" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, thank you for your guide.</p>
<p>I have a general question regarding training (and predicting) on multiple time-series. I understand that the answer might be “it depends”, but I hope you can give some insight (or point me in the right direction).</p>
<p>I have N time series of variable length Mi, each sample in each time series having the same dimension D. My goal is to have the network train on some fraction of these N series and then predict on the remaining series. That is, unlike your tutorials, I am not interested in training a fraction of ONE time series and predict the rest of the same series.</p>
<p>Currently, I pad each time series so they are all equal length and create a matrix of shape (N*M’ x D) where M’ is the length of the longest time series. I split the matrix into two smaller matrices (train/test) and during training I feed the RNN network with (1 x D) samples in batches of some batch size B.</p>
<p>That is, in my sequential keras-model, my first layer (SimpleRNN) has input_shape=(1, D) and since I am trying to predict the following F steps my Dense output layer is a Dense(F) layer.</p>
<p>This works (at least, I get a result) but I am wondering if there is a better way to do it. Is it possible (and if so, better) to feed the network with samples of shape (Mi x D) (i.e. one time-series a the time)? Are there any “general rules” to follow when it comes to these sorts of things (if so, where can I read up on them)? </p>
<p>Thank you for a very interesting blog.<br>
Cheers</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429342" onclick="return addComment.moveForm( &quot;comment-429342&quot;, &quot;429342&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Erik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429387" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-429387" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 14, 2018 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429387" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend brainstorming multiple framings of the problem and evaluate each to see what works best for your specific data.</p>
<p>Also, consider starting with MLPs and only move to LSTMs or RNNs generally if they offer better results (often they don’t).</p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429387" onclick="return addComment.moveForm( &quot;comment-429387&quot;, &quot;429387&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429733" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-429733" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ba587052add6f256834112f7eee27159.png" srcset="https://secure.gravatar.com/avatar/ba587052add6f256834112f7eee27159?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TaZa</span>
	                <span class="date">February 17, 2018 at 2:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429733" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,</p>
<p>can I make out-of-sample forecast using LSTM network. Can you help and give me a hint how to do this in python. </p>
<p>Thank you very much in advance!<br>
TZ</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429733" onclick="return addComment.moveForm( &quot;comment-429733&quot;, &quot;429733&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to TaZa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429760" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-429760" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 17, 2018 at 8:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429760" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I show exactly how in the tutorial above.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429760" onclick="return addComment.moveForm( &quot;comment-429760&quot;, &quot;429760&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429778" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-429778" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/587b244c9af0ff71854d0055d841e892.png" srcset="https://secure.gravatar.com/avatar/587b244c9af0ff71854d0055d841e892?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zou Yanyun</span>
	                <span class="date">February 17, 2018 at 2:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, thanks for your tutorial. It helps me a lot. And I’m wondering if there is only one hidden layer in this neural network. And how to determine the number of neurons?<br>
Thank you very much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429778" onclick="return addComment.moveForm( &quot;comment-429778&quot;, &quot;429778&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Zou Yanyun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429808" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-429808" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 18, 2018 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429808" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Trial and error is the best way to configure the number of layers and neurons. There are no reliable analytical methods to configure neural nets as far as I know.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-429808" onclick="return addComment.moveForm( &quot;comment-429808&quot;, &quot;429808&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430450" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-430450" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d09436caf450b842b1d53a84ff90ae51.jpeg" srcset="https://secure.gravatar.com/avatar/d09436caf450b842b1d53a84ff90ae51?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Haylee Ham</span>
	                <span class="date">February 25, 2018 at 7:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430450" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, your website has been such any amazing resource for me. I have had trouble in my searches on Google scholar and elsewhere in finding the appropriate way to construct a NN for panel data and any tips would be greatly appreciated.</p>
<p>How would the data preparation/model change here if you were using a panel data set? In that case, the date would not be unique and so I assume should not be used as a index.</p>
<p>Also, how do you create the LSTM in such a way that it will produce predictions for all locations at time period t?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430450" onclick="return addComment.moveForm( &quot;comment-430450&quot;, &quot;430450&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Haylee Ham">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430463" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-430463" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 25, 2018 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430463" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not worked with panel data. I don’t have good off the cuff advice.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430463" onclick="return addComment.moveForm( &quot;comment-430463&quot;, &quot;430463&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430561" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-430561" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cea1c6d706a5255d6f25fd5d56b878e3.png" srcset="https://secure.gravatar.com/avatar/cea1c6d706a5255d6f25fd5d56b878e3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Torky</span>
	                <span class="date">February 26, 2018 at 11:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430561" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, I have read your work and it has been great advice for me. I have tried to implement it on time series (dynamic) analysis of buildings due to ground motion. Could you kindly consider the following:<br>
I have the input as the ground acceleration X(t) and target as the motion of the first floor Y(t). I would like to train the network on LSTM, or any other RNN that would be suitable. However, researchers have published ideas that make use of other RNNs and Wavenet, yet they do not share their codes.<br>
Could you kindly have a look at my work and inform me if there are better techniques to work with? Do you have any idea on how to use Wavelet Neural Networks?<br>
Thank you for considering it.<br>
Work found here: <a href="https://www.dropbox.com/sh/lqt97olutq9uca2/AAB1aCWlfFtP3BRJcGjjqwXUa?dl=0" rel="nofollow">https://www.dropbox.com/sh/lqt97olutq9uca2/AAB1aCWlfFtP3BRJcGjjqwXUa?dl=0</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430561" onclick="return addComment.moveForm( &quot;comment-430561&quot;, &quot;430561&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ahmed Torky">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430596" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-430596" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I am not familiar with that paper, perhaps contact the authors of the paper?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430596" onclick="return addComment.moveForm( &quot;comment-430596&quot;, &quot;430596&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430608" class="comment even depth-3 parent">

	      	<div id="li-comment-430608" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cea1c6d706a5255d6f25fd5d56b878e3.png" srcset="https://secure.gravatar.com/avatar/cea1c6d706a5255d6f25fd5d56b878e3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Torky</span>
	                <span class="date">February 27, 2018 at 6:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430608" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your reply. What do you think of having both the predictor and target variables in time, would you use LSTM, or would ConvLSTM2D be better? I am not entirely confident in LSTM, and have read that applications like DeepMind have had better results with Wavenet. I am looking forward to you sharing your ideas because I trust your opinion.<br>
Thank you.<br>
Ahmed</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430608" onclick="return addComment.moveForm( &quot;comment-430608&quot;, &quot;430608&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ahmed Torky">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430624" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-430624" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2018 at 2:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430624" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A good place to start would be an MLP. I’d only recommend moving to an LSTM if you can lift model skill.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430624" onclick="return addComment.moveForm( &quot;comment-430624&quot;, &quot;430624&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430581" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-430581" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/76576acd9112a091dbb82020e99e4d04.png" srcset="https://secure.gravatar.com/avatar/76576acd9112a091dbb82020e99e4d04?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bosco Raju</span>
	                <span class="date">February 27, 2018 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430581" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the great resource. I have a question.</p>
<p>Shouldn’t you apply MinMaxScaler normalisation after splitting the dataset into train/test? If you apply MinMaxScaler normalisation before splitting the dataset, the LSTM model will have sufficient information about the test sample during training? Therefore, it is not a true “test” sample. Or does it only apply for standardisation (z-score)? Could you please clarify on this matter? Thanks.</p>
<p>Bosco</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430581" onclick="return addComment.moveForm( &quot;comment-430581&quot;, &quot;430581&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bosco Raju">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430606" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-430606" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, correct. I was trying yo keep things simple for the tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430606" onclick="return addComment.moveForm( &quot;comment-430606&quot;, &quot;430606&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430611" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-430611" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f6472de13f74a4628ea9460cdac63859.png" srcset="https://secure.gravatar.com/avatar/f6472de13f74a4628ea9460cdac63859?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">William</span>
	                <span class="date">February 27, 2018 at 9:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430611" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason </p>
<p>Thank you for this tutorial.  I am new to RNN and this has helped me a lot.  Is it possible to train a LSTM model to do forecasting using multiple multivariate time series?</p>
<p>I am currently working with a dataset that has N individuals and each individual has a time series that has 3 features and 16 samples (the time series are all of equal length, have the same time step and contain no missing values).  What I would like to do is to train LSTM with the 3 feature values from t1, t2,…t15 to predict the 3 feature values at t16 for this sample population.  Would you be able to offer some advice or point me to the right direction?</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430611" onclick="return addComment.moveForm( &quot;comment-430611&quot;, &quot;430611&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to William">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430626" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-430626" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2018 at 2:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430626" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. You could predict a vector for each time step, e.g. multiple units in the output layer and a TimeDistributedDense for the time steps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430626" onclick="return addComment.moveForm( &quot;comment-430626&quot;, &quot;430626&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430945" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-430945" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/de9792ea25076aec98712d4acf4a2e86.png" srcset="https://secure.gravatar.com/avatar/de9792ea25076aec98712d4acf4a2e86?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jakob</span>
	                <span class="date">March 3, 2018 at 5:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430945" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for very interesting articles Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430945" onclick="return addComment.moveForm( &quot;comment-430945&quot;, &quot;430945&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jakob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430974" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-430974" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 3, 2018 at 8:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome, I hope they help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-430974" onclick="return addComment.moveForm( &quot;comment-430974&quot;, &quot;430974&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431347" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-431347" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cd72f36a71be3e60d3d41bed581a9cc9.png" srcset="https://secure.gravatar.com/avatar/cd72f36a71be3e60d3d41bed581a9cc9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vinyak</span>
	                <span class="date">March 6, 2018 at 5:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431347" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
I have a question about prediction in general.<br>
1. Does it matter if you predict one value ahead or multiple values? for example: would 24 x one hour ahead forecast be more accurate than 24 hours ahead forecast if we do not use lags?</p>
<p>2. If we want to predict 24 values at a time for one day ahead forecast(wind, solar) how do we do that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431347" onclick="return addComment.moveForm( &quot;comment-431347&quot;, &quot;431347&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to vinyak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431395" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-431395" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 7, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One step forecasts are more accurate if you are using real obs as input to make the forecast.</p>
<p>Forecasting a long time ahead with any model is really hard and will have a high error.</p>
<p>In general, try multiple approaches with your data/model and see what has the lowest error.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431395" onclick="return addComment.moveForm( &quot;comment-431395&quot;, &quot;431395&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431461" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-431461" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/afc856c8333249372ce6997203368854.png" srcset="https://secure.gravatar.com/avatar/afc856c8333249372ce6997203368854?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hari</span>
	                <span class="date">March 7, 2018 at 5:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431461" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for your articles. With a good combination of theory and code, it really helped me to get a kickstart in RNNs. </p>
<p>In your post, you mentioned that: “Remember that the internal state of the LSTM in Keras is reset at the end of each batch”. In addition, I would like to know if the LSTM reuses any hidden state among the instances within a batch.<br>
For example, the first instance is: 0.129779   0.352941   0.245902 .. -&gt; 0.148893. The second instance is 0.148893   0.367647   0.245902 .. -&gt; 0.159960. If both belong to the same batch, will there be any hidden state which will get transferred to instance 2 after training based on instance 1 (or vice versa). </p>
<p>What I understood is that hidden states are maintained across timesteps within an instance. But hidden states are not reused/transferred across instances.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431461" onclick="return addComment.moveForm( &quot;comment-431461&quot;, &quot;431461&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431535" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-431535" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 8, 2018 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431535" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, state is reused between instances within a batch.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431535" onclick="return addComment.moveForm( &quot;comment-431535&quot;, &quot;431535&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431487" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-431487" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1efdc6353bfd8d070845ad945c2ab2dd.png" srcset="https://secure.gravatar.com/avatar/1efdc6353bfd8d070845ad945c2ab2dd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">weiliming</span>
	                <span class="date">March 7, 2018 at 9:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431487" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I’m so sorry, it’s too hard for me to read all of these comments.<br>
My question is like this, now I have data from 80 cities, every city has 4 years of 8 input variables(pm2.5, DEWP, TEMP, PRES, cbwd, Iws, Is, Ir), I want to train a model which use all of these data from 80 cities, but only to predict in a specifed city.<br>
I read some articles like “Example of LSTM with Multiple Input Features”, or “o Convert a Time Series to a Supervised Learning Problem”.<br>
Q1:  If I train a model by input shape(8760, 80, 8), how can I use model to predict air pollution of a single city, I do not have data from other 79 cities, so I can’t input (n, 80,<br>
 8), I can only input(n, 1, 8)<br>
Q2: Convert LSTM to supervised learning may solve the problem, but I want to use time series RNN in the model, because In my dataset all features have strong time series relationship.<br>
There is so little articles about this multi-input single-output RNN instance, I wonder if LSTM cannot do it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431487" onclick="return addComment.moveForm( &quot;comment-431487&quot;, &quot;431487&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to weiliming">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431541" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-431541" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 8, 2018 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431541" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally LSTMs are poor at autoregression type forecasting problems. I would recommend MLPs first and only jump to LSTMs if they give better skill.</p>
<p>Generally, you could model each city separately or have one model for all cities. I would recommend testing both and see what works best.</p>
<p>This post will help you to better understand how to reshape input data:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431541" onclick="return addComment.moveForm( &quot;comment-431541&quot;, &quot;431541&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431514" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-431514" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/648fe4a3bc41a14a11ea37f9e15bfb06.png" srcset="https://secure.gravatar.com/avatar/648fe4a3bc41a14a11ea37f9e15bfb06?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Monty Shaw</span>
	                <span class="date">March 8, 2018 at 2:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431514" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a question about the graph. Should the test line match the train line? I understand why we plot the error for the train and for the test, but since the model is trained when computing the test data, should it not be a straight line across the bottom (assuming a well trained model)? I guess I am concerned about ‘over-fitting’, something else I am confusing about. </p>
<p>I have modified the example given above, and I am getting Test RMSE: 22.027, and my line is fairly flat across the bottom, with a better rme than the training line.</p>
<p>I changed to use 90% of the data to train with,  added another layer of lstm, changed the number or neurons to 32/16, and set the epoch to 10, batch size of 24.</p>
<p>Thanks for these great tutorials</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431514" onclick="return addComment.moveForm( &quot;comment-431514&quot;, &quot;431514&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Monty Shaw">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431554" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-431554" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 8, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They could match, in general it would be nice if they did. You may see different results each run given the stochastic nature of the algorithm.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431554" onclick="return addComment.moveForm( &quot;comment-431554&quot;, &quot;431554&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431572" class="comment even depth-3">

	      	<div id="li-comment-431572" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/648fe4a3bc41a14a11ea37f9e15bfb06.png" srcset="https://secure.gravatar.com/avatar/648fe4a3bc41a14a11ea37f9e15bfb06?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Monty Shaw</span>
	                <span class="date">March 8, 2018 at 11:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431572" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting, I don’t see why they would ever match, unless the training model was not working or a bug in the code. It seems counter intuitive to me.</p>
<p>Thanks for the reply</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431572" onclick="return addComment.moveForm( &quot;comment-431572&quot;, &quot;431572&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Monty Shaw">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431669" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-431669" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/916ad93790cc265bcf0b0a743a87bade.png" srcset="https://secure.gravatar.com/avatar/916ad93790cc265bcf0b0a743a87bade?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://latiaoshusheng.github.io/" rel="external nofollow" class="url">latiaoshusheng</a></span>
	                <span class="date">March 9, 2018 at 1:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431669" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting! This is very useful for me, but I have a question that the features contain the historical PM2.5 what it is say all the train process contain y. I think it may be not right.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431669" onclick="return addComment.moveForm( &quot;comment-431669&quot;, &quot;431669&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to latiaoshusheng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431727" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431727" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 10, 2018 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431727" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why is that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431727" onclick="return addComment.moveForm( &quot;comment-431727&quot;, &quot;431727&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431806" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-431806" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bff9d66aab7d1942ad9c3882404b5fcc.png" srcset="https://secure.gravatar.com/avatar/bff9d66aab7d1942ad9c3882404b5fcc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sachin</span>
	                <span class="date">March 10, 2018 at 11:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431806" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, while feeding the data to series_to_supervised function, it returns one row less than number of rows originally. Can you please have a look into it ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431806" onclick="return addComment.moveForm( &quot;comment-431806&quot;, &quot;431806&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sachin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431836" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431836" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 11, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431836" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, rows with NaN are removed.</p>
<p>Perhaps read this post about why this is the case:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431836" onclick="return addComment.moveForm( &quot;comment-431836&quot;, &quot;431836&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431865" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-431865" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e5b29ed21166ce16a60a0135b8eeacc5.png" srcset="https://secure.gravatar.com/avatar/e5b29ed21166ce16a60a0135b8eeacc5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">NATALIE CARUANA</span>
	                <span class="date">March 11, 2018 at 10:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431865" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
thanks alot for this very interesting and useful tutorial!</p>
<p>Just one question…When you are scaling the data, you are using a range of (0,1).  But then in LSTM you are not specifying the activation function.  Doesn’t Keras assume tanh by default?  If so shouldn’t the the data be scaled between -1 and 1 then?</p>
<p>thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431865" onclick="return addComment.moveForm( &quot;comment-431865&quot;, &quot;431865&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to NATALIE CARUANA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431892" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431892" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 12, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My own experiments have shown that 0-1 results in faster learning for LSTMs. Experiment for your dataset and use what works best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431892" onclick="return addComment.moveForm( &quot;comment-431892&quot;, &quot;431892&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431946" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-431946" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/263781dbc0817932b422a5b27c25ce57.png" srcset="https://secure.gravatar.com/avatar/263781dbc0817932b422a5b27c25ce57?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kevin Daftary</span>
	                <span class="date">March 12, 2018 at 9:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431946" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m working on a project about bus trip scheduling where I need to predict values for a particular timeslot, say 10:00:00-11:00:00 for the next week based on data from earlier months. Can this timeseries forecasting model be used to keep the timeslot same and just increment the day?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431946" onclick="return addComment.moveForm( &quot;comment-431946&quot;, &quot;431946&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kevin Daftary">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431974" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431974" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 13, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend exploring multiple different framings of the problem and see what works best for your specific data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-431974" onclick="return addComment.moveForm( &quot;comment-431974&quot;, &quot;431974&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432063" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432063" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7a1b58146e9c174d39b9f27b88a1298b.png" srcset="https://secure.gravatar.com/avatar/7a1b58146e9c174d39b9f27b88a1298b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fati</span>
	                <span class="date">March 14, 2018 at 1:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432063" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>How we can use sklearn train_test_split method for the second example?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432063" onclick="return addComment.moveForm( &quot;comment-432063&quot;, &quot;432063&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fati">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432106" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-432106" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2018 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432106" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432106" onclick="return addComment.moveForm( &quot;comment-432106&quot;, &quot;432106&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432142" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-432142" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7a1b58146e9c174d39b9f27b88a1298b.png" srcset="https://secure.gravatar.com/avatar/7a1b58146e9c174d39b9f27b88a1298b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fati</span>
	                <span class="date">March 14, 2018 at 8:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432142" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I meant instead of splitting data like this </p>
<p># split into train and test sets<br>
values = reframed.values<br>
n_train_hours = 365 * 24<br>
train = values[:n_train_hours, :]<br>
test = values[n_train_hours:, :]<br>
# split into input and outputs<br>
n_obs = n_hours * n_features<br>
train_X, train_y = train[:, :n_obs], train[:, -n_features]<br>
test_X, test_y = test[:, :n_obs], test[:, -n_features]<br>
print(train_X.shape, len(train_X), train_y.shape)</p>
<p>What if we split the data using sklearn method?<br>
I split the data using sklearn method but I have got problem with reshaping, because I cant use hour and feature like you did.<br>
The reason for this question is that when I tried to use your sample I have got rmse=0 which means over fitting, so I decided to first split data to training and test data then do Normalization for each set, also I want the split be random because in this sample we don’t have random split (means we start at first row to 365*24 and the rest is for test).<br>
I hope I was clear.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432142" onclick="return addComment.moveForm( &quot;comment-432142&quot;, &quot;432142&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fati">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432167" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-432167" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432167" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post can teach you about reshaping data for lstms:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432167" onclick="return addComment.moveForm( &quot;comment-432167&quot;, &quot;432167&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432241" class="comment odd alt depth-5">

	      	<div id="li-comment-432241" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7a1b58146e9c174d39b9f27b88a1298b.png" srcset="https://secure.gravatar.com/avatar/7a1b58146e9c174d39b9f27b88a1298b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fati</span>
	                <span class="date">March 15, 2018 at 7:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432241" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Thanks for your help.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-432294" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-432294" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432294" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-432246" class="comment odd alt depth-5">

	      	<div id="li-comment-432246" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7a1b58146e9c174d39b9f27b88a1298b.png" srcset="https://secure.gravatar.com/avatar/7a1b58146e9c174d39b9f27b88a1298b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fati</span>
	                <span class="date">March 15, 2018 at 8:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432246" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Do we need to scale output? for example I have y_train and y_test do I need to scale these or not?</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-432297" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-432297" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2018 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432297" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It can help.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432069" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-432069" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f9d9ddd6ca3cfa7eaaaf0076c7dff596.png" srcset="https://secure.gravatar.com/avatar/f9d9ddd6ca3cfa7eaaaf0076c7dff596?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Moma</span>
	                <span class="date">March 14, 2018 at 1:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432069" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I would like to predict next 12 months of employee number based on 24 or more history data.</p>
<p>I have multiple features for this task such as turnover, profit and salaries. </p>
<p>So my first concern is what parameters should I supply for series_to_sequence function, would it be (values,24,12) appropriate solution?  </p>
<p>Next, how should I use this time series frame from series_to_sequence to train on 24 months and predict employee numbers for next 12 months?</p>
<p>What should be the input for prediction model if I want to train on 24 months of 2016 and 2017 data and want to predict for whole 2018 year when I do not have any of the turnover, profit and salaries feature data for that year?</p>
<p>Thanks a lot!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432069" onclick="return addComment.moveForm( &quot;comment-432069&quot;, &quot;432069&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Moma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432111" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432111" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432111" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can use this post as a template:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432111" onclick="return addComment.moveForm( &quot;comment-432111&quot;, &quot;432111&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432087" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-432087" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/540b35a7a01bdf296f47913683ddf798.png" srcset="https://secure.gravatar.com/avatar/540b35a7a01bdf296f47913683ddf798?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rushabh Kapadia</span>
	                <span class="date">March 14, 2018 at 5:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432087" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I tried this code and modified it a bit according to my problem, the queries i had are:</p>
<p>1.The predicted forecast is yhat right? And if that is the case then, inv_yhat should be the forecast after scaling it back to the defined domain of values, now I’m getting negative values in these forecasts which should not be possible since the actual prediction and even the data does not have any negative values at all. (Assuming min-max scaler would map it back to the actual domain and there aren’t negative values in the domain)</p>
<p>2. If yhat isn’t the predicted forecast then which variable is? </p>
<p>This post was really helpful for implementing LSTM. Hopefully you can help me with my query.Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432087" onclick="return addComment.moveForm( &quot;comment-432087&quot;, &quot;432087&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rushabh Kapadia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-432152" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-432152" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7bfa45ba5ef092a90d24eddd3f1d7a4b.png" srcset="https://secure.gravatar.com/avatar/7bfa45ba5ef092a90d24eddd3f1d7a4b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vishnu Prashanth Indramohan</span>
	                <span class="date">March 15, 2018 at 2:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you so much for this great tutorial. I just need your suggestion/ reference to solve the business problem I have. </p>
<p>I have a dataset containing Dates, Product (Categorical Variable) and Quantities sold.<br>
How can I forecast the Quantities sold for each Product(category)? </p>
<p>Say in this example, how can I use wnd_dir as categorical input to forecast the output? </p>
<p>Any suggestion would be highly helpful. </p>
<p>Thanks and Regards,<br>
Vishnu</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432152" onclick="return addComment.moveForm( &quot;comment-432152&quot;, &quot;432152&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vishnu Prashanth Indramohan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432174" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-432174" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432174" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This process will help you work through your problem systematically:<br>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow">https://machinelearningmastery.com/start-here/#process</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432174" onclick="return addComment.moveForm( &quot;comment-432174&quot;, &quot;432174&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432158" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432158" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f9d9ddd6ca3cfa7eaaaf0076c7dff596.png" srcset="https://secure.gravatar.com/avatar/f9d9ddd6ca3cfa7eaaaf0076c7dff596?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Moma</span>
	                <span class="date">March 15, 2018 at 3:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432158" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply! </p>
<p>This is very useful post! </p>
<p>However, I still do not see if I use whole dataset of two years for training what should be the input in prediction model after I reframe to supervised sequence. </p>
<p>For example if I would use template from that post with series_to_supervised(values,1,3) with 6 features I would get (46,24) dimesion. So 3*6 is number of input columns and last 6 is output. </p>
<p>So expected output would be 10 3-month forecasts, but what would be the input to prediction model in real case without splitting the test set from reframed dataset in order to predict sequence for the next 12 months?</p>
<p>Thanks a lot!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432158" onclick="return addComment.moveForm( &quot;comment-432158&quot;, &quot;432158&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Moma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432179" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-432179" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You define the input and output of the model. To make a prediction, you provide the required input.</p>
<p>Perhaps this post will make this input/output relationship clearer for you:<br>
<a href="http://machinelearningmastery.com/how-machine-learning-algorithms-work/" rel="nofollow">http://machinelearningmastery.com/how-machine-learning-algorithms-work/</a></p>
<p>Also, this post will show you how to call the predict function:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432179" onclick="return addComment.moveForm( &quot;comment-432179&quot;, &quot;432179&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432381" class="comment even depth-3 parent">

	      	<div id="li-comment-432381" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f9d9ddd6ca3cfa7eaaaf0076c7dff596.png" srcset="https://secure.gravatar.com/avatar/f9d9ddd6ca3cfa7eaaaf0076c7dff596?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Moma</span>
	                <span class="date">March 17, 2018 at 2:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432381" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason!</p>
<p>Something is still keeping me down, so to be sure I understand I will give some example: </p>
<p>If I have this reframed series with one lag value and 12 predictions for each month in a year. </p>
<p>var3 corresponds to value that should be predicted, using multistep approach, from December in last year to predict January in next year and use January to predict February and so on. </p>
<p>So what should be training set in model.fit, is it the first two columns (13, 2) for X and the third column (13,1) for y?</p>
<p>What should be the argument in model.predict(?) for each time step prediction?</p>
<p>(13, 39)<br>
    var1(t-1)  var2(t-1)  var3(t-1)  var1(t)   var2(t)  var3(t)  var1(t+1)  \<br>
1       -20.0    43000.0        3.0    -18.0   50692.0      3.0      -15.0<br>
2       -18.0    50692.0        3.0    -15.0   66060.0      3.0      -12.0<br>
3       -15.0    66060.0        3.0    -12.0   87786.0      3.0      -10.0<br>
4       -12.0    87786.0        3.0    -10.0  117319.0      3.0       -8.0<br>
5       -10.0   117319.0        3.0     -8.0  152754.0      4.0       -6.0<br>
6        -8.0   152754.0        4.0     -6.0  196452.0      5.0       -4.0<br>
7        -6.0   196452.0        5.0     -4.0  247350.0      6.0       -2.0<br>
8        -4.0   247350.0        6.0     -2.0  303460.0      6.0       -1.0<br>
9        -2.0   303460.0        6.0     -1.0  368524.0      8.0        1.0<br>
10       -1.0   368524.0        8.0      1.0  438343.0      9.0        2.0<br>
11        1.0   438343.0        9.0      2.0  517572.0     10.0        3.0<br>
12        2.0   517572.0       10.0      3.0  604000.0     12.0        3.0<br>
13        3.0   604000.0       12.0      3.0  688251.0     13.0        4.0   </p>
<p>    var2(t+1)  var3(t+1)  var1(t+2)     …      var3(t+8)  var1(t+9)  \<br>
1     66060.0        3.0      -12.0     …            8.0        1.0<br>
2     87786.0        3.0      -10.0     …            9.0        2.0<br>
3    117319.0        3.0       -8.0     …           10.0        3.0<br>
4    152754.0        4.0       -6.0     …           12.0        3.0<br>
5    196452.0        5.0       -4.0     …           13.0        4.0<br>
6    247350.0        6.0       -2.0     …           15.0        4.0<br>
7    303460.0        6.0       -1.0     …           16.0        4.0<br>
8    368524.0        8.0        1.0     …           18.0        4.0<br>
9    438343.0        9.0        2.0     …           20.0        4.0<br>
10   517572.0       10.0        3.0     …           23.0        4.0<br>
11   604000.0       12.0        3.0     …           25.0        3.0<br>
12   688251.0       13.0        4.0     …           27.0        2.0<br>
13   788380.0       15.0        4.0     …           30.0        1.0   </p>
<p>    var2(t+9)  var3(t+9)  var1(t+10)  var2(t+10)  var3(t+10)  var1(t+11)  \<br>
1    438343.0        9.0         2.0    517572.0        10.0         3.0<br>
2    517572.0       10.0         3.0    604000.0        12.0         3.0<br>
3    604000.0       12.0         3.0    688251.0        13.0         4.0<br>
4    688251.0       13.0         4.0    788380.0        15.0         4.0<br>
5    788380.0       15.0         4.0    892134.0        16.0         4.0<br>
6    892134.0       16.0         4.0   1006428.0        18.0         4.0<br>
7   1006428.0       18.0         4.0   1123891.0        20.0         4.0<br>
8   1123891.0       20.0         4.0   1252351.0        23.0         4.0<br>
9   1252351.0       23.0         4.0   1388010.0        25.0         3.0<br>
10  1388010.0       25.0         3.0   1526148.0        27.0         2.0<br>
11  1526148.0       27.0         2.0   1675973.0        30.0         1.0<br>
12  1675973.0       30.0         1.0   1827819.0        33.0         0.0<br>
13  1827819.0       33.0         0.0   1991810.0        36.0        -2.0   </p>
<p>    var2(t+11)  var3(t+11)<br>
1     604000.0        12.0<br>
2     688251.0        13.0<br>
3     788380.0        15.0<br>
4     892134.0        16.0<br>
5    1006428.0        18.0<br>
6    1123891.0        20.0<br>
7    1252351.0        23.0<br>
8    1388010.0        25.0<br>
9    1526148.0        27.0<br>
10   1675973.0        30.0<br>
11   1827819.0        33.0<br>
12   1991810.0        36.0<br>
13   2163000.0        39.0  </p>
<p>I very appreciate your help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432381" onclick="return addComment.moveForm( &quot;comment-432381&quot;, &quot;432381&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Moma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432414" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-432414" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 17, 2018 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Think of your problem in terms of model inputs and outputs, X and Y.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432414" onclick="return addComment.moveForm( &quot;comment-432414&quot;, &quot;432414&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432397" class="comment even depth-3">

	      	<div id="li-comment-432397" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f9d9ddd6ca3cfa7eaaaf0076c7dff596.png" srcset="https://secure.gravatar.com/avatar/f9d9ddd6ca3cfa7eaaaf0076c7dff596?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Moma</span>
	                <span class="date">March 17, 2018 at 7:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432397" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just short explanation of the previous post. The thing is that I do not have available real features  var1 and var2 for these months that I need prediction so that is why I am confised. What I am looking is similar behavior to generate prediction sequence like in Arima passing number of prediction steps if not input vector of var1 and var2.</p>
<p>Thanks!!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432397" onclick="return addComment.moveForm( &quot;comment-432397&quot;, &quot;432397&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Moma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432160" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-432160" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/56872ae4aae794ccd858e1605ce9f9bf.png" srcset="https://secure.gravatar.com/avatar/56872ae4aae794ccd858e1605ce9f9bf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fafa</span>
	                <span class="date">March 15, 2018 at 4:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432160" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, what if we have both categorical and numerical dataset? Is the code works fine?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432160" onclick="return addComment.moveForm( &quot;comment-432160&quot;, &quot;432160&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fafa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432181" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432181" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432181" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Categorical variables might need to be integer encoded or one hot encoded first.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432181" onclick="return addComment.moveForm( &quot;comment-432181&quot;, &quot;432181&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432187" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432187" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8677c8d9a90844c508c168cd72874b64.png" srcset="https://secure.gravatar.com/avatar/8677c8d9a90844c508c168cd72874b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">March 15, 2018 at 7:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I have read the article on how to tune the parameters on the LSTM neural network and i have tried to do it on this dataset. My problem is the following: everytime i run the model even with the same number of epochs and without changing the parameters i obtain different results in term of RMSE. So even if found that the optimal number of epochs is 90, when i run the model with 90 epochs i obtain everytime different results.<br>
Why does this happen? Do you have any suggestion ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432187" onclick="return addComment.moveForm( &quot;comment-432187&quot;, &quot;432187&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Marco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432214" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432214" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 2:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is a feature of neural networks. Perhaps this post will make things clearer:<br>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<p>See this post for a better way to evaluate neural networks:<br>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<p>See this post for locking down randomness if you want to go that route:<br>
<a href="https://machinelearningmastery.com/reproducible-results-neural-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reproducible-results-neural-networks-keras/</a></p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432214" onclick="return addComment.moveForm( &quot;comment-432214&quot;, &quot;432214&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432208" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-432208" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/587b244c9af0ff71854d0055d841e892.png" srcset="https://secure.gravatar.com/avatar/587b244c9af0ff71854d0055d841e892?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zou Yanyun</span>
	                <span class="date">March 15, 2018 at 1:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432208" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I want to predict the air pollution in next two, three or more hours instead of only next one hour, how can i modify the code?<br>
Thank you so much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432208" onclick="return addComment.moveForm( &quot;comment-432208&quot;, &quot;432208&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Zou Yanyun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432225" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432225" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 2:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432225" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Use this post as a template:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432225" onclick="return addComment.moveForm( &quot;comment-432225&quot;, &quot;432225&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432275" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432275" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d96ede0be7091e88bcdd10e78221f70e.png" srcset="https://secure.gravatar.com/avatar/d96ede0be7091e88bcdd10e78221f70e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Beibei</span>
	                <span class="date">March 16, 2018 at 2:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432275" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for your excellent blogs and it gave me much help! I am confused about the sequence length, the lag timestep and timestep. Is lag timestep same as the sequence length? I used your codes on my data and I set the lag timestep as 12. When I used the built model to predict new data, the number of the result became less. For example, I want to predict the number of 13 but I only got 1 result data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432275" onclick="return addComment.moveForm( &quot;comment-432275&quot;, &quot;432275&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Beibei">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432306" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432306" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432306" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this post will help you understand lag obs:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<p>This post will help you understand how to reshape input:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432306" onclick="return addComment.moveForm( &quot;comment-432306&quot;, &quot;432306&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432356" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-432356" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/dab3a2c7629ecbaeb7a906d355042abc.png" srcset="https://secure.gravatar.com/avatar/dab3a2c7629ecbaeb7a906d355042abc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Li Yue</span>
	                <span class="date">March 16, 2018 at 7:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432356" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, this post really helps me a lot. thank you. i am confused that why the test set has more samples than the training set and the loss on test set is smaller than the training set. wish to get your reply, thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432356" onclick="return addComment.moveForm( &quot;comment-432356&quot;, &quot;432356&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Li Yue">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432403" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-432403" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 17, 2018 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432403" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The training set has more than test, 4 years vs 1 year.</p>
<p>A test loss less then training loss my be a statistical fluke.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432403" onclick="return addComment.moveForm( &quot;comment-432403&quot;, &quot;432403&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432538" class="comment odd alt depth-3">

	      	<div id="li-comment-432538" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/dab3a2c7629ecbaeb7a906d355042abc.png" srcset="https://secure.gravatar.com/avatar/dab3a2c7629ecbaeb7a906d355042abc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Li Yue</span>
	                <span class="date">March 18, 2018 at 10:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry, i missed these words in your blog: “To speed up the training of the model for this demonstration, we will only fit the model on the first year of data, then evaluate it on the remaining 4 years of data.” and “Interestingly, we can see that test loss drops below training loss. The model may be overfitting the training data.” I trained the model with the first year of data, and the test loss less than training loss maybe because “the model is overfitting the training data”. i will try to train the model with 4 years data, and calculate the loss on training set and test set to see if the overfitting can be solved. Thank you for your reply.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432538" onclick="return addComment.moveForm( &quot;comment-432538&quot;, &quot;432538&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Li Yue">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-432539" class="comment even depth-3">

	      	<div id="li-comment-432539" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/dab3a2c7629ecbaeb7a906d355042abc.png" srcset="https://secure.gravatar.com/avatar/dab3a2c7629ecbaeb7a906d355042abc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Li Yue</span>
	                <span class="date">March 18, 2018 at 10:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432539" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i am also confused about these words in your blog: “Interestingly, we can see that test loss drops below training loss. The model may be overfitting the training data.”as what i have learned, if the model overfits the training data, the model will perform better on training set than test set and loss on training set will be less than on the test set.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432539" onclick="return addComment.moveForm( &quot;comment-432539&quot;, &quot;432539&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Li Yue">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432374" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432374" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7a1b58146e9c174d39b9f27b88a1298b.png" srcset="https://secure.gravatar.com/avatar/7a1b58146e9c174d39b9f27b88a1298b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fati</span>
	                <span class="date">March 17, 2018 at 1:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432374" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>How we can use model to predict value on new input data?<br>
I saw you have post that talks about save and load model , if I want to apply this model on new data what should be the shape of input? (none, timestep, feature)?</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432374" onclick="return addComment.moveForm( &quot;comment-432374&quot;, &quot;432374&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fati">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432413" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432413" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 17, 2018 at 8:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will show you how:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432413" onclick="return addComment.moveForm( &quot;comment-432413&quot;, &quot;432413&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432460" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-432460" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7528a69232cc799502d62416b45bff6c.png" srcset="https://secure.gravatar.com/avatar/7528a69232cc799502d62416b45bff6c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Med</span>
	                <span class="date">March 18, 2018 at 12:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432460" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr.Jason, </p>
<p>Firstly, thank you very much for this tutorial!<br>
My question is, how to interpret the result and make a prediction, how to make a prediction using a new data?<br>
Thank you,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432460" onclick="return addComment.moveForm( &quot;comment-432460&quot;, &quot;432460&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Med">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432489" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432489" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 18, 2018 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432489" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432489" onclick="return addComment.moveForm( &quot;comment-432489&quot;, &quot;432489&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432586" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432586" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d8f54648dd383e0157c5e570cad82ce9.png" srcset="https://secure.gravatar.com/avatar/d8f54648dd383e0157c5e570cad82ce9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jay</span>
	                <span class="date">March 19, 2018 at 4:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432586" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr.Jason,</p>
<p>Thank you very much for this tutorial!</p>
<p>Not sure if you have the same problem as I had, Well, keras is using tensorflow as the backend, it was kinda of using this code ( x = tf.placeholder(dtype, shape=shape, name=name)<br>
and then this error shows up. </p>
<p>TypeError: ‘NoneType’ object is not callable</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432586" onclick="return addComment.moveForm( &quot;comment-432586&quot;, &quot;432586&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432649" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432649" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 20, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not seen this error. Perhaps you could try posting to stackoverflow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432649" onclick="return addComment.moveForm( &quot;comment-432649&quot;, &quot;432649&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432830" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-432830" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d5937c7ba2a8540861e49bb8e4e0f9aa.png" srcset="https://secure.gravatar.com/avatar/d5937c7ba2a8540861e49bb8e4e0f9aa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Christian</span>
	                <span class="date">March 21, 2018 at 11:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432830" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
Thanks for the post.<br>
Is it possible to frame the supervised learning problem as predicting the pollution at the next time step based only on the weather conditions at the current time?<br>
Cheers,<br>
Christian</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432830" onclick="return addComment.moveForm( &quot;comment-432830&quot;, &quot;432830&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Christian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432864" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432864" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 22, 2018 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432864" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432864" onclick="return addComment.moveForm( &quot;comment-432864&quot;, &quot;432864&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432861" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-432861" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8677c8d9a90844c508c168cd72874b64.png" srcset="https://secure.gravatar.com/avatar/8677c8d9a90844c508c168cd72874b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">March 22, 2018 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432861" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
As some other people notice when you plot the graph of predicted and real values, it seems that they are shifted by one.  I think that the main reason of this problem is the following line:</p>
<p>68 –   test_X, test_y = test[:, :n_obs], test[:, -n_features]</p>
<p>The problem i that in this way when you do ‘test[:, :n_obs]’ you are you using the data of the previous hour, while the corresponding label that you have are scaled by one.<br>
Instead if you do like this ‘test[:, n_obs : ] ‘  the results will be corrected and not shifted:</p>
<p>68 –   test_X, test_y = test[:, n_obs : ], test[:, -n_features]</p>
<p>I have made some tests and i am quite sure that this is an error. Let me know what do you think</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432861" onclick="return addComment.moveForm( &quot;comment-432861&quot;, &quot;432861&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Marco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-432922" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-432922" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/086619702026b1d48afbf9ec018873bc.png" srcset="https://secure.gravatar.com/avatar/086619702026b1d48afbf9ec018873bc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://quantapi.co/" rel="external nofollow" class="url">Nick WONG</a></span>
	                <span class="date">March 22, 2018 at 7:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432922" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I have followed your tutorials and they are very nice and helpful.<br>
I’ve made a LSTM wheat price prediction model on Kaggle based on your tutorial.<br>
Just want to share it and encourage others to try their hands on.</p>
<p><a href="https://www.kaggle.com/nickwong64/lstm-wheat-price-predictions/" rel="nofollow">https://www.kaggle.com/nickwong64/lstm-wheat-price-predictions/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432922" onclick="return addComment.moveForm( &quot;comment-432922&quot;, &quot;432922&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nick WONG">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432974" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-432974" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 23, 2018 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>
<p>Perhaps you could link back to where you copied the code from and credit the source?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432974" onclick="return addComment.moveForm( &quot;comment-432974&quot;, &quot;432974&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433009" class="comment even depth-3">

	      	<div id="li-comment-433009" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/086619702026b1d48afbf9ec018873bc.png" srcset="https://secure.gravatar.com/avatar/086619702026b1d48afbf9ec018873bc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://quantapi.co/" rel="external nofollow" class="url">Nick WONG</a></span>
	                <span class="date">March 23, 2018 at 12:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433009" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, added it back.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433009" onclick="return addComment.moveForm( &quot;comment-433009&quot;, &quot;433009&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nick WONG">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433910" class="comment odd alt depth-2">

	      	<div id="li-comment-433910" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3ad56c7e889c196d9b6016ad7fa30904.png" srcset="https://secure.gravatar.com/avatar/3ad56c7e889c196d9b6016ad7fa30904?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">GuanYu</span>
	                <span class="date">April 2, 2018 at 4:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433910" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>cool</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433910" onclick="return addComment.moveForm( &quot;comment-433910&quot;, &quot;433910&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to GuanYu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432938" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-432938" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f9d9ddd6ca3cfa7eaaaf0076c7dff596.png" srcset="https://secure.gravatar.com/avatar/f9d9ddd6ca3cfa7eaaaf0076c7dff596?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Moma</span>
	                <span class="date">March 22, 2018 at 11:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432938" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I still have a problem with defining the input data in prediction. If I reframe the problem for example as 1 lag value and 1 prediction, from previous month to predict the next, I get (24,14) for 2 years of history data and 7 features so when I reshape it I get X for training with this dimension  (24,1,13) and y (24,). I am using whole this history data to train LSTM and up to this step everything is ok when I design and train LSTM.</p>
<p>But if I pass last row from history data that represents December 2017, as input data in prediction method which is this dimension (1,1,13) I actually evaluating prediction of the last row  for employee count that corresponds to this December, not generating new prediction for January 2018.</p>
<p>I do not have new features (salaries, turnover, etc) from the next month (January 2018) to generate prediction (number of employees) for that month. </p>
<p>I really do not understand what to pass as input in prediction to generate sequence of next 12 months from previous lag values. Can this be done like in ARIMA where we just pass the number of time steps for which we need prediction?</p>
<p>Thanks a lot!</p>
<p>I am sorry for bothering you with this!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-432938" onclick="return addComment.moveForm( &quot;comment-432938&quot;, &quot;432938&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Moma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-433129" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-433129" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9de0b91ade5ff69527abcae9a42dce24.png" srcset="https://secure.gravatar.com/avatar/9de0b91ade5ff69527abcae9a42dce24?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ruhin</span>
	                <span class="date">March 25, 2018 at 12:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433129" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir,can you please provide me with a python code for “NETWORK ANOMALY DETECTION IN RNN USING LSTM”.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433129" onclick="return addComment.moveForm( &quot;comment-433129&quot;, &quot;433129&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ruhin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433155" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433155" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 25, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433155" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433155" onclick="return addComment.moveForm( &quot;comment-433155&quot;, &quot;433155&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433214" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-433214" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e2fc37a7802f03eefda40e3f46c5bda7.png" srcset="https://secure.gravatar.com/avatar/e2fc37a7802f03eefda40e3f46c5bda7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Purvesh</span>
	                <span class="date">March 26, 2018 at 7:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>TypeError: parse() takes 1 positional argument but 4 were given<br>
while converting into timestamp</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433214" onclick="return addComment.moveForm( &quot;comment-433214&quot;, &quot;433214&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Purvesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433249" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-433249" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 26, 2018 at 10:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433249" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps confirm that you are using Python3 and all libraries are up to date.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433249" onclick="return addComment.moveForm( &quot;comment-433249&quot;, &quot;433249&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440217" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-440217" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5d009a4d8cdb0e977be325f4cd8a0251.png" srcset="https://secure.gravatar.com/avatar/5d009a4d8cdb0e977be325f4cd8a0251?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Francesco Dainese</span>
	                <span class="date">June 8, 2018 at 8:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I confirm I am using Python3.6 with Spyder IDE and I have just installed DateTime package thruogh conda but problem still remains. Yet I don’t understand the syntax in *date_parser=parse*. Shouldn’t it be *date_parser=parse(x)* with x being a tangible variable?<br>
PS:I’ve found and installed DateTime package..is it the one required?I have not found any other similar.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440217" onclick="return addComment.moveForm( &quot;comment-440217&quot;, &quot;440217&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Francesco Dainese">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440270" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-440270" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 9, 2018 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are providing the name of the function, not calling the function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440270" onclick="return addComment.moveForm( &quot;comment-440270&quot;, &quot;440270&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440242" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-440242" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5d009a4d8cdb0e977be325f4cd8a0251.png" srcset="https://secure.gravatar.com/avatar/5d009a4d8cdb0e977be325f4cd8a0251?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Francesco Dainese</span>
	                <span class="date">June 9, 2018 at 3:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440242" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>my bad, there was a misplelled % inside the function…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440242" onclick="return addComment.moveForm( &quot;comment-440242&quot;, &quot;440242&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Francesco Dainese">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440278" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-440278" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 9, 2018 at 6:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440278" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear you worked it out.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440278" onclick="return addComment.moveForm( &quot;comment-440278&quot;, &quot;440278&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433349" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-433349" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/587b244c9af0ff71854d0055d841e892.png" srcset="https://secure.gravatar.com/avatar/587b244c9af0ff71854d0055d841e892?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yanyun Zou</span>
	                <span class="date">March 27, 2018 at 12:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433349" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I’m considering the structure of this LSTM network. Is there a recurrent loop between hidden layer and output layer? Or is there a recurrent loop just in the hidden layer? I want to know where the circular structure is.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433349" onclick="return addComment.moveForm( &quot;comment-433349&quot;, &quot;433349&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Yanyun Zou">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433377" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433377" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 27, 2018 at 4:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433377" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Recurrence occurs within the LSTM layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433377" onclick="return addComment.moveForm( &quot;comment-433377&quot;, &quot;433377&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433413" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-433413" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8386194774a639e1de96572acb2ac359.png" srcset="https://secure.gravatar.com/avatar/8386194774a639e1de96572acb2ac359?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://air2it.com/" rel="external nofollow" class="url">joshua</a></span>
	                <span class="date">March 28, 2018 at 3:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi I got the code examples to run but I am curious how to make use of it?<br>
I seen this use case for tuning boilers or furnaces.<br>
<a href="https://www.itl.nist.gov/div898/handbook/pmc/section4/pmc451.htm" rel="nofollow">https://www.itl.nist.gov/div898/handbook/pmc/section4/pmc451.htm</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433413" onclick="return addComment.moveForm( &quot;comment-433413&quot;, &quot;433413&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to joshua">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433432" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433432" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 28, 2018 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can use it however you like. Perhaps I misunderstand your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433432" onclick="return addComment.moveForm( &quot;comment-433432&quot;, &quot;433432&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433499" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-433499" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5748727422ad858e3bd09706ca04c13c.png" srcset="https://secure.gravatar.com/avatar/5748727422ad858e3bd09706ca04c13c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raj</span>
	                <span class="date">March 29, 2018 at 2:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433499" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I stumbled upon your website through a referral link in LinkedIn. You have some great tutorials and a great teaching style, kudos to you. I  followed through this tutorial and have a question related to a problem that I’m trying to solve. I’ve a time series data similar to the example in this tutorial except it has the following format:</p>
<p>t-n:   x1(t-n) x2(t-n) x3(t-n) x4(t-n) x5(t-n)     y(t-n)<br>
:<br>
:<br>
t-2:   x1(t-2) x2(t-2) x3(t-2) x4(t-2) x5(t-2)     y(t-2)<br>
t-1:   x1(t-1) x2(t-1) x3(t-1) x4(t-1) x5(t-1)     y(t-1)<br>
t   :   x1(t) x2(t) x3(t) x4(t) x5(t)                     y(t)</p>
<p>I’m trying to predict y but y can’t be part of the feature vector [x1, x2, x3, x4, x5]. Will a LSTM architecture be able to predict y(t-n),…, y(t-1), y(t) in such a scenario? Thinking of y as say, temperature, y could be increasing as a function of time even for the same set of values of the feature vector. Will the code and example in this tutorial be applied to this case?</p>
<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433499" onclick="return addComment.moveForm( &quot;comment-433499&quot;, &quot;433499&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Raj">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433540" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433540" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2018 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433540" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally LSTMs are pretty poor at time series. Perhaps explore using an MLP instead?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433540" onclick="return addComment.moveForm( &quot;comment-433540&quot;, &quot;433540&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433635" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-433635" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9355d3fcf3be12b13dafe974982d1000.png" srcset="https://secure.gravatar.com/avatar/9355d3fcf3be12b13dafe974982d1000?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">March 30, 2018 at 4:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433635" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>Thanks for your article and I have a question.<br>
In most cases, as you explained in your article, the goal of model is to predict y(t) given x1(t-n), x1(t-n-1),…,xn(t), y(t-n), y(t-n-1),…,y(t-1).</p>
<p>But in my case, I have lot’s of person’s time series data like the following. So I don’t know about how to split and use my data for model training.</p>
<p>[data for person #1]<br>
         x1(t-n) x1(t-n-1) … xn(t-1) xn(t) y(t-n) y(t-n-1) … y(t-1)<br>
2011<br>
2012<br>
2013<br>
…<br>
2017</p>
<p>[data for person #2]<br>
         x1(t-n) x1(t-n-1) … xn(t-1) xn(t) y(t-n) y(t-n-1) … y(t-1)<br>
2011<br>
2012<br>
2013<br>
…<br>
2017</p>
<p>…</p>
<p>[data for person #n]<br>
         x1(t-n) x1(t-n-1) … xn(t-1) xn(t) y(t-n) y(t-n-1) … y(t-1)<br>
2011<br>
2012<br>
2013<br>
…<br>
2017</p>
<p>The goal of my model is to predict y(t) given a new person’s time series data.</p>
<p>Any opinions on how to design and train  model will be appreciated.</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433635" onclick="return addComment.moveForm( &quot;comment-433635&quot;, &quot;433635&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433667" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433667" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2018 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433667" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps model per person, per group of people or for all people.</p>
<p>Try each and see what works best?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433667" onclick="return addComment.moveForm( &quot;comment-433667&quot;, &quot;433667&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433748" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-433748" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7528a69232cc799502d62416b45bff6c.png" srcset="https://secure.gravatar.com/avatar/7528a69232cc799502d62416b45bff6c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Med</span>
	                <span class="date">March 31, 2018 at 8:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433748" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mr Jason,<br>
I made a prediction with this model using new data, I want to know what is the relation with the prediction value an RMSE? for exemple: real prediction=model prediction+RMSE?</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433748" onclick="return addComment.moveForm( &quot;comment-433748&quot;, &quot;433748&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Med">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433792" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433792" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 1, 2018 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433792" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The RMSE is an estimation of the model error when making a prediction.</p>
<p>It cannot be used directly for calculating a confidence interval or a prediction interval.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433792" onclick="return addComment.moveForm( &quot;comment-433792&quot;, &quot;433792&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433987" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-433987" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3ad56c7e889c196d9b6016ad7fa30904.png" srcset="https://secure.gravatar.com/avatar/3ad56c7e889c196d9b6016ad7fa30904?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">walau</span>
	                <span class="date">April 3, 2018 at 12:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i  transform a new dataset using function series_to_supervised, some of the values become negative, hows that happened</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-433987" onclick="return addComment.moveForm( &quot;comment-433987&quot;, &quot;433987&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to walau">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434050" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-434050" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 4, 2018 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434050" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is surprising. The values are not changed. Perhaps check your original dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434050" onclick="return addComment.moveForm( &quot;comment-434050&quot;, &quot;434050&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434142" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-434142" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5748727422ad858e3bd09706ca04c13c.png" srcset="https://secure.gravatar.com/avatar/5748727422ad858e3bd09706ca04c13c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raj</span>
	                <span class="date">April 5, 2018 at 2:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434142" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there a way to initialize the hidden state to a specific non-zero value in Keras? My understanding is that hidden and cell states are initialized to zero by default. Are you aware of any setting where I can set h0 to an arbitrary value for LSTM?GRU layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434142" onclick="return addComment.moveForm( &quot;comment-434142&quot;, &quot;434142&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Raj">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434184" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-434184" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 5, 2018 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In all of my testing, initializing state or warming up state has had no effect on model skill.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434184" onclick="return addComment.moveForm( &quot;comment-434184&quot;, &quot;434184&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434378" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-434378" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8677c8d9a90844c508c168cd72874b64.png" srcset="https://secure.gravatar.com/avatar/8677c8d9a90844c508c168cd72874b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">April 7, 2018 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434378" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
In this example you use the data of the previous n hours to predict sample measure of the actual hour, but if i understand well you are not using the values of Humidity, Pressure ecc… of the hour you want to predict, but only of the previous hours. How can i do to use also the weather data of the hour that i want to predict?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434378" onclick="return addComment.moveForm( &quot;comment-434378&quot;, &quot;434378&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Marco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434426" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-434426" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 8, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434426" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Take a look at the section “LSTM Data Preparation” to change the data yo wish to feed into the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434426" onclick="return addComment.moveForm( &quot;comment-434426&quot;, &quot;434426&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434440" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-434440" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8677c8d9a90844c508c168cd72874b64.png" srcset="https://secure.gravatar.com/avatar/8677c8d9a90844c508c168cd72874b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">April 8, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434440" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What i want to do is :<br>
‘Predict the pollution for the next hour as above and given the “expected” weather conditions for the next hour.’<br>
The problem is the following,the input_shape of the LSTM layer is :</p>
<p>input_shape=(train_X.shape[1], train_X.shape[2])</p>
<p>So if we have a lag=3 and a  features=8 the shape will be (3,8).<br>
If i want to add the weather conditions of the next hour i should use instead 7 features since i cannot insert the feature that contain the value i want to predict(the pm 2.5 concentration), and this will raise an error in the LSTM<br>
How can i solve this problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434440" onclick="return addComment.moveForm( &quot;comment-434440&quot;, &quot;434440&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Marco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446186" class="comment even depth-4 parent">

	      	<div id="li-comment-446186" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1cfd1c1103d98d7bc148836d0a79ed8d.png" srcset="https://secure.gravatar.com/avatar/1cfd1c1103d98d7bc148836d0a79ed8d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andy</span>
	                <span class="date">August 16, 2018 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446186" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have this same question/issue as Marco.  Should we drop the pollution from the features altogether when training the model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446186" onclick="return addComment.moveForm( &quot;comment-446186&quot;, &quot;446186&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Andy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446206" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-446206" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2018 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446206" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why? We have a time series of pollution values in the past, they may be useful in predicting pollution in the future.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-446263" class="comment even depth-5">

	      	<div id="li-comment-446263" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1cfd1c1103d98d7bc148836d0a79ed8d.png" srcset="https://secure.gravatar.com/avatar/1cfd1c1103d98d7bc148836d0a79ed8d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andy</span>
	                <span class="date">August 17, 2018 at 1:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446263" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for your quick response.  I agree I would like to keep the pollution for previous timesteps, but I encounter the issue I will attempt to describe below.</p>
<p>My goal is to include the features of the current timestep when predicting the pollution of the current timestep.  The problem I have is that the current timestep has only 7 features since we do not have the pollution, but the previous timesteps have 8 features since we do have the pollution for those.  </p>
<p>This creates a problem when attempting to reshape the features into (samples, timesteps, features) because the current timestep has 7 features and previous timesteps have 8.  Does that make sense?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-446289" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-446289" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 17, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446289" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You need a new framing of the problem, where pollution at the current time step is not used as input.</p>
<p>Remember, the way the model is trained is the way the model will be used when making predictions. Start with what you want to forecast and with what input and work backwards to the framing required to address it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-449743" class="comment even depth-5">

	      	<div id="li-comment-449743" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8677c8d9a90844c508c168cd72874b64.png" srcset="https://secure.gravatar.com/avatar/8677c8d9a90844c508c168cd72874b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco Miglionico</span>
	                <span class="date">September 25, 2018 at 7:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449743" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Andy did you find any solution?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434648" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-434648" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/22edb15a1756ea45cfba145e5cf734ea.png" srcset="https://secure.gravatar.com/avatar/22edb15a1756ea45cfba145e5cf734ea?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ANWAR M ALQUTAN</span>
	                <span class="date">April 10, 2018 at 6:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434648" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very excellent code, really thanks Jason<br>
How we update the last example train on multiple lag timesteps to be at the same time forecast multi step in futures<br>
(I.e. multivariate &amp; multisteps with the same code)<br>
I tried that but I faced some problems with difference<br>
Thanks again</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434648" onclick="return addComment.moveForm( &quot;comment-434648&quot;, &quot;434648&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to ANWAR M ALQUTAN">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434690" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-434690" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 11, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434690" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here’s an example of multi-step forecasting with LSTMs that you can use as a starting point:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-434690" onclick="return addComment.moveForm( &quot;comment-434690&quot;, &quot;434690&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435161" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435161" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/727383fce1e0725900f25a81b3d1baac.png" srcset="https://secure.gravatar.com/avatar/727383fce1e0725900f25a81b3d1baac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">hugo</span>
	                <span class="date">April 16, 2018 at 9:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435161" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Doctor：<br>
thanks for sharing.<br>
 I have a question:<br>
why use all the 35k samples for training. its too long. You said the time-step is nice between 200-400.In this blog,the time-step is 1.why dont split to 35k/20 samples?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435161" onclick="return addComment.moveForm( &quot;comment-435161&quot;, &quot;435161&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to hugo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435191" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435191" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 17, 2018 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435191" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the example, we do split up and only use the prior time step as input.</p>
<p>Quoting from the post:</p>
<blockquote><p>
We will frame the supervised learning problem as predicting the pollution at the current hour (t) given the pollution measurement and weather conditions at the prior time step.
</p></blockquote>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435191" onclick="return addComment.moveForm( &quot;comment-435191&quot;, &quot;435191&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435235" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-435235" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/88dd7942be67539184d07a11465e9ad7.png" srcset="https://secure.gravatar.com/avatar/88dd7942be67539184d07a11465e9ad7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">hugo</span>
	                <span class="date">April 17, 2018 at 2:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435235" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>many thanks, Jason! you sovled my big problem. So,If the sequence is long enough, I can  use 200 time-steps right?</p>
<p>thanks a lot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435235" onclick="return addComment.moveForm( &quot;comment-435235&quot;, &quot;435235&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to hugo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435236" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435236" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 17, 2018 at 3:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435236" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435236" onclick="return addComment.moveForm( &quot;comment-435236&quot;, &quot;435236&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435252" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435252" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/47d6cd7745a701265ec91680329ddebd.png" srcset="https://secure.gravatar.com/avatar/47d6cd7745a701265ec91680329ddebd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris Skywalker</span>
	                <span class="date">April 17, 2018 at 9:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435252" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>excellent blog!! Thanks Jason.<br>
Can LSTM output more than one type of output at the same time? like pollution and rainfall.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435252" onclick="return addComment.moveForm( &quot;comment-435252&quot;, &quot;435252&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Chris Skywalker">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435297" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435297" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 18, 2018 at 8:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435297" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Absolutely.</p>
<p>You can output a vector each time step.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435297" onclick="return addComment.moveForm( &quot;comment-435297&quot;, &quot;435297&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435266" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-435266" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/727383fce1e0725900f25a81b3d1baac.png" srcset="https://secure.gravatar.com/avatar/727383fce1e0725900f25a81b3d1baac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">April 18, 2018 at 12:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435266" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason:<br>
Is there any way to output more than one type of sequence at the same time? Like pollution and rainfall</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435266" onclick="return addComment.moveForm( &quot;comment-435266&quot;, &quot;435266&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435308" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435308" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 18, 2018 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435308" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the model can output a vector at each time step.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435308" onclick="return addComment.moveForm( &quot;comment-435308&quot;, &quot;435308&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435368" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435368" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a0cb29989faf59cc4aee5d524a936ae0.png" srcset="https://secure.gravatar.com/avatar/a0cb29989faf59cc4aee5d524a936ae0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://github.com/gabrielamolinar" rel="external nofollow" class="url">Gabriela</a></span>
	                <span class="date">April 19, 2018 at 12:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435368" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello everyone,<br>
here you find a script for several hours forecasting based on Jason’s code: <a href="https://github.com/gabrielamolinar/LSTM_TSForecasting.git" rel="nofollow">https://github.com/gabrielamolinar/LSTM_TSForecasting.git</a><br>
I hope you find it useful.<br>
Cheers!<br>
Gabriela</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435368" onclick="return addComment.moveForm( &quot;comment-435368&quot;, &quot;435368&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Gabriela">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435396" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435396" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 19, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435396" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435396" onclick="return addComment.moveForm( &quot;comment-435396&quot;, &quot;435396&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435450" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-435450" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6e414586915a976767216a6f578e4615.png" srcset="https://secure.gravatar.com/avatar/6e414586915a976767216a6f578e4615?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kingsley Udeh</span>
	                <span class="date">April 19, 2018 at 9:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435450" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the post and tutorial.</p>
<p>Having calculated the RMSE for the LSTM, how could we now show pollution(t) from the previous one time step, say pollution(t-1), using real values, after knowing the error?</p>
<p>For example, I want to feed in previous pollution value for the past one hour, and see the corresponding forecast for time t, or t+1.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435450" onclick="return addComment.moveForm( &quot;comment-435450&quot;, &quot;435450&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kingsley Udeh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435480" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-435480" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 20, 2018 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435480" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is what the model is doing.</p>
<p>Perhaps I misunderstand your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435480" onclick="return addComment.moveForm( &quot;comment-435480&quot;, &quot;435480&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435490" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-435490" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6e414586915a976767216a6f578e4615.png" srcset="https://secure.gravatar.com/avatar/6e414586915a976767216a6f578e4615?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kingsley Udeh</span>
	                <span class="date">April 20, 2018 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435490" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is, looking at the Temperature variable, I want to see the value 148 printed when I feed in 129(previous value) to the model, just as we do in feed forward networks, or do we just conclude that since the test or validate error is close to train error, and these error values are small, that the model has accomplished its expectation?</p>
<p>I used my dataset to adapt your code, with few modifications, for the multivariate, one time step forecasting, and I got a RMSE of about 3.5. I’m wondering if that should be indication that the model is performing well.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435490" onclick="return addComment.moveForm( &quot;comment-435490&quot;, &quot;435490&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kingsley Udeh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435500" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-435500" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 20, 2018 at 2:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435500" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure I follow, sorry.</p>
<p>This post has more information on how to make predictions with LSTMs:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>
<p>This post has more information on how to determine if model performance is good or not:<br>
<a href="https://machinelearningmastery.com/how-to-know-if-your-machine-learning-model-has-good-performance/" rel="nofollow">https://machinelearningmastery.com/how-to-know-if-your-machine-learning-model-has-good-performance/</a></p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435500" onclick="return addComment.moveForm( &quot;comment-435500&quot;, &quot;435500&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435539" class="comment odd alt depth-5">

	      	<div id="li-comment-435539" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6e414586915a976767216a6f578e4615.png" srcset="https://secure.gravatar.com/avatar/6e414586915a976767216a6f578e4615?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kingsley Udeh</span>
	                <span class="date">April 21, 2018 at 2:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435539" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, Jason. Your send link helps.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435736" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435736" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1ed164330ed7471f113610b6726d2143.png" srcset="https://secure.gravatar.com/avatar/1ed164330ed7471f113610b6726d2143?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">April 24, 2018 at 2:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435736" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr. Brownlee, thank you for your tutorial. I’ve learned so much from you.<br>
Here is something I don’t understand. In this example, the past pollution data (t-1) is an input variable, but what if I don’t have this data? Say if I have the past pollution data and past weather condition data and the next-24-hour weather condition data, and I want to use it to predict the pollution values for the next 24 hours, what should I do? How does it work if I don’t have the true values of current pollution data and just want to predict it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435736" onclick="return addComment.moveForm( &quot;comment-435736&quot;, &quot;435736&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435769" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-435769" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 24, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435769" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must design a model to predict based on what data you do have or expect to have.</p>
<p>You can frame the problem any way you wish, there are just no guarantees that the problem can be learned sufficiently.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435769" onclick="return addComment.moveForm( &quot;comment-435769&quot;, &quot;435769&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435783" class="comment even depth-3 parent">

	      	<div id="li-comment-435783" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1ed164330ed7471f113610b6726d2143.png" srcset="https://secure.gravatar.com/avatar/1ed164330ed7471f113610b6726d2143?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">April 24, 2018 at 12:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435783" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You mean I have to design my own model? Is there any adjustments I can make to the LSTM model? I’m dealing with a time series prediction problem now. I want to combine the past time series data with the influencing factor data, and that’s why I choose to do it with LSTM, because I think this model incorporate both. My objective is to forecast the target variable in the future, but I can’t do it without the corresponding time series data. I’m kind of stuck here, so what do I do now?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435783" onclick="return addComment.moveForm( &quot;comment-435783&quot;, &quot;435783&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435793" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-435793" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 24, 2018 at 2:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435793" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not quite, I meant that you have control over the inputs and the outputs of the model.</p>
<p>Does that make sense? In the example above I took the dataset and decided what the inputs and outputs were going to be. It is not obvious, there are many ways to do it, and there is no one best way. Frame the problem in a way that makes sense based on data you do have, or enumerate many framings of the problem to see what works best (if you have the resources).</p>
<p>There models are approximating a mapping function, learn more about this here:<br>
<a href="http://machinelearningmastery.com/how-machine-learning-algorithms-work/" rel="nofollow">http://machinelearningmastery.com/how-machine-learning-algorithms-work/</a></p>
<p>For help on defining this for your dataset, see this post:<br>
<a href="http://machinelearningmastery.com/how-to-define-your-machine-learning-problem/" rel="nofollow">http://machinelearningmastery.com/how-to-define-your-machine-learning-problem/</a></p>
<p>If you are struggling to prepare time series data for the model, perhaps this post will help:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435793" onclick="return addComment.moveForm( &quot;comment-435793&quot;, &quot;435793&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435891" class="comment even depth-5">

	      	<div id="li-comment-435891" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1ed164330ed7471f113610b6726d2143.png" srcset="https://secure.gravatar.com/avatar/1ed164330ed7471f113610b6726d2143?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">April 25, 2018 at 6:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435891" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can I do a multi-step multi-variable forecasting?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-435957" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-435957" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435957" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-436017" class="comment even depth-5">

	      	<div id="li-comment-436017" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1ed164330ed7471f113610b6726d2143.png" srcset="https://secure.gravatar.com/avatar/1ed164330ed7471f113610b6726d2143?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">April 26, 2018 at 6:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436017" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you have an example of multi-step multi-variable forecasting?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-436057" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-436057" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 27, 2018 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436057" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not directly, you can combine this tutorial (above) with this tutorial:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435787" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-435787" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/79d04edb3affb7b09426418c40cf4cfc.png" srcset="https://secure.gravatar.com/avatar/79d04edb3affb7b09426418c40cf4cfc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">izsak</span>
	                <span class="date">April 24, 2018 at 2:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435787" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>‘ProgbarLogger’ object has no attribute ‘log_values’<br>
could you tell me how can i fix it？thx！</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435787" onclick="return addComment.moveForm( &quot;comment-435787&quot;, &quot;435787&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to izsak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435796" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-435796" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 24, 2018 at 2:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not seen this error.</p>
<p>Perhaps try searching and/or posting on StackOverflow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435796" onclick="return addComment.moveForm( &quot;comment-435796&quot;, &quot;435796&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435877" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435877" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e5b44e733585119fd671ecad0404ee66.png" srcset="https://secure.gravatar.com/avatar/e5b44e733585119fd671ecad0404ee66?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">StarsDie</span>
	                <span class="date">April 25, 2018 at 2:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435877" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great article! I just have a quick question: because of the inherent nature of the RNN, if we’re trying to understand the fit for y(t), we use information from the past such as y(t-1), y(t-2).. etc. as part of the ‘features’. But when we’re performing prediction, in this example, it seems like the lag values are actually coming from the existing data as well. </p>
<p>In a real world scenario, should we predict for one time step at a time, and then use the predicted values as the ‘past’ values for the next prediction?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435877" onclick="return addComment.moveForm( &quot;comment-435877&quot;, &quot;435877&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to StarsDie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435948" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-435948" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435948" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, there are multiple ways to solve this and I recommend testing each on your specific prediction problem.</p>
<p>For an overview see this post:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<p>For one example with LSTMs see this post:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-435948" onclick="return addComment.moveForm( &quot;comment-435948&quot;, &quot;435948&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436085" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-436085" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/587b244c9af0ff71854d0055d841e892.png" srcset="https://secure.gravatar.com/avatar/587b244c9af0ff71854d0055d841e892?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zou Yanyun</span>
	                <span class="date">April 27, 2018 at 12:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436085" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
This tutorial helps me a lot.<br>
And I want to add more LSTM layers instead of only one LSTM layer, how can I modify the code?<br>
Thank you very much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436085" onclick="return addComment.moveForm( &quot;comment-436085&quot;, &quot;436085&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Zou Yanyun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436096" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-436096" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 27, 2018 at 2:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example of adding more LSTM layers:<br>
<a href="https://machinelearningmastery.com/stacked-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/stacked-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436096" onclick="return addComment.moveForm( &quot;comment-436096&quot;, &quot;436096&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436257" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-436257" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7ad78b380c2a3c83693bed44c1ce94d6.png" srcset="https://secure.gravatar.com/avatar/7ad78b380c2a3c83693bed44c1ce94d6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anindya Sankar Chattopadhyay</span>
	                <span class="date">April 29, 2018 at 10:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436257" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason:</p>
<p>A quick one. The example that is here takes care of multi variate,multi time lag time series. Wondering if there is any example of multi dimension.By that I mean,with the multi variate and multi time lag aspect remaining the same, we want to predict say pollution of not only 1 place but of 2 places.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436257" onclick="return addComment.moveForm( &quot;comment-436257&quot;, &quot;436257&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Anindya Sankar Chattopadhyay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436283" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-436283" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2018 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436283" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is called multi-step, you can see an example here:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436283" onclick="return addComment.moveForm( &quot;comment-436283&quot;, &quot;436283&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436386" class="comment even depth-3">

	      	<div id="li-comment-436386" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7ad78b380c2a3c83693bed44c1ce94d6.png" srcset="https://secure.gravatar.com/avatar/7ad78b380c2a3c83693bed44c1ce94d6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anindya Sankar Chattopadhyay</span>
	                <span class="date">May 1, 2018 at 10:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436386" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436386" onclick="return addComment.moveForm( &quot;comment-436386&quot;, &quot;436386&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Anindya Sankar Chattopadhyay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436323" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-436323" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2efaa53300d55057f09132bc8c5caa92.png" srcset="https://secure.gravatar.com/avatar/2efaa53300d55057f09132bc8c5caa92?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jeremiah</span>
	                <span class="date">April 30, 2018 at 10:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436323" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for such a wonderful post. I am new to this time series data implementation and to be honest, I do not know where to start from. I have this dataset which I am using to predict the activity energy expenditure of a person. I just wanted to find out that using this same preprocessing analysis of converting the data to supervised learning, can I use it on my classification data? If yes, does it mean my t(1) value I want to predict here will be the labels am to predict? Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436323" onclick="return addComment.moveForm( &quot;comment-436323&quot;, &quot;436323&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jeremiah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436344" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436344" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 1, 2018 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436344" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend starting here:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436344" onclick="return addComment.moveForm( &quot;comment-436344&quot;, &quot;436344&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436387" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-436387" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/587b244c9af0ff71854d0055d841e892.png" srcset="https://secure.gravatar.com/avatar/587b244c9af0ff71854d0055d841e892?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zou</span>
	                <span class="date">May 1, 2018 at 10:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436387" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
If I want to use multiple recent time steps to make the prediction for the next time step, that is the window method, how can I do? And I already read one of your tutorials named “Time Series Prediction With Deep Learning in Keras”, the window method was introduced, but there is only one variable in that case. So how can i use the window method when there are multiple input variables?<br>
Thank you so much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436387" onclick="return addComment.moveForm( &quot;comment-436387&quot;, &quot;436387&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Zou">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436416" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436416" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 2, 2018 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436416" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will show you how to prepare data for the window method:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436416" onclick="return addComment.moveForm( &quot;comment-436416&quot;, &quot;436416&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436393" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-436393" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/587b244c9af0ff71854d0055d841e892.png" srcset="https://secure.gravatar.com/avatar/587b244c9af0ff71854d0055d841e892?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zou Yanyun</span>
	                <span class="date">May 1, 2018 at 11:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436393" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for your tutorial. And I’m wondering if I want to use multiple recent time steps to make the prediction for the next time step, what can I do? And I have read one of your posts named “Time Series Prediction With Deep Learning in Keras”, and you mentioned the window method to solve this problem, but there is only one variable in that case, so how can I apply the window method to multiple variables condition?<br>
Thank you so much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436393" onclick="return addComment.moveForm( &quot;comment-436393&quot;, &quot;436393&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Zou Yanyun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436423" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436423" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 2, 2018 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help you prepare your data for the window method:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436423" onclick="return addComment.moveForm( &quot;comment-436423&quot;, &quot;436423&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436554" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-436554" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/587b244c9af0ff71854d0055d841e892.png" srcset="https://secure.gravatar.com/avatar/587b244c9af0ff71854d0055d841e892?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yanyun Zou</span>
	                <span class="date">May 3, 2018 at 9:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for your reply. And I have tried the window method on LSTM network, It seems work worse than using only one previous time step.<br>
And I want to try MLP using the window method, and I have 13 variables, do you have any tutorials about it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436554" onclick="return addComment.moveForm( &quot;comment-436554&quot;, &quot;436554&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Yanyun Zou">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436595" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436595" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 4, 2018 at 7:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436595" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No but I hope to prepare some soon.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436595" onclick="return addComment.moveForm( &quot;comment-436595&quot;, &quot;436595&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436623" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-436623" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b9a7c6feb9fff8a700bde30f49e40b7e.png" srcset="https://secure.gravatar.com/avatar/b9a7c6feb9fff8a700bde30f49e40b7e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dee</span>
	                <span class="date">May 4, 2018 at 1:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436623" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>please help, i got an error when I try to change the codes,</p>
<p>AttributeError: ‘DataFrame’ object has no attribute ‘inverse_transform’</p>
<p>please let me know how to solve this, thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436623" onclick="return addComment.moveForm( &quot;comment-436623&quot;, &quot;436623&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436659" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436659" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 5, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436659" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It looks like you may have modified the code. Perhaps ensure that you copy all of the code exactly.</p>
<p>This might help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436659" onclick="return addComment.moveForm( &quot;comment-436659&quot;, &quot;436659&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436901" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-436901" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a8be19c206c2cfe107cd2859df67892d.png" srcset="https://secure.gravatar.com/avatar/a8be19c206c2cfe107cd2859df67892d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">May 8, 2018 at 12:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436901" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi，Jason.<br>
I have used the model to forecast the numbers of crime of every grid in a street. But the forecast result is exactly the same as test_y. How could I improve the model ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436901" onclick="return addComment.moveForm( &quot;comment-436901&quot;, &quot;436901&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436921" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-436921" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 8, 2018 at 2:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436921" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-436921" onclick="return addComment.moveForm( &quot;comment-436921&quot;, &quot;436921&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437387" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-437387" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a8be19c206c2cfe107cd2859df67892d.png" srcset="https://secure.gravatar.com/avatar/a8be19c206c2cfe107cd2859df67892d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">May 13, 2018 at 12:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437387" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply.<br>
And I want to use the trained model to predict the numbers of crime of every grid.<br>
I input the predict_X , but i don’t know the predict_Y , to use the model , i should assign values to predict_Y randomly.<br>
When i give different values to predict_Y, the final results are also different. Why is it ?<br>
Theoretically, the predict_Y should not influence the forecast results, right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437387" onclick="return addComment.moveForm( &quot;comment-437387&quot;, &quot;437387&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437445" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-437445" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 14, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437445" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure I follow, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437445" onclick="return addComment.moveForm( &quot;comment-437445&quot;, &quot;437445&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437523" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-437523" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/001603fa295ab9d854fca81ea1fed5b3.png" srcset="https://secure.gravatar.com/avatar/001603fa295ab9d854fca81ea1fed5b3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fatemeh</span>
	                <span class="date">May 15, 2018 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437523" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
Thanks for your well-explained examples.<br>
I am using your code to predict the ice-jam occurrence in the rivers in Quebec (Canada)  using daily hydrometeorological variables (i.e. temperature, precipitation, and river discharge). My problem is that I want to develop one model for whole the rivers so there are various data for one day from different rivers. How can I handle this spatial problem?<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437523" onclick="return addComment.moveForm( &quot;comment-437523&quot;, &quot;437523&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fatemeh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437540" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-437540" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 15, 2018 at 8:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437540" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>
<p>Perhaps look up some similar examples in the literature to get an idea of the type/structure of the models used for similar spatial problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437540" onclick="return addComment.moveForm( &quot;comment-437540&quot;, &quot;437540&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437595" class="comment odd alt depth-3">

	      	<div id="li-comment-437595" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/001603fa295ab9d854fca81ea1fed5b3.png" srcset="https://secure.gravatar.com/avatar/001603fa295ab9d854fca81ea1fed5b3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fatemeh</span>
	                <span class="date">May 15, 2018 at 11:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437595" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437595" onclick="return addComment.moveForm( &quot;comment-437595&quot;, &quot;437595&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fatemeh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437616" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-437616" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/03652b12aa9104d7017c3b2aa6b70268.png" srcset="https://secure.gravatar.com/avatar/03652b12aa9104d7017c3b2aa6b70268?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bhanuteja</span>
	                <span class="date">May 16, 2018 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437616" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hii jasoni sir,I reallly like your research blogs in machine learning and so on may i knew how much harder to  be like you and how much time did u take for preparing each blog and writing ur findings in blog can u just summarise how to be master sry doctor like u in machine learning how to prepare ourself i am enthusiastic in machine learning and ai but failing in publishing research paper and publishing it seems hard to get my own finding i am failing from last 1 year and trying to publish a good research work paper in machine learning and artificial intelligence can i have guidance how to master in it and crystal clearly and perfect                                         I personally an below average student thats i regret myself i am seriously expecting few words from u its really helpful to find my self to “regularise” and “fit to ai,ml world research”  i request a few words from ur precious time to correct myself and set to this world.ai</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437616" onclick="return addComment.moveForm( &quot;comment-437616&quot;, &quot;437616&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bhanuteja">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437638" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-437638" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 16, 2018 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437638" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My best advice is to write every day and get critical feedback from your advisor.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437638" onclick="return addComment.moveForm( &quot;comment-437638&quot;, &quot;437638&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437640" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-437640" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/422c54458b97d29b5570dd57b54938eb.png" srcset="https://secure.gravatar.com/avatar/422c54458b97d29b5570dd57b54938eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mah</span>
	                <span class="date">May 16, 2018 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437640" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>First of all thanks a lot for this nice article. I just have a question here. I have a similar use case when I would like to predict power based on sensors data. However, I have multiple assets (30 Turbines). I am wondering if I can just simply add an ID column (1 to 30) and use the same approach? I appreciate if you can help me with this.</p>
<p>Thanks so much,<br>
Mah</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437640" onclick="return addComment.moveForm( &quot;comment-437640&quot;, &quot;437640&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437649" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-437649" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/422c54458b97d29b5570dd57b54938eb.png" srcset="https://secure.gravatar.com/avatar/422c54458b97d29b5570dd57b54938eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ma</span>
	                <span class="date">May 16, 2018 at 8:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you have an example of this:</p>
<p>Predict the pollution for the next hour as above and given the “expected” weather conditions for the next hour.</p>
<p>First Question:<br>
Basically in a real world scenario, I have a set of features (sensors), for some of them like temperature, I have the expected value that I can use for prediction. However, for some of the features, I don’t have any expected value and I need to use the past values. Is it possible to do this?</p>
<p>Second question: I was looking at this post:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a><br>
In addition to predict the outcome variable for time t, I would like to do that for more timessteps ahead. If I Don’t have any expected value of my features other than the current value at t, I assume I cannot do the multi step time series forecasting for t+1, t+2 and t+3. right? For some features I have expected values like temperature and wind speed but not for every single feature. </p>
<p>I really appreciate your comment.</p>
<p>Thanks,<br>
Mah</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437649" onclick="return addComment.moveForm( &quot;comment-437649&quot;, &quot;437649&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437714" class="comment byuser comment-author-jasonb bypostauthor even depth-3 parent">

	      	<div id="li-comment-437714" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 17, 2018 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437714" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I believe this is what the tutorial shows.</p>
<p>Yes, you can predict the future from the past, this is the field of time series forecasting:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>
<p>Yes, here is an example of multi-step forecasting with an LSTM:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437714" onclick="return addComment.moveForm( &quot;comment-437714&quot;, &quot;437714&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437749" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-437749" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/422c54458b97d29b5570dd57b54938eb.png" srcset="https://secure.gravatar.com/avatar/422c54458b97d29b5570dd57b54938eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mah</span>
	                <span class="date">May 17, 2018 at 11:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437749" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks so much for your quick reply.</p>
<p>In your multivariate time series example in this port (Train On Multiple Lag Timesteps Example), can we do multi step forecasting and predict pollution for t, t+1, t +2 and t+3?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437749" onclick="return addComment.moveForm( &quot;comment-437749&quot;, &quot;437749&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437767" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-437767" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 17, 2018 at 3:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437767" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437712" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-437712" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 17, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437712" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can try to model each case standalone or try to model groups or even all cases together.</p>
<p>No need to add id’s as they do likely do not contain information.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437712" onclick="return addComment.moveForm( &quot;comment-437712&quot;, &quot;437712&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437710" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-437710" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8677c8d9a90844c508c168cd72874b64.png" srcset="https://secure.gravatar.com/avatar/8677c8d9a90844c508c168cd72874b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">May 17, 2018 at 5:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, how can i change the problem setting in case i have 4 different datasets, 1 for each monitoring station of PM2.5. Should i create a LSTM neural network model for each station or there is a way to do it with only one neural network?<br>
Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437710" onclick="return addComment.moveForm( &quot;comment-437710&quot;, &quot;437710&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Marco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437740" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-437740" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 17, 2018 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437740" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try modeling each standalone and all together and double down on what works best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437740" onclick="return addComment.moveForm( &quot;comment-437740&quot;, &quot;437740&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437811" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-437811" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e6f227e0ff1e9a1bd15f800a6781b8ac.png" srcset="https://secure.gravatar.com/avatar/e6f227e0ff1e9a1bd15f800a6781b8ac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sara</span>
	                <span class="date">May 18, 2018 at 1:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437811" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would like to thank you firstly for this nice job. I have a question that concerns a different case.<br>
The idea is to make a prediction at time ‘t’ based on the values of this feature at time ‘t-1’ and an other feature at time “t”.</p>
<p>A real use case: we want to make prediction of the solar power production of tomorrow giving the historical production data and the temperature of tomorrow (given the value of production of today and we know that tomorrow will be hot 35° for example what will be the estimation of the production for tomorrow )<br>
How can use the RNN and LSTM in this case?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437811" onclick="return addComment.moveForm( &quot;comment-437811&quot;, &quot;437811&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437836" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-437836" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 18, 2018 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437836" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Use can use the above example as a template for getting started.</p>
<p>What problem are you having exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437836" onclick="return addComment.moveForm( &quot;comment-437836&quot;, &quot;437836&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437957" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-437957" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5789ddd0a76af869ed4079213d68c9b4.png" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thabet</span>
	                <span class="date">May 19, 2018 at 5:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437957" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Is there a way to find what input that contributed the most to affect the output?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437957" onclick="return addComment.moveForm( &quot;comment-437957&quot;, &quot;437957&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Thabet">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438007" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438007" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 20, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438007" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can try removing one feature at a time from the model and evaluate the impact.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438007" onclick="return addComment.moveForm( &quot;comment-438007&quot;, &quot;438007&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437967" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-437967" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3c7948e8727300a75b35f9dbbe9ab0b2.jpeg" srcset="https://secure.gravatar.com/avatar/3c7948e8727300a75b35f9dbbe9ab0b2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ikram</span>
	                <span class="date">May 19, 2018 at 9:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for this amazing article.<br>
My question is : can we add more hidden layers for example two or three ? if yes, how can I do this ? Which part of code should i modify ?</p>
<p># design network<br>
model = Sequential()<br>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
model.add(Dense(1))<br>
model.compile(loss=’mae’, optimizer=’adam’)<br>
# fit network<br>
history = model.fit(train_X, train_y, epochs=50, batch_size=72, validation_data=(test_X, test_y), verbose=2, shuffle=False)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-437967" onclick="return addComment.moveForm( &quot;comment-437967&quot;, &quot;437967&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to ikram">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438010" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438010" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 20, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, here is more info on stacking LSTMs:<br>
<a href="https://machinelearningmastery.com/stacked-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/stacked-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438010" onclick="return addComment.moveForm( &quot;comment-438010&quot;, &quot;438010&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438108" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-438108" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f433fcfc456c050b6d26107ac921c12.png" srcset="https://secure.gravatar.com/avatar/1f433fcfc456c050b6d26107ac921c12?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anwesha</span>
	                <span class="date">May 21, 2018 at 10:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438108" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi! Do you know what embedding’s are? Also is it possible to use RNN’s for unsupervised learning and predict for multivariate time series?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438108" onclick="return addComment.moveForm( &quot;comment-438108&quot;, &quot;438108&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Anwesha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438116" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438116" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 21, 2018 at 2:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438116" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have an introduction to embeddings for NLP here:<br>
<a href="https://machinelearningmastery.com/what-are-word-embeddings/" rel="nofollow">https://machinelearningmastery.com/what-are-word-embeddings/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438116" onclick="return addComment.moveForm( &quot;comment-438116&quot;, &quot;438116&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438127" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-438127" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/508f37acd06f89c5839bfadf9e22c360.png" srcset="https://secure.gravatar.com/avatar/508f37acd06f89c5839bfadf9e22c360?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">enri</span>
	                <span class="date">May 21, 2018 at 5:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438127" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Would this be the right approach to take if I wanted forecast for a certain timeframe? Say, I have timeseries data in 2min buckets for January 2018 and February 2018, and I wanted to forecast based on two independent variables for the first week of March to determine some dependent variable. I have data for the two independent variables, also in 2min buckets, but I’m trying to predict the dependent variable. Reading through this blog, I think this is the approach I want to take — it makes a lot of sense to me. However, I’m having trouble making sense of predicting that first week of March in isolation. </p>
<p>1) Do I use the complete data from January 2018 and February 2018 to develop a training and testing sample, and then use the model to predict the March timeseries? Running into some errors in this, so I’m assuming this is not the right approach, but open to feedback.</p>
<p>2) Do I include the March timeseries in the testing sample and get the resulting values from that? If so, how does one map these testing values (predictions) to the the original timeseries/timeframe. </p>
<p>Regardless of either approach, what is the right way of mapping back the prediction of ‘foo’ back to timeframe ‘bar’? Perhaps this is a straight index lookup? There should be an easier way, no?</p>
<p>Thank you very much! This blog was very helpful <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438127" onclick="return addComment.moveForm( &quot;comment-438127&quot;, &quot;438127&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to enri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438195" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438195" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 22, 2018 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438195" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend trying a suite of approaches and see what works best for your data. </p>
<p>Be systematic and use data/results to make decisions around model design.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438195" onclick="return addComment.moveForm( &quot;comment-438195&quot;, &quot;438195&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438140" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-438140" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/be25e56c9b1b0f715c58041ff127bc5e.png" srcset="https://secure.gravatar.com/avatar/be25e56c9b1b0f715c58041ff127bc5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kg</span>
	                <span class="date">May 21, 2018 at 7:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438140" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks a lot for all clear explanations. what if I want to predict all the variables at the time (t+1)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438140" onclick="return addComment.moveForm( &quot;comment-438140&quot;, &quot;438140&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to kg">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438200" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438200" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 22, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438200" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Change the the model to output a vector or change the model to be a seq2seq such as an encoder-decoder.</p>
<p>I have examples of both approaches on the blog, use the search.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438200" onclick="return addComment.moveForm( &quot;comment-438200&quot;, &quot;438200&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438359" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-438359" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6a92d08d286686aed4d66602b216e5e5.png" srcset="https://secure.gravatar.com/avatar/6a92d08d286686aed4d66602b216e5e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kevin</span>
	                <span class="date">May 23, 2018 at 10:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,  I read your this article and run the code.</p>
<p>However, it works just like persistence model~ I’m so confused</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438359" onclick="return addComment.moveForm( &quot;comment-438359&quot;, &quot;438359&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kevin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438407" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438407" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 24, 2018 at 8:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438407" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, LSTMs and neural nets in general are poor a time series forecasting, learn more here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-use-lstms-for-time-series-forecasting" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-use-lstms-for-time-series-forecasting</a></p>
<p>Nevertheless, there is huge demand for knowing how to do it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438407" onclick="return addComment.moveForm( &quot;comment-438407&quot;, &quot;438407&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438585" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-438585" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/05302c6e3af8a7af80ee1c96f93c29bc.png" srcset="https://secure.gravatar.com/avatar/05302c6e3af8a7af80ee1c96f93c29bc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gene</span>
	                <span class="date">May 25, 2018 at 12:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Lots of fun debugging this code!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438585" onclick="return addComment.moveForm( &quot;comment-438585&quot;, &quot;438585&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Gene">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438600" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438600" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 25, 2018 at 2:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438600" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438600" onclick="return addComment.moveForm( &quot;comment-438600&quot;, &quot;438600&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438859" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-438859" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cbe8663b3e9e0d78ee7b6d35d3af6893.png" srcset="https://secure.gravatar.com/avatar/cbe8663b3e9e0d78ee7b6d35d3af6893?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anwar</span>
	                <span class="date">May 28, 2018 at 3:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438859" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Using the same test set for validation during training and then for prediction wouldn’t cause biasness. If yes, how to specify a validation set from the training set.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438859" onclick="return addComment.moveForm( &quot;comment-438859&quot;, &quot;438859&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Anwar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438878" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438878" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 28, 2018 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438878" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It would introduce a bias.</p>
<p>Try not to use the validation set too often.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438878" onclick="return addComment.moveForm( &quot;comment-438878&quot;, &quot;438878&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438889" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-438889" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6bdd28113dfc934c21318e8730bc7843.png" srcset="https://secure.gravatar.com/avatar/6bdd28113dfc934c21318e8730bc7843?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://catasana.com/" rel="external nofollow" class="url">Phillip Otero</a></span>
	                <span class="date">May 28, 2018 at 9:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438889" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, Ran your model with a 15 min timestamp dataset with 11 features. Used a  2 period lookback var1(t-2) and a forecast with var1(t+1).  Since the output is an array of 11 features, how can I reconcile these forecasted sequences (inv_yhat) with my original timestamps? Pls let me know if you want me to send my data and model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438889" onclick="return addComment.moveForm( &quot;comment-438889&quot;, &quot;438889&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Phillip Otero">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438915" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438915" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 28, 2018 at 2:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438915" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The number of output time steps will match the number of input time steps directly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438915" onclick="return addComment.moveForm( &quot;comment-438915&quot;, &quot;438915&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438949" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-438949" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/14e4cf42a4f1e8cacd26ac6d207bfe68.png" srcset="https://secure.gravatar.com/avatar/14e4cf42a4f1e8cacd26ac6d207bfe68?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">May 29, 2018 at 2:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438949" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How do I get the result values themselves (not the diffs). Let’s say I wanna output them.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438949" onclick="return addComment.moveForm( &quot;comment-438949&quot;, &quot;438949&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438972" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438972" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 29, 2018 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Invert the diff operation.</p>
<p>There’s an example in this post for example:<br>
<a href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="nofollow">https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438972" onclick="return addComment.moveForm( &quot;comment-438972&quot;, &quot;438972&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438988" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-438988" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2fc5c229a4ee18415000370f469635f8.png" srcset="https://secure.gravatar.com/avatar/2fc5c229a4ee18415000370f469635f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jurek</span>
	                <span class="date">May 29, 2018 at 2:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438988" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
First of all thank you for sharing your knowledge. I learn a ton of things reading your blog.</p>
<p>My question is bit tricky. How would you aproach mv time series problem but not on one long observation, like in the example but on multiple smaller observations with diferent features of the same problem?<br>
They can last for 40 to 180 days and can also overlap each other so one starts and next one starts after lets say 14 days and they run parallel. Then 3rd one starts and so on.</p>
<p>What I come up with:<br>
I was thinking of showing  observations like “slides” and train on single observations and save them somehow. End slide will be my observation that I want to predict. My concern is that showing multiple “slides” will confuse the network and it won’t be able to give good prediction.</p>
<p>Can you coment on that? How would you approach this problem? MAybe someone already did that and you can point me in the right direction?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438988" onclick="return addComment.moveForm( &quot;comment-438988&quot;, &quot;438988&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jurek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438996" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-438996" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 29, 2018 at 2:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438996" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure I follow sorry.</p>
<p>Do you mean discontinuous observations over time?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-438996" onclick="return addComment.moveForm( &quot;comment-438996&quot;, &quot;438996&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439024" class="comment even depth-3 parent">

	      	<div id="li-comment-439024" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2fc5c229a4ee18415000370f469635f8.png" srcset="https://secure.gravatar.com/avatar/2fc5c229a4ee18415000370f469635f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jurek</span>
	                <span class="date">May 29, 2018 at 9:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok, maybe example will cast some light:</p>
<p>lets say you have time series starting 2016-01-01 it lasts for 90 days<br>
2nd starting 2016-01-20 lasting 90 days<br>
3rd starting 2016-02-10 lasting 90 days</p>
<p>They all fall into same category but they have different features resulting in different outcomes</p>
<p>Now I have 4th starting 2016-03-30 and it will last for 90 days. Based on trained data from 1, 2, 3 I want to forecast 4</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439024" onclick="return addComment.moveForm( &quot;comment-439024&quot;, &quot;439024&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jurek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439072" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-439072" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 30, 2018 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439072" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must get creative and try many different framings of the problem to see what works best.</p>
<p>Perhaps ignore the difference in periods and treat them as parallel variates?<br>
Perhaps pad all variates to the same lengths?<br>
Perhaps not all variates are useful?<br>
… </p>
<p>Brainstorm and test.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439072" onclick="return addComment.moveForm( &quot;comment-439072&quot;, &quot;439072&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439035" class="comment even thread-even depth-1">

	      	<div id="li-comment-439035" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e6f227e0ff1e9a1bd15f800a6781b8ac.png" srcset="https://secure.gravatar.com/avatar/e6f227e0ff1e9a1bd15f800a6781b8ac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sara</span>
	                <span class="date">May 30, 2018 at 12:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439035" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thank you for nice tuto,<br>
I have a problem when I tested the code on my own data </p>
<p>after computing the inverse transform, the inv_y does not match with the original test data:</p>
<p>test=dataset[‘consom’].values<br>
test.reshape(-1,1)<br>
test[n_train:]</p>
<p>* n_train is n_train_hours in your code and consom is the output (to predict)</p>
<p>test: array([ 54.779979,  56.330428,  55.546604, …,  43.95959 ,  43.196657,<br>
        43.160589])</p>
<p>inv_y: array([ 5.70597649,  5.62580299,  5.35393763, …,  4.44062805,<br>
        4.36259127,  4.35890198], dtype=float32)</p>
<p>could you help me please, thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439035" onclick="return addComment.moveForm( &quot;comment-439035&quot;, &quot;439035&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-439038" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439038" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ff8f471e11755d04c0755d9b70600181.png" srcset="https://secure.gravatar.com/avatar/ff8f471e11755d04c0755d9b70600181?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sarthak</span>
	                <span class="date">May 30, 2018 at 1:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439038" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I really like your blogs and these are really knowledgeable. Thank you for doing this.</p>
<p>I have a question, when i graph the test_y and predicted_y, the predicted_y is shifted to the right .Its not completed shifted it does overlaps over some of the points especially the minimum. Is there a way to make it better</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439038" onclick="return addComment.moveForm( &quot;comment-439038&quot;, &quot;439038&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sarthak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439050" class="comment even depth-2">

	      	<div id="li-comment-439050" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ff8f471e11755d04c0755d9b70600181.png" srcset="https://secure.gravatar.com/avatar/ff8f471e11755d04c0755d9b70600181?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sarthak</span>
	                <span class="date">May 30, 2018 at 4:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439050" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I figured it out i just added more time steps but now the problem is that is over-fitting. I have multiple data-sets so it works really well for most of them. </p>
<p>Thank you again for this blog</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439050" onclick="return addComment.moveForm( &quot;comment-439050&quot;, &quot;439050&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sarthak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-439077" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439077" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 30, 2018 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439077" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>
<p>I have some suggestions here:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439077" onclick="return addComment.moveForm( &quot;comment-439077&quot;, &quot;439077&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439040" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-439040" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8a920b6067b827eed84de2d2223a511a.png" srcset="https://secure.gravatar.com/avatar/8a920b6067b827eed84de2d2223a511a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ferda</span>
	                <span class="date">May 30, 2018 at 1:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, thanks for this great tutorial. Could you please answer why did you give LSTM 50 neurons although data has 7 features. Weren’t 7 nodes (aount of features) would be enough for this, or, For example why didn’t you give 100 ?</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439040" onclick="return addComment.moveForm( &quot;comment-439040&quot;, &quot;439040&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ferda">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439078" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439078" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 30, 2018 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I configured the network via trial and error.</p>
<p>The number nodes in the hidden layer is unrelated to the number of input and output time steps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439078" onclick="return addComment.moveForm( &quot;comment-439078&quot;, &quot;439078&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439156" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439156" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/db8e508d654fa671f47047dc7e41b1d3.png" srcset="https://secure.gravatar.com/avatar/db8e508d654fa671f47047dc7e41b1d3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.ashleykleinhans.com/" rel="external nofollow" class="url">Ashley Kleinhans</a></span>
	                <span class="date">May 30, 2018 at 11:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439156" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi. I am trying to build my own! I have data which is days rather than hours. I have 3 years of days and I want to predict a week ahead. So each week I would like to run my model on a Tuesday and produce an output (linear value of percentage) for each day of the coming week – Wednesday to Wednesday. Right now though I am just starting and what I have done is divide my training and test set as follows:</p>
<p>n_train_days = math.floor(tot_days * 0.8)<br>
train = values[:n_train_days, :]<br>
test = values[n_train_days:, :] </p>
<p>These are my training and test shapes:</p>
<p>(298, 21, 11) (298,) (75, 21, 11) (75,)</p>
<p>Which come originally from: </p>
<p>values = reframed.values</p>
<p>Which has the shape: </p>
<p>(373, 242)</p>
<p>– I have 11 features and n_days = 21 (so 3 weeks of training) </p>
<p>Everything runs and at the end, I get inv_yhat and inv_y to plot, but I have an issue: I want to plot them against another model (ARIMA) output and the actual dates that they occur. So I go back to my original csv file and I extract what I think is the dates:</p>
<p>data_csv = load_csv(data.csv)<br>
test_dates = data_csv[‘DATES’][n_train_days:]<br>
arima_out = data_csv[‘ARIMA’][n_train_days:]</p>
<p>Now I want to plot inv_yhat and arima_out against dates – but the lengths are different:</p>
<p>Length of test_dates : 96, Length of arima_out : 96, Length of inv_yhat : 75, Length of inv_y : 75</p>
<p>I am confusing myself. Can you help me, please?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439156" onclick="return addComment.moveForm( &quot;comment-439156&quot;, &quot;439156&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashley Kleinhans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439188" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-439188" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 31, 2018 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m eager to help, but I don’t have the capacity to debug your code. I’m sure you can understand.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439188" onclick="return addComment.moveForm( &quot;comment-439188&quot;, &quot;439188&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439307" class="comment even depth-3 parent">

	      	<div id="li-comment-439307" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04e4a402eaa96ad743767cb09ba496bb.jpeg" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashley</span>
	                <span class="date">June 1, 2018 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439307" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks – it’s all working correctly! no debugging needed! I just need to understand why there is a change in dimensions when going to a supervisory learning problem. </p>
<p>My original data has 96 rows in the test set. but for some reason when making test and training sets I get 75 – its a 3-week difference, 21 days. But which three weeks is it, does the training set actually have 21 more days, and the test set have 21 less?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439307" onclick="return addComment.moveForm( &quot;comment-439307&quot;, &quot;439307&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashley">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439340" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-439340" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 1, 2018 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439340" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps it is related to your chosen lag?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439340" onclick="return addComment.moveForm( &quot;comment-439340&quot;, &quot;439340&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439428" class="comment even depth-5">

	      	<div id="li-comment-439428" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04e4a402eaa96ad743767cb09ba496bb.jpeg" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashley</span>
	                <span class="date">June 1, 2018 at 10:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. I think so. I shifted the input to just continue as if three weeks had already gone past. But I thought this was too simple. But simple is always better!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439273" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-439273" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7b9fe804ef2f5848d89870caced42bcb.png" srcset="https://secure.gravatar.com/avatar/7b9fe804ef2f5848d89870caced42bcb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dominik</span>
	                <span class="date">June 1, 2018 at 12:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439273" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why in line<br>
inv_y = concatenate((test_y, test_X[:, -7:]), axis=1)<br>
there’s a “-7” ? I guess its something with number of features but then why didn’t you use the “n_features” variable here?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439273" onclick="return addComment.moveForm( &quot;comment-439273&quot;, &quot;439273&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dominik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439331" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-439331" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 1, 2018 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439331" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct.</p>
<p>Learn more about working with numpy arrays here:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439331" onclick="return addComment.moveForm( &quot;comment-439331&quot;, &quot;439331&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439276" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439276" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b2961dae20543513e71a3b5a3b6aad9e.png" srcset="https://secure.gravatar.com/avatar/b2961dae20543513e71a3b5a3b6aad9e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kay</span>
	                <span class="date">June 1, 2018 at 12:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439276" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Matt,</p>
<p>Very good example, but I want to use LSTM method on my data. Due to multiple reasons, the time series includes 10% missing data. Do you have some suggestions on this problem?</p>
<p>Thanks,</p>
<p>Best,<br>
jay</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439276" onclick="return addComment.moveForm( &quot;comment-439276&quot;, &quot;439276&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to kay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439332" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-439332" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 1, 2018 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439332" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here are some examples for working with missing data:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-handle-missing-data" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-handle-missing-data</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439332" onclick="return addComment.moveForm( &quot;comment-439332&quot;, &quot;439332&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439298" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-439298" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/03e3df0f65d51d30adea92e21e3156f2.png" srcset="https://secure.gravatar.com/avatar/03e3df0f65d51d30adea92e21e3156f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anderson D</span>
	                <span class="date">June 1, 2018 at 4:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439298" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,</p>
<p>I have a question about your preprocessing step – a lot of sources state that data normalization should be done separately on test and train but in your example you normalize the data and then split into test and training datasets. Is there something that I’m missing or does this not matter?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439298" onclick="return addComment.moveForm( &quot;comment-439298&quot;, &quot;439298&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Anderson D">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439338" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-439338" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 1, 2018 at 8:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439338" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, that is correct. I simplified data preparation in this tutorial to focus on the learning method.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439338" onclick="return addComment.moveForm( &quot;comment-439338&quot;, &quot;439338&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439431" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439431" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04e4a402eaa96ad743767cb09ba496bb.jpeg" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashley</span>
	                <span class="date">June 1, 2018 at 11:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439431" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I want to predict more than a day ahead – so I have 3 weeks in and one week out (like 21*24 hrs and 7*24 out) do I just update the Dense(1) to be Dense(7) ? </p>
<p>When I try this I get an error: </p>
<p>ValueError: Error when checking target: expected dense_11 to have shape (7,) but got array with shape (1,)</p>
<p>And it comes from this line</p>
<p>—&gt; 10 history = model.fit(train_X, train_y, epochs=50, batch_size=12, validation_data=(test_X, test_y), verbose=2, shuffle=False)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439431" onclick="return addComment.moveForm( &quot;comment-439431&quot;, &quot;439431&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashley">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439476" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-439476" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have an example here of multiple-step forecasts that you can use as a template:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439476" onclick="return addComment.moveForm( &quot;comment-439476&quot;, &quot;439476&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439812" class="comment odd alt depth-3">

	      	<div id="li-comment-439812" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04e4a402eaa96ad743767cb09ba496bb.jpeg" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashley</span>
	                <span class="date">June 5, 2018 at 5:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439812" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439812" onclick="return addComment.moveForm( &quot;comment-439812&quot;, &quot;439812&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashley">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439915" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-439915" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8f6e7ab83e75f845f700ee2432fb3e87.png" srcset="https://secure.gravatar.com/avatar/8f6e7ab83e75f845f700ee2432fb3e87?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.vincentgranville.com/" rel="external nofollow" class="url">vincent granville</a></span>
	                <span class="date">June 6, 2018 at 12:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439915" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I just published a new book related to time series: </p>
<p>Full title: Applied Stochastic Processes, Chaos Modeling, and Probabilistic Properties of Numeration Systems. Published June 2, 2018. Author: Vincent Granville, PhD. (104 pages, 16 chapters.)</p>
<p>This book is intended for professionals in data science, computer science, operations research, statistics, machine learning, big data, and mathematics. In 100 pages, it covers many new topics, offering a fresh perspective on the subject. It is accessible to practitioners with a two-year college-level exposure to statistics and probability. The compact and tutorial style, featuring many applications (Blockchain, quantum algorithms, HPC, random number generation, cryptography, Fintech, web crawling, statistical testing) with numerous illustrations, is aimed at practitioners, researchers and executives in various quantitative fields.</p>
<p>New ideas, advanced topics, and state-of-the-art research are discussed in simple English, without using jargon or arcane theory. It unifies topics that are usually part of different fields (data science, operations research, dynamical systems, computer science, number theory, probability) broadening the knowledge and interest of the reader in ways that are not found in any other book. This short book contains a large amount of condensed material that would typically be covered in 500 pages in traditional publications. Thanks to cross-references and redundancy, the chapters can be read independently, in random order.</p>
<p>This book is available for Data Science Central members exclusively. The text in blue consists of clickable links to provide the reader with additional references.  Source code and Excel spreadsheets summarizing computations, are also accessible as hyperlinks for easy copy-and-paste or replication purposes. The most recent version of this book is available from this link, accessible to DSC members only. </p>
<p>About the author</p>
<p>Vincent Granville is a start-up entrepreneur, patent owner, author, investor, pioneering data scientist with 30 years of corporate experience in companies small and large (eBay, Microsoft, NBC, Wells Fargo, Visa, CNET) and a former VC-funded executive, with a strong academic and research background including Cambridge University.</p>
<p>For details about the book, go to <a href="https://www.datasciencecentral.com/profiles/blogs/fee-book-applied-stochastic-processes" rel="nofollow">https://www.datasciencecentral.com/profiles/blogs/fee-book-applied-stochastic-processes</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439915" onclick="return addComment.moveForm( &quot;comment-439915&quot;, &quot;439915&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to vincent granville">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439943" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439943" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 6, 2018 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439943" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439943" onclick="return addComment.moveForm( &quot;comment-439943&quot;, &quot;439943&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439953" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439953" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/58223d7b4ac1dd14b4231ca6f3adec91.png" srcset="https://secure.gravatar.com/avatar/58223d7b4ac1dd14b4231ca6f3adec91?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">akn</span>
	                <span class="date">June 6, 2018 at 8:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439953" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Your website is a treasure of knowledge on Neural networks and Machine learning. Thank you so much for sharing with others.<br>
I am trying to implement a time series forecasting where each row in my dataset has 3 columns: timestamp, 2D numpy array(10000×6000), float32. The numpy array is my input data in each row.<br>
I have decided to use input of previous 12 timesteps and predict output for 4 future timesteps. I have a couple of questions, and hoping to find answers here:</p>
<p>1. Can I only have the numpy arrays in my input sequence without having the output value ? (in your example I see var1(t-1) … var8(t-1) and then  var1(t). This means the var1 is being forecasted and you have var1 in input sequence as well. </p>
<p>2. what is the best way to use a 2D array as input ? I am flattening it to a 1D array but its too big.</p>
<p>3. if my dataset is a dataframe with columns X, y where X is my input and y is the output, can we use the LSTM to predict  say, y[11]  through y[15] using X[1] through X[10] as input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439953" onclick="return addComment.moveForm( &quot;comment-439953&quot;, &quot;439953&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to akn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439971" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439971" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 6, 2018 at 2:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439971" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Yes, data must be in numpy arrays.</p>
<p>My best advice on preparing data is here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439971" onclick="return addComment.moveForm( &quot;comment-439971&quot;, &quot;439971&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439967" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-439967" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/58223d7b4ac1dd14b4231ca6f3adec91.png" srcset="https://secure.gravatar.com/avatar/58223d7b4ac1dd14b4231ca6f3adec91?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">akn</span>
	                <span class="date">June 6, 2018 at 1:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thank you for sharing your wealth of knowledge with every one !!</p>
<p>I am attempting to forecast a specific value for next 5 timesteps. Here is how my data looks:</p>
<p>time               input                     output<br>
timestamp   2D numpy array     float32</p>
<p>In the above example, I have seen that var1 is the input, and var2 is the output. I see totally 8 variables created where var1 is mentioned twice. This indicates you are adding the output variable also as part of input sequence. </p>
<p>Is this mandatory ? Or, can we have intput variables in the following way :<br>
var2 through var8 for (t-1) and predict var1 for t, t+1</p>
<p>Also, is it valid to use a 1D numpy array as an input variable, just wanted to confirm since I haven’t seen this in examples</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439967" onclick="return addComment.moveForm( &quot;comment-439967&quot;, &quot;439967&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to akn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439974" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439974" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 6, 2018 at 2:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can frame your problem any way you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439974" onclick="return addComment.moveForm( &quot;comment-439974&quot;, &quot;439974&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439968" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439968" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8cd9067dbed519ef13d39f71d7fe9200.png" srcset="https://secure.gravatar.com/avatar/8cd9067dbed519ef13d39f71d7fe9200?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tin</span>
	                <span class="date">June 6, 2018 at 1:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439968" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for the post, it is so great. I have two quick question after go through it.</p>
<p>1. how did you decide the batch size? is there any rule to follow?<br>
2. The input data you use for each time step is 1×8 (8 attributes for one feature), could we update it into nxm dimension? I mean for each time step we have n training samples and each of them contains m attributes. If we could, where is the best palce to change the code?</p>
<p>Thx, Tin</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439968" onclick="return addComment.moveForm( &quot;comment-439968&quot;, &quot;439968&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439975" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439975" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 6, 2018 at 2:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439975" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I used trial and error and careful experimentation.</p>
<p>Yes, you can change the lag in the call to transform the data from time series to supervised to add more past observations as input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-439975" onclick="return addComment.moveForm( &quot;comment-439975&quot;, &quot;439975&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440006" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-440006" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashish</span>
	                <span class="date">June 6, 2018 at 11:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440006" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How many attribute did you have used for predicting pollution? Kindly specify with code.<br>
Where have you used date in your code as it is present in the data set?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440006" onclick="return addComment.moveForm( &quot;comment-440006&quot;, &quot;440006&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440041" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-440041" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 7, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440041" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>All input attributes were used.</p>
<p>Date is discarded as the observations are contiguous and evenly spaced in time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440041" onclick="return addComment.moveForm( &quot;comment-440041&quot;, &quot;440041&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440025" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-440025" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/422c54458b97d29b5570dd57b54938eb.png" srcset="https://secure.gravatar.com/avatar/422c54458b97d29b5570dd57b54938eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mah</span>
	                <span class="date">June 7, 2018 at 3:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440025" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. </p>
<p>I am getting the following when I want to calculate the rsme. Actually the error comes from concatenate((yhat, test_X[:, 1:]), axis=1)<br>
Any idea?</p>
<p>from numpy import concatenate<br>
from keras.layers import concatenate<br>
from keras.layers import *<br>
# invert scaling for forecast<br>
inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)<br>
inv_yhat = scaler.inverse_transform(inv_yhat)<br>
inv_yhat = inv_yhat[:,0]</p>
<p>Layer concatenate_1 was called with an input that isn’t a symbolic tensor. Received type: . Full input: [(array([[0.03575472],</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440025" onclick="return addComment.moveForm( &quot;comment-440025&quot;, &quot;440025&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440049" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-440049" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 7, 2018 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some ideas here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440049" onclick="return addComment.moveForm( &quot;comment-440049&quot;, &quot;440049&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-443893" class="comment even depth-2">

	      	<div id="li-comment-443893" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/78ad8f65806e75ac5ff9f754655f8ed9.png" srcset="https://secure.gravatar.com/avatar/78ad8f65806e75ac5ff9f754655f8ed9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">JJZ</span>
	                <span class="date">July 19, 2018 at 5:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443893" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I got the same error as you and I found that you just have to remove the “from keras.layers import concatenate” line to fix that error.</p>
<p>Seems like compiler confused and use keras’s concatenate instead of numpy’s.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443893" onclick="return addComment.moveForm( &quot;comment-443893&quot;, &quot;443893&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to JJZ">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-443894" class="comment odd alt depth-2">

	      	<div id="li-comment-443894" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/78ad8f65806e75ac5ff9f754655f8ed9.png" srcset="https://secure.gravatar.com/avatar/78ad8f65806e75ac5ff9f754655f8ed9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">JJT</span>
	                <span class="date">July 19, 2018 at 5:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have better idea for you.</p>
<p>The compiler is confusing about which concatenate to use.</p>
<p>Just remove “from keras.layers import concatenate” and you are good to go.</p>
<p>Or better…</p>
<p>import numpy as np</p>
<p>then use np.concatenate instead of just concatenate from now on.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443894" onclick="return addComment.moveForm( &quot;comment-443894&quot;, &quot;443894&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to JJT">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-445465" class="comment even depth-2">

	      	<div id="li-comment-445465" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/acc1334b29cf1badb198361deaa12998.png" srcset="https://secure.gravatar.com/avatar/acc1334b29cf1badb198361deaa12998?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mr.Wu</span>
	                <span class="date">August 7, 2018 at 8:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445465" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi，I met the same problem,and I have make it, you can try this:<br>
from numpy import concatenate, sqrt<br>
from sklearn.metrics import mean_squared_error</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445465" onclick="return addComment.moveForm( &quot;comment-445465&quot;, &quot;445465&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mr.Wu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440106" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-440106" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/00f9c7a663e6faab5f7b07be12067c73.png" srcset="https://secure.gravatar.com/avatar/00f9c7a663e6faab5f7b07be12067c73?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">AmitG</span>
	                <span class="date">June 7, 2018 at 10:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440106" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I have been following your tutorial. You mention in the initial parts that one can predict the pollution for the next hour as above and given the “expected” weather conditions for the next hour. I have been trying to do the same but in my case it I have 6 variables and i have to predict the sixth variable for time t+1  based on the expected five for t+1.<br>
I have noted that you have kept pollution as the first variable in the data set that you have used. This quite nicely translates to your problem of predicting the pollution level for the next timestep when you are using some time lag, e.g. 3 in the tutorial, given pollution and weather variables for previous timesteps. This is because pollution at the next timestep becomes natural for the sequence, as a total of 24 data points are there in the sequence (after taking 3 lags) and the 25th one is naturally the pollution for the next timestep.<br>
For the problem I have at hand, I am facing serious limitations in selecting the number of lags I can use for training. I had to keep the variable to be predicted in the sixth column in the dataset and take a lag of 5 and deliberately keep the features to be equal to 7. That created a sequence of length 36 (I have 6 variables in the data and lag used is 5) and taking the number of features equal to 7 framed the problem in a way that I can predict the 6th variable given the other five variables expected values for the next timestep. I cant use lag 4 because 4*6 = 24, 24-1 = 23 and 23 is not a composite number. I hope I have made the problem clear. </p>
<p>Question:<br>
1) How can I generalize the data preparation for the prediction problem that I have been facing?</p>
<p>Please help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440106" onclick="return addComment.moveForm( &quot;comment-440106&quot;, &quot;440106&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to AmitG">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440157" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-440157" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 8, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440157" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this function will help:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440157" onclick="return addComment.moveForm( &quot;comment-440157&quot;, &quot;440157&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440321" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-440321" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/00f9c7a663e6faab5f7b07be12067c73.png" srcset="https://secure.gravatar.com/avatar/00f9c7a663e6faab5f7b07be12067c73?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">AmitG</span>
	                <span class="date">June 9, 2018 at 8:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440321" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason! thanks for the link.<br>
I have a quick question. </p>
<p>For example- Lets say I have a data frame of 6 variables. 5 of them are weather variables and 1 is a disease incidence variable for a plant. I need to predict the disease incidence given weather at the next timestep. I take a lag of 3, and I end up with 24 columns. So, technically I have to predict the 24th instance, which is the disease, in the sequence and I have to use the sequence of length 23 as the input. How can I achieve that?<br>
I had thought of using the input as (Number of samples, timestep = 1, features = 23).<br>
Is it appropriate if I don’t keep the number of timesteps in the input to LSTM equal to the number of lags I have taken? </p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440321" onclick="return addComment.moveForm( &quot;comment-440321&quot;, &quot;440321&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to AmitG">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440347" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-440347" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 10, 2018 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440347" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You would have 3 time steps, and 5 features.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440347" onclick="return addComment.moveForm( &quot;comment-440347&quot;, &quot;440347&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440159" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-440159" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6e414586915a976767216a6f578e4615.png" srcset="https://secure.gravatar.com/avatar/6e414586915a976767216a6f578e4615?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kingsley Udeh</span>
	                <span class="date">June 8, 2018 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440159" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you so much for the time you have been devoting to questions asked on your blogs. I do really appreciate your selfless service.</p>
<p>Please I have couple of questions regarding the multistep, multivariate time forecasting. I have already seen the articles you wrote on them, but  I have to ask from the following section of your code that I’m adapting to my data:</p>
<p>1. I have 6 features(0-5), and I will like to predict the last feature, is the following code correct?</p>
<p># split into input and outputs<br>
n_obs = hours_past * n_features<br>
train_X, train_y = train[:, :n_obs], train[:, -1]<br>
test_X, test_y = test[:, :n_obs], test[:, -1]</p>
<p>2. Inverting normalization of forecast and actual values like the following :</p>
<p># invert normalization of forecast values<br>
    inv_yhat_i = concatenate((yhat_i, test_X_reshaped[:, 0:4]), axis=1)<br>
    inv_yhat_i = scaler.inverse_transform(inv_yhat_i)<br>
    inv_yhat_i = inv_yhat_i[:,0]</p>
<p>    # invert normalization of actual values<br>
    inv_y_i = concatenate((test_y_i, test_X_reshaped[:, 0:4]), axis=1)<br>
    inv_y_i = scaler.inverse_transform(inv_y_i)<br>
    inv_y_i = inv_y_i[:,0]</p>
<p>produces the following ValueError:</p>
<p>“operands could not be broadcast together with shapes (2958,5) (6,) (2958,5) ”</p>
<p>What am I doing wrong here?<br>
Also, can I forecast more than one features with values from other features?</p>
<p>Thank you again , in advance</p>
<p>Regards,<br>
Kingsley</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440159" onclick="return addComment.moveForm( &quot;comment-440159&quot;, &quot;440159&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kingsley Udeh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440250" class="comment even depth-2 parent">

	      	<div id="li-comment-440250" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6e414586915a976767216a6f578e4615.png" srcset="https://secure.gravatar.com/avatar/6e414586915a976767216a6f578e4615?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kingsley Udeh</span>
	                <span class="date">June 9, 2018 at 5:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440250" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I’m still waiting to hear from you regarding my previous post at your most convinient time.</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440250" onclick="return addComment.moveForm( &quot;comment-440250&quot;, &quot;440250&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kingsley Udeh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440283" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-440283" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 9, 2018 at 6:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440283" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My best advice on how to prepare data for LSTMs is here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440283" onclick="return addComment.moveForm( &quot;comment-440283&quot;, &quot;440283&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440178" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-440178" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/66f51320be65d56f2fb54fa6af4d579f.png" srcset="https://secure.gravatar.com/avatar/66f51320be65d56f2fb54fa6af4d579f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.catasana.com/" rel="external nofollow" class="url">Phillip Otero</a></span>
	                <span class="date">June 8, 2018 at 8:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, I have data consisting of 6,000 time steps by 11 features. I am looking back 3 steps and want to project 2 steps forward for all 11 features. train_X.shape is (1760,33) and train_y.shape is (1760,22). my network design is:</p>
<p># design network<br>
model = Sequential()<br>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2]), return_sequences=True))<br>
model.add(LSTM(50))<br>
model.add(Dense(1))<br>
model.compile(loss=’mae’, optimizer=’adam’)<br>
# fit network<br>
history = model.fit(train_X, train_y, epochs=10, batch_size=32, validation_data=(test_X, test_y), verbose=2, shuffle=False)<br>
print(model.summary())<br>
# plot history<br>
pyplot.plot(history.history[‘loss’], label=’train’)<br>
pyplot.plot(history.history[‘val_loss’], label=’test’)<br>
pyplot.legend()<br>
pyplot.show()<br>
model.save(‘SP-LSTM.h5’)</p>
<p>however I get the following error on my fit line:</p>
<p>ValueError: Error when checking target: expected dense_1 to have shape (1,) but got array with shape (22,)</p>
<p>Also what changes will I need to make to output the two forecast time steps with 11 forecasted features each?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440178" onclick="return addComment.moveForm( &quot;comment-440178&quot;, &quot;440178&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Phillip Otero">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440256" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-440256" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 9, 2018 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440256" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I explain how to prepare data for LSTMs here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440256" onclick="return addComment.moveForm( &quot;comment-440256&quot;, &quot;440256&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440611" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-440611" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f0788916a9fa130b449673180dc9fa6.png" srcset="https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shamsul</span>
	                <span class="date">June 13, 2018 at 12:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440611" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir,<br>
    From my understanding here we are doing uni-variate forecasting considering Multivariate as an input. This can also be called MISO (multiple variable as an input and single variable as an output) technique.</p>
<p>    how we can we do MIMO (multiple variable as an input and multiple variable as an output) ?</p>
<p>    please do correct me if i am wrong?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440611" onclick="return addComment.moveForm( &quot;comment-440611&quot;, &quot;440611&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to shamsul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440639" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-440639" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 13, 2018 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The above tutorial does exactly this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440639" onclick="return addComment.moveForm( &quot;comment-440639&quot;, &quot;440639&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440668" class="comment even depth-3 parent">

	      	<div id="li-comment-440668" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f0788916a9fa130b449673180dc9fa6.png" srcset="https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shamsul</span>
	                <span class="date">June 13, 2018 at 11:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440668" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how we can we do MIMO (multiple variable as an input and multiple variable as an output) ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440668" onclick="return addComment.moveForm( &quot;comment-440668&quot;, &quot;440668&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to shamsul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440691" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-440691" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 13, 2018 at 3:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440691" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post has an example of multiple outputs that you can use as a template:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440691" onclick="return addComment.moveForm( &quot;comment-440691&quot;, &quot;440691&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440616" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-440616" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cce0e04dc530231cfcc4b5cd36167dbe.png" srcset="https://secure.gravatar.com/avatar/cce0e04dc530231cfcc4b5cd36167dbe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Parsh</span>
	                <span class="date">June 13, 2018 at 1:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440616" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Such a wonderful post for me to get started with multi variable input. </p>
<p>After that I extended to make_forecast for 5 more timesteps using other post.<br>
but the prediction comes as 1 variable and now I need to feed for 5 more times but it expects 8 </p>
<p>and getting this error.<br>
ValueError: all the input arrays must have same number of dimensions. Any clue how to feed the prediction to get more predictions.</p>
<p>def make_forecast(model: Sequential, look_back_buffer: numpy.ndarray, timesteps: int=1, batch_size: int=1):</p>
<p>    forecast_predict = numpy.empty((1, 1), dtype=numpy.float32)<br>
    for _ in trange(timesteps, desc=’predicting data\t’, mininterval=1.0):<br>
        cur_predict = model.predict(look_back_buffer)<br>
        forecast_predict = numpy.concatenate([forecast_predict, cur_predict], axis=0)<br>
# This is where I am not sure if I need to have 8 input variable.<br>
        cur_predict = numpy.reshape(cur_predict.shape[0],1, cur_predict.shape[1])<br>
        look_back_buffer = numpy.delete(look_back_buffer, 0, axis=1)<br>
        look_back_buffer = numpy.concatenate([look_back_buffer, cur_predict], axis=1)<br>
    return forecast_predict</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440616" onclick="return addComment.moveForm( &quot;comment-440616&quot;, &quot;440616&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Parsh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440640" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-440640" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 13, 2018 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440640" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have the capacity to review your modifications.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440640" onclick="return addComment.moveForm( &quot;comment-440640&quot;, &quot;440640&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440718" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-440718" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f85f98230e9f283a431241b6772fef83.png" srcset="https://secure.gravatar.com/avatar/f85f98230e9f283a431241b6772fef83?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://kamin.ai/" rel="external nofollow" class="url">Fredrik Hellander</a></span>
	                <span class="date">June 13, 2018 at 8:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440718" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for an interesting tutorial!</p>
<p>I discussed some performance metrics with a colleague and he suggested comparing all results to a benchmark where we simply use the most recent value in the time series as the next forecast, i.e  Pollution(t=n) = Pollution(t=n-1).</p>
<p>I then calculate the RMSE of the benchmark as: </p>
<p>rmse_bench = np.sqrt(mean_squared_error(inv_y[1:], inv_y[:-1]))</p>
<p>The trained LSTM gives me a RMSE of 26.4 and my Benchmark RMSE is 26.6. Do you think this is a valid comparison and in that case have we really added that much value by using the LSTM model?</p>
<p>Kind regards,</p>
<p>Fredrik</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440718" onclick="return addComment.moveForm( &quot;comment-440718&quot;, &quot;440718&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Fredrik Hellander">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440769" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-440769" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 14, 2018 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440769" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is called a persistence model or the naive model.</p>
<p>Yes, it is an excellent baseline, I explain more here:<br>
<a href="https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/" rel="nofollow">https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/</a></p>
<p>LSTMs don’t add much value, I explain more here:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>
<p>Nevertheless, there is a huge demand for LSTMs applied to time series.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440769" onclick="return addComment.moveForm( &quot;comment-440769&quot;, &quot;440769&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440837" class="comment even thread-even depth-1">

	      	<div id="li-comment-440837" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/96ff2c1631f95b031a0d7102d7bac9ba.png" srcset="https://secure.gravatar.com/avatar/96ff2c1631f95b031a0d7102d7bac9ba?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">anusha</span>
	                <span class="date">June 14, 2018 at 10:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I couldn’t understand the ‘invert scaling for forecast’ section of the code. Can you please explain it briefly?<br>
Also , in my case , there are total 62 features where the 62nd feature is to be predicted.<br>
test_X has the following shape:-(70080,61).yhat has shape:-(70080,1). Hence the concatenation statement is posing to be a problem as they are not of the same shape.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440837" onclick="return addComment.moveForm( &quot;comment-440837&quot;, &quot;440837&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to anusha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-440990" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-440990" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8e1f8c411fac6054e4fc458ca64c248a.png" srcset="https://secure.gravatar.com/avatar/8e1f8c411fac6054e4fc458ca64c248a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Xiaolu Wei</span>
	                <span class="date">June 16, 2018 at 10:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440990" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason，<br>
    I wonder if there is any approach to forecast multifactor based on their history data via LSTM?<br>
Best Regards,<br>
Xiaolu Wei</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-440990" onclick="return addComment.moveForm( &quot;comment-440990&quot;, &quot;440990&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Xiaolu Wei">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441040" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441040" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 17, 2018 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you could predict each series using the LSTM via a seq2seq type model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441040" onclick="return addComment.moveForm( &quot;comment-441040&quot;, &quot;441040&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441098" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-441098" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b273150eef766d3aaa4c2e07333da40e.png" srcset="https://secure.gravatar.com/avatar/b273150eef766d3aaa4c2e07333da40e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Democrito</span>
	                <span class="date">June 18, 2018 at 3:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441098" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason Brownlee!</p>
<p>Thank you for all your really useful Topics!</p>
<p>I’m wondering about a thing related to the timesteps. Let’s suppose in an LSTM that I have a batch_size equal to 5 and timestep equal to 1 (like your examples). Is this architecture like an MLP or does it take into account the memory cell between one prediction and the next one?</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441098" onclick="return addComment.moveForm( &quot;comment-441098&quot;, &quot;441098&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Democrito">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441128" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441128" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 18, 2018 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441128" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The memory cell may add value, as it is not reset until the end of the batch. </p>
<p>I would be skeptical though and strongly suggest comparing results to an MLP to ensure the LSTM is adding value.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441128" onclick="return addComment.moveForm( &quot;comment-441128&quot;, &quot;441128&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441177" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-441177" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashish</span>
	                <span class="date">June 18, 2018 at 8:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p># split into input and outputs<br>
train_X, train_y = train[:, :-1], train[:, -1]<br>
test_X, test_y = test[:, :-1], test[:, -1]</p>
<p>In this portion of code you have taken all the lagged value with time step 1 even included pollution with 1 time lag.<br>
Why have you included the 1 time lag of pollution in the train_X and test_X?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441177" onclick="return addComment.moveForm( &quot;comment-441177&quot;, &quot;441177&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441216" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441216" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 19, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441216" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps re-read the definition of the problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441216" onclick="return addComment.moveForm( &quot;comment-441216&quot;, &quot;441216&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441180" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-441180" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashish</span>
	                <span class="date">June 18, 2018 at 8:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441180" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can we predict future values of pollution in numeric form?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441180" onclick="return addComment.moveForm( &quot;comment-441180&quot;, &quot;441180&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441217" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-441217" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 19, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441217" onclick="return addComment.moveForm( &quot;comment-441217&quot;, &quot;441217&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445737" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-445737" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bde6818fe3aaed782bfb7b58efd1c704.png" srcset="https://secure.gravatar.com/avatar/bde6818fe3aaed782bfb7b58efd1c704?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">August 10, 2018 at 9:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445737" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What code do we need to add to predict the future value? I might have missed that, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445737" onclick="return addComment.moveForm( &quot;comment-445737&quot;, &quot;445737&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445753" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-445753" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 10, 2018 at 2:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can call model.predict() to make a prediction.</p>
<p>This tutorial offers more help:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445753" onclick="return addComment.moveForm( &quot;comment-445753&quot;, &quot;445753&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441189" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-441189" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashish</span>
	                <span class="date">June 18, 2018 at 11:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441189" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How to validate or get model score of the lstm model which you have applied?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441189" onclick="return addComment.moveForm( &quot;comment-441189&quot;, &quot;441189&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441221" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441221" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 19, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441221" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We calculate the RMSE, perhaps re-read the tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441221" onclick="return addComment.moveForm( &quot;comment-441221&quot;, &quot;441221&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441190" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-441190" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ambika</span>
	                <span class="date">June 19, 2018 at 12:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441190" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>what is training and test losses as in your code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441190" onclick="return addComment.moveForm( &quot;comment-441190&quot;, &quot;441190&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ambika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441222" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441222" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 19, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441222" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They are the losses calculated on the training and test sets respectively.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441222" onclick="return addComment.moveForm( &quot;comment-441222&quot;, &quot;441222&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441299" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-441299" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/25074f0b78dae3720e801e8923a31cc1.png" srcset="https://secure.gravatar.com/avatar/25074f0b78dae3720e801e8923a31cc1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark</span>
	                <span class="date">June 19, 2018 at 7:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441299" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>thanks for all these interesting and useful tutorials!</p>
<p>I was wondering how to decide the range in which to scale our data. In the “Time Series Forecasting with the Long Short-Term Memory Network in Python ” post, you suggest [- 1, 1]; here [0, 1]. There is a precise rule or something?</p>
<p>Moreover, do you have a tutorial, example or anything else about learning from several trajectories? For instance, I have N training examples of a paraboloid trajectory made of 3 features (x, y and z coordinates) and I want to predict the next point (so, again, x, y and z).<br>
Instead of looping n_epochs times over the same trajectory (like for the shampoo dataset), I’d like to loop over these N trajectories.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441299" onclick="return addComment.moveForm( &quot;comment-441299&quot;, &quot;441299&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441362" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-441362" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 20, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441362" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Normalizing to the range 0-1 is a good idea.</p>
<p>I am currently preparing tutorials on activity recognition that I think will be helpful.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441362" onclick="return addComment.moveForm( &quot;comment-441362&quot;, &quot;441362&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441425" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-441425" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/25074f0b78dae3720e801e8923a31cc1.png" srcset="https://secure.gravatar.com/avatar/25074f0b78dae3720e801e8923a31cc1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark</span>
	                <span class="date">June 20, 2018 at 4:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441425" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much! Can’t wait to read it.</p>
<p>Do you have an estimate of the publishing period of these tutorials?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441425" onclick="return addComment.moveForm( &quot;comment-441425&quot;, &quot;441425&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441484" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-441484" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>August.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441484" onclick="return addComment.moveForm( &quot;comment-441484&quot;, &quot;441484&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441309" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-441309" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/25074f0b78dae3720e801e8923a31cc1.png" srcset="https://secure.gravatar.com/avatar/25074f0b78dae3720e801e8923a31cc1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark</span>
	                <span class="date">June 19, 2018 at 9:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441309" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your amazing work! It’s super useful.</p>
<p>I was wondering if you have a tutorial (or other suggested readings) about how to train a model on series of different length and with more than 1 feature. For instance, how to predict a 3D trajectory with (x,y,z) coordinates (3 features) training the model on N examples (possibly with different length, but not necessarily).</p>
<p>Thanks again!</p>
<p>(PS: I wrote something similar before, but I’m not sure it was sent successfully)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441309" onclick="return addComment.moveForm( &quot;comment-441309&quot;, &quot;441309&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441365" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441365" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 20, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441365" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can pad all sequences to the same length, more on padding here:<br>
<a href="https://machinelearningmastery.com/data-preparation-variable-length-input-sequences-sequence-prediction/" rel="nofollow">https://machinelearningmastery.com/data-preparation-variable-length-input-sequences-sequence-prediction/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441365" onclick="return addComment.moveForm( &quot;comment-441365&quot;, &quot;441365&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441420" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-441420" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ambika</span>
	                <span class="date">June 20, 2018 at 4:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you please provide me the code for predicting pollution in numeric form ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441420" onclick="return addComment.moveForm( &quot;comment-441420&quot;, &quot;441420&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ambika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441481" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-441481" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t understand sorry, can you please explain what you mean by “numeric form”?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441481" onclick="return addComment.moveForm( &quot;comment-441481&quot;, &quot;441481&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441526" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-441526" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8f8f3a6d8241da6f90156c924122adf0.png" srcset="https://secure.gravatar.com/avatar/8f8f3a6d8241da6f90156c924122adf0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ambika</span>
	                <span class="date">June 21, 2018 at 2:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441526" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean i want to predict pollution at 48th hour in numeric form not on plot.<br>
So how can i do that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441526" onclick="return addComment.moveForm( &quot;comment-441526&quot;, &quot;441526&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ambika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441542" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-441542" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2018 at 4:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441542" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can make a prediction with a fit model by calling the predict() function.</p>
<p>I explain more here:<br>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" rel="nofollow">https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441542" onclick="return addComment.moveForm( &quot;comment-441542&quot;, &quot;441542&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441423" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-441423" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ambika</span>
	                <span class="date">June 20, 2018 at 4:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there any post of multivariate VAR model in python?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441423" onclick="return addComment.moveForm( &quot;comment-441423&quot;, &quot;441423&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ambika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441482" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441482" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see here:<br>
<a href="http://www.statsmodels.org/dev/vector_ar.html" rel="nofollow">http://www.statsmodels.org/dev/vector_ar.html</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441482" onclick="return addComment.moveForm( &quot;comment-441482&quot;, &quot;441482&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441424" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-441424" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashish</span>
	                <span class="date">June 20, 2018 at 4:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>what does model.evaluate function do in lstm?<br>
Can we apply r2score for getting r2 score of model in lstm?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441424" onclick="return addComment.moveForm( &quot;comment-441424&quot;, &quot;441424&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ashish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441483" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441483" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441483" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It makes predictions using the model for a test set, then evaluates it.</p>
<p>You can use any of the metrics or loss functions provided by keras or write your own. More here:<br>
<a href="https://machinelearningmastery.com/custom-metrics-deep-learning-keras-python/" rel="nofollow">https://machinelearningmastery.com/custom-metrics-deep-learning-keras-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441483" onclick="return addComment.moveForm( &quot;comment-441483&quot;, &quot;441483&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441640" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-441640" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8f61205b2f4be346f6a654456974ca90.png" srcset="https://secure.gravatar.com/avatar/8f61205b2f4be346f6a654456974ca90?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yuan Yao</span>
	                <span class="date">June 22, 2018 at 12:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441640" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I am thinking of using this multivariate time series is kind of the combine of many single variate time series.<br>
For example, I use the pm2.5, NO2, SO2 data to predict the next month’s pm2.5. In keras model, is it real to use pm2.5, NO2 and SO2 data to predict the next month’s pm2.5, NO2 and SO2 data? Or it just use pm2.5 LSTM to predict pm2.5, NO2 LSTM to predict NO2, SO2 LSTM to predict SO2? This is kind of fake multivariate LSTM.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441640" onclick="return addComment.moveForm( &quot;comment-441640&quot;, &quot;441640&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Yuan Yao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441650" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441650" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 22, 2018 at 2:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441650" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The model predicts pm2.5 from all input variates.</p>
<p>Specifically, from the post:</p>
<blockquote><p>
We will frame the supervised learning problem as predicting the pollution at the current hour (t) given the pollution measurement and weather conditions at the prior time step.
</p></blockquote>
<p>Nothing fake about that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441650" onclick="return addComment.moveForm( &quot;comment-441650&quot;, &quot;441650&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441681" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-441681" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b47d7719db7491079f66601c3178cef2.jpeg" srcset="https://secure.gravatar.com/avatar/b47d7719db7491079f66601c3178cef2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jurgen</span>
	                <span class="date">June 22, 2018 at 10:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, would encoding the wind direction with something like sin(dir) and cos(dir) where dir = “N” = 0, dir = “NE” = 45 etc. be better than integer or one-hot encoding? This (co)sine encoding would retain the “circularity” of the data in a sense, I think.</p>
<p>What do you think about this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441681" onclick="return addComment.moveForm( &quot;comment-441681&quot;, &quot;441681&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jurgen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441719" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441719" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 23, 2018 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441719" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great idea!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441719" onclick="return addComment.moveForm( &quot;comment-441719&quot;, &quot;441719&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441683" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-441683" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f2f8e435ad3cca5ccfb65fec70a557e1.png" srcset="https://secure.gravatar.com/avatar/f2f8e435ad3cca5ccfb65fec70a557e1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maurice</span>
	                <span class="date">June 22, 2018 at 10:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441683" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I followed your example in both Python and R code and was able to get the same answers as per the tutorial. Then, I tried some variations, swapping the size of the Train /Test data to be four years of train followed by one year of test data. I also used a different method of normalisation based on percentiles instead of min/ max, and applied the train normalised dataset to the future test dataset. Running this model gave a RMSE = 35 versus 25 (the original method using min /max across both train /test).<br>
Perhaps this result is the effect of the bias of using a normalisation method across both train and test data and not from the changed method of using percentiles which are a better reflection of the train dataset, especially so if you use an accurate data extraction technique such as a constrained cubic spline.<br>
So, a RMSE of 35 &gt; RMSE of 30 for the persistence model, thus negating the LSTM’S supposedly superior forecasting!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441683" onclick="return addComment.moveForm( &quot;comment-441683&quot;, &quot;441683&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Maurice">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441721" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441721" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 23, 2018 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441721" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, LSTMs and neural nets in general are terrible at time series forecasting. Yet, people are obsessed with using them.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-441721" onclick="return addComment.moveForm( &quot;comment-441721&quot;, &quot;441721&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442369" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-442369" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6e35ae3ca7e279a3521346d6cd646ca7.png" srcset="https://secure.gravatar.com/avatar/6e35ae3ca7e279a3521346d6cd646ca7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arjun</span>
	                <span class="date">June 30, 2018 at 12:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442369" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Brownlee! Thank you so much for these amazing tutorials! They’ve so deepened my understanding of both deep learning and python.</p>
<p>I’m working on a problem with my own Multivariate dataset (have 12 time series, one of which my goal is to also predict). I’ve been using the pandas diff function, as you went over in another article, to convert alll of my 12 series into 12 time series of differences over 1 time period. When I use this adjusted dataset as input into the model, and train the model, from the get-go, the validation loss is weirdly lower than the training loss, for up to 300 epochs of training. If I don’t do “diff” on my dataset, this behavior does not occur. It’s been bewildering to me, and I’ve tried other random data on the network to make sure there is not a problem with the network, and there doesn’t seem to be. This behavior has been confounding for over a week now, and I would really appreciate and suggestions or hints you may have. Thank you <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442369" onclick="return addComment.moveForm( &quot;comment-442369&quot;, &quot;442369&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Arjun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442387" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-442387" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 30, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442387" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Test loss lower than training often means an unstable model:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/what-if-model-skill-on-the-test-dataset-is-better-than-the-training-dataset" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/what-if-model-skill-on-the-test-dataset-is-better-than-the-training-dataset</a></p>
<p>Perhaps start by modeling the univariate series first and use the results as a baseline for more sophisticated methods:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442387" onclick="return addComment.moveForm( &quot;comment-442387&quot;, &quot;442387&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442529" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-442529" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6e35ae3ca7e279a3521346d6cd646ca7.png" srcset="https://secure.gravatar.com/avatar/6e35ae3ca7e279a3521346d6cd646ca7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arjun</span>
	                <span class="date">July 3, 2018 at 1:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442529" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Brownlee, thank you for the reply! I’ve varied the lookback, the test/training sizes, and model configurations, tried a univariate model, and tried modeli the time series with various lookbacks as a normal ANN, and the behavior was still exhibited. If you would indulge me, I have a couple questions I could use your advice on!</p>
<p>One thing I’ve noticed is that, even after inverting the predicted data back to scale, my models still have a hard time learning the proper magnitudes of the data. This is true for both the univariate and the multicariate models, of all varieties. For example, if the distribution of actual inv_y is Norma with its tails at [-5, 5], the model’s predicted data after inversion may or may not demonstrate Gaussian behavior, but its distribution’s tails are in the range of, say, [-.5 ,0], and the predicted values are always much smaller than the actual values. Sometimes the values are all positive, or all negative, too. Is this a known problem with a known solution?</p>
<p>My dataset has approximately 2300-2600 samples, depending on how large of a lookback I choose for the series_to_supervised input. Is it possible that I just have far too few samples for any robust model to be developed, irrespective of the lookback?</p>
<p>Lastly, I’m wondering if there’s a good rule of thumb for determining the proper ranges of hidden units in the LSTM layer. I’ve read your articles that touch upon this topic and paid especially close attention the the hyper parameter grid search article, and as you choose a pretty wide range, I’m wondering if you have a rule of thumb we could use in the initial stages of building our network. Thank you so much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442529" onclick="return addComment.moveForm( &quot;comment-442529&quot;, &quot;442529&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Arjun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442547" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-442547" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 3, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This might help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442547" onclick="return addComment.moveForm( &quot;comment-442547&quot;, &quot;442547&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442525" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-442525" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6a7ea63503169c529beba32f97284276.png" srcset="https://secure.gravatar.com/avatar/6a7ea63503169c529beba32f97284276?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Oscar Labrador</span>
	                <span class="date">July 3, 2018 at 12:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442525" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Really useful post. I have a problem running the code, in line</p>
<p>inv_yhat = scaler.inverse_transform(inv_yhat)</p>
<p>I get the following error</p>
<p>    X -= self.min_<br>
ValueError: operands could not be broadcast together with shapes (35063,23) (12,) (35063,23) </p>
<p>Do you know the reason why?</p>
<p>Regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442525" onclick="return addComment.moveForm( &quot;comment-442525&quot;, &quot;442525&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Oscar Labrador">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442543" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-442543" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 3, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442543" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ensure that your libraries are up to date.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442543" onclick="return addComment.moveForm( &quot;comment-442543&quot;, &quot;442543&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442592" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-442592" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/422c54458b97d29b5570dd57b54938eb.png" srcset="https://secure.gravatar.com/avatar/422c54458b97d29b5570dd57b54938eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mah</span>
	                <span class="date">July 4, 2018 at 3:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442592" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I am just wondering how I can just invert scaling for forecast and skip the concatenate part? I just need to have the actual outcome values and I don’t need the rest of variable. </p>
<p>Thanks</p>
<p># invert scaling for forecast<br>
inv_yhat = concatenate((yhat, test_X[:, -7:]), axis=1)<br>
inv_yhat = scaler.inverse_transform(inv_yhat)<br>
inv_yhat = inv_yhat[:,0]</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442592" onclick="return addComment.moveForm( &quot;comment-442592&quot;, &quot;442592&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442617" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-442617" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 4, 2018 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442617" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The scaler expects data to have the same dimensions for the inverse operation.</p>
<p>You could write your own function to do this if you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442617" onclick="return addComment.moveForm( &quot;comment-442617&quot;, &quot;442617&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442639" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-442639" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/422c54458b97d29b5570dd57b54938eb.png" srcset="https://secure.gravatar.com/avatar/422c54458b97d29b5570dd57b54938eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mah</span>
	                <span class="date">July 4, 2018 at 3:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason.</p>
<p>This might not be related to this example but I really would like to get your opinion.<br>
I have a MLP model and I standardized both input features and my outcome variable. I deployed my model as a web service. As part of deployment I have a scoring script. </p>
<p>When I use the web service to score my raw data, the predicted value is between 0 and 1 because my outcome was scaled to 0 and 1 before training the model. How can I rescale the predicted values? In scoring script, I standardized my input values and use the web service to predict the outcome. So, in raw data I don’t have the outcome variable. I hope this makes sense. </p>
<p>In summary, when we use scaled outcome in training the model, how can we have the predicted outcome in actual scale in scoring phase with new data.</p>
<p>PS. I tried MLP without standardizing the outcome variable and I didn’t get accurate predictions.</p>
<p>I really appreciate your input here.</p>
<p>Thanks so much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442639" onclick="return addComment.moveForm( &quot;comment-442639&quot;, &quot;442639&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442694" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-442694" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 5, 2018 at 7:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442694" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can invert the transform on the predicted values prior to evaluating them.</p>
<p>In sklearn you can call inverse_transform(), otherwise you can do it manually if you know the mean and standard deviation used for standaridzation or the min/max for normalization.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442694" onclick="return addComment.moveForm( &quot;comment-442694&quot;, &quot;442694&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442787" class="comment odd alt depth-5">

	      	<div id="li-comment-442787" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/422c54458b97d29b5570dd57b54938eb.png" srcset="https://secure.gravatar.com/avatar/422c54458b97d29b5570dd57b54938eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mah</span>
	                <span class="date">July 6, 2018 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442787" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I am confused. In a production case, when we call a web service (our deployed ml model), we have the raw data and the raw data is not normalized (like sensor data). However, the machine learning model was trained on standardized features. In this situation, I don’t know what we can do. Can we train a MLP model without standardization at all? I know in neural net we need to convert feature to [0,1].<br>
Can you help me and explain more?</p>
<p>Thanks,<br>
Mah</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-442853" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-442853" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 7, 2018 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We must hang onto the objects that prepared the data or the coefficients within those objects so that we can prepare new data in the same way as the training data.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-442789" class="comment odd alt depth-5">

	      	<div id="li-comment-442789" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/422c54458b97d29b5570dd57b54938eb.png" srcset="https://secure.gravatar.com/avatar/422c54458b97d29b5570dd57b54938eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mah</span>
	                <span class="date">July 6, 2018 at 7:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>can I just use min and max values in the training dataset and change the scale to 0 and 1 for data coming from sensors?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-442854" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-442854" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 7, 2018 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442854" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Exactly.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442663" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-442663" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/75b4071072f9d4dc4fa797df8a6eff08.png" srcset="https://secure.gravatar.com/avatar/75b4071072f9d4dc4fa797df8a6eff08?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">July 4, 2018 at 11:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442663" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason<br>
about the scaler too, should we not use a different MinMaxScaler for each column of the database ?<br>
especially for pollution column for the invert transform ?<br>
to keep the same scale from the pollution column of the raw file</p>
<p>all of that to calculate the RMSE </p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442663" onclick="return addComment.moveForm( &quot;comment-442663&quot;, &quot;442663&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442703" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-442703" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 5, 2018 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442703" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A very important point Alex. In fact, it scales per column by design.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442703" onclick="return addComment.moveForm( &quot;comment-442703&quot;, &quot;442703&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442685" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-442685" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8d3c906af38c39e9862194930433a11b.png" srcset="https://secure.gravatar.com/avatar/8d3c906af38c39e9862194930433a11b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jonathan Roy</span>
	                <span class="date">July 5, 2018 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442685" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great demonstration and tutorial thank you very much!</p>
<p>I get stuck on an detail… how to reshape my data if I have for exemple<br>
6 features and 3 hours times step<br>
and the features #6 become my “y” on the last hours </p>
<p>#1 to #5 are observed feature on all timestep include “t”<br>
#6 t-1, t-2 and t-3 are observed too<br>
I want to predict #6 at “t”</p>
<p>Thank you very much for your attention</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442685" onclick="return addComment.moveForm( &quot;comment-442685&quot;, &quot;442685&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jonathan Roy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442715" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-442715" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 5, 2018 at 8:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442715" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442715" onclick="return addComment.moveForm( &quot;comment-442715&quot;, &quot;442715&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442831" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-442831" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9d44d81b865d1a694648302b290f869f.png" srcset="https://secure.gravatar.com/avatar/9d44d81b865d1a694648302b290f869f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">A Straker</span>
	                <span class="date">July 7, 2018 at 1:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442831" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
Great site, it’s proving to be a useful resource.</p>
<p>Perhaps I’m misunderstanding some LSTM fundamentals, but as I understand it, the ‘memory’ of the network is inherent in the structure of the LSTM node. Because of this, I’m a little confused why we structure the data as a lagged time series in the initial stages, in a manner similar to if we were using autoregression.</p>
<p>You say:<br>
‘The LSTM is exposed to one input at a time with no fixed set of lag variables, as the windowed-multilayer Perceptron (MLP).’</p>
<p>in:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a><br>
which I think supports my thoughts. Could you perhaps explain this a little more please? Many thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442831" onclick="return addComment.moveForm( &quot;comment-442831&quot;, &quot;442831&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to A Straker">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442872" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-442872" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 7, 2018 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442872" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but we must still provide vectorized inputs to the model with the shape [samples, timesteps, features].</p>
<p>Therefore we must take our data and shape it with this structure, the timesteps look like lags, they are just not treated as such by the model.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442872" onclick="return addComment.moveForm( &quot;comment-442872&quot;, &quot;442872&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442844" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-442844" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6536aa3781afe7a19c1db18ab8346d16.png" srcset="https://secure.gravatar.com/avatar/6536aa3781afe7a19c1db18ab8346d16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arjun Majumdar</span>
	                <span class="date">July 7, 2018 at 4:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, I am facing a problem as follows:</p>
<p>In this tutorial, the train and test splits have 8 features viz., ‘pollution’, ‘dew’, ‘temp’, ‘press’, ‘wnd_dir’, ‘wnd_spd’, ‘snow’, ‘rain’ at step ‘t-1’, while the output feature is ‘pollution’ at current step ‘t’.</p>
<p>After fitting the model to the training and testing data splits, what if I want to make predictions for a new dataset having 7 features since it does not have the ‘pollution’ feature in it (while the remaining 7 features remain the same).</p>
<p>How do I handle such a situation?</p>
<p>Thanks and excellent tutorial!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442844" onclick="return addComment.moveForm( &quot;comment-442844&quot;, &quot;442844&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Arjun Majumdar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442876" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-442876" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 7, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442876" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend training a different model that does not use pollution as an input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442876" onclick="return addComment.moveForm( &quot;comment-442876&quot;, &quot;442876&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442910" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-442910" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6536aa3781afe7a19c1db18ab8346d16.png" srcset="https://secure.gravatar.com/avatar/6536aa3781afe7a19c1db18ab8346d16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arjun Majumdar</span>
	                <span class="date">July 7, 2018 at 7:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442910" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you recommend some other different models capable of handling such situations?<br>
Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442910" onclick="return addComment.moveForm( &quot;comment-442910&quot;, &quot;442910&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Arjun Majumdar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442911" class="comment even depth-4 parent">

	      	<div id="li-comment-442911" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6536aa3781afe7a19c1db18ab8346d16.png" srcset="https://secure.gravatar.com/avatar/6536aa3781afe7a19c1db18ab8346d16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arjun Majumdar</span>
	                <span class="date">July 7, 2018 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442911" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you mean training a separate LSTM model as demonstrated above and not using ‘pollution’ as an input feature? If yes, how should the training be done?<br>
Because if the target variable (‘pollution’ for this tutorial) is not included while training the model, how will the model make predictions for it?</p>
<p>Or, do you mean training a different type of a neural network, say a Multi layer Perceptron, etc. for Time Series Predictions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442911" onclick="return addComment.moveForm( &quot;comment-442911&quot;, &quot;442911&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Arjun Majumdar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442938" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-442938" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 8, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442938" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Lag pollution values are used in the above model.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442937" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-442937" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 8, 2018 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442937" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend testing a suite of methods to see what works best for your specific dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-442937" onclick="return addComment.moveForm( &quot;comment-442937&quot;, &quot;442937&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443052" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443052" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9ed467a692f3efa675d67db6c6ad5346.png" srcset="https://secure.gravatar.com/avatar/9ed467a692f3efa675d67db6c6ad5346?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jordan</span>
	                <span class="date">July 10, 2018 at 1:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443052" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr. Brownlee,</p>
<p>Thank you so much for such an interesting post. I am attempting to run this program but am getting the following error.</p>
<p>TypeError: while_loop() got an unexpected keyword argument ‘maximum_iterations’</p>
<p>Do you have an idea of how this could be fixed?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443052" onclick="return addComment.moveForm( &quot;comment-443052&quot;, &quot;443052&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jordan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443087" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443087" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 10, 2018 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443087" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have not had this error myself, perhaps try searching or posting on stackoverflow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443087" onclick="return addComment.moveForm( &quot;comment-443087&quot;, &quot;443087&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-443798" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-443798" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f10f720f5157ae7c660fe9f9d2006258.png" srcset="https://secure.gravatar.com/avatar/f10f720f5157ae7c660fe9f9d2006258?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">hyu</span>
	                <span class="date">July 18, 2018 at 4:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443798" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is caused by the old version of tensorflow. Updating tensorflow should fix the problem!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443798" onclick="return addComment.moveForm( &quot;comment-443798&quot;, &quot;443798&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to hyu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443849" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-443849" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2018 at 7:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good tip!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443849" onclick="return addComment.moveForm( &quot;comment-443849&quot;, &quot;443849&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-448645" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-448645" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/30a6dc3074b2be27a998db9eeddbd7ec.png" srcset="https://secure.gravatar.com/avatar/30a6dc3074b2be27a998db9eeddbd7ec?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://no/" rel="external nofollow" class="url">Poiuwn</a></span>
	                <span class="date">September 13, 2018 at 12:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448645" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jordan,<br>
I had the same issue when I tried to run the code. The I tried to upgrade my tensorflow, but it then gave me this error: ImportError: cannot import name ‘abs’.</p>
<p>Then I uninstalled keras and tensorflow, and reinstall tensorflow and keras. The problems all cleared after that.</p>
<p>python -m pip install –upgrade pip # upgrade pip<br>
pip uninstall keras<br>
python -m pip uninstall tensorflow<br>
pip3 install tensorflow<br>
pip3 install keras</p>
<p>Please note I am using Anaconda 3, and details are shown below:<br>
‘3.6.3 |Anaconda custom (64-bit)| (default, Oct 15 2017, 03:27:45) [MSC v.1900 64 bit (AMD64)]’</p>
<p>Hope this helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448645" onclick="return addComment.moveForm( &quot;comment-448645&quot;, &quot;448645&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Poiuwn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448666" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-448666" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 13, 2018 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448666" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice tip, thanks for sharing!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448666" onclick="return addComment.moveForm( &quot;comment-448666&quot;, &quot;448666&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443101" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443101" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5b02f98446a74cc0fd7e176c65148c7d.png" srcset="https://secure.gravatar.com/avatar/5b02f98446a74cc0fd7e176c65148c7d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dave Craft</span>
	                <span class="date">July 10, 2018 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443101" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just an aside:  It looks to me like you are performing fit_transform() on the total<br>
data set but performing inverse_transform() only on the test data set.  An<br>
inverse_transform() on a small subset of the original transformation may not result in equivalent scaling to the original (larger data set).   Thus inv_yhat and inv_y are<br>
comparable but they may now be in different ranges than train_y</p>
<p>Your work is extremely helpful!  Like many others I read lots of different topics on ml and<br>
you are a *go to* for better explanations.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443101" onclick="return addComment.moveForm( &quot;comment-443101&quot;, &quot;443101&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dave Craft">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443118" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443118" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 10, 2018 at 2:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443118" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see the problem. Perhaps I am missing something?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443118" onclick="return addComment.moveForm( &quot;comment-443118&quot;, &quot;443118&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443116" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443116" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/db10d124ceb4b31e4c0ea7f71e9da274.png" srcset="https://secure.gravatar.com/avatar/db10d124ceb4b31e4c0ea7f71e9da274?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">José Mayorga</span>
	                <span class="date">July 10, 2018 at 2:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443116" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>good job doctor</p>
<p>I want to know if this job can be applied with stock indexes, for example if the stock index “x”, affects the price movement (up or down) of the stock index “y”.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443116" onclick="return addComment.moveForm( &quot;comment-443116&quot;, &quot;443116&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to José Mayorga">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443124" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443124" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 10, 2018 at 2:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443124" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>More on stocks here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443124" onclick="return addComment.moveForm( &quot;comment-443124&quot;, &quot;443124&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443148" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443148" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2f63f5f7f644fc79eb13578aa87b3d6c.png" srcset="https://secure.gravatar.com/avatar/2f63f5f7f644fc79eb13578aa87b3d6c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">subhash</span>
	                <span class="date">July 10, 2018 at 11:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443148" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,<br>
             I have one question, it may sound naive. But this is bugging me. For prediction you are using (t-1) step data as input. at every time step you are using the data of (t-1) pollution data. means we can only predict one time step ahead?<br>
             What if I want to predict several time steps ahead. assuming that I have the data of all other variables wind, temp, etc. I want to input the data of pollution from the previos prediction.<br>
thank you for answering</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443148" onclick="return addComment.moveForm( &quot;comment-443148&quot;, &quot;443148&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to subhash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443177" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443177" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2018 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post gives an example of a multi-step forecast:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443177" onclick="return addComment.moveForm( &quot;comment-443177&quot;, &quot;443177&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443149" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443149" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2f63f5f7f644fc79eb13578aa87b3d6c.png" srcset="https://secure.gravatar.com/avatar/2f63f5f7f644fc79eb13578aa87b3d6c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">INAVOLU Subhash</span>
	                <span class="date">July 10, 2018 at 11:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443149" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,<br>
            I can see that to predict the pollution in we are using the (t-1) time step pollution data.<br>
what if I want to predict several time steps ahead of pollution data.(t+1, t+2,t+3) but using predicted  pollution (t,t+1,t+2) data and the existing data from other variables such as wind velocity and all</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443149" onclick="return addComment.moveForm( &quot;comment-443149&quot;, &quot;443149&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to INAVOLU Subhash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443178" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443178" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2018 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example of a multi-step forecast:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443178" onclick="return addComment.moveForm( &quot;comment-443178&quot;, &quot;443178&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443199" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443199" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f41a0a9d6bf9e69c3b954c49c8ca157d.png" srcset="https://secure.gravatar.com/avatar/f41a0a9d6bf9e69c3b954c49c8ca157d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Meursault</span>
	                <span class="date">July 11, 2018 at 10:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443199" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I noticed that when I set n_out=0 in the series_to_supervised method, my results are almost perfect. This is pretty suspicious to me, but I went through the code and can’t figure out what is going wrong, if anything. The model is still predicting on the right column and using the other columns are the X data. I read your article linked above which discusses the method in more detail but couldn’t figure out what was going on from that. Interestingly, the results get worse as n_out increases, but when I look through the code, the future steps shouldn’t ever be used – so why any change at all? I’m pretty confused here, so any help would be greatly appreciated, and thanks for an awesome tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443199" onclick="return addComment.moveForm( &quot;comment-443199&quot;, &quot;443199&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Meursault">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443214" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443214" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2018 at 2:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As you increase the number of output steps you will have less training data. This may explain the decrease in performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443214" onclick="return addComment.moveForm( &quot;comment-443214&quot;, &quot;443214&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443235" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443235" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ff8f471e11755d04c0755d9b70600181.png" srcset="https://secure.gravatar.com/avatar/ff8f471e11755d04c0755d9b70600181?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sarthak</span>
	                <span class="date">July 11, 2018 at 10:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443235" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>This article has really helped me.</p>
<p>I have a question, I want to predict for next 30 days and I have a lag of 4, I give the required value for 1 variable and constantly shift after each prediction. But since the value is scaled between 0 and 1 the predicted value differs from that scale. Causing problem after 10 days of predicted value. Is there any better way to predict for the next 30 days from the model that you have above</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443235" onclick="return addComment.moveForm( &quot;comment-443235&quot;, &quot;443235&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Sarthak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443259" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443259" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 12, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443259" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this post will help:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443259" onclick="return addComment.moveForm( &quot;comment-443259&quot;, &quot;443259&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443300" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443300" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0a8686ba610df42b0b1cdc3e0195e214.png" srcset="https://secure.gravatar.com/avatar/0a8686ba610df42b0b1cdc3e0195e214?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Theo</span>
	                <span class="date">July 12, 2018 at 5:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443300" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Very useful tutorial! I am trying this on a different dataset and the results are really good. However, I am afraid I am cheating by letting the output be part of the input?</p>
<p>Shouldn’t the non-shifted pollution column be dropped as well?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443300" onclick="return addComment.moveForm( &quot;comment-443300&quot;, &quot;443300&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Theo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443335" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443335" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 13, 2018 at 7:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443335" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The output at the time step being predicted is not part of the input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443335" onclick="return addComment.moveForm( &quot;comment-443335&quot;, &quot;443335&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443301" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443301" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f8675c9cdb374c2350f3240e4e6a9e66.png" srcset="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">July 12, 2018 at 5:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443301" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason,<br>
In section 2 Basic Data Preparation, when you plot all the data, how can I show date in the transverse axis instead of number counts?Please help me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443301" onclick="return addComment.moveForm( &quot;comment-443301&quot;, &quot;443301&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443336" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443336" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 13, 2018 at 7:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443336" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can set the axis of the graph to be anything you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443336" onclick="return addComment.moveForm( &quot;comment-443336&quot;, &quot;443336&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443313" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443313" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0a8686ba610df42b0b1cdc3e0195e214.png" srcset="https://secure.gravatar.com/avatar/0a8686ba610df42b0b1cdc3e0195e214?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">theodor|</span>
	                <span class="date">July 12, 2018 at 10:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443313" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Why isn’t the pollution column removed when this is the one we are trying to predict? is it not cheating to use the actual values in the prediction?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443313" onclick="return addComment.moveForm( &quot;comment-443313&quot;, &quot;443313&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to theodor|">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443343" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443343" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 13, 2018 at 7:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, we are providing the pollution at the last time step as an input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443343" onclick="return addComment.moveForm( &quot;comment-443343&quot;, &quot;443343&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443354" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443354" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e42ce1f2bad89a23a83a5af96cff9c4f.png" srcset="https://secure.gravatar.com/avatar/e42ce1f2bad89a23a83a5af96cff9c4f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gabriel Mouzella Silva</span>
	                <span class="date">July 13, 2018 at 11:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443354" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I usually never comment on those things, but you just saved my skin. I’ve been trying to create a good and generic way to produce a multivariate data frame for LSTM analysis and this is the only one with a good explanation that I’ve found. Keep doing this amazing job.</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443354" onclick="return addComment.moveForm( &quot;comment-443354&quot;, &quot;443354&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Gabriel Mouzella Silva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443414" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443414" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 14, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443414" onclick="return addComment.moveForm( &quot;comment-443414&quot;, &quot;443414&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443358" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443358" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/2d990c4d2134c035c84abba26a05dd76.png" srcset="https://secure.gravatar.com/avatar/2d990c4d2134c035c84abba26a05dd76?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jay B.</span>
	                <span class="date">July 13, 2018 at 2:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443358" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Fantastic article! It’s also great to see that you’re still actively helping students a year later.</p>
<p>So, to be clear, this setup does not work for more than a single time-step into the future (i.e. autoregression), is that correct? I encountered numerous problems, but one in particular I couldn’t solve is when extending this problem to both 1.) predict multiple time-steps down the road (by changing the respective value in the series_to_supervised() fxn); and 2.) predicting more than a single value at a particular time step, e.g. predicting the temperature and dew point at the same time. Please let me know if I’m overlooking anything.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443358" onclick="return addComment.moveForm( &quot;comment-443358&quot;, &quot;443358&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jay B.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443416" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443416" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 14, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443416" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example of multi-step forecasts:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443416" onclick="return addComment.moveForm( &quot;comment-443416&quot;, &quot;443416&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443370" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443370" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/dbe427b1e8fea289bfdb82ddb997fcea.png" srcset="https://secure.gravatar.com/avatar/dbe427b1e8fea289bfdb82ddb997fcea?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">hamid</span>
	                <span class="date">July 13, 2018 at 5:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443370" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for your incredible posts and tutorials. I ran your model with some modifications for my own problem and it just worked well.<br>
I have a few questions. It will be the great if have some advice from you.</p>
<p>1) Is training neurons using a shape of ( number of samples, timesteps = 1, features = 24) the same as training using a shape of (number of samples, timesteps=3, features=8) ?</p>
<p>2) I don’t get the difference between the number of timesteps and the number of training samples. For example, If we use timestep=1, does it mean that we don’t need samples before timestep t-1 for updating weights? Of course we do. but I don’t know how.</p>
<p>3) Are validation set used for updating weights? If yes, why you used validation set to predict. This makes bias and over fitting.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443370" onclick="return addComment.moveForm( &quot;comment-443370&quot;, &quot;443370&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to hamid">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443421" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443421" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 14, 2018 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this will help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<p>The validation set is not used for updating weights.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443421" onclick="return addComment.moveForm( &quot;comment-443421&quot;, &quot;443421&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443459" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443459" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f9c884972f5b922015a20054edc8f3ae.png" srcset="https://secure.gravatar.com/avatar/f9c884972f5b922015a20054edc8f3ae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TC</span>
	                <span class="date">July 14, 2018 at 2:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443459" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Jason Brownlee,</p>
<p>First of all, thank you so much for a wonderful tutorial. I can learn faster in neural network and work faster in my project.</p>
<p>Today, I have a few questions that would like to ask about implement LSTM in multivariate time series data.</p>
<p>1. How to modify code if I would like to change column I would like to predicted? For example, predicted wind speed from other columns.</p>
<p>2. Similar to first question, but what if I would like to predicted columns from specific columns? For example, predicted wind speed only from temperatures and pollution values.</p>
<p>3. About model, how to know if this model is model is well-tuned already, or need more tuning? I am a little bit confused about it.</p>
<p>4. About RMSE, if I use another dataset, how could I know if this values is good or bad for regression prediction?</p>
<p>5. This question may out of this tutorial, but what if I would like to do classification problem instead of regression? I would like how to work out with multivariate time series data with LSTM? or maybe if you have another suggestion, I would appreciated it.</p>
<p>I am sorry if some question maybe too weird to ask, but I stuck with this problems for a while now. Also, sorry for my terrible English</p>
<p>Thank you so much for your answer in advance. I am looking forward to hear a response from expert like you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443459" onclick="return addComment.moveForm( &quot;comment-443459&quot;, &quot;443459&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to TC">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443508" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-443508" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 15, 2018 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443508" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>More on data prep for LSTMs here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<p>You can use diagnostics to see if the model is well suited:<br>
<a href="https://machinelearningmastery.com/diagnose-overfitting-underfitting-lstm-models/" rel="nofollow">https://machinelearningmastery.com/diagnose-overfitting-underfitting-lstm-models/</a></p>
<p>You can use grid/random searches of hyperparameters to see if you can do better.</p>
<p>Error is relative, and “good” performance is determined against a baseline method like persistence, more here:<br>
<a href="https://machinelearningmastery.com/how-to-know-if-your-machine-learning-model-has-good-performance/" rel="nofollow">https://machinelearningmastery.com/how-to-know-if-your-machine-learning-model-has-good-performance/</a></p>
<p>More on how to change a neural net to/form regression to classification:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-can-i-change-a-neural-network-from-regression-to-classification" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-can-i-change-a-neural-network-from-regression-to-classification</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443508" onclick="return addComment.moveForm( &quot;comment-443508&quot;, &quot;443508&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443542" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-443542" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f9c884972f5b922015a20054edc8f3ae.png" srcset="https://secure.gravatar.com/avatar/f9c884972f5b922015a20054edc8f3ae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TC</span>
	                <span class="date">July 15, 2018 at 12:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443542" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much for your knowledge resources, Dr. Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443542" onclick="return addComment.moveForm( &quot;comment-443542&quot;, &quot;443542&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to TC">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443572" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-443572" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 16, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443572" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad it helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443572" onclick="return addComment.moveForm( &quot;comment-443572&quot;, &quot;443572&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443466" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443466" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4ad43c2d0ff136ee686c96c7a50dafa8.png" srcset="https://secure.gravatar.com/avatar/4ad43c2d0ff136ee686c96c7a50dafa8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zhang Bo</span>
	                <span class="date">July 14, 2018 at 5:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443466" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello,i have tried your univariable method  and multivariable method on the problem of prediction for bank businnessvolume.The latter is much better.thanks for your courses.<br>
Is there some suggest on chossing GRU or LSTM or reLSTM for prediction?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443466" onclick="return addComment.moveForm( &quot;comment-443466&quot;, &quot;443466&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Zhang Bo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443511" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443511" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 15, 2018 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443511" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>
<p>Perhaps try each and see what works best for your problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443511" onclick="return addComment.moveForm( &quot;comment-443511&quot;, &quot;443511&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443616" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443616" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0a8686ba610df42b0b1cdc3e0195e214.png" srcset="https://secure.gravatar.com/avatar/0a8686ba610df42b0b1cdc3e0195e214?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Theodor</span>
	                <span class="date">July 16, 2018 at 7:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443616" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Since we are providing the pollution from the last time step does that mean we are only forecasting tomorrow “then we wait until tomorrow, get the actual value” to predict the day after that? </p>
<p>I apologize for asking this a third time, I am quite new to this concept.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443616" onclick="return addComment.moveForm( &quot;comment-443616&quot;, &quot;443616&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Theodor">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443659" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443659" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 17, 2018 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443659" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are providing pollution from the prior time step (hour) to predict the pollution at the next time step (hour).</p>
<p>Generally, LSTMs are terrible at time series forecasting.</p>
<p>Perhaps start with intro to time series:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443659" onclick="return addComment.moveForm( &quot;comment-443659&quot;, &quot;443659&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443702" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443702" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/94b14572b78b70a9c616ab0800934eea.png" srcset="https://secure.gravatar.com/avatar/94b14572b78b70a9c616ab0800934eea?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Will</span>
	                <span class="date">July 17, 2018 at 6:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443702" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your article Dr. Jason.</p>
<p>I have two question that would like to ask.<br>
How to improve RMSE values using LSTM model, What parameter(s) do I have to change in code? I have tried to edit some of parameters but it not work for me.<br>
And is there any other way to predict future more than LSTM method?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443702" onclick="return addComment.moveForm( &quot;comment-443702&quot;, &quot;443702&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Will">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443746" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443746" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 18, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443746" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>Also, try other methods, LSTMs are terrible at time series forecasting.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443746" onclick="return addComment.moveForm( &quot;comment-443746&quot;, &quot;443746&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443721" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443721" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d1f51078ec1037133a05fb16ea26eea0.png" srcset="https://secure.gravatar.com/avatar/d1f51078ec1037133a05fb16ea26eea0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alice</span>
	                <span class="date">July 18, 2018 at 12:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443721" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for sharing. I am considering using RNN to predict customer attrition, that is given all customers’ purchase data in history and labelled attrition status, predict the churn probability of the customers who are still active. I am wondering if LSTM can be applied in such case with such time series data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443721" onclick="return addComment.moveForm( &quot;comment-443721&quot;, &quot;443721&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Alice">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443753" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443753" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 18, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Alice, try a suite of methods and see what works best for your specific problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443753" onclick="return addComment.moveForm( &quot;comment-443753&quot;, &quot;443753&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443728" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443728" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8f0df838362617f6d5f437f686ee2082.png" srcset="https://secure.gravatar.com/avatar/8f0df838362617f6d5f437f686ee2082?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mallick</span>
	                <span class="date">July 18, 2018 at 2:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443728" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why does lstm forecast for my data gives a smooth curve instaed of following the given data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443728" onclick="return addComment.moveForm( &quot;comment-443728&quot;, &quot;443728&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mallick">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443758" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443758" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 18, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443758" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may not be a suitable model for your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443758" onclick="return addComment.moveForm( &quot;comment-443758&quot;, &quot;443758&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443817" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443817" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a35c2da932872bbe5abd64a57ea9f4bb.png" srcset="https://secure.gravatar.com/avatar/a35c2da932872bbe5abd64a57ea9f4bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="external nofollow" class="url">Neha</a></span>
	                <span class="date">July 18, 2018 at 9:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443817" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the good article Dr.Jason.</p>
<p>Is it possible for you to give pointers on multi entity time series forecasting.<br>
I need to forecast for 1000 customers. So was wondering if there is a way of doing so using  Lstms or any other technique where multiple models are not required.</p>
<p>Appreciate the help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443817" onclick="return addComment.moveForm( &quot;comment-443817&quot;, &quot;443817&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Neha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443856" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443856" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2018 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>Some ideas:<br>
– try a model per customer<br>
– try a model per a group of customers<br>
– try a model for all customers</p>
<p>Go with whatever works best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443856" onclick="return addComment.moveForm( &quot;comment-443856&quot;, &quot;443856&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443832" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443832" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1c800dc0f4ce34f942615208951f4129.png" srcset="https://secure.gravatar.com/avatar/1c800dc0f4ce34f942615208951f4129?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ranjith</span>
	                <span class="date">July 19, 2018 at 1:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443832" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Jason,</p>
<p>Thank you so much for your tutorial on air pollution.<br>
I just want to try bidirectional LSTM for the above LSTM model to predict the air pollution. </p>
<p>I have same pollution dataset which is used for above LSTM model.</p>
<p>How to develop bidirectional LSTM for that pollution dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443832" onclick="return addComment.moveForm( &quot;comment-443832&quot;, &quot;443832&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ranjith">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443862" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-443862" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2018 at 7:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443862" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example of a bidirectional LSTM:<br>
<a href="https://machinelearningmastery.com/develop-bidirectional-lstm-sequence-classification-python-keras/" rel="nofollow">https://machinelearningmastery.com/develop-bidirectional-lstm-sequence-classification-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443862" onclick="return addComment.moveForm( &quot;comment-443862&quot;, &quot;443862&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443989" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-443989" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1c800dc0f4ce34f942615208951f4129.png" srcset="https://secure.gravatar.com/avatar/1c800dc0f4ce34f942615208951f4129?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ranjith</span>
	                <span class="date">July 20, 2018 at 10:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443989" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Jason,</p>
<p>I changed above code from LSTM to bidirectional LSTM model like</p>
<p>model = Sequential()<br>
model.add(Bidirectional(LSTM(50, return_sequences=True), input_shape=(train_X.shape[1], train_X.shape[2])))<br>
model.add(Dense(1))<br>
model.compile(loss=’mae’, optimizer=’adam’)<br>
# fit network<br>
history = model.fit(train_X, train_y, epochs=50, batch_size=1, validation_data=(test_X, test_y), verbose=2, shuffle=False)<br>
————————————————-</p>
<p>but I got error like the following</p>
<p>ValueError                                Traceback (most recent call last)<br>
 in ()<br>
     74 model.compile(loss=’mae’, optimizer=’adam’)<br>
     75 # fit network<br>
—&gt; 76 history = model.fit(train_X, train_y, epochs=50, batch_size=1, validation_data=(test_X, test_y), verbose=2, shuffle=False)<br>
     77 # plot history<br>
     78 pyplot.plot(history.history[‘loss’], label=’train’)</p>
<p>ValueError: Error when checking target: expected dense_1 to have 3 dimensions, but got array with shape (50, 1)<br>
—————————–</p>
<p>can you help me to fix the error.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443989" onclick="return addComment.moveForm( &quot;comment-443989&quot;, &quot;443989&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ranjith">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444026" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-444026" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 21, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps don’t return sequences.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444026" onclick="return addComment.moveForm( &quot;comment-444026&quot;, &quot;444026&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443868" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443868" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bf27cba0faa131a8f124b1024f094eba.png" srcset="https://secure.gravatar.com/avatar/bf27cba0faa131a8f124b1024f094eba?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Max</span>
	                <span class="date">July 19, 2018 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443868" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Jason,</p>
<p>I find this very helpful. I was wondering what changes in this code if you would want to predict each and every time series that you put as input (i.e. pollution, dew, snow, pressure, etc) not just one target variable.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443868" onclick="return addComment.moveForm( &quot;comment-443868&quot;, &quot;443868&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Max">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443879" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443879" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2018 at 2:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443879" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could use a TimeDistributed layer wrapping the output model (a dense layer) and have one node for each series to be predicted.</p>
<p>I have no idea how this might perform.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443879" onclick="return addComment.moveForm( &quot;comment-443879&quot;, &quot;443879&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443978" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-443978" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/003780a01261ffe5415fefc9af568733.png" srcset="https://secure.gravatar.com/avatar/003780a01261ffe5415fefc9af568733?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">boraton</span>
	                <span class="date">July 20, 2018 at 7:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443978" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you very much for this tutorial, I found it very useful. I was wondering if you can be of help and assistance in sharing an insight into how to do precipitation forecast using the set of images. I was tasked to train a model to take any number (determined by you) of daily precipitation maps as input, and generate precipitation forecast maps for one week (7 days) into the future. My challenge is how to transform the image dataset into something I can use for precipitation forecasting. Do you have the idea on how I can convert the images to numerical to allow me to use the LSTM and follow the process in your tutorial? I will really appreciate your help since this is my first task in machine learning project.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-443978" onclick="return addComment.moveForm( &quot;comment-443978&quot;, &quot;443978&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to boraton">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444022" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-444022" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 21, 2018 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A good model for working with a time series of images is the CNN LSTM, you can learn more here:<br>
<a href="https://machinelearningmastery.com/cnn-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/cnn-long-short-term-memory-networks/</a></p>
<p>I also have an example in my LSTM book.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444022" onclick="return addComment.moveForm( &quot;comment-444022&quot;, &quot;444022&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444007" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444007" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f89243dd14d422e5e290c79a885becc7.png" srcset="https://secure.gravatar.com/avatar/f89243dd14d422e5e290c79a885becc7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Qian Wu</span>
	                <span class="date">July 21, 2018 at 5:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444007" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how can i resolve this problem?<br>
“model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
Traceback (most recent call last):</p>
<p>  File “”, line 1, in<br>
    model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))</p>
<p>NameError: name ‘LSTM’ is not defined”</p>
<p>Thanks for your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444007" onclick="return addComment.moveForm( &quot;comment-444007&quot;, &quot;444007&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Qian Wu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444037" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-444037" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 21, 2018 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444037" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You need to import the LSTM layer.</p>
<p>Perhaps make sure you have copied all of the code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444037" onclick="return addComment.moveForm( &quot;comment-444037&quot;, &quot;444037&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444220" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-444220" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/473c2ae2d458d7e6a97a98c2bde94964.png" srcset="https://secure.gravatar.com/avatar/473c2ae2d458d7e6a97a98c2bde94964?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ian</span>
	                <span class="date">July 23, 2018 at 11:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444220" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>i get the following error: Input contains NaN, infinity or a value too large for dtype(‘float32’)</p>
<p>I suggest that the algorithm is still working with the wind direction, which causes the error due to the dtype is somehow still a string and can not be converted to float. </p>
<p>Does anybody has the same problem and can help out?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444220" onclick="return addComment.moveForm( &quot;comment-444220&quot;, &quot;444220&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444249" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-444249" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 24, 2018 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444249" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Did you copy all of the code? Perhaps you skipped a step?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444249" onclick="return addComment.moveForm( &quot;comment-444249&quot;, &quot;444249&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445182" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-445182" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/26e8d9fec9b0fea98de03d467c0e2a85.png" srcset="https://secure.gravatar.com/avatar/26e8d9fec9b0fea98de03d467c0e2a85?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Murat</span>
	                <span class="date">August 4, 2018 at 3:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445182" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>I am having the same issue with the Ian. My data does not have any nan values. Algorithm is producing this error: Input contains NaN, infinity or a value too large for dtype(‘float32’)<br>
with certain epochs or bach sizes. When I chance epoch, or batch size with the same data, I am not getting this error.<br>
I made a research on it and having 0 values in data cause the nans. However, after I remove the 0’s, I still get the same error. I don’t know how epochs or batch size, cause this problem.</p>
<p>Thank you Jason and Ian</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445182" onclick="return addComment.moveForm( &quot;comment-445182&quot;, &quot;445182&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Murat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445206" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-445206" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 4, 2018 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445206" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try scaling or not scaling the data before modeling?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445206" onclick="return addComment.moveForm( &quot;comment-445206&quot;, &quot;445206&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444224" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444224" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/66b3b31de5f37a1127d1fc0f4133ba4c.png" srcset="https://secure.gravatar.com/avatar/66b3b31de5f37a1127d1fc0f4133ba4c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ryan</span>
	                <span class="date">July 24, 2018 at 1:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444224" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, This is super helpful. You mention that LSTM is not good for time-series/sequence models. Why is that, and what would you recommend as the optimal algorithm to use for such models? Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444224" onclick="return addComment.moveForm( &quot;comment-444224&quot;, &quot;444224&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ryan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444250" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-444250" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 24, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444250" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post for why:<br>
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>
<p>There are no optimal algorithms, just methods we test on a given problem to discover what works.</p>
<p>I am finding CNNs to be very effective for time series problems at the moment. I have a ton of posts scheduled on the topic.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444250" onclick="return addComment.moveForm( &quot;comment-444250&quot;, &quot;444250&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447372" class="comment odd alt depth-3">

	      	<div id="li-comment-447372" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/66b3b31de5f37a1127d1fc0f4133ba4c.png" srcset="https://secure.gravatar.com/avatar/66b3b31de5f37a1127d1fc0f4133ba4c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ryan</span>
	                <span class="date">August 31, 2018 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447372" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is perfect–thanks so much for your reponse!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447372" onclick="return addComment.moveForm( &quot;comment-447372&quot;, &quot;447372&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ryan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444275" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-444275" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/32e3b26856f1a7bc70181a49d6913597.png" srcset="https://secure.gravatar.com/avatar/32e3b26856f1a7bc70181a49d6913597?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muddassir</span>
	                <span class="date">July 24, 2018 at 3:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444275" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I tried with Random forest.It is giving less mse and rmse compared to LSTM</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444275" onclick="return addComment.moveForm( &quot;comment-444275&quot;, &quot;444275&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Muddassir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444328" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444328" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 25, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444328" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not surprised.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444328" onclick="return addComment.moveForm( &quot;comment-444328&quot;, &quot;444328&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444432" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444432" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ced66530599a19571334566ffed8e03c.png" srcset="https://secure.gravatar.com/avatar/ced66530599a19571334566ffed8e03c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Malcom</span>
	                <span class="date">July 26, 2018 at 12:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>DR. Jason</p>
<p>Thanks for your tutorial. I am a little bit confused with # drop columns we don’t want to predict.</p>
<p>reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)</p>
<p>This line, means that we predict 8) Polution and use 1) Polution 2) dew 3) temp 4) press 5) wnd_dir 6) wnd_spd 7) snow 8) rain as features for prediction model, am I right?</p>
<p>so if we change the number, we can predict another column, am I right?</p>
<p>and if I want to predict more than 2 columns and/or use only some feature, what can I do?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444432" onclick="return addComment.moveForm( &quot;comment-444432&quot;, &quot;444432&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Malcom">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444439" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-444439" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 26, 2018 at 2:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444439" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>
<p>You can predict more columns by having more nodes in the output layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444439" onclick="return addComment.moveForm( &quot;comment-444439&quot;, &quot;444439&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444446" class="comment even depth-3 parent">

	      	<div id="li-comment-444446" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ced66530599a19571334566ffed8e03c.png" srcset="https://secure.gravatar.com/avatar/ced66530599a19571334566ffed8e03c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Malcom</span>
	                <span class="date">July 26, 2018 at 3:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your reply. I have some more question about split into input and output</p>
<p># split into input and outputs<br>
train_X, train_y = train[:, :-1], train[:, -1]<br>
test_X, test_y = test[:, :-1], test[:, -1]</p>
<p>from here, what does -1 means exactly? Thank you for your reply in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444446" onclick="return addComment.moveForm( &quot;comment-444446&quot;, &quot;444446&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Malcom">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444488" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-444488" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 27, 2018 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444488" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn more about how to slice and split in Python here:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444488" onclick="return addComment.moveForm( &quot;comment-444488&quot;, &quot;444488&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444534" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-444534" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5098ce81f2c234a8338e5585e20815e5.png" srcset="https://secure.gravatar.com/avatar/5098ce81f2c234a8338e5585e20815e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luke</span>
	                <span class="date">July 27, 2018 at 5:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444534" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, thanks for a nice article.<br>
I am struggling with some error once I tried predicted more variables and use less variable to predicted. But there seems to be error like this while it is going to report RMSE value.</p>
<p>ValueError: operands could not be broadcast together with shapes (10000,18) (16,) (10000,18) </p>
<p>in this line</p>
<p>—&gt; inv_yhat = scaler.inverse_transform(inv_yhat)</p>
<p>Any suggestion to modify code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444534" onclick="return addComment.moveForm( &quot;comment-444534&quot;, &quot;444534&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Luke">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444587" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-444587" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 28, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444587" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Looks like there is something going on with the shape of your data.</p>
<p>Confirm you copied all of the code exactly?<br>
Confirm the shape and content of the data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444587" onclick="return addComment.moveForm( &quot;comment-444587&quot;, &quot;444587&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444625" class="comment even depth-3 parent">

	      	<div id="li-comment-444625" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/561ca5f087477dba61ce4960b723bdc2.png" srcset="https://secure.gravatar.com/avatar/561ca5f087477dba61ce4960b723bdc2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luke</span>
	                <span class="date">July 28, 2018 at 2:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444625" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply Jason.</p>
<p>I am pretty sure all code are the same except the number in drop column in reframed. Because I want to try predict another column. (I use another dataset, it works well when I predicted only one column and use all columns for prediction but, it return value error when I want to predicted more than one or not use all column for prediction)</p>
<p>any advice please?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444625" onclick="return addComment.moveForm( &quot;comment-444625&quot;, &quot;444625&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Luke">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444660" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-444660" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2018 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444660" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have changed the example, it is hard for me to help without debugging your changes, which I don’t have the capacity to do.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444660" onclick="return addComment.moveForm( &quot;comment-444660&quot;, &quot;444660&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444539" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444539" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7afdbf27831b1b2e2b92be84eb9d321c.png" srcset="https://secure.gravatar.com/avatar/7afdbf27831b1b2e2b92be84eb9d321c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jorge</span>
	                <span class="date">July 27, 2018 at 7:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444539" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, agin thanks for your tutorial</p>
<p>There is one of your tutorial you said  ”  It also requires explicit resetting of the network state after each exposure to the training data (epoch) by calls to model.reset_states()”<br>
-name of that tutorial is “Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras”</p>
<p>I am wondering why that idea was not implemented in this code</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444539" onclick="return addComment.moveForm( &quot;comment-444539&quot;, &quot;444539&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to jorge">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444590" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-444590" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 28, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444590" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>By all means you can try it.</p>
<p>I wanted the focus of the tutorial to be how to get multivariate time series going with LSTM, not all the variations in which to do it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444590" onclick="return addComment.moveForm( &quot;comment-444590&quot;, &quot;444590&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444697" class="comment even depth-3 parent">

	      	<div id="li-comment-444697" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/561ca5f087477dba61ce4960b723bdc2.png" srcset="https://secure.gravatar.com/avatar/561ca5f087477dba61ce4960b723bdc2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luke</span>
	                <span class="date">July 29, 2018 at 9:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444697" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your answer.</p>
<p>One last question.<br>
According to your sample, if I change like this</p>
<p># drop columns we don’t want to predict<br>
reframed.drop(reframed.columns[[6, 7, 8,10,11,12,13,14,15]], axis=1, inplace=True)</p>
<p>What should I edit more to make it work?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444697" onclick="return addComment.moveForm( &quot;comment-444697&quot;, &quot;444697&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Luke">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444736" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-444736" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 30, 2018 at 5:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444736" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m eager to help, but I don’t have the capacity to customize the tutorial for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444736" onclick="return addComment.moveForm( &quot;comment-444736&quot;, &quot;444736&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444564" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-444564" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6ea5737ef7c3d9ffb228d4b4ef7238a9.png" srcset="https://secure.gravatar.com/avatar/6ea5737ef7c3d9ffb228d4b4ef7238a9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">RYY</span>
	                <span class="date">July 28, 2018 at 2:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Thank you so much for such useful code. It works very well.<br>
By the way, my data set has hundreds of features and the number of lag time to be considered is over 10000. Therefore, when using the function “series_to_supervised”, insufficient memory happens and the operation stops completely.</p>
<p>I think it can be solved by using model.fit_generator, but I can not make generator code that incorporates series_to_supervised function….</p>
<p>Could you tell me your opinion?<br>
I really need your help…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444564" onclick="return addComment.moveForm( &quot;comment-444564&quot;, &quot;444564&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to RYY">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444601" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444601" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 28, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444601" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try working with less data?<br>
Perhaps try working on a machine with more RAM?<br>
Perhaps try writing a custom data generator?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444601" onclick="return addComment.moveForm( &quot;comment-444601&quot;, &quot;444601&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444636" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444636" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7afdbf27831b1b2e2b92be84eb9d321c.png" srcset="https://secure.gravatar.com/avatar/7afdbf27831b1b2e2b92be84eb9d321c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jorge</span>
	                <span class="date">July 28, 2018 at 7:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444636" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>I did as you suggest reset the states after every epoch, results become better. Unfortunately when i add stateful = True at lstm layer, the results become not good and I used time series data. So is it OK to train with both stateful and return_sequence  to be False</p>
<p>If stateful = False means the RNN does not learn the relation between sequences, it means sequence 1 will be treated independently of sequence 2?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444636" onclick="return addComment.moveForm( &quot;comment-444636&quot;, &quot;444636&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to jorge">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444665" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444665" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not quite. A stateful LSTM will give you control over when internal state is reset. </p>
<p>A “stateless” lstm will reset state after each batch of samples during training.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444665" onclick="return addComment.moveForm( &quot;comment-444665&quot;, &quot;444665&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444717" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-444717" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a7b835389dd2f3f5d403cb3f7e855ed8.png" srcset="https://secure.gravatar.com/avatar/a7b835389dd2f3f5d403cb3f7e855ed8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yang</span>
	                <span class="date">July 30, 2018 at 1:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444717" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason Thank you for your great code.<br>
I was following your direction and I got some error at<br>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
this code named ‘while_loop() got an unexpected keyword argument ‘maximum_iterations’.<br>
Do you know how to solve this problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444717" onclick="return addComment.moveForm( &quot;comment-444717&quot;, &quot;444717&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Yang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444744" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444744" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 30, 2018 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444744" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444744" onclick="return addComment.moveForm( &quot;comment-444744&quot;, &quot;444744&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444725" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444725" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/15953d4e4e94a024ddc79648cbb00a13.png" srcset="https://secure.gravatar.com/avatar/15953d4e4e94a024ddc79648cbb00a13?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kaushik Dey</span>
	                <span class="date">July 30, 2018 at 4:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444725" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the code and explanations.. Really helped me get a handle on time series using RNNs..<br>
One question, I found during the data preparation phase, if I use a StandardScaler as opposed to a MinMaxScaler, the accuracy deteriorates by huge amount.. Can you throw some light on why a standard scaling cannot provide even a  close result on the same code which MinMax scaling can?</p>
<p>Thanks and really appreciate your work in this blog</p>
<p>Regards<br>
Kaushik</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444725" onclick="return addComment.moveForm( &quot;comment-444725&quot;, &quot;444725&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kaushik Dey">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444749" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-444749" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 30, 2018 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444749" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on the data and the model that you are using.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444749" onclick="return addComment.moveForm( &quot;comment-444749&quot;, &quot;444749&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444782" class="comment even depth-3 parent">

	      	<div id="li-comment-444782" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/15953d4e4e94a024ddc79648cbb00a13.png" srcset="https://secure.gravatar.com/avatar/15953d4e4e94a024ddc79648cbb00a13?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kaushik Dey</span>
	                <span class="date">July 30, 2018 at 2:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444782" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I was using the same pollution data and the model is the LSTM, coded in the way, which you have shown… All I did was change the scaling to StandardScaler and the prediction accuracy just went out of bounds… Any pointers/ thoughts you can provide on this would be helpful..</p>
<p>Thanks in advance…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444782" onclick="return addComment.moveForm( &quot;comment-444782&quot;, &quot;444782&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kaushik Dey">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451086" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-451086" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6ec0900d38cb3b29261a0e771efc8a45.png" srcset="https://secure.gravatar.com/avatar/6ec0900d38cb3b29261a0e771efc8a45?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Le Van Duc</span>
	                <span class="date">October 9, 2018 at 4:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451086" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
I also run Jason’s tutorial with changing MinMaxScaler to StandardScaler (just change like this: scaler = StandardScaler() and everything else keeps no change) and I got a better RMSE of 24.619.<br>
Hope this help you !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451086" onclick="return addComment.moveForm( &quot;comment-451086&quot;, &quot;451086&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Le Van Duc">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451142" class="comment even depth-5">

	      	<div id="li-comment-451142" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/319e879f2235473fe4a4ebfbaf8657d7.png" srcset="https://secure.gravatar.com/avatar/319e879f2235473fe4a4ebfbaf8657d7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kaushik Dey</span>
	                <span class="date">October 10, 2018 at 1:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451142" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Le Van. However in my case using a Standard Scaler takes down the RMSE quite a few notches… Not sure why!!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-451163" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-451163" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2018 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451163" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice tip!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444776" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-444776" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4f0ebd5744ee255e2797c9849eebc6de.png" srcset="https://secure.gravatar.com/avatar/4f0ebd5744ee255e2797c9849eebc6de?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jake</span>
	                <span class="date">July 30, 2018 at 12:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444776" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am curious about RMSE part.</p>
<p>First, does inv_y equivalent to test_y ? because inv_y is inverse of test_y.<br>
And in RMSE calculation, why don’t we use rmse = sqrt(mean_squared_error(yhat, test_y)) instead? because mean square error should calculated from prediction and test. Or did I missing something?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444776" onclick="return addComment.moveForm( &quot;comment-444776&quot;, &quot;444776&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jake">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444788" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-444788" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 30, 2018 at 2:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444788" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are inverting the transform on the prediction before comparing yhat to y_true in original units.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444788" onclick="return addComment.moveForm( &quot;comment-444788&quot;, &quot;444788&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444809" class="comment even depth-3 parent">

	      	<div id="li-comment-444809" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4f0ebd5744ee255e2797c9849eebc6de.png" srcset="https://secure.gravatar.com/avatar/4f0ebd5744ee255e2797c9849eebc6de?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jake</span>
	                <span class="date">July 30, 2018 at 11:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444809" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your answer. Nevertheless, I am really confused in Evaluate model part.</p>
<p>In my understanding, we use inverse to inverse value that we normalized back to same value just like in dataset.</p>
<p>But when I try to print(inv_y)</p>
<p>and result in</p>
<p>[31. 20. 19. … 10.  8. 12.]</p>
<p>If this is really inverse of y or something we want to predict or test (Pollution). It should be as same as value in dataset. But those first 3 lines of values is not like to any value in pollution dataset column.</p>
<p>To summarize my problem. I mean like this</p>
<p>inv_y : 31, 20, 19<br>
Polution : 129, 148, 159</p>
<p>They are not the same. </p>
<p>I followed all of your code and it give me result of RMSE but I am a bit confused about this.<br>
Am I missing something? Thanks for your reply in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444809" onclick="return addComment.moveForm( &quot;comment-444809&quot;, &quot;444809&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jake">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444833" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-444833" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 31, 2018 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444833" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you sure you’re printing the correct column of data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444833" onclick="return addComment.moveForm( &quot;comment-444833&quot;, &quot;444833&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444875" class="comment even depth-5">

	      	<div id="li-comment-444875" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4f0ebd5744ee255e2797c9849eebc6de.png" srcset="https://secure.gravatar.com/avatar/4f0ebd5744ee255e2797c9849eebc6de?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jake</span>
	                <span class="date">July 31, 2018 at 1:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am pretty sure that I am printing correct data. Even though I print wrong column, it should be same as some column in dataset, but it don not match any column at all. That’s why I am curious about it.</p>
<p>Thank for your answer in advance, looking forward for your reply soon.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-444878" class="comment odd alt depth-5">

	      	<div id="li-comment-444878" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4f0ebd5744ee255e2797c9849eebc6de.png" srcset="https://secure.gravatar.com/avatar/4f0ebd5744ee255e2797c9849eebc6de?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jake</span>
	                <span class="date">July 31, 2018 at 2:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444878" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I just found something that maybe useful.</p>
<p>After I print test_y, it result like this</p>
<p>[[0.03118712]<br>
 [0.02012072]<br>
 [0.01911469]<br>
 …<br>
 [0.01006036]<br>
 [0.00804829]<br>
 [0.01207243]]</p>
<p>And when I print inv_y, it result like this</p>
<p>[31. 20. 19. … 10.  8. 12.]</p>
<p>For some reason, this look like inv_y is test_y * 100, not the inverse of data column.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444898" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444898" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/32e3b26856f1a7bc70181a49d6913597.png" srcset="https://secure.gravatar.com/avatar/32e3b26856f1a7bc70181a49d6913597?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muddassir</span>
	                <span class="date">July 31, 2018 at 6:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What if we don’t have the target variable ‘Y’ in the test.<br>
In the above case we have the target variable in both train and test.</p>
<p>Can u please suggest?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444898" onclick="return addComment.moveForm( &quot;comment-444898&quot;, &quot;444898&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Muddassir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444951" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-444951" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2018 at 7:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444951" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must have targets in train and test.</p>
<p>If you don’t have a target for a dataset, then you are making a prediction with a final model:<br>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<p>Here’s how:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444951" onclick="return addComment.moveForm( &quot;comment-444951&quot;, &quot;444951&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445138" class="comment even depth-3 parent">

	      	<div id="li-comment-445138" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/32e3b26856f1a7bc70181a49d6913597.png" srcset="https://secure.gravatar.com/avatar/32e3b26856f1a7bc70181a49d6913597?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muddassir</span>
	                <span class="date">August 3, 2018 at 1:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445138" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i have 4 years of data 2007,2008,2009,2010 data with 10 predictor variables and 1 target variable .<br>
Target variable is continous.<br>
train data:2007,2008,2009<br>
test data:2010<br>
I have to forecast the target variable for 2011<br>
Note: predictor variables are not given for 2011 data .</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445138" onclick="return addComment.moveForm( &quot;comment-445138&quot;, &quot;445138&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Muddassir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445142" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-445142" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 3, 2018 at 2:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445142" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Once you choose your model configuration, you can train a final model and use it to predict 2011.</p>
<p>I have more on final models here:<br>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445142" onclick="return addComment.moveForm( &quot;comment-445142&quot;, &quot;445142&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445178" class="comment even depth-5">

	      	<div id="li-comment-445178" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/32e3b26856f1a7bc70181a49d6913597.png" srcset="https://secure.gravatar.com/avatar/32e3b26856f1a7bc70181a49d6913597?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muddassir</span>
	                <span class="date">August 4, 2018 at 12:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I will check and get back to u</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444920" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-444920" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4aefa6173df962ad926e8f5397784003.png" srcset="https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">RUI J GONCALVES</span>
	                <span class="date">August 1, 2018 at 12:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444920" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is multivariate or multivariable ? I think it is multivariable in this case (many “indicators” to predict one value : <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3518362/" rel="nofollow">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3518362/</a> )</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444920" onclick="return addComment.moveForm( &quot;comment-444920&quot;, &quot;444920&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to RUI J GONCALVES">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444960" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-444960" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2018 at 7:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444960" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the ref.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-444960" onclick="return addComment.moveForm( &quot;comment-444960&quot;, &quot;444960&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445098" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-445098" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4e465c9175e58209b68bb8b7cd5bb4a0.png" srcset="https://secure.gravatar.com/avatar/4e465c9175e58209b68bb8b7cd5bb4a0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">August 3, 2018 at 5:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445098" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For evaluation, how about:</p>
<p>pyplot.scatter(test_y, yhat)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445098" onclick="return addComment.moveForm( &quot;comment-445098&quot;, &quot;445098&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445120" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-445120" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 3, 2018 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445120" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very nice.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445120" onclick="return addComment.moveForm( &quot;comment-445120&quot;, &quot;445120&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445156" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-445156" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4bb90c1e6e593c6d9e27594d8807bf61.png" srcset="https://secure.gravatar.com/avatar/4bb90c1e6e593c6d9e27594d8807bf61?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Simranjit Singh</span>
	                <span class="date">August 3, 2018 at 6:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445156" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir, First of all Great Tutorial<br>
I am new to this. In the tutorial, reframed.drop the columns u want to predict. how can i make changes such that i can predict more columns??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445156" onclick="return addComment.moveForm( &quot;comment-445156&quot;, &quot;445156&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Simranjit Singh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445194" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-445194" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 4, 2018 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445194" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Change the model to have multiple nodes in the output layer, then change the data accordingly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445194" onclick="return addComment.moveForm( &quot;comment-445194&quot;, &quot;445194&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445163" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-445163" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/17537ee7e8d6bbe0cc77f7215ed10307.png" srcset="https://secure.gravatar.com/avatar/17537ee7e8d6bbe0cc77f7215ed10307?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alan</span>
	                <span class="date">August 3, 2018 at 8:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445163" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
in case know the covariates value in next 24 timesteps  and i want to estimate thevalue of pollution. How can I adjust the model you have published? Thx A</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445163" onclick="return addComment.moveForm( &quot;comment-445163&quot;, &quot;445163&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Alan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445199" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-445199" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 4, 2018 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445199" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t follow, perhaps you can rephrase your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445199" onclick="return addComment.moveForm( &quot;comment-445199&quot;, &quot;445199&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445226" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-445226" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/25f908b89bb92bb471f645dd4b1fd5ea.png" srcset="https://secure.gravatar.com/avatar/25f908b89bb92bb471f645dd4b1fd5ea?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">FP</span>
	                <span class="date">August 4, 2018 at 10:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445226" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good Day Jason,</p>
<p>Thank you for this example. I hope you do not mind a couple of questions:</p>
<p>1. Are you perhaps aware of similar example for time series stock market forecasting?<br>
2. Could you clarify whether the back propagation algorithm is used in this demonstration?</p>
<p>Tx, FP</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445226" onclick="return addComment.moveForm( &quot;comment-445226&quot;, &quot;445226&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to FP">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445260" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-445260" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 5, 2018 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445260" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have more on the stock market here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market</a></p>
<p>Backpropagation was used to train the model. specifically Backpropagation through time or BPTT.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445260" onclick="return addComment.moveForm( &quot;comment-445260&quot;, &quot;445260&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445372" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-445372" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7afdbf27831b1b2e2b92be84eb9d321c.png" srcset="https://secure.gravatar.com/avatar/7afdbf27831b1b2e2b92be84eb9d321c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jorge</span>
	                <span class="date">August 6, 2018 at 5:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445372" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason</p>
<p>Thanks for the good tutorial, I have another question regarding usage of dataset.<br>
We used  test_X, test_y as validation dataset and again we used  test_X, test_y for prediction as testing dataset. Some data science tutorial said need three separate dataset for train, validation and testing. There is no effect of using the same dataset during fitting the model and evaluating the model</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445372" onclick="return addComment.moveForm( &quot;comment-445372&quot;, &quot;445372&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to jorge">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445413" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-445413" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 7, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can learn more about the use of the different datasets here:<br>
<a href="https://machinelearningmastery.com/difference-test-validation-datasets/" rel="nofollow">https://machinelearningmastery.com/difference-test-validation-datasets/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445413" onclick="return addComment.moveForm( &quot;comment-445413&quot;, &quot;445413&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445861" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-445861" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/59a1a45efd73fe5053c7c201e4f898bc.png" srcset="https://secure.gravatar.com/avatar/59a1a45efd73fe5053c7c201e4f898bc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Katya</span>
	                <span class="date">August 12, 2018 at 2:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445861" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you so much for creating this amazing blog. I have learned so much about time series modeling from you. </p>
<p>I’m new to machine learning and have a basic question about LSTMs. When you split your data into a test and training set as you did in your example, is the training set using the LSTM model-predicted value to predict the next time step value; or does the test set use the real previous day’s value to go to the next time step?</p>
<p>For example, I used an LSTM model with a 10 day lag and 7 independent variables to predict a dependent variable. All values are measured once a day and I had 2876 days of data. I made my training set the first 2000 values and used that model to predict the next 876 days. I got a RMSE of less than 1 and the plot between modeled and observed (real data) was extremely well fit. It was so well fit that it made me wonder if I was missing something. </p>
<p>To help illustrate my question, let’s say I’m looking at data point 2300, which is in the test set. Is the LSTM using the real dependent variables from days 2290-2299 to predict the dependent variable on day 2300 or is it using the predicted values for days 2290-2299 to predict day 2300? I understand that each day in the test set would use the real data for the 7 independent variables. </p>
<p>Please let me know if I need to clarify this further. I really look forward to hearing from you. Thanks. </p>
<p>Katya</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445861" onclick="return addComment.moveForm( &quot;comment-445861&quot;, &quot;445861&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Katya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445887" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-445887" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 12, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445887" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can choose to model the problem any way you wish. </p>
<p>I’d encourage you to explore a few framings of the problem in order to discover work works well.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445887" onclick="return addComment.moveForm( &quot;comment-445887&quot;, &quot;445887&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445890" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-445890" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/59a1a45efd73fe5053c7c201e4f898bc.png" srcset="https://secure.gravatar.com/avatar/59a1a45efd73fe5053c7c201e4f898bc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Katya</span>
	                <span class="date">August 12, 2018 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445890" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason. I meant in your example, which way did you do this? Is your model predicting all of the data in your test set using predicted y-variables the whole time, or is each new y-prediction going back to the real data to forecast ahead? It seems the model is way more accurate if it can correctly simulate 800+ days of data when predicted values for t-1 and t-2 are used as opposed to using the real data, the x-variables, and the model to predict the next day’s value. Hopefully this makes sense. </p>
<p>What I’m modeling varies between 60 and 200, and only moves up and down a few points each day. So it wouldn’t be hard to forecast it using a moving average if all you had to do was correctly guess the next day. But to correctly guess 800+ days in a row, which I thought it what a validation (test set) does, is much more impressive. </p>
<p>I also had another question. Can you write a more detailed explanation of what “n_features = 8” means? I thought it would be something like the number of independent variables in your model, but there are only 7 of those so I am confused.  Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445890" onclick="return addComment.moveForm( &quot;comment-445890&quot;, &quot;445890&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Katya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445954" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-445954" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 13, 2018 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445954" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will better explain how to prepare input data for the LSTM:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-445954" onclick="return addComment.moveForm( &quot;comment-445954&quot;, &quot;445954&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446259" class="comment odd alt depth-5">

	      	<div id="li-comment-446259" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/59a1a45efd73fe5053c7c201e4f898bc.png" srcset="https://secure.gravatar.com/avatar/59a1a45efd73fe5053c7c201e4f898bc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Katya</span>
	                <span class="date">August 17, 2018 at 12:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446259" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Thank you. I appreciate your help.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446012" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446012" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4b5a9f9777c53b6c017390b6ae9ff652.png" srcset="https://secure.gravatar.com/avatar/4b5a9f9777c53b6c017390b6ae9ff652?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rich Larrabee</span>
	                <span class="date">August 14, 2018 at 12:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446012" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can this algorithm be used to find outliers or anomalies in the data set?  If so, what changes would be used?</p>
<p>Thanks,</p>
<p>Rich</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446012" onclick="return addComment.moveForm( &quot;comment-446012&quot;, &quot;446012&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rich Larrabee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446045" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446045" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 14, 2018 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this will help:<br>
<a href="https://machinelearningmastery.com/how-to-use-statistics-to-identify-outliers-in-data/" rel="nofollow">https://machinelearningmastery.com/how-to-use-statistics-to-identify-outliers-in-data/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446045" onclick="return addComment.moveForm( &quot;comment-446045&quot;, &quot;446045&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446028" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-446028" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/cb29641563938997c0873a90bfb82bae.png" srcset="https://secure.gravatar.com/avatar/cb29641563938997c0873a90bfb82bae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tejpata</span>
	                <span class="date">August 14, 2018 at 4:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446028" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How can we do it for images ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446028" onclick="return addComment.moveForm( &quot;comment-446028&quot;, &quot;446028&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tejpata">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446053" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446053" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 14, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446053" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do what?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446053" onclick="return addComment.moveForm( &quot;comment-446053&quot;, &quot;446053&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446093" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446093" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e1bf050e6a4a1b90a45a04221e3a564e.png" srcset="https://secure.gravatar.com/avatar/e1bf050e6a4a1b90a45a04221e3a564e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://-/" rel="external nofollow" class="url">Thibault</a></span>
	                <span class="date">August 14, 2018 at 9:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446093" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, I took your example to make a hydrological forecast for the next hour using meteorological forecasts available as explanatory variables at time t + 0 and the hydrological variable t-1. It works pretty well thank you very much.<br>
Given that I have weather forecasts for the next 72 hours, how do I run the model 72 times, taking each time my previous forecast (Y) as a new entry and having 72 hours of forecast? There I am stuck</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446093" onclick="return addComment.moveForm( &quot;comment-446093&quot;, &quot;446093&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Thibault">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446127" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-446127" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2018 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446127" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try a for-loop.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446127" onclick="return addComment.moveForm( &quot;comment-446127&quot;, &quot;446127&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446372" class="comment even depth-3 parent">

	      	<div id="li-comment-446372" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e1bf050e6a4a1b90a45a04221e3a564e.png" srcset="https://secure.gravatar.com/avatar/e1bf050e6a4a1b90a45a04221e3a564e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thibault</span>
	                <span class="date">August 18, 2018 at 12:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446372" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Helllo again<br>
I tried to adapt the multivariate forecast above on several timestamps to my case an it works. But I can not make a loop for my model outputs as model entries, for example for the next 72 hours. How are you doing that? It’s probably a bit like this example below, but it’s multivariate… Pease I would take any help :</p>
<p># make one forecast with an LSTM,<br>
def forecast_lstm(model, X, n_batch):<br>
	# reshape input pattern to [samples, timesteps, features]<br>
	X = test_X.reshape(1, 1, len(X))<br>
	# make forecast<br>
	forecast = model.predict(X, batch_size=n_batch)<br>
	# convert to array<br>
	return [x for x in forecast[0, :]]</p>
<p># evaluate the persistence model<br>
def make_forecasts(model, n_batch, train, test, n_lag, n_seq):<br>
	forecasts = list()<br>
	for i in range(len(test)):<br>
		X, y = test[i, 0:n_lag], test[i, n_lag:]<br>
		# make forecast<br>
		forecast = forecast_lstm(model, X, n_batch)<br>
		# store the forecast<br>
		forecasts.append(forecast)<br>
	return forecasts</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446372" onclick="return addComment.moveForm( &quot;comment-446372&quot;, &quot;446372&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Thibault">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446386" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-446386" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2018 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446386" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This may help:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446386" onclick="return addComment.moveForm( &quot;comment-446386&quot;, &quot;446386&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446112" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-446112" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/74bd06fb0fc32730b7a73285d4035a6f.png" srcset="https://secure.gravatar.com/avatar/74bd06fb0fc32730b7a73285d4035a6f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">OR</span>
	                <span class="date">August 15, 2018 at 2:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446112" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you think about PyTorch, Jason? Is it going to replace Keras as a go-to toolkit for newbies? Maybe you can write an article comparing the two platforms and why you think one might be better than another.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446112" onclick="return addComment.moveForm( &quot;comment-446112&quot;, &quot;446112&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to OR">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446141" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446141" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446141" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps, but not yet.</p>
<p>Keras might be easier to use, pytorch might have more flexibility.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446141" onclick="return addComment.moveForm( &quot;comment-446141&quot;, &quot;446141&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446212" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446212" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3e1de3bbe4c10a897419b08b691d66b1.png" srcset="https://secure.gravatar.com/avatar/3e1de3bbe4c10a897419b08b691d66b1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aynaz Biniyaz</span>
	                <span class="date">August 16, 2018 at 7:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446212" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
Thank you for your great blog and examples.I am very new in Machine Learning topic and  I was wondering If we could just predict the Pollution based on the other inputs, not included the Pollution as input. I appreciate your help in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446212" onclick="return addComment.moveForm( &quot;comment-446212&quot;, &quot;446212&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Aynaz Biniyaz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446231" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446231" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2018 at 1:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446231" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you will have to modify the example to only use the other variables as input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446231" onclick="return addComment.moveForm( &quot;comment-446231&quot;, &quot;446231&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446601" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-446601" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8677c8d9a90844c508c168cd72874b64.png" srcset="https://secure.gravatar.com/avatar/8677c8d9a90844c508c168cd72874b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">August 21, 2018 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446601" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I have read also other answers you provide and also your article about the difference between training, validation and test set. But it is still not clear to me why during the training of our model when we fit it we use ” validation_data=(X_test, y_test)” , that is the same test dataset we will use to make the final predictions. I hope you can help me to understand it since for me this is not clear.<br>
Thank you,<br>
Marco</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446601" onclick="return addComment.moveForm( &quot;comment-446601&quot;, &quot;446601&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Marco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446622" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446622" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 21, 2018 at 2:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446622" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You do not need to use a validation dataset, it is a choice.</p>
<p>You can learn more about validation datasets here:<br>
<a href="https://machinelearningmastery.com/difference-test-validation-datasets/" rel="nofollow">https://machinelearningmastery.com/difference-test-validation-datasets/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446622" onclick="return addComment.moveForm( &quot;comment-446622&quot;, &quot;446622&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446635" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446635" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5eaa76710276a08925b69cde4def89a6.png" srcset="https://secure.gravatar.com/avatar/5eaa76710276a08925b69cde4def89a6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Henry</span>
	                <span class="date">August 21, 2018 at 6:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446635" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Jason:<br>
       Thanks for your share. Your example data is formed by weather conditions and pollution,and your goal is to predict current time’s pollution according to previous time step(s’)’s weather conditions and pollution. What if the weather conditions are the artificial control variables,and can I use LSTM to solve it? For example,my data is formed by system’s control variable and system performance(ipc,etc.) in time series, that is, each interval I change the systems control variable and measure a instant performance during emulator’s working. My goal is to train a model between system’s control variable and system’s performance, is it proper for me to use a LSTM  to solve it? Hope your answer,thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446635" onclick="return addComment.moveForm( &quot;comment-446635&quot;, &quot;446635&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Henry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446679" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446679" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 22, 2018 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446679" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446679" onclick="return addComment.moveForm( &quot;comment-446679&quot;, &quot;446679&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446646" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-446646" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/457b9c7391063ce419c636ffe28533e1.png" srcset="https://secure.gravatar.com/avatar/457b9c7391063ce419c636ffe28533e1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">xiaojuan cheng</span>
	                <span class="date">August 21, 2018 at 8:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446646" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hai,I have a question. when normalize data, you use all the data, including input and output.<br>
and when invert scaler, you use all the training or test data, including input and output. why not<br>
invert just output? because when compute rmse, we just need pre_y and true_y, if I invert only output values, not input value, is it right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446646" onclick="return addComment.moveForm( &quot;comment-446646&quot;, &quot;446646&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to xiaojuan cheng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446681" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446681" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 22, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We only need to invert the output to calculate RMSE. We create a larger matrix because the sklearn library requires the data to be the same shape on each call to fit(), transform() and invert_transform().</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446681" onclick="return addComment.moveForm( &quot;comment-446681&quot;, &quot;446681&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446736" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446736" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ac1a7d4c79c73b8ecf5c8bec2e1d2c13.png" srcset="https://secure.gravatar.com/avatar/ac1a7d4c79c73b8ecf5c8bec2e1d2c13?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Richard</span>
	                <span class="date">August 22, 2018 at 11:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446736" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr Brownlee<br>
Deeply enjoyed this article, and all other ones.<br>
I have a question regarding a problem I have, which is that I have a data with a timeline for 2 years and with data each week of 10 variables. eg, 2017/01/01 var1 = a, var2 = b, var3 = c etc. All data are numeric. i want to predict all varibales for the next 3 month for example, Is this a problem that lstm time seris can solve or is it a surviavl problem, thank you very much for your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446736" onclick="return addComment.moveForm( &quot;comment-446736&quot;, &quot;446736&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Richard">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446760" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446760" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2018 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446760" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend testing many other methods first.</p>
<p>Follow this process:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446760" onclick="return addComment.moveForm( &quot;comment-446760&quot;, &quot;446760&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446749" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-446749" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7b49654b99b2c07d131b6dacedb27001.png" srcset="https://secure.gravatar.com/avatar/7b49654b99b2c07d131b6dacedb27001?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Miles</span>
	                <span class="date">August 23, 2018 at 3:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446749" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks so much for this Jason! I have a question about seeding the forecast. With the LSTM, it looks like I have to provide a “guess” at the pollution for the forecast to work (e.g., I can’t just give it the inputs from the previous day and get an answer without also providing a “guess” at what the answer might be). This will probably work well for trying to predict the next day. But what if I wanted to forecast every day for the next month where I don’t have a good guess at what the pollution level might be?<br>
Is this basically just a multi-step multivariate time series forecast? And do you have a tutorial for something like this?<br>
Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446749" onclick="return addComment.moveForm( &quot;comment-446749&quot;, &quot;446749&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Miles">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446764" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-446764" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446764" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No guessing is going on.</p>
<p>You can frame the problem any way you wish.</p>
<p>Nail down the inputs you want to use and the outputs required, then define a model to meet that, then reshape your data into that form.</p>
<p>I have a number of multivariate multistep examples written already and scheduled. I also have some in my new book that should be out in a week or two on deep learning for time series forecasting.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446764" onclick="return addComment.moveForm( &quot;comment-446764&quot;, &quot;446764&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446769" class="comment even depth-3 parent">

	      	<div id="li-comment-446769" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7b49654b99b2c07d131b6dacedb27001.png" srcset="https://secure.gravatar.com/avatar/7b49654b99b2c07d131b6dacedb27001?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Miles</span>
	                <span class="date">August 23, 2018 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446769" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So if I wanted to follow this same example (forecasting air pollution), but I didn’t want to use the previous day’s pollution as an input, I could just drop that column from reframed dataframe, correct? e.g. Change<br>
# frame as supervised learning<br>
reframed = series_to_supervised(scaled, 1, 1)<br>
# drop columns we don’t want to predict<br>
reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)</p>
<p>to</p>
<p># frame as supervised learning<br>
reframed = series_to_supervised(scaled, 1, 1)<br>
# drop columns we don’t want to predict<br>
reframed.drop(reframed.columns[[0,9,10,11,12,13,14,15]], axis=1, inplace=True)</p>
<p>Dropping the first column drops the previous day’s pollution from the input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446769" onclick="return addComment.moveForm( &quot;comment-446769&quot;, &quot;446769&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Miles">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446773" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-446773" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2018 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446773" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, sounds good, although I’ve not tested your changes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446773" onclick="return addComment.moveForm( &quot;comment-446773&quot;, &quot;446773&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446776" class="comment even depth-5">

	      	<div id="li-comment-446776" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/7b49654b99b2c07d131b6dacedb27001.png" srcset="https://secure.gravatar.com/avatar/7b49654b99b2c07d131b6dacedb27001?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Miles</span>
	                <span class="date">August 23, 2018 at 8:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446776" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Fantastic. Going to try it. Will let you know how it turns out.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446945" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446945" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1bba64cd3890e29f89bd37efb57a8ccb.png" srcset="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chrisa</span>
	                <span class="date">August 25, 2018 at 8:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446945" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jashon,</p>
<p>Can I apply lstm if I want to categorize my input into 4 classes? Like the iris problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446945" onclick="return addComment.moveForm( &quot;comment-446945&quot;, &quot;446945&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Chrisa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446982" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-446982" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 26, 2018 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446982" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>LSTMs are not suitable for non-sequence prediction problems like the iris flower problem.</p>
<p>Learn more here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/when-should-i-use-an-mlp-cnn-and-rnn" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/when-should-i-use-an-mlp-cnn-and-rnn</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-446982" onclick="return addComment.moveForm( &quot;comment-446982&quot;, &quot;446982&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447033" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-447033" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ec67ed3c7331ff62587ee80e88e725e3.png" srcset="https://secure.gravatar.com/avatar/ec67ed3c7331ff62587ee80e88e725e3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">August 27, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447033" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Firstly I am new to this technology and this is has served as a great example, thank you!  I have modified the example and built a number of LSTM models that appear to forecast properly based on 1 second data.  Two questions:</p>
<p>1. What is the best way to predict given a real-time prediction scenario.  I can loop thru the real-time data and update a prediction every couple of minutes.  (i.e. wait until i have 60 rows of features then perform a prediction, wait for another 60 rows of features then re-predict etc …)  Would i change series_to_supervised(scaled, 60, 1) to support looking at 60 seconds at a time?</p>
<p>2. I am new and therefore cautious of using the predict feature with the feature (y variable) we are trying to predict in the data set (yhat = model.predict(test_X)).  Can we strip this variable out before loading the model.predict (e.g. yhat = model.predict(test_X[:,1:])?  I have tried this but it complains about a shape error … I am probably be overly cautious but when i predict in a real-time scenario we won’t have the y variable …</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447033" onclick="return addComment.moveForm( &quot;comment-447033&quot;, &quot;447033&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447050" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447050" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 27, 2018 at 1:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447050" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on your domain, e.g. whether there is benefit in fitting one final model, whether a model needs to be updated or whether a new model should be fit. Experiment and see what results in the best skill on your data.</p>
<p>You can model the problem anyway you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447050" onclick="return addComment.moveForm( &quot;comment-447050&quot;, &quot;447050&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447117" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-447117" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5135cce63995c2d41adf60753b1f0bbe.png" srcset="https://secure.gravatar.com/avatar/5135cce63995c2d41adf60753b1f0bbe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter Peng</span>
	                <span class="date">August 28, 2018 at 1:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447117" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. I apply LSTMs to the traffic flow predictiom(time series data). I have some questions to consult. First, i use “mse” as the loss function, but the test loss is always lower train loss during the whole process. And i get the same result even if change the dataset. That is why? Becase the loss function、model…? Second, you suggest that LSTMs can not be applied for time series data prediction and what preprocess(except for normalizition) needs to be done berfore features come into LSTMs, just do like your this example? In addition, i find that LSTMs can capture the trend of time series, but it is sometimes weak in accuracy.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447117" onclick="return addComment.moveForm( &quot;comment-447117&quot;, &quot;447117&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Peter Peng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447172" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447172" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2018 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447172" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some notes on having better performance on the test dataset here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/what-if-model-skill-on-the-test-dataset-is-better-than-the-training-dataset" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/what-if-model-skill-on-the-test-dataset-is-better-than-the-training-dataset</a></p>
<p>Try Relu activation functions with LSTMs. Also, I have found LSTMs work better if the data is differenced to remove trends/seasonality.</p>
<p>Also try CNNs, CNN-LSTMs and ConvLSTMs on time series, I’ve had great success.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447172" onclick="return addComment.moveForm( &quot;comment-447172&quot;, &quot;447172&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447155" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-447155" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ccac25358ff5f928f5a7c8c29ce771fc.png" srcset="https://secure.gravatar.com/avatar/ccac25358ff5f928f5a7c8c29ce771fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vishwas Samanth</span>
	                <span class="date">August 29, 2018 at 12:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447155" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>model = Sequential()<br>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))</p>
<p>In the code you have mentioned LSTM layer with 50 neurons, On what basis are we deciding the number of neurons here?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447155" onclick="return addComment.moveForm( &quot;comment-447155&quot;, &quot;447155&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Vishwas Samanth">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447188" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447188" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2018 at 8:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Trial and error. You can learn more here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447188" onclick="return addComment.moveForm( &quot;comment-447188&quot;, &quot;447188&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447205" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-447205" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/bb904120b43186d06afdc683e8c4dcb2.png" srcset="https://secure.gravatar.com/avatar/bb904120b43186d06afdc683e8c4dcb2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wendy</span>
	                <span class="date">August 29, 2018 at 10:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447205" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason,</p>
<p>I want to predict daily temperature based on historical data which is measured in each 15 minutes.</p>
<p>6/16/07 4:45	1.94	1180	16.7<br>
6/16/07 5:00	1.94	1180	16.7<br>
6/16/07 5:15	1.95	1190	16.7<br>
6/16/07 5:30	1.94	1180	16.6<br>
6/16/07 5:45	1.94	1180	16.6<br>
6/16/07 6:00	1.93	1180	16.6<br>
6/16/07 6:15	1.94	1180	16.6<br>
6/16/07 6:30	1.94	1180	16.5<br>
6/16/07 6:45	1.94	1180	16.5<br>
6/16/07 7:00	1.93	1180	16.5</p>
<p># specify the number of lag hours<br>
n_hours = 4*24    (is that correct ? if I want to have daily prediction)<br>
n_features = 3</p>
<p># split into train and test sets<br>
values = reframed.values<br>
n_train_hours = 365 * 24*4*8  (I have 10 years historical data. So I split 80% as train data. )</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447205" onclick="return addComment.moveForm( &quot;comment-447205&quot;, &quot;447205&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Wendy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447260" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447260" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 30, 2018 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447260" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m eager to help, but I don’t have the capacity to debug your changes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447260" onclick="return addComment.moveForm( &quot;comment-447260&quot;, &quot;447260&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447291" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-447291" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5135cce63995c2d41adf60753b1f0bbe.png" srcset="https://secure.gravatar.com/avatar/5135cce63995c2d41adf60753b1f0bbe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter Peng</span>
	                <span class="date">August 30, 2018 at 11:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447291" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, Jason. You suggest that LSTMs will work better if data is difference to remove trends/seasonality. Can you give me some examples or posts about it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447291" onclick="return addComment.moveForm( &quot;comment-447291&quot;, &quot;447291&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Peter Peng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447312" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447312" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 30, 2018 at 4:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447312" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I have a number scheduled and I have examples in the new book:<br>
<a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/</a></p>
<p>You can prepare your own examples also, fit a univariate problem that has trend+seasonality with and without differencing and compare results.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447312" onclick="return addComment.moveForm( &quot;comment-447312&quot;, &quot;447312&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447430" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-447430" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5135cce63995c2d41adf60753b1f0bbe.png" srcset="https://secure.gravatar.com/avatar/5135cce63995c2d41adf60753b1f0bbe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter Peng</span>
	                <span class="date">August 31, 2018 at 7:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447430" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks，Jason. I find that predicted value x(t) is equal to actual value x(t-1), which means that the model has one step delay by LSTMs. Can you give me some suggestions on how to improve or solve this problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447430" onclick="return addComment.moveForm( &quot;comment-447430&quot;, &quot;447430&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Peter Peng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447467" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447467" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 1, 2018 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447467" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447467" onclick="return addComment.moveForm( &quot;comment-447467&quot;, &quot;447467&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447491" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-447491" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3bac2085dcdb160c0490992e6bfc7a31.png" srcset="https://secure.gravatar.com/avatar/3bac2085dcdb160c0490992e6bfc7a31?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://omega.uta.edu/~nxk6013/" rel="external nofollow" class="url">Nitin Kanwar</a></span>
	                <span class="date">September 1, 2018 at 1:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447491" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Exceptional tutorials you have here on this website. I have been following this website for a while now. </p>
<p>I am kinda new to RNNs. I have a few questions/doubts – </p>
<p>1. In the example above, do we predict only for one time step in the future? What if I want to predict multiple time steps into the future? Will this code work or I need to make changes?</p>
<p>2. I read through Andrej Karpathy’s blog “The Unreasonable Effectiveness of Recurrent Neural Networks”. He performs a sampling process where he generates new characters once the RNN has learned. The following excerpt is from the blog –</p>
<p>“At test time, we feed a character into the RNN and get a distribution over what characters are likely to come next. We sample from this distribution, and feed it right back in to get the next letter. Repeat this process and you’re sampling text! Lets now train an RNN on different datasets and see what happens.”</p>
<p>Can we do something similar in this RNN? Like feed it data for one time step and keep feeding the result back to the RNN and predict for multiple time steps? If this is how it is being done in your code then could you please point me to the code section. </p>
<p>Thank you for all your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447491" onclick="return addComment.moveForm( &quot;comment-447491&quot;, &quot;447491&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nitin Kanwar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447537" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-447537" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 2, 2018 at 5:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447537" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example for predicting multiple future time steps:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>
<p>You can use RNNs as a generative model for time series. Not sure why you would want to though?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447537" onclick="return addComment.moveForm( &quot;comment-447537&quot;, &quot;447537&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447552" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-447552" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3bac2085dcdb160c0490992e6bfc7a31.png" srcset="https://secure.gravatar.com/avatar/3bac2085dcdb160c0490992e6bfc7a31?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nitin Kanwar</span>
	                <span class="date">September 2, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447552" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for your reply. </p>
<p>I am working on predicting stock prices based on historical stock market data available. I would like to predict stock prices for future dates. I plan to use RNNs to learn the features and make predictions. Once the predictions are generated, I want to apply a reinforcement learning algorithm to maximize the future profits. Does that sound feasible? I am new to RNNs and RL so not sure if this is the right path. Please let me know your thoughts.</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447552" onclick="return addComment.moveForm( &quot;comment-447552&quot;, &quot;447552&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Nitin Kanwar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447610" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-447610" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2018 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447610" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not a fan of predicting stocks:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market</a></p>
<p>Nevertheless, you can get a long way with stochastic optimization first, before trying RL methods.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447610" onclick="return addComment.moveForm( &quot;comment-447610&quot;, &quot;447610&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447627" class="comment odd alt depth-5">

	      	<div id="li-comment-447627" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3bac2085dcdb160c0490992e6bfc7a31.png" srcset="https://secure.gravatar.com/avatar/3bac2085dcdb160c0490992e6bfc7a31?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nitin Kanwar</span>
	                <span class="date">September 3, 2018 at 7:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447627" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply. </p>
<p>I am a graduate student working on a thesis to study the efficiency of Deep RL algorithms in predicting stock prices. I will really appreciate if you could point me to some good resources. </p>
<p>Thank you for all your help.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-447664" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-447664" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2018 at 1:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447664" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have material on deep RL, I cannot give you good ad hoc advice.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447564" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-447564" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/169a28e91d4f439dcf1deefc7590a713.png" srcset="https://secure.gravatar.com/avatar/169a28e91d4f439dcf1deefc7590a713?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SA</span>
	                <span class="date">September 2, 2018 at 9:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason</p>
<p>I have a time series dataset which include 30 attributes and the price.I would like to predict the price.All 30 fields are related to the price and the price in the past is also an important input.<br>
Any suggestions.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447564" onclick="return addComment.moveForm( &quot;comment-447564&quot;, &quot;447564&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to SA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447615" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-447615" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447615" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, try a suite of different methods and discover what works best for your specific dataset:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447615" onclick="return addComment.moveForm( &quot;comment-447615&quot;, &quot;447615&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447625" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-447625" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/169a28e91d4f439dcf1deefc7590a713.png" srcset="https://secure.gravatar.com/avatar/169a28e91d4f439dcf1deefc7590a713?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SA</span>
	                <span class="date">September 3, 2018 at 6:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447625" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason<br>
I have read the article , very comprehensive .Thanks a lot.</p>
<p>Is there any way that we can convert multiple inputs to one variable that represent all the inputs.For example I have 30 attribute which are all related to prediction .Is there any algorithm that receive multivariate  and convert it to univariate before we make the final prediction.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447625" onclick="return addComment.moveForm( &quot;comment-447625&quot;, &quot;447625&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to SA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447663" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-447663" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2018 at 1:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447663" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can train an autoencoder to compress multiple sequences to a fixed length vector.</p>
<p>I have a post on this topic scheduled.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447663" onclick="return addComment.moveForm( &quot;comment-447663&quot;, &quot;447663&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447737" class="comment odd alt depth-5">

	      	<div id="li-comment-447737" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/169a28e91d4f439dcf1deefc7590a713.png" srcset="https://secure.gravatar.com/avatar/169a28e91d4f439dcf1deefc7590a713?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SA</span>
	                <span class="date">September 4, 2018 at 5:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447737" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Great. Will look into it an wait for your new article.</p>
<p>You are the ML Wikipedia <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-447751" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-447751" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 4, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447751" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447588" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-447588" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b1a7f8d28ee52564248da8245d56db44.png" srcset="https://secure.gravatar.com/avatar/b1a7f8d28ee52564248da8245d56db44?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joe</span>
	                <span class="date">September 2, 2018 at 5:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447588" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I wonder if this method can be applied to real-time prediction or online learning? Perhaps change batch_size to 1 might make it online?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447588" onclick="return addComment.moveForm( &quot;comment-447588&quot;, &quot;447588&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Joe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447618" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447618" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447618" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean by online?</p>
<p>The model can make make predictions from one sample directly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447618" onclick="return addComment.moveForm( &quot;comment-447618&quot;, &quot;447618&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447677" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-447677" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a470d62ca2508a935277dd2effc92ec6.png" srcset="https://secure.gravatar.com/avatar/a470d62ca2508a935277dd2effc92ec6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rahul B Raj</span>
	                <span class="date">September 3, 2018 at 4:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447677" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I am relatively new to the topic. According to my understanding of the code, you have forecasted the pollution value for tomorrow providing today’s feature values(temperature, and the like). How can we do the same with forecasted feature values?<br>
Thank You</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447677" onclick="return addComment.moveForm( &quot;comment-447677&quot;, &quot;447677&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rahul B Raj">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447739" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-447739" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 4, 2018 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447739" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean exactly, what are the inputs and outputs that you want?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447739" onclick="return addComment.moveForm( &quot;comment-447739&quot;, &quot;447739&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447764" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-447764" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a470d62ca2508a935277dd2effc92ec6.png" srcset="https://secure.gravatar.com/avatar/a470d62ca2508a935277dd2effc92ec6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rahul B Raj</span>
	                <span class="date">September 4, 2018 at 11:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447764" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Suppose I have trained the data using 3 months  features f1 , f2 to predict w. Now I have an external data of f1 and f2 of the day after  the trained 3 months. I need to predict the corresponding w for the same.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447764" onclick="return addComment.moveForm( &quot;comment-447764&quot;, &quot;447764&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Rahul B Raj">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447772" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-447772" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 4, 2018 at 1:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447772" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>call model.predict()</p>
<p>What problem are you having exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447772" onclick="return addComment.moveForm( &quot;comment-447772&quot;, &quot;447772&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447778" class="comment odd alt depth-5">

	      	<div id="li-comment-447778" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a470d62ca2508a935277dd2effc92ec6.png" srcset="https://secure.gravatar.com/avatar/a470d62ca2508a935277dd2effc92ec6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rahul B Raj</span>
	                <span class="date">September 4, 2018 at 2:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>According to the model that you have created, the argument in the model.predict() has values in f1, f2 and w right?<br>
I know the f1 and f2 values of the next timestep. I need to get the  corresponding w value.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-447866" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-447866" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 5, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447866" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can define the inputs and outputs of the model to be anything you wish.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447912" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-447912" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8643f3131369fd0ad4182fab5b748cf7.png" srcset="https://secure.gravatar.com/avatar/8643f3131369fd0ad4182fab5b748cf7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Uday</span>
	                <span class="date">September 5, 2018 at 5:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447912" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for this tutorial.</p>
<p>I have a question on “how to automatically identify time series data using python”. I want to build one data science workbench, where I need to classify the problem type programatically by reading the data. We can easily differentiate Regression Vs Classification Vs Clustering. But I am looking at differentiating Time-Series Vs Regression problems. </p>
<p>Need to know your suggestions on how to differentiate the problem type, like, Time-Series Vs Regression programmatically.</p>
<p>Thank You</p>
<p>Uday</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447912" onclick="return addComment.moveForm( &quot;comment-447912&quot;, &quot;447912&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Uday">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447948" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447948" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 6, 2018 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447948" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If observations are ordered by time, it is a time series.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-447948" onclick="return addComment.moveForm( &quot;comment-447948&quot;, &quot;447948&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-448029" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-448029" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/dfd8ca942bc1ceeea5ccaeb8d63db207.png" srcset="https://secure.gravatar.com/avatar/dfd8ca942bc1ceeea5ccaeb8d63db207?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">keras_tf</span>
	                <span class="date">September 6, 2018 at 4:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448029" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi why are you using the same data for test and validation.Using the same data for both will not give proper info about its performance on truely unseen values.Or am i missing sth here.Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448029" onclick="return addComment.moveForm( &quot;comment-448029&quot;, &quot;448029&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to keras_tf">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448085" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-448085" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 7, 2018 at 8:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448085" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>To simplify the example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448085" onclick="return addComment.moveForm( &quot;comment-448085&quot;, &quot;448085&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-448118" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-448118" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/0e3aafa1a62669100fe1f01a7019f745.png" srcset="https://secure.gravatar.com/avatar/0e3aafa1a62669100fe1f01a7019f745?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Akim</span>
	                <span class="date">September 7, 2018 at 3:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448118" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Amazing job! Thank you for sharing. I have one question. I have 3 features and I want to look 20 steps back in time. I read in your other post “Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras” you define that as look_back. Then in my case my input will be 3*20=60?<br>
Thank you.</p>
<p>Regards,<br>
Akim</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448118" onclick="return addComment.moveForm( &quot;comment-448118&quot;, &quot;448118&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Akim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448162" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-448162" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 8, 2018 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448162" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend preparing data using this post:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448162" onclick="return addComment.moveForm( &quot;comment-448162&quot;, &quot;448162&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-448343" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-448343" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/3e13233de0995438bd586b5eabf7ba35.png" srcset="https://secure.gravatar.com/avatar/3e13233de0995438bd586b5eabf7ba35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ammara</span>
	                <span class="date">September 11, 2018 at 3:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason Thank you for the code. I used a random input variable  to predict pollution data. I did not change anything in pollution variable.</p>
<p>random_var=(np.random.randint(50, size=(1, 43800))).T<br>
Add random variable as a column in dataset<br>
random_var=dataset.iloc[:,8]</p>
<p>So basically input data is only  pollution data and random variable<br>
input_da=pd.concat([dataset.iloc[:,0:1],dataset.iloc[:,8]], axis=1)<br>
dataset = input_da.iloc[:,0:3]<br>
values = dataset.values</p>
<p>Model is predicting well even with random variable. How is that possible?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448343" onclick="return addComment.moveForm( &quot;comment-448343&quot;, &quot;448343&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to ammara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448364" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-448364" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 11, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448364" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I expect it did not do well.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448364" onclick="return addComment.moveForm( &quot;comment-448364&quot;, &quot;448364&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-448573" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-448573" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/d280417c9e8259448cf1a5bfb50cb02d.png" srcset="https://secure.gravatar.com/avatar/d280417c9e8259448cf1a5bfb50cb02d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ricardo</span>
	                <span class="date">September 12, 2018 at 2:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448573" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>thanks for this tutorial ! and the many others you made ! these are great learning tools, very practical !</p>
<p>I see this in the code , and I think there is a look ahead bias:<br>
# normalize features<br>
scaler = MinMaxScaler(feature_range=(0, 1))<br>
scaled = scaler.fit_transform(values)</p>
<p>and then later a split to train and test:<br>
train = values[:n_train_hours, :]<br>
test = values[n_train_hours:, :]</p>
<p>the usual approach is to 1st split in train and test and then do scaler.fit_transform(train) and scaler.transform(test)…</p>
<p>test data should be treated as unseen…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448573" onclick="return addComment.moveForm( &quot;comment-448573&quot;, &quot;448573&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Ricardo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448592" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-448592" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 12, 2018 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448592" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have advice on the ordering of transforms here:<br>
<a href="https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448592" onclick="return addComment.moveForm( &quot;comment-448592&quot;, &quot;448592&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-448806" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-448806" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/92145c585068148a2472c20d898acf9c.png" srcset="https://secure.gravatar.com/avatar/92145c585068148a2472c20d898acf9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Saad</span>
	                <span class="date">September 14, 2018 at 7:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448806" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
First of all, thank you for this wonderful blog.<br>
I am actually trying to use your LSTM however, I don’t see how I can do that given my data structure.<br>
I currently have time series for 500 stock returns over 5 years on a monthly basis (60 months total) along with characteristics of these companies (50 features like market capitalization, book-to-market ratio etc…), I want to apply the LSTM to predict one month ahead for all the stocks. So my dependent variable is a 60×500 and features 60x500x50.<br>
Do you think there is a best practice for doing that? Consider that my output is multivariate or univariate and do a loop over my stocks? I am still struggling to build my input data for RNN. For MLP and RF I just did a pooled data by training on 55×500 and testing on 5×500 without really worrying about time series and stocks but it didn’t give good results.<br>
Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448806" onclick="return addComment.moveForm( &quot;comment-448806&quot;, &quot;448806&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Saad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448857" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-448857" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 15, 2018 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448857" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Should not be a problem, although I think predicting stocks is a waste of time (you can’t).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-448857" onclick="return addComment.moveForm( &quot;comment-448857&quot;, &quot;448857&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449147" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-449147" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/49344db7bb3a407b5bab15e789709cfb.png" srcset="https://secure.gravatar.com/avatar/49344db7bb3a407b5bab15e789709cfb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brandon</span>
	                <span class="date">September 18, 2018 at 1:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the tutorial. </p>
<p>Question: When training a multi-lag timestep regression problem with LSTM model, does the model need to understand the sequential order of the input variables (e.g., t-3, t-2, t-1), or is it expected to be able to learn the sequence and apply the appropriate weights during the training process? </p>
<p>If the former, can you please explain where in the code this understanding occurs (e.g., when defining the 3D tensor)? I envision a LSTM model that looks back three previous periods (i.e., t-3) to have three separate LSTM cells that are performing the input, forget, and ouput gate calculations in each cell, but I want to make sure that my expectation lines up with what is actually going on in the Keras model.</p>
<p>Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449147" onclick="return addComment.moveForm( &quot;comment-449147&quot;, &quot;449147&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Brandon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449185" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-449185" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 18, 2018 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449185" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The order of time steps in a given sample is the order that the model is shown prior observations.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449185" onclick="return addComment.moveForm( &quot;comment-449185&quot;, &quot;449185&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449344" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-449344" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6afc035007b0ed423aea8b8bd60a3a62.png" srcset="https://secure.gravatar.com/avatar/6afc035007b0ed423aea8b8bd60a3a62?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mitch Oldroyd</span>
	                <span class="date">September 20, 2018 at 1:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449344" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,</p>
<p>It would appear that UCI has changed access (and content) of their databases.  Your link is broken (or rather meets with “you don’t have permission…”</p>
<p>I was able to locate the public facing database, but it doesn’t include the “Air Pollution” data set any more.</p>
<p><a href="http://mlr.cs.umass.edu/ml/datasets.html" rel="nofollow">http://mlr.cs.umass.edu/ml/datasets.html</a></p>
<p>Good luck,</p>
<p>Mitch</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449344" onclick="return addComment.moveForm( &quot;comment-449344&quot;, &quot;449344&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mitch Oldroyd">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449371" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-449371" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 20, 2018 at 8:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449371" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I have updated the link to my mirror. Here is a direct link:<br>
<a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/pollution.csv" rel="nofollow">https://raw.githubusercontent.com/jbrownlee/Datasets/master/pollution.csv</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449371" onclick="return addComment.moveForm( &quot;comment-449371&quot;, &quot;449371&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449413" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-449413" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c60154ace44cfe4ce118d5c92bc1cc5a.png" srcset="https://secure.gravatar.com/avatar/c60154ace44cfe4ce118d5c92bc1cc5a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Channing</span>
	                <span class="date">September 20, 2018 at 7:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very impressive. But for the certain scenario, I found the predict is just the pollution of last hour. For more generally speaking, in a “smooth” curve prediction scenario, use the value from last time step to predict current value is not a bad idea. <img draggable="false" class="emoji" alt="😛" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f61b.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449413" onclick="return addComment.moveForm( &quot;comment-449413&quot;, &quot;449413&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Channing">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449449" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-449449" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 21, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449449" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would encourage you to try a CNN, I would expect it to perform much better on this dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449449" onclick="return addComment.moveForm( &quot;comment-449449&quot;, &quot;449449&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449523" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-449523" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/37ff4b71a600e72671dea22825f2eef5.png" srcset="https://secure.gravatar.com/avatar/37ff4b71a600e72671dea22825f2eef5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">tmartin</span>
	                <span class="date">September 22, 2018 at 2:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449523" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi thanks for this great post, it was very useful.</p>
<p>I was not sure of what you mean here : “Remember that the internal state of the LSTM in Keras is reset at the end of each batch, so an internal state that is a function of a number of days may be helpful (try testing this).”</p>
<p>Could you elaborate on that please ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449523" onclick="return addComment.moveForm( &quot;comment-449523&quot;, &quot;449523&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to tmartin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449544" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-449544" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 22, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449544" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean changing the model to stateful and controlling when the state is reset based on the properties of the problem may change the performance of the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449544" onclick="return addComment.moveForm( &quot;comment-449544&quot;, &quot;449544&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449645" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-449645" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ceng</span>
	                <span class="date">September 24, 2018 at 1:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449645" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi thanks for this great post, it was very useful. But，how can I get the real number and the predicted number？ There is no answer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449645" onclick="return addComment.moveForm( &quot;comment-449645&quot;, &quot;449645&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to ceng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449658" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-449658" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 24, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449658" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Call model.predict() to make a prediction.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449658" onclick="return addComment.moveForm( &quot;comment-449658&quot;, &quot;449658&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449643" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-449643" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dazhi</span>
	                <span class="date">September 24, 2018 at 12:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449643" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi，Jason. First, I have to say you are a great master. But I don’t know how to predict, you just given the Trained model. How can I get the predicting number?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449643" onclick="return addComment.moveForm( &quot;comment-449643&quot;, &quot;449643&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dazhi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449657" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-449657" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 24, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449657" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Call model.predict()</p>
<p>Here’s an example:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449657" onclick="return addComment.moveForm( &quot;comment-449657&quot;, &quot;449657&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450792" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-450792" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dazhi</span>
	                <span class="date">October 6, 2018 at 12:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450792" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,master. I am coming to trouble you…Look:</p>
<p># make a prediction<br>
yhat = model.predict(test_X)<br>
test_X = test_X.reshape((test_X.shape[0], test_X.shape[2]))<br>
…</p>
<p>You have given the predicted value. But, I have multivariate, how to do? Just like your air pollution forecasting, how to use it in real forecasting?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450792" onclick="return addComment.moveForm( &quot;comment-450792&quot;, &quot;450792&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dazhi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450817" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-450817" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2018 at 5:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450817" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>You can use a seq2seq to output multiple time steps and the size of each time step can be the number of features (e.g. multivariate).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450817" onclick="return addComment.moveForm( &quot;comment-450817&quot;, &quot;450817&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-450795" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-450795" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dazhi</span>
	                <span class="date">October 6, 2018 at 1:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450795" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am a new learner, and I am not smart. I know that the test set is used to evaluate the model. It is only useful when building the model, right?  </p>
<p>Well, like the example of air pollution forecasting you talked about earlier, you have showed how to training the model，but no predictions. Later you showed the article——How to Make Predictions with Long Short-Term Memory Models in Keras.</p>
<p>However,I still don’t know how can I input the new data to make predictions? How to type the code? I am confused… How to implement it in the new script? Please help me, thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450795" onclick="return addComment.moveForm( &quot;comment-450795&quot;, &quot;450795&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Dazhi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450818" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-450818" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2018 at 5:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450818" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What is the problem exactly? Which part is confusing?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450818" onclick="return addComment.moveForm( &quot;comment-450818&quot;, &quot;450818&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450854" class="comment odd alt depth-5">

	      	<div id="li-comment-450854" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dazhi</span>
	                <span class="date">October 6, 2018 at 5:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450854" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Master, I don’t know how to write the code? The real prediction. multivariate time series forecasting in lstm?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-450896" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-450896" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 7, 2018 at 7:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Which part are you stuck on?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-450856" class="comment odd alt depth-5">

	      	<div id="li-comment-450856" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dazhi</span>
	                <span class="date">October 6, 2018 at 5:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,Master. How to make predictions about “air pollution”(you trained by LSTM) in new data? Can you show me the code to understand?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-450897" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-450897" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 7, 2018 at 7:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-450897" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This tutorial shows you how to make a prediction with an LSTM:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449646" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-449646" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Xiang</span>
	                <span class="date">September 24, 2018 at 1:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449646" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi，master. Can you tell me how to do with the validation set in this example to set up a reliable neural network model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449646" onclick="return addComment.moveForm( &quot;comment-449646&quot;, &quot;449646&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Xiang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449659" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-449659" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 24, 2018 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449659" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is challenging to use a validation set for time series. I need to think about.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449659" onclick="return addComment.moveForm( &quot;comment-449659&quot;, &quot;449659&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451016" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-451016" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Xiang</span>
	                <span class="date">October 9, 2018 at 12:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451016" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi，Jason. I am troubled lately. Cause I have some problems about how to define the networks well. The parameters are quite uneasy to define. Can you show me some guidance?</p>
<p>The code showed above:<br>
#define model<br>
model = Sequential()<br>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
model.add(Dense(1))<br>
model.compile(loss=’mae’, optimizer=’adam’)<br>
# fit model<br>
history = model.fit(train_X, train_y, epochs=50, batch_size=360, validation_data=(test_X, test_y), verbose=2,shuffle=False)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451016" onclick="return addComment.moveForm( &quot;comment-451016&quot;, &quot;451016&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Xiang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451056" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-451056" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2018 at 8:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451056" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451056" onclick="return addComment.moveForm( &quot;comment-451056&quot;, &quot;451056&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449744" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-449744" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8677c8d9a90844c508c168cd72874b64.png" srcset="https://secure.gravatar.com/avatar/8677c8d9a90844c508c168cd72874b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">September 25, 2018 at 7:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449744" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, from the plot of the meteorological data i can notice that temperature, pressure and dew show a seasonality. Is it necessary to remove this seasonality in this case or not? And why?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449744" onclick="return addComment.moveForm( &quot;comment-449744&quot;, &quot;449744&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Marco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449756" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-449756" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2018 at 2:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449756" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have seen cases where CNNs and even LSTMs can handle trend and seasonality directly. It can simply the problem by first differencing the data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-449756" onclick="return addComment.moveForm( &quot;comment-449756&quot;, &quot;449756&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451040" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451040" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ee82219ab61bdc79ba4cf60b32553396.png" srcset="https://secure.gravatar.com/avatar/ee82219ab61bdc79ba4cf60b32553396?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Felipe Gerolomo</span>
	                <span class="date">October 9, 2018 at 7:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, i have a doubt, how your fuction know that polluition is your output variable? How do you specify that polluition is your output variable?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451040" onclick="return addComment.moveForm( &quot;comment-451040&quot;, &quot;451040&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Felipe Gerolomo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451065" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-451065" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2018 at 8:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451065" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The model.fit() function requires that we specify inputs (X) and outputs (y).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451065" onclick="return addComment.moveForm( &quot;comment-451065&quot;, &quot;451065&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451075" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-451075" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6ec0900d38cb3b29261a0e771efc8a45.png" srcset="https://secure.gravatar.com/avatar/6ec0900d38cb3b29261a0e771efc8a45?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Le Van Duc</span>
	                <span class="date">October 9, 2018 at 1:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451075" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Jason,<br>
Thank you very much for your great tutorial. I tried your code with changed training set to 4 years and validation set is 1 year. The code still run very fast with a little better RMSE of 25.418.<br>
Can I ask one question that with multivariate time series LSTM, each time series in LSTM model is trained and predicted independently ? Or they have some dependent in the trained weights ? Could you clear me about that or point me some references ?</p>
<p>Thank you very much !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451075" onclick="return addComment.moveForm( &quot;comment-451075&quot;, &quot;451075&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Le Van Duc">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451082" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-451082" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2018 at 3:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451082" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Depending on your problem you can train the model once and use it to make predictions going forward.</p>
<p>With enough resources, it might be better to re-fit the model as new data is made available.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451082" onclick="return addComment.moveForm( &quot;comment-451082&quot;, &quot;451082&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451091" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-451091" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6ec0900d38cb3b29261a0e771efc8a45.png" srcset="https://secure.gravatar.com/avatar/6ec0900d38cb3b29261a0e771efc8a45?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Le Van Duc</span>
	                <span class="date">October 9, 2018 at 5:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451091" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your quick reply !<br>
I am considering to apply multivariate LSTM to a spatial-temporal air pollution data set (monitoring data in multiple locations of a city and in time series) to predict new value at multiple locations at some time ahead. Could you please have any suggestions in this ? Is this problem more fit to a CNN + LSTM model ?</p>
<p>Thank you very much for your excellent blogs and your kind helping !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451091" onclick="return addComment.moveForm( &quot;comment-451091&quot;, &quot;451091&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Le Van Duc">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451165" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-451165" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2018 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451165" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend testing a suite of methods in order to discover what works best for your specific dataset.</p>
<p>For spatio-temporal data, a CNN-LSTM and ConvLSTM would be two great models to start with.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451165" onclick="return addComment.moveForm( &quot;comment-451165&quot;, &quot;451165&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451189" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451189" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5d64695d9c350e5e13439c3970c9e387.png" srcset="https://secure.gravatar.com/avatar/5d64695d9c350e5e13439c3970c9e387?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">October 10, 2018 at 8:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451189" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
your tutorial is very helpful.<br>
But I have a problem with the LSTM by training the model with data from the previous time steps and also data of the current time step t (all variables but pollution) to predict the current time step t of the pollution. If I try to do this, I don’t know what kind of shape to give to the LSTM. Of course I always get an error because there is missing the one column of pollution data. Do you have an idea how to fit a model with input t-1(all parameter), t(all but pollution)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451189" onclick="return addComment.moveForm( &quot;comment-451189&quot;, &quot;451189&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451210" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-451210" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2018 at 2:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451210" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have general advice on how to prepare data for LSTMs here that might help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451210" onclick="return addComment.moveForm( &quot;comment-451210&quot;, &quot;451210&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451249" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-451249" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/74f3a5ff6149166a0e7399362469e7dd.png" srcset="https://secure.gravatar.com/avatar/74f3a5ff6149166a0e7399362469e7dd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">October 11, 2018 at 12:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451249" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your quick response, Jason.<br>
It appears that this problem has not yet been addressed. The LSTM wants the input as [sample, timestep, feature]. But in my case (Input: t-1 of all features, t of all features without pollution; Output: t pollution) it is not possible to reshape the data into the dimensions [sample, timestep, feature] because all samples of timestep t from feature pollution are excluded from the input. I cannot find any way to reshape the data for this prediction problem. Thanks for your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451249" onclick="return addComment.moveForm( &quot;comment-451249&quot;, &quot;451249&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451300" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-451300" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 11, 2018 at 7:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451300" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are many ways to solve this problem. Perhaps the simplest would be to pad the missing pollution from the t time step with zero and perhaps make use of a masking input layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451300" onclick="return addComment.moveForm( &quot;comment-451300&quot;, &quot;451300&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451237" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-451237" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wang</span>
	                <span class="date">October 10, 2018 at 9:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451237" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason. In this example，which LSTM type you have used？</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451237" onclick="return addComment.moveForm( &quot;comment-451237&quot;, &quot;451237&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Wang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451296" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-451296" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 11, 2018 at 7:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451296" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A vanilla LSTM.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451296" onclick="return addComment.moveForm( &quot;comment-451296&quot;, &quot;451296&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451372" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451372" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/519e28484609d4a2fdad4f378e37e79d.png" srcset="https://secure.gravatar.com/avatar/519e28484609d4a2fdad4f378e37e79d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tao.J</span>
	                <span class="date">October 12, 2018 at 1:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451372" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason. Thank you for your post !<br>
I have a question that whether the date and time info are used in the LSTM model?<br>
I can’t find where we input the index to the model.<br>
Some data may have time periodicity and maybe it’s better to input the time info into the mode?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451372" onclick="return addComment.moveForm( &quot;comment-451372&quot;, &quot;451372&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tao.J">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451397" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-451397" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 12, 2018 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451397" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, just the sequence of observations.</p>
<p>You can make the series stationary prior to using the LSTM and likely achieve better performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451397" onclick="return addComment.moveForm( &quot;comment-451397&quot;, &quot;451397&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451570" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-451570" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04896dfe9e699cdfdafecca2e98608e5.png" srcset="https://secure.gravatar.com/avatar/04896dfe9e699cdfdafecca2e98608e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Z</span>
	                <span class="date">October 14, 2018 at 3:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451570" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, really enlightening tutorial! Thx. I think I found a small problem.<br>
In the one-timestep prediction example you show, I found yhat is not at the same pace as test_y. You see the first four values of yhat are 0.035, 0.032, 0.021, 0.020 while those for from test_y are 0.031, 0.020, 0.019 and 0.018. So it seems that the second to the fourth values in yhat are about the same as the first to the third values in test_y. It seems like the prediction yhat is always one timestep later than it should be. Weird. So if I add the two lines<br>
inv_y = inv_y[:-1]<br>
inv_yhat = inv_yhat[1:]<br>
before calculating RMSE and change nothing else, actually I can get RMSE = 4.234. But if I don’t add those two lines and use your codes literally, I can get RMSE = 26.370 which is similar to yours.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451570" onclick="return addComment.moveForm( &quot;comment-451570&quot;, &quot;451570&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Z">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451585" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-451585" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2018 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is called a persistence model and a poor neural net will converge to something like persistence as a worst case.</p>
<p>Indeed, LSTMs often perform poorly for time series forecasting. Instead, I recommend always testing against linear methods (SARIMA/ETS) and compare results to an MLP, CNN and hybrids.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451585" onclick="return addComment.moveForm( &quot;comment-451585&quot;, &quot;451585&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452786" class="comment odd alt depth-3">

	      	<div id="li-comment-452786" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/04896dfe9e699cdfdafecca2e98608e5.png" srcset="https://secure.gravatar.com/avatar/04896dfe9e699cdfdafecca2e98608e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Z</span>
	                <span class="date">October 26, 2018 at 1:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452786" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your reply!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452786" onclick="return addComment.moveForm( &quot;comment-452786&quot;, &quot;452786&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Z">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451631" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451631" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 15, 2018 at 2:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451631" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,master Jason. Can I use the wavelet decomposition and reconstruction with LSTM model to make prediction in this sample? If yes, and how can I do it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451631" onclick="return addComment.moveForm( &quot;comment-451631&quot;, &quot;451631&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451657" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451657" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 15, 2018 at 7:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451657" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps. Sorry, I don’t have an example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451657" onclick="return addComment.moveForm( &quot;comment-451657&quot;, &quot;451657&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451687" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-451687" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/35de170fc7836ea645e1a7d7b307ff6e.png" srcset="https://secure.gravatar.com/avatar/35de170fc7836ea645e1a7d7b307ff6e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 15, 2018 at 7:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451687" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Another question， why is there no learning rate?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451687" onclick="return addComment.moveForm( &quot;comment-451687&quot;, &quot;451687&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451734" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451734" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 16, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451734" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We use Adam, that adapts the learning rate, more here:<br>
<a href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/" rel="nofollow">https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451734" onclick="return addComment.moveForm( &quot;comment-451734&quot;, &quot;451734&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451833" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451833" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8eca4a5ef0c3db60c29b18db53786625.png" srcset="https://secure.gravatar.com/avatar/8eca4a5ef0c3db60c29b18db53786625?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bowen</span>
	                <span class="date">October 17, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451833" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, nice work going on right here! I was wondering if you can train lstm with multiple time series data? e.g. using your example, maybe use pollutions data on all cities (Beijing, New York etc. ) and then try to predict the pollutions trends on general earth. I would love to see a tutorial on that. Thanks for everything you do here! Respect!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451833" onclick="return addComment.moveForm( &quot;comment-451833&quot;, &quot;451833&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bowen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451850" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451850" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 17, 2018 at 6:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451850" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I call this multi-site forecasting and I have an example here:<br>
<a href="https://machinelearningmastery.com/how-to-develop-baseline-forecasts-for-multi-site-multivariate-air-pollution-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-baseline-forecasts-for-multi-site-multivariate-air-pollution-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451850" onclick="return addComment.moveForm( &quot;comment-451850&quot;, &quot;451850&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451917" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-451917" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8400e507358a694566abbf59c3faf88d.png" srcset="https://secure.gravatar.com/avatar/8400e507358a694566abbf59c3faf88d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.10h11.com/" rel="external nofollow" class="url">Charline</a></span>
	                <span class="date">October 17, 2018 at 11:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I read your very good article <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow">https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/</a> . I am actually working on multivariate time series forecasting with LSTM. </p>
<p>I would like to predict total daily demand order Y for the next day based on Y and on the predicted attributes X over the last 10 days AND given the expected X for the next day. So I have Input: t-10 of all features, …, t-1 of all features, t of all features without Y and Output: t of Y. </p>
<p>In my first attempt, I have passed to the model all features X (from t-10 to t) and historical Y (from t-10 to t-1) in order to predict Y(t). However, I have seen that it is not possible to reshape the data into the dimensions [sample, timestep, feature] because all samples of timestep t from feature Y are excluded from the input.</p>
<p>Someone had the same problem than mine and you’d said «&nbsp;There are many ways to solve this problem. Perhaps the simplest would be to pad the missing pollution from the t time step with zero and perhaps make use of a masking input layer.&nbsp;»<br>
I tried to do what you’d proposed for a week. In particular, I have taken Y(t) in my training set and set it to be equal to -1 (and in a second attempt to zero too). Then I applied the Masking function to the model for all -1 values during the training phase. However, the testing results were definitively wrong : to be clear, when I have set Y(t)= -1, the results of the model.predict were negative. So I guess I need to change something after I have trained the model, in order not to mess the testing predictions up.</p>
<p>I have tried to find an answer in these pages :<br>
<a href="https://machinelearningmastery.com/handle-missing-timesteps-sequence-prediction-problems-python/" rel="nofollow">https://machinelearningmastery.com/handle-missing-timesteps-sequence-prediction-problems-python/</a><br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a><br>
<a href="https://machinelearningmastery.com/use-timesteps-lstm-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/use-timesteps-lstm-networks-time-series-forecasting/</a><br>
But I didn’t find any help.</p>
<p>To be more complete, you can find here my code :</p>
<p># normalize features<br>
scaler = preprocessing.MinMaxScaler(feature_range=(0, 1))<br>
scaled = scaler.fit_transform(values)</p>
<p>n_days = 10<br>
reframed = series_to_supervised(scaled, n_days, 1)<br>
target_index = reframed.columns.get_loc(“var1(t)”)</p>
<p># split into train and test sets<br>
values = reframed.values<br>
n_train_days = 30 </p>
<p>train = values[:n_train_days, :]<br>
test = values[n_train_days:, :] </p>
<p># split into input and outputs<br>
n_features = 13<br>
n_obs = n_days * n_features<br>
train_X, train_y = train, train[:, -n_features]<br>
test_X, test_y = test, test[:, -n_features]</p>
<p>train_X[:,target_index]= -1.<br>
test_X[:,target_index]= -1.</p>
<p># reshape input to be 3D [samples, timesteps, features]<br>
train_X = train_X.reshape((train_X.shape[0], n_days+1, n_features))<br>
test_X = test_X.reshape((test_X.shape[0], n_days+1, n_features))</p>
<p># design network<br>
model = Sequential()<br>
model.add(Masking(mask_value=-1., input_shape=(train_X.shape[1], train_X.shape[2])))<br>
model.add(LSTM(100))<br>
model.add(Dense(1))</p>
<p># MSE loss function and efficient SGD version of stochastic gradient descent<br>
model.compile(loss=’mse’, optimizer=’sgd’)</p>
<p># fit network<br>
history = model.fit(train_X, train_y, epochs=100, batch_size=72, validation_data=(test_X, test_y), verbose=2, shuffle=False)</p>
<p># make a prediction : return in 2D<br>
yhat = model.predict(test_X)</p>
<p>Thanks a lot for your time, I really hope you can help me. </p>
<p>Best regards.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451917" onclick="return addComment.moveForm( &quot;comment-451917&quot;, &quot;451917&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Charline">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451949" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-451949" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 18, 2018 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451949" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I understand correctly, you want to model a forecast problem by having multivariate input including the series that will be predicted, then make a univariate prediction.</p>
<p>I have an example of exactly this here, in the section titled “Encoder-Decoder LSTM Model With Multivariate Input”<br>
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/</a></p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-451949" onclick="return addComment.moveForm( &quot;comment-451949&quot;, &quot;451949&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452010" class="comment even depth-3 parent">

	      	<div id="li-comment-452010" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8400e507358a694566abbf59c3faf88d.png" srcset="https://secure.gravatar.com/avatar/8400e507358a694566abbf59c3faf88d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.10h11.com/" rel="external nofollow" class="url">Charline</a></span>
	                <span class="date">October 18, 2018 at 7:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,  </p>
<p>thank you very much for your quick answer. However I think I didn’t explain you very well my problem.   </p>
<p>I guess the part that made you misunderstanding is this :</p>
<p>«I would like to predict total daily demand order Y for the next day based on Y and on the predicted attributes X over the last 10 days AND given the expected X for the next day. So I have Input: t-10 of all features, …, t-1 of all features, t of all features without Y and Output: t of Y.&nbsp;»  </p>
<p>When I say «given the expected X» I don’t mean that I need to predict X : X represents a projected value that has already been given to us. So, let me reformulate it in a better form :</p>
<p> I would like to predict Y(t) based on Y(t-1),…,Y(t-n) AND X(t),X(t-1),…,X(t-n).</p>
<p>Hope this helps <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>
<p>Thanks again for your time and help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452010" onclick="return addComment.moveForm( &quot;comment-452010&quot;, &quot;452010&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Charline">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452061" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-452061" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 19, 2018 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452061" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You want to predict the next y given past values of x and y.</p>
<p>Sure, test a suite of models and see what works best:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>
<p>The example I linked to showed exactly this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452061" onclick="return addComment.moveForm( &quot;comment-452061&quot;, &quot;452061&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452124" class="comment even depth-5">

	      	<div id="li-comment-452124" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8400e507358a694566abbf59c3faf88d.png" srcset="https://secure.gravatar.com/avatar/8400e507358a694566abbf59c3faf88d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.10h11.com/" rel="external nofollow" class="url">Charline</a></span>
	                <span class="date">October 19, 2018 at 6:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452124" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>“You want to predict the next y given past values of x and y.” : no, I don’t. I want to predict the next y given :</p>
<p>– past values of y,<br>
– the next value of x (supposing we have it), and<br>
– past values of x.</p>
<p>Hope this looks clear now <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"> </p>
<p>Thanks again !</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-452158" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-452158" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 20, 2018 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452158" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see, thanks for being clear. </p>
<p>I believe you can adapt the example to achieve this. I cannot write the code for you, but what problem are you having in adapting the example exactly?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-452360" class="comment even depth-5">

	      	<div id="li-comment-452360" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8400e507358a694566abbf59c3faf88d.png" srcset="https://secure.gravatar.com/avatar/8400e507358a694566abbf59c3faf88d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.10h11.com/" rel="external nofollow" class="url">Charline</a></span>
	                <span class="date">October 22, 2018 at 6:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452360" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I tried to adapt your example but I have seen that it is not possible to reshape the data into the dimensions [sample, timestep, feature] because Y(t) is excluded from the input, whereas X(t) is included. </p>
<p>In a previous discussion, someone had the same problem than mine and you proposed «&nbsp;There are many ways to solve this problem. Perhaps the simplest would be to pad the missing pollution from the t time step with zero and perhaps make use of a masking input layer.&nbsp;»</p>
<p> I tried to do what you proposed for a week. In particular, I have taken Y(t) in my training set and set it to be equal to -1 (and in a second attempt to zero too). Then I applied the Masking function to the model for all -1 values during the training phase. However, the testing results were definitively wrong : to be clear, when I have set Y(t)= -1, the results of the model.predict were negative. So I guess I need to change something after I have trained the model, in order not to mess the testing predictions up.</p>
<p>Thanks for your help : really hope to find a solution on that <img draggable="false" class="emoji" alt="🙂" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-452397" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-452397" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2018 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452397" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have an example of using a Masking layer here:<br>
<a href="https://machinelearningmastery.com/handle-missing-timesteps-sequence-prediction-problems-python/" rel="nofollow">https://machinelearningmastery.com/handle-missing-timesteps-sequence-prediction-problems-python/</a></p>
<p>Perhaps this tutorial will help you understand what we’re trying to achieve by reshaping the data:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<p>Perhaps one of these other tutorials will help:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452150" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-452150" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e42ce1f2bad89a23a83a5af96cff9c4f.png" srcset="https://secure.gravatar.com/avatar/e42ce1f2bad89a23a83a5af96cff9c4f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gabriel Mouzella Silva</span>
	                <span class="date">October 20, 2018 at 2:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452150" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason,</p>
<p>I’m facing a problem with a multivariate time series analisys. I was looking into my results, and it seems that the values are only replicating the curve value, but delyed, so when i try to put it online it doesn’t really predict. Could you please help me. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452150" onclick="return addComment.moveForm( &quot;comment-452150&quot;, &quot;452150&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Gabriel Mouzella Silva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452165" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-452165" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 20, 2018 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452165" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452165" onclick="return addComment.moveForm( &quot;comment-452165&quot;, &quot;452165&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452330" class="comment even depth-3 parent">

	      	<div id="li-comment-452330" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e42ce1f2bad89a23a83a5af96cff9c4f.png" srcset="https://secure.gravatar.com/avatar/e42ce1f2bad89a23a83a5af96cff9c4f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gabriel Mouzella Silva</span>
	                <span class="date">October 22, 2018 at 7:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452330" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi i’m not sure about my neural network being a persistence model or not, there is any way to measure it so i can be sure?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452330" onclick="return addComment.moveForm( &quot;comment-452330&quot;, &quot;452330&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Gabriel Mouzella Silva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452343" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-452343" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2018 at 2:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One approach would be to develop a persistence model, evaluate the performance of it and only use a neural net if it can out perform the persistence model.</p>
<p>I explain more here:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452343" onclick="return addComment.moveForm( &quot;comment-452343&quot;, &quot;452343&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452371" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-452371" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 22, 2018 at 11:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452371" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason. I have trouble, can you help me?</p>
<p>—————————————————————————<br>
IndexError                                Traceback (most recent call last)<br>
 in ()<br>
      4 # integer coding<br>
      5 encoder = LabelEncoder()<br>
—-&gt; 6 values[:,4] = encoder.fit_transform(values[:,4])<br>
      7 # ensure all data is float<br>
      8 values = values.astype(‘float32’)</p>
<p>IndexError: index 4 is out of bounds for axis 1 with size 2</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452371" onclick="return addComment.moveForm( &quot;comment-452371&quot;, &quot;452371&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452401" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-452401" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452401" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452401" onclick="return addComment.moveForm( &quot;comment-452401&quot;, &quot;452401&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452373" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-452373" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 23, 2018 at 12:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452373" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What‘s the LabelEncoder() used for？<br>
values[:,4] = encoder.fit_transform(values[:,4])<br>
why is 4 ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452373" onclick="return addComment.moveForm( &quot;comment-452373&quot;, &quot;452373&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452402" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-452402" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A label encoder converts string labels to integers/numbers.</p>
<p>4 in this case refers to column with the index 4. You can learn more about array indexing in Python here:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452402" onclick="return addComment.moveForm( &quot;comment-452402&quot;, &quot;452402&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452475" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-452475" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 24, 2018 at 12:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452475" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi，Jason. I still can’t understand “lag timesteps=5 and 5 timesteps ahead”，What are the meaning of them and what are the differences between them?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452475" onclick="return addComment.moveForm( &quot;comment-452475&quot;, &quot;452475&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452519" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-452519" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 24, 2018 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452519" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It has to do with the inputs and outputs of the model.</p>
<p>Perhaps this will help:<br>
<a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452519" onclick="return addComment.moveForm( &quot;comment-452519&quot;, &quot;452519&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452476" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-452476" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ae850d988f0f5b90494d9bfb085035c7.png" srcset="https://secure.gravatar.com/avatar/ae850d988f0f5b90494d9bfb085035c7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://-/" rel="external nofollow" class="url">Burak Küçükaslan</a></span>
	                <span class="date">October 24, 2018 at 12:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I want to implement your “Multivariate Time Series Forecasting LSTM Keras” model for forecasting spot electricity price.</p>
<p>So for this purpose ı collected the data which i ll use ın the forecasting model.</p>
<p>At begining my first aim is  just can running the code smoothly.</p>
<p>So with this purpose ı used the limited inputs data which are wind plant electricity production data and electricity consumption data.</p>
<p>But i couldnt success to run to code smoothly , every my  attempt ı ve gotten error.</p>
<p>If you dont mind can you help me for implementing my inputs data to your forecasting model and modifying your model code parameters?</p>
<p>I uploaded the my data file at the link.</p>
<p><a href="https://drive.google.com/file/d/1q0fSAPPVNDDr23o2Z_FgloI2ucmk0EWj/view?usp=sharing" rel="nofollow">https://drive.google.com/file/d/1q0fSAPPVNDDr23o2Z_FgloI2ucmk0EWj/view?usp=sharing</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452476" onclick="return addComment.moveForm( &quot;comment-452476&quot;, &quot;452476&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Burak Küçükaslan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452520" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-452520" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 24, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452520" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have the capacity to work on your project.</p>
<p>My tutorials and my book will teach you how to work through this type of problem by yourself. Perhaps start here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452520" onclick="return addComment.moveForm( &quot;comment-452520&quot;, &quot;452520&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452826" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-452826" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 27, 2018 at 12:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452826" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,Jason. In this example，I want to know how can I reduce the training time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452826" onclick="return addComment.moveForm( &quot;comment-452826&quot;, &quot;452826&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452846" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-452846" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 27, 2018 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452846" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Some ideas:</p>
<p>– smaller network<br>
– faster hardware<br>
– fewer training examples<br>
– fewer training epochs.<br>
– larger batch size<br>
…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452846" onclick="return addComment.moveForm( &quot;comment-452846&quot;, &quot;452846&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452877" class="comment even depth-3 parent">

	      	<div id="li-comment-452877" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 27, 2018 at 5:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452877" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yeah，what you said is quiet useful！But, I don’t want to sacrifice my model training effect to improve operational efficiency. So， how can I do it？</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452877" onclick="return addComment.moveForm( &quot;comment-452877&quot;, &quot;452877&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452923" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-452923" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 28, 2018 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452923" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t understand, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452923" onclick="return addComment.moveForm( &quot;comment-452923&quot;, &quot;452923&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452896" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-452896" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 27, 2018 at 11:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>rmse = sqrt(mean_squared_error(inv_y, inv_yhat))<br>
mae=mean_absolute_error(inv_y,inv_yhat)</p>
<p>Why the next line is wrong in my model? The interpreter is anaconda. Can you help me?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452896" onclick="return addComment.moveForm( &quot;comment-452896&quot;, &quot;452896&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452929" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-452929" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 28, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452929" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps post your code and problem to stackoverflow so that they can debug it for you?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-452929" onclick="return addComment.moveForm( &quot;comment-452929&quot;, &quot;452929&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453055" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-453055" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 29, 2018 at 9:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453055" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,doctor Jason. Today，I did a small test. I found that in this example, if I drop out any other features,but only left the “pollution” feature in your model. The test RMSE and the curve of the predicted pollution is the same to yours, why? I can’t figure it out.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453055" onclick="return addComment.moveForm( &quot;comment-453055&quot;, &quot;453055&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453094" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-453094" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 30, 2018 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453094" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work. Perhaps the additional features are not required.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453094" onclick="return addComment.moveForm( &quot;comment-453094&quot;, &quot;453094&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453161" class="comment even depth-3">

	      	<div id="li-comment-453161" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">October 30, 2018 at 11:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453161" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It seems that the model is no use as the multivariate prediction in your example…As I see，we should not build the model with the output feature as the input. Var1 is the pollution in your model, it can’t be used as the input values, we put the other features as the input , and the pollution as the output to make predictions, that’s all.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453161" onclick="return addComment.moveForm( &quot;comment-453161&quot;, &quot;453161&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453223" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-453223" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c59a989f97399df1b9a9b1411d2fda94.png" srcset="https://secure.gravatar.com/avatar/c59a989f97399df1b9a9b1411d2fda94?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">MAK</span>
	                <span class="date">October 31, 2018 at 8:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453223" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason!<br>
Wonderful blog,<br>
I have a question :<br>
If I want to predict not only the pollution but also other attributes like dew,  temp,   press (or all other attributes) which changes I need to do in the model (and your code) for allowing multivariable forecasting?<br>
In addition, it will damage in the model accuracy, in the matter of changing the hyper parameters (like num of epocs etch’) ?<br>
Thanks,<br>
Mak</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453223" onclick="return addComment.moveForm( &quot;comment-453223&quot;, &quot;453223&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to MAK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453239" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-453239" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 31, 2018 at 2:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453239" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>This requires that you change the data samples to have n variables as input with m time steps, then the target would become a vector of n variables and probably 1 time step.</p>
<p>The model would require n nodes in the output layer.</p>
<p>You can then measure MSE or RMSE for all variables together or for each variable separately.</p>
<p>Compare results to a separate linear model for each variable.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453239" onclick="return addComment.moveForm( &quot;comment-453239&quot;, &quot;453239&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453270" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-453270" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c59a989f97399df1b9a9b1411d2fda94.png" srcset="https://secure.gravatar.com/avatar/c59a989f97399df1b9a9b1411d2fda94?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">MAK</span>
	                <span class="date">October 31, 2018 at 8:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hii Jaso,</p>
<p>So the change need to be like :<br>
***************************************************<br>
n_obs = n_hours * n_features<br>
n_predict_features=2<br>
train_X, train_y = train[:, :n_obs], train[:, -(n_features-n_predict_features)]<br>
model = Sequential()<br>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
model.add(Dense(n_predict_features)) // need to change this line<br>
model.compile(loss=’mae’, optimizer=’adam’)<br>
**********************************************************<br>
This is the only change I need to do ? , or I miss something?<br>
In addition , are you think I need to increase the number of epocs or any other hyper paramter )? </p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453270" onclick="return addComment.moveForm( &quot;comment-453270&quot;, &quot;453270&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to MAK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453303" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-453303" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 1, 2018 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453303" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, change the framing of the problem and change the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453303" onclick="return addComment.moveForm( &quot;comment-453303&quot;, &quot;453303&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453291" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-453291" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e62ee844adfc804ccc8fde89ef575916.png" srcset="https://secure.gravatar.com/avatar/e62ee844adfc804ccc8fde89ef575916?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Roh</span>
	                <span class="date">November 1, 2018 at 3:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453291" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the great article!</p>
<p>I just started working with multivariate time series. I understood the concept of stationary in univariate series. How do we perform it for multivariate? do we have to stationarize each input feature individually along with the output?</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453291" onclick="return addComment.moveForm( &quot;comment-453291&quot;, &quot;453291&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Roh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453312" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-453312" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 1, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453312" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you could try modeling the raw data and then compare results when modeling with a stationary version of each series.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453312" onclick="return addComment.moveForm( &quot;comment-453312&quot;, &quot;453312&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453324" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-453324" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/044e3e01863e58a908c3dd98d8a3d9f8.png" srcset="https://secure.gravatar.com/avatar/044e3e01863e58a908c3dd98d8a3d9f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jessie</span>
	                <span class="date">November 1, 2018 at 1:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453324" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have ValueError: operands could not be broadcast together with shapes (592095,209) (21,) (592095,209)  but i have any idea to ko this problem.i hope that someone can help me.thx</p>
<p>yhat = model.predict(test_X)</p>
<p>test_X = test_X.reshape((test_X.shape[0], test_X.shape[2]))<br>
# invert scaling for forecast<br>
inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)</p>
<p>inv_yhat = scaler.inverse_transform(inv_yhat)<br>
inv_yhat.head()<br>
inv_yhat = inv_yhat[:,0]<br>
# invert scaling for actual<br>
test_y = test_y.reshape((len(test_y), 1))<br>
inv_y = concatenate((test_y, test_X[:, 1:]), axis=1)<br>
inv_y = scaler.inverse_transform(inv_y)<br>
inv_y = inv_y[:,0]</p>
<p>rmse = sqrt(mean_squared_error(inv_y, inv_yhat))<br>
print(‘Test RMSE: %.3f’ % rmse)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453324" onclick="return addComment.moveForm( &quot;comment-453324&quot;, &quot;453324&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jessie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453333" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-453333" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 1, 2018 at 2:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453333" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you able to confirm that your version of Keras, TensorFlow and Python are up to date?</p>
<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453333" onclick="return addComment.moveForm( &quot;comment-453333&quot;, &quot;453333&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453340" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-453340" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/044e3e01863e58a908c3dd98d8a3d9f8.png" srcset="https://secure.gravatar.com/avatar/044e3e01863e58a908c3dd98d8a3d9f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jessie</span>
	                <span class="date">November 1, 2018 at 4:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453340" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>tensorflow:1.11.0<br>
keras:2.2.4<br>
python:3.6.6</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453340" onclick="return addComment.moveForm( &quot;comment-453340&quot;, &quot;453340&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jessie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453389" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-453389" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 2, 2018 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453389" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453389" onclick="return addComment.moveForm( &quot;comment-453389&quot;, &quot;453389&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453474" class="comment odd alt depth-5">

	      	<div id="li-comment-453474" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/044e3e01863e58a908c3dd98d8a3d9f8.png" srcset="https://secure.gravatar.com/avatar/044e3e01863e58a908c3dd98d8a3d9f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jessie</span>
	                <span class="date">November 2, 2018 at 10:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453474" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>//aqhi(column0)<br>
dataset = pd.read_csv(data.csv’, header=0, index_col=0) </p>
<p>locat = list(dataset.locationCode.unique())<br>
for i in locat:<br>
    df=dataset.loc[dataset.locationCode == i,:].drop(columns=[‘locationCode’])<br>
    values = df.values<br>
    # ensure all data is float<br>
    values = values.astype(‘float32′)<br>
    # normalize features<br>
    scaler = MinMaxScaler(feature_range=(0, 1))<br>
    scaled = scaler.fit_transform(values)<br>
    # frame as supervised learning<br>
    ”’<br>
    plt.plot(range(dataset.shape[0]),(dataset[‘aqhi’]))<br>
    plt.xticks(range(0,dataset.shape[0],250),dataset[‘dateTime’].loc[::250],rotation=45)<br>
    plt.xlabel(‘Date’,fontsize=20)<br>
    plt.ylabel(‘AQHI’,fontsize=20)<br>
    plt.show()<br>
    ”’<br>
    # convert series to supervised learning<br>
    def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):<br>
        # past obserations(n_in-1,n_out-1) are used to make forecasting<br>
        #data: Sequence of observations as a list or NumPy array.<br>
        #n_in: Num of lag observations as independent(X). =&gt; VALUE(1- len(data))<br>
        #n_out: Num of observations as dependent(Y).      =&gt; VALUE(0- len(date)-1)<br>
        #dropnan: Boolean whether or not to drop rows with NaN values.<br>
        #Returns: Series framed for supervised learning.</p>
<p>        n_vars = 1 if type(data) is list else data.shape[1]<br>
        df = DataFrame(data)<br>
        cols = list()<br>
        names = list()<br>
        # input sequence (t-n, … t-1)<br>
        for i in range(n_in, 0, -1):<br>
            cols.append(df.shift(i))<br>
            # shift function also works on so-called multivariate time series problems<br>
            names += [(‘var%d(t-%d)’ % (j+1, i)) for j in range(n_vars)]<br>
            # [var1(t-1)….var11(t-1)]</p>
<p>        # forecast sequence (t, t+1, … t+n)<br>
        for i in range(0, n_out):<br>
            cols.append(df.shift(-i))<br>
            # append value to list<br>
            if i == 0:<br>
                names += [(‘var%d(t)’ % (j+1)) for j in range(n_vars)]<br>
            else:<br>
                names += [(‘var%d(t+%d)’ % (j+1, i)) for j in range(n_vars)]<br>
    	# put it all together<br>
        agg = concat(cols, axis=1)<br>
        agg.columns = names<br>
        # drop rows with NaN values<br>
        if dropnan:<br>
            agg.dropna(inplace=True)<br>
        return (agg)</p>
<p>    reframed = series_to_supervised(scaled, 1, 9)<br>
    print(reframed.head())</p>
<p>    ### fit an LSTM on the multivariate input data(split dataset into train and test data sets)<br>
    # split into train and test sets<br>
    values = reframed.values<br>
    hours = 365*24*2<br>
    train = values[:hours, :]<br>
    test = values[hours:, :]</p>
<p>    # split into input and outputs<br>
    train_X, train_y = train[:, :-1], train[:, -1]<br>
    test_X, test_y = test[:, :-1], test[:, -1]<br>
    # reshape input to be 3D [samples, timesteps, features]<br>
    train_X = train_X.reshape((train_X.shape[0], 1, train_X.shape[1]))<br>
    test_X = test_X.reshape((test_X.shape[0], 1, test_X.shape[1]))<br>
    print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)</p>
<p>    # design network<br>
    model = Sequential()<br>
    model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br>
    model.add(Dense(1))<br>
    model.compile(loss=’mae’, optimizer=’adam’)<br>
    # fit network<br>
    history = model.fit(train_X, train_y, epochs=50, batch_size=72, validation_data=(test_X, test_y), verbose=2, shuffle=False)<br>
    # plot history<br>
    pyplot.plot(history.history[‘loss’], label=’train’)<br>
    pyplot.plot(history.history[‘val_loss’], label=’test’)<br>
    pyplot.legend()<br>
    pyplot.show()</p>
<p>    # make a prediction<br>
    yhat = model.predict(test_X)<br>
    test_X = test_X.reshape((test_X.shape[0], test_X.shape[2]))<br>
    # invert scaling for forecast<br>
    inv_yhat = concatenate((yhat, test_X[:, 1:]), axis=1)<br>
    inv_yhat = scaler.inverse_transform(inv_yhat)<br>
    inv_yhat = inv_yhat[:,0]<br>
    # invert scaling for actual<br>
    test_y = test_y.reshape((len(test_y), 1))<br>
    inv_y = concatenate((test_y, test_X[:, 1:]), axis=1)<br>
    inv_y = scaler.inverse_transform(inv_y)<br>
    inv_y = inv_y[:,0]<br>
    # calculate RMSE<br>
    rmse = sqrt(mean_squared_error(inv_y, inv_yhat))<br>
    print(‘Test RMSE: %.3f’ % rmse)</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-453526" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-453526" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 3, 2018 at 7:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453526" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have the capacity to debug your code, I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453366" class="comment odd alt depth-3">

	      	<div id="li-comment-453366" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/044e3e01863e58a908c3dd98d8a3d9f8.png" srcset="https://secure.gravatar.com/avatar/044e3e01863e58a908c3dd98d8a3d9f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jessie</span>
	                <span class="date">November 2, 2018 at 1:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453366" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>but i have not any idea why i have error ? Although I have searched releated keyword in  StackOverflow</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453366" onclick="return addComment.moveForm( &quot;comment-453366&quot;, &quot;453366&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jessie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453381" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-453381" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09018d015f54aa074cf6c71066c0802e.png" srcset="https://secure.gravatar.com/avatar/09018d015f54aa074cf6c71066c0802e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan B.</span>
	                <span class="date">November 2, 2018 at 4:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453381" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I am new at ML and I apprecciate your posts. Actually I have a multi input forecasting problem I use your code and it works well to predict values that I already have. Data is between 2004 and 2017 (all inputs), I just want 1 output, however, the code predict for example, the last 10 observations from 2017, but i want to predict the first step from 2018.<br>
The code works for it? How i can use it? I understand that it is a request for a non supervised problem.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453381" onclick="return addComment.moveForm( &quot;comment-453381&quot;, &quot;453381&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Juan B.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453402" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-453402" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 2, 2018 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Fit the model on all available data, then make a prediction for the new data. More here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-make-predictions" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-make-predictions</a></p>
<p>What problem are you having exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453402" onclick="return addComment.moveForm( &quot;comment-453402&quot;, &quot;453402&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453894" class="comment even depth-3 parent">

	      	<div id="li-comment-453894" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09018d015f54aa074cf6c71066c0802e.png" srcset="https://secure.gravatar.com/avatar/09018d015f54aa074cf6c71066c0802e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan B.</span>
	                <span class="date">November 7, 2018 at 3:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason , thanks for the fast answer.</p>
<p>The problem is that I need to predict values for the future, for the next time stamp.</p>
<p>I understand that with your code I can predict values that already exist in my available data, but could not predict future values. So the result, is a prediction of existing values calculated using the RMSE, I am rigth?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453894" onclick="return addComment.moveForm( &quot;comment-453894&quot;, &quot;453894&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Juan B.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453920" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-453920" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 7, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453920" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Call “model.predict()” to make a prediction beyond the dataset.</p>
<p>I explain this here:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453920" onclick="return addComment.moveForm( &quot;comment-453920&quot;, &quot;453920&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453924" class="comment even depth-5">

	      	<div id="li-comment-453924" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09018d015f54aa074cf6c71066c0802e.png" srcset="https://secure.gravatar.com/avatar/09018d015f54aa074cf6c71066c0802e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan B.</span>
	                <span class="date">November 7, 2018 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453924" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason but, you did it in your code not? </p>
<p>Line 82</p>
<p># make a prediction<br>
yhat = model.predict(test_X)</p>
<p>So, the predicted result “yhat” is that i need?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-453962" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-453962" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 7, 2018 at 2:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453849" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-453849" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/15d245ce4f5828de5f39cd6b6cc8d3c2.png" srcset="https://secure.gravatar.com/avatar/15d245ce4f5828de5f39cd6b6cc8d3c2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jim n</span>
	                <span class="date">November 6, 2018 at 4:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>using the latest (pip3 install tensorflow-gpu) as of this date and tweaking the imports to us tf.keras, model.fit() throws </p>
<p>AttributeError: ‘Tensor’ object has no attribute ‘assign’</p>
<p>the values being passed in are ndarray</p>
<p>this is my first keras endeavor, I’m afraid all the bug reports and patch requests about this assertion exceed my grasp of how to remedy the situation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453849" onclick="return addComment.moveForm( &quot;comment-453849&quot;, &quot;453849&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to jim n">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453904" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-453904" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 7, 2018 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453904" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I developed the code with the standalone Keras library, not tf.keras.</p>
<p>sudo pip install keras</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453904" onclick="return addComment.moveForm( &quot;comment-453904&quot;, &quot;453904&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453855" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-453855" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/044e3e01863e58a908c3dd98d8a3d9f8.png" srcset="https://secure.gravatar.com/avatar/044e3e01863e58a908c3dd98d8a3d9f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jessie</span>
	                <span class="date">November 6, 2018 at 5:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453855" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>after using Multivariate Time Series Forecasting with LSTMs to predict, how to get a prediction of the date time and its value?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453855" onclick="return addComment.moveForm( &quot;comment-453855&quot;, &quot;453855&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to jessie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453907" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-453907" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 7, 2018 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453907" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I show how to make a prediction here:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453907" onclick="return addComment.moveForm( &quot;comment-453907&quot;, &quot;453907&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453877" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-453877" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/916ec24ad7018591c31c9bde117ebb85.png" srcset="https://secure.gravatar.com/avatar/916ec24ad7018591c31c9bde117ebb85?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thomas Lass</span>
	                <span class="date">November 6, 2018 at 11:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453877" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Pls, can I get the Matlab codes for Multivariate Time Series Forecasting with LSTM? this is my email <a href="mailto:thomaslass2002@gmail.com">thomaslass2002@gmail.com</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453877" onclick="return addComment.moveForm( &quot;comment-453877&quot;, &quot;453877&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Thomas Lass">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453915" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-453915" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 7, 2018 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453915" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t have any matlab code tutorials sorry.</p>
<p>I explain why here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/do-you-have-tutorials-in-octave-or-matlab" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/do-you-have-tutorials-in-octave-or-matlab</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-453915" onclick="return addComment.moveForm( &quot;comment-453915&quot;, &quot;453915&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454122" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-454122" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/87caaed05117d32a58017ed3376224c0.png" srcset="https://secure.gravatar.com/avatar/87caaed05117d32a58017ed3376224c0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Carolyn</span>
	                <span class="date">November 9, 2018 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454122" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Excellent tutorial! I’ve noticed folks asking for how to code a similar model but for multiple outputs. I’ve taken a stab at it below, modifying your multiple lags code.</p>
<p>Changes have the (subtle!) comment CHANGES HERE.</p>
<p>This model predicts the variable ‘pollution’ and the variable ‘dew’. </p>
<p>Problem: I have one RMSE score for each output variable. Is that right? I think not. What should I do instead?</p>
<p>The code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c0eee934e6c2353719883" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">#load dataset
dataset = read_csv('pollution.csv', header=0, index_col=0)
values = dataset.values

#integer encode wind direction, as it's the only categorical variable.
encoder = LabelEncoder()
values[:,4] = encoder.fit_transform(values[:,4])

#ensure all data are float32 values
values = values.astype('float32')

#normalize input features
scaler = MinMaxScaler(feature_range=(0, 1))
scaled = scaler.fit_transform(values)

#frame as supervised learning
n_hours = 3 
n_features = 8 
reframed = series_to_supervised(scaled, n_hours, 1)
values = reframed.values
n_train_hours = 365*24
train = values[:n_train_hours, :]
test = values[n_train_hours:, :]

#CHANGES HERE
#split into input and outputs
n_obs = n_hours * n_features
train_X = train[:, :n_obs]
train_y = train[:, -n_features:(-n_features+2)] #+2 because of indexing madness.
test_X = test[:, :n_obs]
test_y = test[:, -n_features:(-n_features+2)]

train_X = train_X.reshape((train_X.shape[0], n_hours, n_features))
test_X = test_X.reshape((test_X.shape[0], n_hours, n_features))

#CHANGES HERE
#Need to output two values, not one.
#design network
model = Sequential()
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))
model.add(Dense(2)) #changed from 1 to 2.
model.compile(loss='mae', optimizer='adam')

#fit network
history = model.fit(train_X, train_y, epochs=4, batch_size=72, validation_data=(test_X, test_y), verbose=2, shuffle=False)

#make a prediction
y_hat = model.predict(test_X)

#CHANGES HERE
test_X = test_X.reshape((test_X.shape[0], n_hours*n_features))
inv_yhat = concatenate((y_hat, test_X[:,-6:]), axis=1) #changed 7 to 6
inv_yhat = scaler.inverse_transform(inv_yhat)
inv_yhat = inv_yhat[:,0:2] #changed from 0 to 0:2. Should be first 2 columns that contain the predictions

#CHANGES HERE
#invert scaling for actual
test_y = test_y.reshape((len(test_y),2)) #changed 1 to 2
inv_y = concatenate((test_y, test_X[:,-6:]), axis=1) #changed 7 to 6
inv_y = scaler.inverse_transform(inv_y)
inv_y = inv_y[:,0:2] #changed from 0 to 0:2. Should be first 2 columns that contain the predictions.

#CHANGES HERE
#calculate RMSE - CHANGED to output RMSE for each variable.
rmse_1 = sqrt(mean_squared_error(inv_y[:,0], inv_yhat[:,0])) #RMSE for the first variable (pollution)
rmse_2 = sqrt(mean_squared_error(inv_y[:,1], inv_yhat[:,0])) #RMSE for the second variable (dew)
print('Test RMSE: ', rmse_1, rmse_2)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-2">2</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-4">4</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-6">6</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-8">8</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-10">10</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-12">12</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-14">14</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-16">16</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-18">18</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-20">20</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-22">22</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-24">24</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-26">26</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-28">28</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-30">30</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-32">32</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-34">34</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-36">36</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-38">38</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-40">40</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-42">42</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-44">44</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-46">46</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-48">48</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-50">50</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-52">52</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-54">54</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-56">56</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-58">58</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-60">60</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-62">62</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-64">64</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0eee934e6c2353719883-66">66</div><div class="crayon-num" data-line="crayon-5c0eee934e6c2353719883-67">67</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-1"><span class="crayon-p">#load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-2"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'pollution.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-3"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-4">&nbsp;</div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-5"><span class="crayon-p">#integer encode wind direction, as it's the only categorical variable.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-6"><span class="crayon-v">encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-7"><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-8">&nbsp;</div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-9"><span class="crayon-p">#ensure all data are float32 values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-10"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-12"><span class="crayon-p">#normalize input features</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-13"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-14"><span class="crayon-v">scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-16"><span class="crayon-p">#frame as supervised learning</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-17"><span class="crayon-v">n_hours</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-18"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-19"><span class="crayon-v">reframed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-20"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reframed</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-21"><span class="crayon-v">n_train_hours</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">365</span><span class="crayon-o">*</span><span class="crayon-cn">24</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-22"><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n_train_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-23"><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-v">n_train_hours</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-24">&nbsp;</div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-25"><span class="crayon-p">#CHANGES HERE</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-26"><span class="crayon-p">#split into input and outputs</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-27"><span class="crayon-v">n_obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">n_hours *</span><span class="crayon-h"> </span><span class="crayon-e">n_features</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-28"><span class="crayon-v">train_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">n_obs</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-29"><span class="crayon-v">train_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-o">+</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-p">#+2 because of indexing madness.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-30"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">n_obs</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-31"><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">n_features</span><span class="crayon-o">+</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-32">&nbsp;</div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-33"><span class="crayon-v">train_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-34"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hours</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-36"><span class="crayon-p">#CHANGES HERE</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-37"><span class="crayon-p">#Need to output two values, not one.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-38"><span class="crayon-p">#design network</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-39"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-40"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p">#changed from 1 to 2.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mae'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-44"><span class="crayon-p">#fit network</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-45"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">72</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-46">&nbsp;</div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-47"><span class="crayon-p">#make a prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-48"><span class="crayon-v">y_hat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-50"><span class="crayon-p">#CHANGES HERE</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-51"><span class="crayon-v">test_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">n_hours*</span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-52"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y_hat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p">#changed 7 to 6</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-53"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-54"><span class="crayon-v">inv_yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-p">#changed from 0 to 0:2. Should be first 2 columns that contain the predictions</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-56"><span class="crayon-p">#CHANGES HERE</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-57"><span class="crayon-p">#invert scaling for actual</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-58"><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p">#changed 1 to 2</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-59"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p">#changed 7 to 6</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-60"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-61"><span class="crayon-v">inv_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inv_y</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-p">#changed from 0 to 0:2. Should be first 2 columns that contain the predictions.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-62">&nbsp;</div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-63"><span class="crayon-p">#CHANGES HERE</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-64"><span class="crayon-p">#calculate RMSE - CHANGED to output RMSE for each variable.</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-65"><span class="crayon-v">rmse_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p">#RMSE for the first variable (pollution)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0eee934e6c2353719883-66"><span class="crayon-v">rmse_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">inv_y</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inv_yhat</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p">#RMSE for the second variable (dew)</span></div><div class="crayon-line" id="crayon-5c0eee934e6c2353719883-67"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test RMSE: '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rmse_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rmse_2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454122" onclick="return addComment.moveForm( &quot;comment-454122&quot;, &quot;454122&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Carolyn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454151" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-454151" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 9, 2018 at 1:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454151" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454151" onclick="return addComment.moveForm( &quot;comment-454151&quot;, &quot;454151&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454226" class="comment even depth-3 parent">

	      	<div id="li-comment-454226" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/87caaed05117d32a58017ed3376224c0.png" srcset="https://secure.gravatar.com/avatar/87caaed05117d32a58017ed3376224c0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Carolyn</span>
	                <span class="date">November 10, 2018 at 2:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454226" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the reply. The problem in the code is that there is one RMSE score for each output variable. Is that right? If not, what should I do instead?</p>
<p>Best regards,<br>
Carolyn</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454226" onclick="return addComment.moveForm( &quot;comment-454226&quot;, &quot;454226&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Carolyn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454266" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-454266" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 10, 2018 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454266" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can report RMSE for each lead time or combine RMSE into a single score, or both.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454266" onclick="return addComment.moveForm( &quot;comment-454266&quot;, &quot;454266&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454277" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-454277" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/460e4b5160be26f70620e2e45538bb5e.png" srcset="https://secure.gravatar.com/avatar/460e4b5160be26f70620e2e45538bb5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vedant wankhede</span>
	                <span class="date">November 10, 2018 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454277" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Sir,<br>
Thank you for this Great tutorial !<br>
I kindly request you to offer me some tips for my project.<br>
I have hourly data for weather parameters and solar irradiation.<br>
I am willing to predict the solar irradiance from those weather parameters (wind velocity, air temperature, relative humidity).<br>
can you kindly tell me that is this multivariate LSTM model will be suitable for my purpose or should i go for another one ?<br>
i have already applied the statistical approach by using algorithms like random forest, decision trees and multivariate linear regression. However i want to use neural networks for the same, as my data is highly nonlinear and time dependent.<br>
your answer will be greatly helpful. thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454277" onclick="return addComment.moveForm( &quot;comment-454277&quot;, &quot;454277&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to vedant wankhede">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454359" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454359" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 11, 2018 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend this process:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454359" onclick="return addComment.moveForm( &quot;comment-454359&quot;, &quot;454359&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454519" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-454519" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">November 12, 2018 at 3:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454519" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>train_X.shape[1], train_X.shape[2]<br>
I know the “train_X.shape[0]” means the rows,  “train_X.shape[1]” means  the columns.<br>
But what does “the train_X.shape[2]” mean?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454519" onclick="return addComment.moveForm( &quot;comment-454519&quot;, &quot;454519&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454583" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454583" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 13, 2018 at 5:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454583" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It would refer to the third dimension of the array.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454583" onclick="return addComment.moveForm( &quot;comment-454583&quot;, &quot;454583&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454525" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-454525" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">November 12, 2018 at 4:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454525" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, doctor Jason. I have another question:<br>
If I use the BPNN instead of the LSTM,<br>
In my model, it has 3 input-timesteps and 1 timestep,9 features.<br>
I did it like this:<br>
# design network<br>
model = Sequential()<br>
model.add(Dense(100,input_dim=27,kernel_initializer=”uniform”)) # input_dim=27,<br>
model.add(Activation(‘sigmoid’))<br>
model.add(Dropout(0.01))<br>
model.add(Dense(100,input_dim=27,kernel_initializer=”uniform”)) # input_dim=27,<br>
model.add(Activation(‘sigmoid’))<br>
model.add(Dropout(0.01))<br>
model.add(Dense(100,input_dim=27,kernel_initializer=”uniform”)) # input_dim=27,<br>
model.add(Activation(‘sigmoid’))<br>
model.add(Dropout(0.01))<br>
model.compile(loss=’mae’, optimizer=’adam’)</p>
<p>But the point is that, what should i do?<br>
ValueError: Error when checking input: expected dense_5_input to have 2 dimensions, but got array with shape (18041, 3, 9)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454525" onclick="return addComment.moveForm( &quot;comment-454525&quot;, &quot;454525&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454584" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454584" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 13, 2018 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454584" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It suggests that the expectation of your model and the shape of your data differ.</p>
<p>You could change your model or change your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454584" onclick="return addComment.moveForm( &quot;comment-454584&quot;, &quot;454584&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454561" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-454561" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/35de170fc7836ea645e1a7d7b307ff6e.png" srcset="https://secure.gravatar.com/avatar/35de170fc7836ea645e1a7d7b307ff6e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Richard</span>
	                <span class="date">November 13, 2018 at 12:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454561" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, Jason.<br>
Now，I found that I want to do it with multivariate-time-series-forecasting with BP neural network。 In this example， how can I do faster？</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454561" onclick="return addComment.moveForm( &quot;comment-454561&quot;, &quot;454561&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Richard">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454592" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-454592" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 13, 2018 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454592" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean by faster?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454592" onclick="return addComment.moveForm( &quot;comment-454592&quot;, &quot;454592&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454642" class="comment even depth-3 parent">

	      	<div id="li-comment-454642" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/388390d6dfbe9254499acfb312e5c17e.png" srcset="https://secure.gravatar.com/avatar/388390d6dfbe9254499acfb312e5c17e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Richard</span>
	                <span class="date">November 13, 2018 at 4:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean， can I use the Keras to build a BPNN model？</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454642" onclick="return addComment.moveForm( &quot;comment-454642&quot;, &quot;454642&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Richard">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454708" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-454708" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 14, 2018 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454708" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>By BPNN, do you mean MLP? If so, sure. Start here:<br>
<a href="https://machinelearningmastery.com/how-to-develop-multilayer-perceptron-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-multilayer-perceptron-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454708" onclick="return addComment.moveForm( &quot;comment-454708&quot;, &quot;454708&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454779" class="comment even depth-5">

	      	<div id="li-comment-454779" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/388390d6dfbe9254499acfb312e5c17e.png" srcset="https://secure.gravatar.com/avatar/388390d6dfbe9254499acfb312e5c17e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Richard</span>
	                <span class="date">November 15, 2018 at 12:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454779" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean, BP neural networks.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-454804" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-454804" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2018 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454804" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Most neural networks have their weights updated using BP == backpropagation, including CNNs, LSTMs and MLPs. It does not comment on the structure/type of the network, only how the weights are updated during training.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454739" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-454739" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/12ec312920bce495c37d7fb4002e86f5.png" srcset="https://secure.gravatar.com/avatar/12ec312920bce495c37d7fb4002e86f5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mike Yang</span>
	                <span class="date">November 14, 2018 at 1:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454739" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Dr Jason,<br>
Thank you for your Great tutorial </p>
<p>Actually, I have a small question.</p>
<p>In the one-timestep prediction example you show, I found yhat is not at the same pace as test_y.</p>
<p>When I plot the last 100 samples as you do.</p>
<p>pyplot.plot(inv_yhat[-100:])<br>
pyplot.plot(inv_y[-100:])<br>
pyplot.show()</p>
<p> It seems like the prediction yhat is always one timestep later than it should be.<br>
if I add the two lines<br>
inv_y = inv_y[:-1]<br>
inv_yhat = inv_yhat[1:]<br>
before calculating RMSE and change nothing else, the RMSE is much smaller. and the yhat is perfectly at the same pace as  test_y.</p>
<p>What’s more, this problem also happened in your other examples such as this one<br>
 <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/</a>  </p>
<p>and  this one<br>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/</a></p>
<p>Can you explain why there is a one day delay in the result?<br>
Why is it just exactly one day delay in every examples?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454739" onclick="return addComment.moveForm( &quot;comment-454739&quot;, &quot;454739&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mike Yang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454741" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-454741" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 14, 2018 at 2:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the model has learned a persistence model, meaning that it cannot do better than the most naive model.</p>
<p>LSTMs are generally poor at time series forecasting (yet everyone wants to know how to use them), I recommend reading this:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>
<p>And this:<br>
<a href="https://machinelearningmastery.com/findings-comparing-classical-and-machine-learning-methods-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/findings-comparing-classical-and-machine-learning-methods-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454741" onclick="return addComment.moveForm( &quot;comment-454741&quot;, &quot;454741&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454820" class="comment even depth-3 parent">

	      	<div id="li-comment-454820" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/12ec312920bce495c37d7fb4002e86f5.png" srcset="https://secure.gravatar.com/avatar/12ec312920bce495c37d7fb4002e86f5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mike</span>
	                <span class="date">November 15, 2018 at 7:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason.</p>
<p>Now I am little confused.</p>
<p>What is a persistence model?</p>
<p>If we plot the result like this<br>
pyplot.plot(inv_yhat[-100:])<br>
pyplot.plot(inv_y[-100:])<br>
pyplot.show()</p>
<p>Why is it so regular that a persistence model have exactly one day delay in the prediction result?</p>
<p>Can you explain that in detail?</p>
<p>Can we eliminate the delay in the persistence model?</p>
<p>Thanks a lot</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454820" onclick="return addComment.moveForm( &quot;comment-454820&quot;, &quot;454820&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Mike">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454840" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-454840" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2018 at 11:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454840" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A persistance model uses the input as the output. If the input is the observation yesterday, then the output will have a 1-day delay.</p>
<p>If your model learns a persistence model, you may have to change the configuration of the model or the model itself. I have suggestions here:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454840" onclick="return addComment.moveForm( &quot;comment-454840&quot;, &quot;454840&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454778" class="comment even depth-2">

	      	<div id="li-comment-454778" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/726175db4ede3c6d5e26c132cf9cbd65.png" srcset="https://secure.gravatar.com/avatar/726175db4ede3c6d5e26c132cf9cbd65?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Xiang</span>
	                <span class="date">November 14, 2018 at 11:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well down，Yang. Can I make friends with you? And this is my Q:44706602.<br>
I am quite interesting in multi-steps forecasting, and I will be very glad to make friends with you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454778" onclick="return addComment.moveForm( &quot;comment-454778&quot;, &quot;454778&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Xiang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454758" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-454758" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/723b7a4a87f4a1b06fa56347012fe90c.png" srcset="https://secure.gravatar.com/avatar/723b7a4a87f4a1b06fa56347012fe90c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Masahiro</span>
	                <span class="date">November 14, 2018 at 6:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454758" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Thank you for great post every time.</p>
<p>I have tried to predict the difference between current and one-step ahead values instead of one-step ahead value itself.<br>
Is this effective to avoid a persistence model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454758" onclick="return addComment.moveForm( &quot;comment-454758&quot;, &quot;454758&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Masahiro">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454798" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-454798" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2018 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454798" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not quite, differencing the data is a good strategy to make it stationary if there is a trend.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454798" onclick="return addComment.moveForm( &quot;comment-454798&quot;, &quot;454798&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454822" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-454822" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f8055f68235d8ad6e47a628d235d8737.png" srcset="https://secure.gravatar.com/avatar/f8055f68235d8ad6e47a628d235d8737?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kashyap Maheshwari</span>
	                <span class="date">November 15, 2018 at 7:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454822" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,</p>
<p>I tried carrying out the same procedure as you have shown here, but I am getting the following error</p>
<p>yhat = model.predict(X_test)<br>
X_test = X_test.reshape((X_test.shape[0], 1, X_test.shape[2]))<br>
# invert scaling for forecast<br>
inv_yhat = pd.concat((yhat, X_test[:, 1:]), axis=1)<br>
inv_yhat = scaler.inverse_transform(inv_yhat)<br>
inv_yhat = inv_yhat[:,0]<br>
# invert scaling for actual<br>
y_test = y_test.reshape((len(y_test), 1))<br>
inv_y = pd.concat((y_test, X_test[:, 1:]), axis=1)<br>
inv_y = scaler.inverse_transform(inv_y)<br>
inv_y = inv_y[:,0]<br>
# calculate RMSE<br>
rmse = sqrt(mean_squared_error(inv_y, inv_yhat))<br>
print(‘Test RMSE: %.3f’ % rmse)<br>
Traceback (most recent call last):</p>
<p>  File “”, line 4, in<br>
    inv_yhat = pd.concat((yhat, X_test[:, 1:]), axis=1)</p>
<p>  File “C:\Users\kashy\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py”, line 225, in concat<br>
    copy=copy, sort=sort)</p>
<p>  File “C:\Users\kashy\Anaconda3\lib\site-packages\pandas\core\reshape\concat.py”, line 286, in __init__<br>
    raise TypeError(msg)</p>
<p>TypeError: cannot concatenate object of type “”; only pd.Series, pd.DataFrame, and pd.Panel (deprecated) objs are valid</p>
<p>Could you tell me where am I making a mistake?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454822" onclick="return addComment.moveForm( &quot;comment-454822&quot;, &quot;454822&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kashyap Maheshwari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454842" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-454842" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2018 at 11:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454842" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454842" onclick="return addComment.moveForm( &quot;comment-454842&quot;, &quot;454842&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454914" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-454914" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/47e8e06c8bf3e8d470545b9f524b6f8e.png" srcset="https://secure.gravatar.com/avatar/47e8e06c8bf3e8d470545b9f524b6f8e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kashyap Maheshwari</span>
	                <span class="date">November 16, 2018 at 3:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454914" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey,<br>
I found a workaround for that piece of code and it did work out</p>
<p># make a prediction<br>
yhat = model.predict(X_test)<br>
X_test = X_test.reshape((X_test.shape[0], X_test.shape[2]))<br>
X_test = scaler.inverse_transform(X_test)</p>
<p>#invert scaling for forecast<br>
# create empty table with 8 fields<br>
yhat_inv = np.zeros(shape=(len(yhat), 8))<br>
# put the predicted values in the right field<br>
yhat_inv[:,0] = yhat[:,0]<br>
# inverse transform and then select the right field<br>
yhat = scaler.inverse_transform(yhat_inv)[:,0]</p>
<p># invert scaling for actual<br>
y_test_inv = np.zeros(shape=(len(y_test), 8))<br>
y_test = y_test.reshape(y_test.shape[0],1)<br>
y_test_inv[:,0] = y_test[:,0]<br>
y_test = scaler.inverse_transform(y_test_inv)[:,0]</p>
<p># calculate RMSE<br>
from sklearn.metrics import mean_squared_error<br>
rmse = np.sqrt(mean_squared_error(y_test,yhat))<br>
print(‘Test RMSE: %.3f’ % rmse)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454914" onclick="return addComment.moveForm( &quot;comment-454914&quot;, &quot;454914&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Kashyap Maheshwari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454934" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-454934" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2018 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454934" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-454934" onclick="return addComment.moveForm( &quot;comment-454934&quot;, &quot;454934&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455011" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-455011" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/4f8a3756722a33c399eebec24c79208d.png" srcset="https://secure.gravatar.com/avatar/4f8a3756722a33c399eebec24c79208d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Siddhesh wani</span>
	                <span class="date">November 16, 2018 at 7:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455011" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason,</p>
<p>thanks for great tutorial. I’m trying similar kind of modelling but my applications needs to use iterative predictions. by iterative predictions i mean that use current predictions as input for next prediction and so on. In example given in the post, you predict for whole range of X values in one go. My requirement is to use previous (n) samples to predict next value(t=1) and then club this predicted value with previous (n-1) samples to make a new sample of length (n). use this new sample for predicting (t=2) and so on. Though my model gives good results for predicting in one go for available samples it fails for iterative predictions. Can you share your thoughts about it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455011" onclick="return addComment.moveForm( &quot;comment-455011&quot;, &quot;455011&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Siddhesh wani">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455073" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-455073" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2018 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455073" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is called recursive. Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455073" onclick="return addComment.moveForm( &quot;comment-455073&quot;, &quot;455073&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455097" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455097" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a83d4beda77e1dc985b420d0c3aa5e47.png" srcset="https://secure.gravatar.com/avatar/a83d4beda77e1dc985b420d0c3aa5e47?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Schveta</span>
	                <span class="date">November 17, 2018 at 8:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you so much an amazing tutorial! I managed to use your techniques on my data set and got forecast results. However, I getting a validation loss value that is slightly less than the training loss. Why do you think that is the case.</p>
<p>Secondly, all the test data is converted to supervised time series and normalized. How do I convert it back to how it was – unscaled and unsupervised, so that I get rid of the lagging variables and get back the raw data? I want to append unscaled y_inv and yhat to this dataframe and have a collective view of what was the input, what is the real value and what is the predicted value. How can this be obtained?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455097" onclick="return addComment.moveForm( &quot;comment-455097&quot;, &quot;455097&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Schveta">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455223" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-455223" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 18, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455223" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may be cause the validation dataset is less representative than the training dataset, e.g. it’s easier.</p>
<p>You can perform an inverse transform to get back to original units.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455223" onclick="return addComment.moveForm( &quot;comment-455223&quot;, &quot;455223&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455196" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-455196" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9c3a8a5afd51befe4ad19d5a9909fd63.png" srcset="https://secure.gravatar.com/avatar/9c3a8a5afd51befe4ad19d5a9909fd63?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tom</span>
	                <span class="date">November 18, 2018 at 3:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455196" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Big thanks for your tutorial, I’ve tried to apply it to an issue related to CPU utilization. I need to forecast usage of four CPU (cpu1 cpu2 cpu3 cpu4) in next iteration based on present usage and additional variable (ch) which in fact is the root cause of CPU utilization.<br>
For unknown reason the learning process starts with a huge mean_squared_error :</p>
<p>Epoch 1/200<br>
 – 2s – loss: 2157.2555 – val_loss: 1959.0597<br>
Epoch 2/200<br>
 – 2s – loss: 1994.9966 – val_loss: 1823.9065</p>
<p>and ends with much lower value but its still unsatisfying.. </p>
<p>Epoch 199/200<br>
 – 2s – loss: 154.8171 – val_loss: 126.7922<br>
Epoch 200/200<br>
 – 2s – loss: 150.6429 – val_loss: 126.9605</p>
<p>Do you have an idea what is wrong? </p>
<p>The Data basically looks like that: </p>
<p>ch           cpu1     cpu2  cpu3  cpu4<br>
7	       24,02	2	0	0<br>
47	       24,19	2	0	0<br>
87	       25,25	2	0	0<br>
128	       25,98	2	0	0<br>
167	       26,5	        2	0	0<br>
…<br>
2050	28,02	5,29	2,35	9,42<br>
2093	28,02	5,4	2,35	9,58<br>
2134	28,02	5,51	2,35	9,73<br>
…<br>
6014	30,04	14,69	8,02	32,57<br>
6054	30,04	14,77	8,06	32,81<br>
6094	30,1	        14,85	8,08	33,08<br>
…<br>
13818	40,56	32,55	60,71	92,31<br>
13818	40,56	32,58	60,71	92,24<br>
13818	40,52	32,61	60,71	92,13</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455196" onclick="return addComment.moveForm( &quot;comment-455196&quot;, &quot;455196&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tom">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455241" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-455241" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 18, 2018 at 6:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455241" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds like a fun project. </p>
<p>Perhaps scale the data?<br>
Perhaps start with a linear model per series?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455241" onclick="return addComment.moveForm( &quot;comment-455241&quot;, &quot;455241&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455547" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-455547" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/9c3a8a5afd51befe4ad19d5a9909fd63.png" srcset="https://secure.gravatar.com/avatar/9c3a8a5afd51befe4ad19d5a9909fd63?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tom</span>
	                <span class="date">November 20, 2018 at 5:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>&gt;&gt; Sounds like a fun project.<br>
    Indeed, I truly believe that ML can give better results than standard approach.<br>
    Will give you feedback after all<br>
&gt;&gt; Perhaps scale the data?<br>
    Please advise,<br>
    CPU are 0-100 -&gt; scale to 0-1?<br>
    ch is 0- 20k (maybe 30 or even more) cant estimate the max value. -&gt; what scaling<br>
    function can I use here ?<br>
&gt;&gt; Perhaps start with a linear model per series?<br>
    Do you mean another predictor like for e.g Linear regression?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455547" onclick="return addComment.moveForm( &quot;comment-455547&quot;, &quot;455547&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Tom">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455574" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-455574" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 20, 2018 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455574" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try normalizing or standardizing the data prior to modeling.</p>
<p>I meant SARIMA or ETS.</p>
<p>See this process:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455574" onclick="return addComment.moveForm( &quot;comment-455574&quot;, &quot;455574&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455491" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455491" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09018d015f54aa074cf6c71066c0802e.png" srcset="https://secure.gravatar.com/avatar/09018d015f54aa074cf6c71066c0802e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan B.</span>
	                <span class="date">November 19, 2018 at 3:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455491" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
It’s possible to use this code in a unsupervised problem?<br>
I want to predict new data</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455491" onclick="return addComment.moveForm( &quot;comment-455491&quot;, &quot;455491&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Juan B.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455555" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-455555" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 20, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455555" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Predicting is a supervised learning problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455555" onclick="return addComment.moveForm( &quot;comment-455555&quot;, &quot;455555&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455803" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-455803" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09018d015f54aa074cf6c71066c0802e.png" srcset="https://secure.gravatar.com/avatar/09018d015f54aa074cf6c71066c0802e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan B.</span>
	                <span class="date">November 22, 2018 at 7:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes it is, but it doesn’t predict future values?<br>
What i understand it’s that it predict known outputs</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455803" onclick="return addComment.moveForm( &quot;comment-455803&quot;, &quot;455803&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Juan B.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455821" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-455821" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2018 at 2:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455821" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Forecasting by definition involves predicting unknown values.</p>
<p>Perhaps I don’t understand your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455821" onclick="return addComment.moveForm( &quot;comment-455821&quot;, &quot;455821&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456493" class="comment odd alt depth-5">

	      	<div id="li-comment-456493" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09018d015f54aa074cf6c71066c0802e.png" srcset="https://secure.gravatar.com/avatar/09018d015f54aa074cf6c71066c0802e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan B.</span>
	                <span class="date">November 29, 2018 at 2:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, please help me with two questions about your code:</p>
<p>1. The predicted values are unkown values but, they are found in function of the test data set? In that case, it means it is predicting till actual time step,not to next time stemps. Please explain to me<br>
2. How many predictions does the code? Just one time step? Can I predict more time steps changing the variable n_train_hours (line 58)</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-456541" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-456541" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2018 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456541" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have examples of different types of LSTMs for time series forecasting here, including multi-step:<br>
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455933" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-455933" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ea34dca6280bddea25f5e4dd0e616b04.png" srcset="https://secure.gravatar.com/avatar/ea34dca6280bddea25f5e4dd0e616b04?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ZHOU</span>
	                <span class="date">November 23, 2018 at 8:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455933" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello, I just face the same problem like you.Have you solved this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455933" onclick="return addComment.moveForm( &quot;comment-455933&quot;, &quot;455933&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to ZHOU">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455975" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-455975" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455975" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try another model type, e.g. MLP or CNN?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-456496" class="comment odd alt depth-5">

	      	<div id="li-comment-456496" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09018d015f54aa074cf6c71066c0802e.png" srcset="https://secure.gravatar.com/avatar/09018d015f54aa074cf6c71066c0802e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan B.</span>
	                <span class="date">November 29, 2018 at 2:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456496" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Zhou, no i don’t.<br>
Tell me if you achieved please</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-456564" class="comment even depth-5">

	      	<div id="li-comment-456564" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09018d015f54aa074cf6c71066c0802e.png" srcset="https://secure.gravatar.com/avatar/09018d015f54aa074cf6c71066c0802e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan</span>
	                <span class="date">November 29, 2018 at 10:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>the RMSE value magnitude (it’s too large) depends on my data magnitude order?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455950" class="comment odd alt depth-4">

	      	<div id="li-comment-455950" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ea34dca6280bddea25f5e4dd0e616b04.png" srcset="https://secure.gravatar.com/avatar/ea34dca6280bddea25f5e4dd0e616b04?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ZHOU</span>
	                <span class="date">November 24, 2018 at 12:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455950" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello, have you worked out this question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455950" onclick="return addComment.moveForm( &quot;comment-455950&quot;, &quot;455950&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to ZHOU">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455931" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-455931" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/ea34dca6280bddea25f5e4dd0e616b04.png" srcset="https://secure.gravatar.com/avatar/ea34dca6280bddea25f5e4dd0e616b04?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ZHOU</span>
	                <span class="date">November 23, 2018 at 7:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I have a question. When I plot the curve of yhat and test_y, I find yhat just follow itself.(like yhat[i] = y[i]).Can you please explain this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455931" onclick="return addComment.moveForm( &quot;comment-455931&quot;, &quot;455931&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to ZHOU">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455974" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455974" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds like a persistence model:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455974" onclick="return addComment.moveForm( &quot;comment-455974&quot;, &quot;455974&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455940" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455940" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f4a866ad94a89e9da77eba28113bd380.png" srcset="https://secure.gravatar.com/avatar/f4a866ad94a89e9da77eba28113bd380?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andreas</span>
	                <span class="date">November 23, 2018 at 9:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455940" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>i have a simple question about the time series to supervised function. In case i want to use a supervised model for a classification problem (e.g. SGDClassifier), do i have to include the original labels as well in the transformed input data for training and testing? It would look like this in case of 2 features in my input data and using a window size of 2:</p>
<p>x1(t-2) x2(t-2) y(t-2) x1(t-1) x2(t-1) y(t-1) x1(t) x2(t) y(t)</p>
<p>y(t) is the label that i either give in the traning stage or predict in the test stage. But do i have to remove the y(t-2) and y(t-1) from my transformed input data or do they have to be included?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455940" onclick="return addComment.moveForm( &quot;comment-455940&quot;, &quot;455940&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Andreas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455978" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455978" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455978" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help you prepare your data:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455978" onclick="return addComment.moveForm( &quot;comment-455978&quot;, &quot;455978&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455999" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-455999" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1a294f2b03ec8daefbac2e9e01023336.png" srcset="https://secure.gravatar.com/avatar/1a294f2b03ec8daefbac2e9e01023336?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Francisco Rodriguez</span>
	                <span class="date">November 24, 2018 at 10:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455999" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>Congratulate you, guide me and tell how I can reuse the model to predict a future value starting from a model generated and recorded as using for example</p>
<p>lstm.save (my_modelo.h5 ‘)</p>
<p>Now my question is the model that can be used to predict future values ​​with new input, you could help me or guide if you have a post that says how to use multivarinate lstm already trained that iliustre how to process the model with new values.</p>
<p>I hope you can help me,</p>
<p>Greetings from Ecuador</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-455999" onclick="return addComment.moveForm( &quot;comment-455999&quot;, &quot;455999&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Francisco Rodriguez">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456062" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456062" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 25, 2018 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456062" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can load the model and start using it by calling model.predict()</p>
<p>I give more advice on making predictions here:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>
<p>And here:<br>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" rel="nofollow">https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456062" onclick="return addComment.moveForm( &quot;comment-456062&quot;, &quot;456062&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456013" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-456013" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/b85a20bdb768275f9785afb4b55bc32e.png" srcset="https://secure.gravatar.com/avatar/b85a20bdb768275f9785afb4b55bc32e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">November 24, 2018 at 3:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456013" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason</p>
<p>Thank you for your great posts.<br>
Based on my readings, we need to normalize the data after we have splitted our train and test data. Can you please explain why you have normalized all the data at once. Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456013" onclick="return addComment.moveForm( &quot;comment-456013&quot;, &quot;456013&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456064" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456064" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 25, 2018 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456064" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, I explain how here:<br>
<a href="https://machinelearningmastery.com/how-to-scale-data-for-long-short-term-memory-networks-in-python/" rel="nofollow">https://machinelearningmastery.com/how-to-scale-data-for-long-short-term-memory-networks-in-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456064" onclick="return addComment.moveForm( &quot;comment-456064&quot;, &quot;456064&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456047" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-456047" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c7b7ba24849575bafc9da8006ef077a4.png" srcset="https://secure.gravatar.com/avatar/c7b7ba24849575bafc9da8006ef077a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yi</span>
	                <span class="date">November 25, 2018 at 2:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456047" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for the great article!<br>
In your program, the input X is a one-dimensional vector, which is denoteded as 1*8. And in the model, input_shape=(train_X.shape[1], train_X.shape[2]), here the train_X.shape[2] represents 8 input characteristics. But what should i do when the input X is a two-dimensional vector? For example, sometimes we may want to organise these 8 imput features in a matrix of 2 rows and 4 columns. I hope you can help me.<br>
Thank you for your careful guidance.Best wishes!<br>
Guyi</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456047" onclick="return addComment.moveForm( &quot;comment-456047&quot;, &quot;456047&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Yi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456072" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-456072" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 25, 2018 at 6:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456072" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean by 2 rows and 4 columns for a single sample?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456072" onclick="return addComment.moveForm( &quot;comment-456072&quot;, &quot;456072&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456168" class="comment even depth-3 parent">

	      	<div id="li-comment-456168" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c7b7ba24849575bafc9da8006ef077a4.png" srcset="https://secure.gravatar.com/avatar/c7b7ba24849575bafc9da8006ef077a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yi</span>
	                <span class="date">November 26, 2018 at 10:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456168" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can think of it as a matrix on a graph. Or in another way, when I want to put a sequence of images into the LSTM model, what should i do?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456168" onclick="return addComment.moveForm( &quot;comment-456168&quot;, &quot;456168&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Yi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456184" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-456184" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 26, 2018 at 2:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try a ConvLSTM2D? I have an example here:<br>
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456184" onclick="return addComment.moveForm( &quot;comment-456184&quot;, &quot;456184&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456206" class="comment even depth-5">

	      	<div id="li-comment-456206" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/c7b7ba24849575bafc9da8006ef077a4.png" srcset="https://secure.gravatar.com/avatar/c7b7ba24849575bafc9da8006ef077a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yi</span>
	                <span class="date">November 26, 2018 at 5:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456206" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I find a example of ConvLSTM in this website. But I can’t find the example of ConvLSTM2D. Does ConvLSTM model is suitable for my problem? I am a beginner in deep learning and hope you don’t mind.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-456269" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-456269" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 27, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456269" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The ConvLSTM is implemented using a ConvLSTM2D layer in Keras.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456193" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-456193" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/6eb08041118b72c853eb2eeb6a0eafb1.png" srcset="https://secure.gravatar.com/avatar/6eb08041118b72c853eb2eeb6a0eafb1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gazelle</span>
	                <span class="date">November 26, 2018 at 2:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456193" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for your fruitful tutorials. I wonder if can use time series in predicting multiple variable? Just like multi-task learning</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456193" onclick="return addComment.moveForm( &quot;comment-456193&quot;, &quot;456193&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Gazelle">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456264" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456264" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 27, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456264" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I have some examples here:<br>
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456264" onclick="return addComment.moveForm( &quot;comment-456264&quot;, &quot;456264&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456260" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-456260" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5b20853bff36a800b940105036edf8a4.png" srcset="https://secure.gravatar.com/avatar/5b20853bff36a800b940105036edf8a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luis Mendes</span>
	                <span class="date">November 27, 2018 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456260" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi there!! I have a big question!</p>
<p>So, this predicts the next day pollution, but i want to predict for example, 7 days in advance! not knowing the pollutions behind!</p>
<p>Lets imagine:</p>
<p>You have data until 2014-12-31, and i want to predict pollution data for 1, 2, 3, 4, 5 of January! knowing only the atmospheric data offcourse (dew,temp,press,wnd_dir,wnd_spd,snow,rain).</p>
<p>I ask this because i can’t figure it out how :/.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456260" onclick="return addComment.moveForm( &quot;comment-456260&quot;, &quot;456260&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Luis Mendes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456286" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456286" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 27, 2018 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456286" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is multi-step forecasting and I have many examples. You can get started here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456286" onclick="return addComment.moveForm( &quot;comment-456286&quot;, &quot;456286&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456448" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-456448" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a9a5c48e013116a28ee4b63ca43592fe.png" srcset="https://secure.gravatar.com/avatar/a9a5c48e013116a28ee4b63ca43592fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hung Nguyen</span>
	                <span class="date">November 28, 2018 at 3:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456448" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Firstly thanks for all useful tutorials so far.<br>
I have one question regarding the first dimension “sample”. I just don’t get the meaning of converting 2D to 3D data frame here, as “Beijing, China” seems to be the one and only “sample” in the dataset. Am I misunderstanding something?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456448" onclick="return addComment.moveForm( &quot;comment-456448&quot;, &quot;456448&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hung Nguyen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456528" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-456528" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2018 at 7:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456528" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this will help:<br>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456528" onclick="return addComment.moveForm( &quot;comment-456528&quot;, &quot;456528&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456575" class="comment even depth-3 parent">

	      	<div id="li-comment-456575" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/a9a5c48e013116a28ee4b63ca43592fe.png" srcset="https://secure.gravatar.com/avatar/a9a5c48e013116a28ee4b63ca43592fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hung Nguyen</span>
	                <span class="date">November 29, 2018 at 1:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456575" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks! That did help.<br>
However after reading a comment below that post I had another confusion.<br>
“Am I correct to say that in the iris dataset, the timesteps can be 2, 3, 5, 6 – as long as it neatly divides the dataset into equal number of rows (iris has 150 rows).<br>
And the number of features will be the number of columns (apart from the target column/class)?<br>
—&gt; The iris dataset is not a sequence classification problem. It does not have time steps, only samples and features.”</p>
<p>But in this PM2.5 dataset you converted all time steps into samples, leaving only one time step. Isn’t it equivalent to a dataset with only samples and features (panel data)? Or is it correct to say panel data is 3D data with 1 time-step?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456575" onclick="return addComment.moveForm( &quot;comment-456575&quot;, &quot;456575&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Hung Nguyen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456591" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-456591" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2018 at 2:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but problem has a temporal relationship between observations and the LSTM can harness this relationship.</p>
<p>Iris does not have such a relationship, using an LSTM will cause it to try to learn this relationship, which would be problematic (it does not exist).</p>
<p>Perhaps this post on time series as supervised learning will help:<br>
<a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456591" onclick="return addComment.moveForm( &quot;comment-456591&quot;, &quot;456591&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456472" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-456472" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/017d4ed257a6adefd8d7db937fb7b354.png" srcset="https://secure.gravatar.com/avatar/017d4ed257a6adefd8d7db937fb7b354?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">wei</span>
	                <span class="date">November 28, 2018 at 8:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456472" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, jason<br>
I have one question, after training the model, I use this code yhat = model.predict(test_X) to predict the pollution, actually the first col of test_X is real pollution, I want to use the other 7 col data to predict the pollution,  can I fill the first col of test_X with zero?  I do that, the predict result is wrong, why?<br>
thank!<br>
wei</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456472" onclick="return addComment.moveForm( &quot;comment-456472&quot;, &quot;456472&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to wei">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456532" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456532" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2018 at 7:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can remove the variable from the input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456532" onclick="return addComment.moveForm( &quot;comment-456532&quot;, &quot;456532&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456495" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-456495" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/f533344af0d13b4fc4c35341578e86fa.png" srcset="https://secure.gravatar.com/avatar/f533344af0d13b4fc4c35341578e86fa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Savan Gowda</span>
	                <span class="date">November 29, 2018 at 2:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456495" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you very much for this great explanation of LSTMs for Multivariate Time Series. i have one question regarding the input variables that is included. Is it a good idea to include pollution at (t-1) also as an input variable to predict pollution at (t) along with other input parameters, as we already have information about the pollution available, wouldn’t the LSTM be biased and learn only from the behavior of this variable? Looking forward for your answer! </p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456495" onclick="return addComment.moveForm( &quot;comment-456495&quot;, &quot;456495&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Savan Gowda">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456542" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456542" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2018 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456542" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Maybe. Perhaps experiment and discover the answer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456542" onclick="return addComment.moveForm( &quot;comment-456542&quot;, &quot;456542&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456659" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-456659" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/37ff4b71a600e72671dea22825f2eef5.png" srcset="https://secure.gravatar.com/avatar/37ff4b71a600e72671dea22825f2eef5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">martin</span>
	                <span class="date">November 30, 2018 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456659" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason Thanks for all those tutos, they are very helpful.</p>
<p>I’ve a question for the multivariate time series :<br>
When the target Y is at step T, one uses the features and targets of previous steps T-1, T-2, etc. But one does not use the features of step T.</p>
<p>==&gt; Is it possible to use the features contained at time T ?</p>
<p>Hope my question is clear enough.</p>
<p>Thanks in advance,<br>
Best regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456659" onclick="return addComment.moveForm( &quot;comment-456659&quot;, &quot;456659&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to martin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456670" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456670" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 30, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456670" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456670" onclick="return addComment.moveForm( &quot;comment-456670&quot;, &quot;456670&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456751" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-456751" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5b20853bff36a800b940105036edf8a4.png" srcset="https://secure.gravatar.com/avatar/5b20853bff36a800b940105036edf8a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luis Mendes</span>
	                <span class="date">December 1, 2018 at 3:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456751" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello again.</p>
<p>Well, i have another noob question.</p>
<p>Here:</p>
<p>train_X, train_y = train[:, :n_obs], train[:, -n_features]<br>
test_X, test_y = test[:, :n_obs], test[:, -n_features]</p>
<p>To this, the test_X will have 3 * 8 columns, but there are 8 columns left, that are the var(t) values. Well, one of this 8 left is the pollution value, so lets say there are 7 columns left.</p>
<p>Shouldn’t text_X have this 7 columns from var(t), so the atmospheric data count for the predict of var(t) pollution day?</p>
<p>Many thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456751" onclick="return addComment.moveForm( &quot;comment-456751&quot;, &quot;456751&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Luis Mendes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-457071" class="comment odd alt depth-2">

	      	<div id="li-comment-457071" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5b20853bff36a800b940105036edf8a4.png" srcset="https://secure.gravatar.com/avatar/5b20853bff36a800b940105036edf8a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luis Mendes</span>
	                <span class="date">December 3, 2018 at 10:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457071" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Don’t kniw if you see this post. </p>
<p>But can you check?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457071" onclick="return addComment.moveForm( &quot;comment-457071&quot;, &quot;457071&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Luis Mendes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-457089" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-457089" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 3, 2018 at 2:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457089" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, no, we discard the remaining data, but then use it directly for predicting the subsequent time step.</p>
<p>Perhaps this post will help the framing of the problem as supervised learning:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457089" onclick="return addComment.moveForm( &quot;comment-457089&quot;, &quot;457089&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-457303" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-457303" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5b20853bff36a800b940105036edf8a4.png" srcset="https://secure.gravatar.com/avatar/5b20853bff36a800b940105036edf8a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luis Mendes</span>
	                <span class="date">December 5, 2018 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457303" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I really tried to figure it out, but I couldn’t :/.</p>
<p>How can I shape de data to contain the atmospheric data of tomorrow excluding the pollution of tomorrow? because this changes the all thing.</p>
<p>because i and appending 7 days (atmospheric data + pollution value (8 columns)), and i want to append the atmospheric data for tomorrow (7 columns of data) so the predict of tomorrow pollution can be more accurate.</p>
<p>What am I missing here? :/</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457303" onclick="return addComment.moveForm( &quot;comment-457303&quot;, &quot;457303&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Luis Mendes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-457320" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-457320" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 5, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457320" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You will have to write some custom code to prepare the data in this way.</p>
<p>Sorry, I don’t have the capacity to write this code for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457320" onclick="return addComment.moveForm( &quot;comment-457320&quot;, &quot;457320&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-457335" class="comment odd alt depth-5">

	      	<div id="li-comment-457335" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/5b20853bff36a800b940105036edf8a4.png" srcset="https://secure.gravatar.com/avatar/5b20853bff36a800b940105036edf8a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luis Mendes</span>
	                <span class="date">December 5, 2018 at 8:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457335" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok thanks anyway :D.</p>
<p>If i got a solution I’ll post it here.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456755" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-456755" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/09b635fb8858273506353c7e49552005.png" srcset="https://secure.gravatar.com/avatar/09b635fb8858273506353c7e49552005?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Camilo</span>
	                <span class="date">December 1, 2018 at 5:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456755" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Dr. Jason,<br>
If I have a RMSE of 25496.75 it’s not a good value?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456755" onclick="return addComment.moveForm( &quot;comment-456755&quot;, &quot;456755&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Camilo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456767" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456767" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 1, 2018 at 6:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456767" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-to-know-if-a-model-has-good-performance" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-to-know-if-a-model-has-good-performance</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-456767" onclick="return addComment.moveForm( &quot;comment-456767&quot;, &quot;456767&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-457010" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-457010" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e84b8d10aa41e65e30b7525ae726c0a4.png" srcset="https://secure.gravatar.com/avatar/e84b8d10aa41e65e30b7525ae726c0a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pierre Laflamme</span>
	                <span class="date">December 3, 2018 at 1:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Your articles are awesome! For my use as a process engineer, they provide the most useful information I can find. Keep up the excellent work!</p>
<p>Is there a good way to consider a time lag that changes through time in multivariate time series? For example, in a chemical industrial process I work on, the final product may take between 16 hours and 32 hours to get from the beginning to the end of the end process (passing though different stages of the process and through different tanks). The time lag will depend on the product flow in the different stages and on the level of the different tanks (we have real-time measurements of these flows and levels). For example, if tanks are full and all stages are slowed down, the time lag will be much longer for a given period. </p>
<p>I would thus like to predict a quality parameter at the end of the process from different process parameters at the beginning of the process considering this variable time lag. Currently, I do so doing weekly rolling averages, but I would like to improve the prediction precision in time.  </p>
<p>Do you have an article on this subject?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457010" onclick="return addComment.moveForm( &quot;comment-457010&quot;, &quot;457010&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Pierre Laflamme">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-457046" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-457046" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 3, 2018 at 6:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457046" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, you could pad the variable length sequences with 0 values and use a Masking layer to ignore the padded values.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-457046" onclick="return addComment.moveForm( &quot;comment-457046&quot;, &quot;457046&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458075" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-458075" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/8079db6575f0524d5abef7b811f80b6c.png" srcset="https://secure.gravatar.com/avatar/8079db6575f0524d5abef7b811f80b6c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Christophe</span>
	                <span class="date">December 11, 2018 at 2:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-458075" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great article again. Totally love your work.</p>
<p>I am curious to know if you have an idea why all my time series LSTM work is ending up in a network that return the same value for all cases in the dataset (roughly the mean). So instead of predicting (y):</p>
<p>[[-0.01705725]<br>
 [ 0.01895695]<br>
 [-0.01623851]<br>
 [ 0.00772999]<br>
 [ 0.00546604]<br>
 [-0.01859799]<br>
 [-0.00874636]<br>
 [-0.01666667]<br>
 [ 0.01186441]<br>
 [ 0.00201991]<br>
 [-0.00290083]<br>
 [-0.00986193]]</p>
<p>for example, it would predict (y_hat):</p>
<p>[[0.31817305]<br>
 [0.31918538]<br>
 [0.3168676 ]<br>
 [0.31791273]<br>
 [0.31691164]<br>
 [0.31631264]<br>
 [0.3179203 ]<br>
 [0.3183312 ]<br>
 [0.3190964 ]<br>
 [0.31722257]<br>
 [0.3165959 ]<br>
 [0.31672308]]</p>
<p>Where the mean of the dataset is 0.317702080498597</p>
<p>So it feels like my model always end-up trying to learn to output the mean (( I noticed the same effect with different time series and different LSTM architectures.</p>
<p>Have you had similar issue in the past ? How did you sort out the problem ? I tried to change the learning rate, the function, the number of layers, the number of nodes per layer, the  “lag” length, etc … But it always gets back to outputting the same value ((</p>
<p>Thanks in advance for your answer.</p>
<p>Regards,<br>
Christophe</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-458075" onclick="return addComment.moveForm( &quot;comment-458075&quot;, &quot;458075&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Christophe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458110" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-458110" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2018 at 7:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-458110" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it suggests the model has learned a persistance model:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>
<p>I recommend following this process:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-458110" onclick="return addComment.moveForm( &quot;comment-458110&quot;, &quot;458110&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458079" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-458079" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/e07dbeca44403b0dcd13d0cf2d4b6bfc.png" srcset="https://secure.gravatar.com/avatar/e07dbeca44403b0dcd13d0cf2d4b6bfc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter Klein</span>
	                <span class="date">December 11, 2018 at 4:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-458079" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, </p>
<p>You say:</p>
<p>The first step is to prepare the pollution dataset for the LSTM.</p>
<p>This involves framing the dataset as a supervised learning problem </p>
<p>How does this make sense in the context of LSTM. Your input should just be the sequence. There is no need to frame it as a supervised learning problem by considering lags. </p>
<p>Of course your loss function will have to compare prediction to realized value, but isnt the idea behind RNN that you dont have to resort to the “trick” of reframing your time series problem as a supervised problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-458079" onclick="return addComment.moveForm( &quot;comment-458079&quot;, &quot;458079&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Peter Klein">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458111" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-458111" class="comment-container">

					                <div class="avatar"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2018 at 7:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-458111" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, you still need input and output patterns to fit the model, it just so happens that the input patterns are sequences of observations, rather than single observations.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#comment-458111" onclick="return addComment.moveForm( &quot;comment-458111&quot;, &quot;458111&quot;, &quot;respond&quot;, &quot;4195&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#respond" style="display:none;">Click here to cancel reply.</a></small></h3>			<form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="4195" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e4c3fbd123"></p><p style="display: none;"></p>			<input type="hidden" id="ak_js" name="ak_js" value="1544482482239"></form>
			</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/1d75d46040c28497f0dee5d8e100db37(2).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" height="100" width="100"></span>
<p>Hi, I'm Jason Brownlee, PhD
<br>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="https://machinelearningmastery.com/about">Read More</a></p>
<div class="fix"></div>
</div><div id="text-51" class="widget widget_text">			<div class="textwidget"><p></p><center><br>
<strong>Deep Learning for Time Series</strong><br>
Forecast the future with MLPs, CNNs, and LSTMs.<p></p>
<p><a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/">Click to Get Started Now!</a><br>
<a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/"><img src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/Cover-220.png"></a><br>
</p></center><p></p>
</div>
		</div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#tab-pop" class="selected">Popular</a></li>                                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul id="tab-pop" class="list" style="display: block;">
                    	<li>
		<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img width="45" height="45" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" class="thumbnail wp-post-image" alt="How to Develop a Neural Machine Translation System in Keras" title="How to Develop a Neural Machine Translation System from Scratch"></a>		<a title="How to Develop a Neural Machine Translation System from Scratch" href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/">How to Develop a Neural Machine Translation System from Scratch</a>
		<span class="meta">January 10, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img width="45" height="45" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" class="thumbnail wp-post-image" alt="Difference Between Classification and Regression in Machine Learning" title="Difference Between Classification and Regression in Machine Learning"></a>		<a title="Difference Between Classification and Regression in Machine Learning" href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/">Difference Between Classification and Regression in Machine Learning</a>
		<span class="meta">December 11, 2017</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img width="45" height="45" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" class="thumbnail wp-post-image" alt="So, You are Working on a Machine Learning Problem..." title="So, You are Working on a Machine Learning Problem..."></a>		<a title="So, You are Working on a Machine Learning Problem…" href="https://machinelearningmastery.com/working-machine-learning-problem/">So, You are Working on a Machine Learning Problem…</a>
		<span class="meta">April 4, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img width="45" height="45" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" class="thumbnail wp-post-image" alt="Plot of the Multichannel Convolutional Neural Network For Text" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"></a>		<a title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
		<span class="meta">January 12, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img width="45" height="45" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" class="thumbnail wp-post-image" alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" title="How to Make Predictions with Keras"></a>		<a title="How to Make Predictions with Keras" href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/">How to Make Predictions with Keras</a>
		<span class="meta">April 9, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img width="45" height="45" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" class="thumbnail wp-post-image" alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"></a>		<a title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
		<span class="meta">August 6, 2018</span>
		<div class="fix"></div>
	</li>
		<li style="border-bottom: 0px;">
		<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img width="45" height="45" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" class="thumbnail wp-post-image" alt="How to Visualize a Deep Learning Neural Network Model in Keras" title="How to Visualize a Deep Learning Neural Network Model in Keras"></a>		<a title="How to Visualize a Deep Learning Neural Network Model in Keras" href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/">How to Visualize a Deep Learning Neural Network Model in Keras</a>
		<span class="meta">December 13, 2017</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         <div id="custom_html-2" class="widget_text widget widget_custom_html"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
	<li><a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
  <li><a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
	<li><a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
	<li><a href="https://machinelearningmastery.com/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
	<li><a href="https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
			<p></p><p>
<a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a>
</p><p></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/comment-reply.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/scripts.js"></script>
<script type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/wp-embed.min.js"></script>
<script async="async" type="text/javascript" src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/form.js"></script>

<div style="position: absolute; right: 0px; left: 0px; bottom: 0px; top: 0px; z-index: 2147483646; background: black; width: 100%; opacity: 0.5; display: none; height: 290285px;"></div><iframe src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/saved_resource.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 741px;"></iframe><iframe src="./Multivariate Time Series Forecasting with LSTMs in Keras_files/saved_resource(1).html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 741px;"></iframe><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image classic">
    <div id="drip-header-2211" class="drip-header">
      <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Your Start in Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -546px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Your Start in Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without the math or fancy degree</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em> email course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
            </div>
            <dl class="no-labels">
              
                
                  <dt>Email Address</dt>
                  <dd class="drip-clearfix">
                    
                      <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field">
                      <div id="drip-errors-for-email-2211" class="drip-errors"></div>
                    
                  </dd>
                
              
                
                  <dt></dt>
                  <dd class="drip-clearfix">
                    
                      <div class="classic--checkbox hidden" data-container="eu-checkbox">
                        <input type="hidden" name="fields[eu_consent]" id="drip-field-eu_consent-denied" value="denied" disabled="disabled">
                        <input type="checkbox" name="fields[eu_consent]" id="drip-field-eu_consent" value="granted" disabled="disabled">
                        <label for="drip-field-eu_consent">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
                      </div>
                    
                  </dd>
                
              
                
                  <input type="hidden" name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/).">
                
              
            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>

      
    </div>
  </div>
</div></body></html>